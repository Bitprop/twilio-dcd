(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerpolicy&&(i.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?i.credentials="include":a.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();function mh(e,t){const r=Object.create(null),n=e.split(",");for(let a=0;a<n.length;a++)r[n[a]]=!0;return t?a=>!!r[a.toLowerCase()]:a=>!!r[a]}const WI="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",GI=mh(WI);function C0(e){return!!e||e===""}function bh(e){if(it(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],a=sr(n)?KI(n):bh(n);if(a)for(const i in a)t[i]=a[i]}return t}else{if(sr(e))return e;if(Bt(e))return e}}const zI=/;(?![^(]*\))/g,VI=/:(.+)/;function KI(e){const t={};return e.split(zI).forEach(r=>{if(r){const n=r.split(VI);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function zc(e){let t="";if(sr(e))t=e;else if(it(e))for(let r=0;r<e.length;r++){const n=zc(e[r]);n&&(t+=n+" ")}else if(Bt(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}const Ar=e=>sr(e)?e:e==null?"":it(e)||Bt(e)&&(e.toString===P0||!ut(e.toString))?JSON.stringify(e,R0,2):String(e),R0=(e,t)=>t&&t.__v_isRef?R0(e,t.value):Gs(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,a])=>(r[`${n} =>`]=a,r),{})}:A0(t)?{[`Set(${t.size})`]:[...t.values()]}:Bt(t)&&!it(t)&&!M0(t)?String(t):t,xt={},Ws=[],Pn=()=>{},YI=()=>!1,JI=/^on[^a-z]/,Vc=e=>JI.test(e),wh=e=>e.startsWith("onUpdate:"),wr=Object.assign,_h=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},QI=Object.prototype.hasOwnProperty,ht=(e,t)=>QI.call(e,t),it=Array.isArray,Gs=e=>Kc(e)==="[object Map]",A0=e=>Kc(e)==="[object Set]",ut=e=>typeof e=="function",sr=e=>typeof e=="string",Sh=e=>typeof e=="symbol",Bt=e=>e!==null&&typeof e=="object",O0=e=>Bt(e)&&ut(e.then)&&ut(e.catch),P0=Object.prototype.toString,Kc=e=>P0.call(e),XI=e=>Kc(e).slice(8,-1),M0=e=>Kc(e)==="[object Object]",$h=e=>sr(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,nc=mh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Yc=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},ZI=/-(\w)/g,Yn=Yc(e=>e.replace(ZI,(t,r)=>r?r.toUpperCase():"")),eC=/\B([A-Z])/g,es=Yc(e=>e.replace(eC,"-$1").toLowerCase()),Jc=Yc(e=>e.charAt(0).toUpperCase()+e.slice(1)),Qf=Yc(e=>e?`on${Jc(e)}`:""),$u=(e,t)=>!Object.is(e,t),ac=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},hc=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},Wp=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Pg;const tC=()=>Pg||(Pg=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Gr;class x0{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&Gr&&(this.parent=Gr,this.index=(Gr.scopes||(Gr.scopes=[])).push(this)-1)}run(t){if(this.active){const r=Gr;try{return Gr=this,t()}finally{Gr=r}}}on(){Gr=this}off(){Gr=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(this.parent&&!t){const a=this.parent.scopes.pop();a&&a!==this&&(this.parent.scopes[this.index]=a,a.index=this.index)}this.active=!1}}}function N0(e){return new x0(e)}function rC(e,t=Gr){t&&t.active&&t.effects.push(e)}function nC(){return Gr}function aC(e){Gr&&Gr.cleanups.push(e)}const Th=e=>{const t=new Set(e);return t.w=0,t.n=0,t},L0=e=>(e.w&ii)>0,j0=e=>(e.n&ii)>0,iC=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=ii},sC=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const a=t[n];L0(a)&&!j0(a)?a.delete(e):t[r++]=a,a.w&=~ii,a.n&=~ii}t.length=r}},Gp=new WeakMap;let su=0,ii=1;const zp=30;let En;const Gi=Symbol(""),Vp=Symbol("");class kh{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,rC(this,n)}run(){if(!this.active)return this.fn();let t=En,r=Xa;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=En,En=this,Xa=!0,ii=1<<++su,su<=zp?iC(this):Mg(this),this.fn()}finally{su<=zp&&sC(this),ii=1<<--su,En=this.parent,Xa=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){En===this?this.deferStop=!0:this.active&&(Mg(this),this.onStop&&this.onStop(),this.active=!1)}}function Mg(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let Xa=!0;const U0=[];function vo(){U0.push(Xa),Xa=!1}function ho(){const e=U0.pop();Xa=e===void 0?!0:e}function Yr(e,t,r){if(Xa&&En){let n=Gp.get(e);n||Gp.set(e,n=new Map);let a=n.get(r);a||n.set(r,a=Th()),F0(a)}}function F0(e,t){let r=!1;su<=zp?j0(e)||(e.n|=ii,r=!L0(e)):r=!e.has(En),r&&(e.add(En),En.deps.push(e))}function ya(e,t,r,n,a,i){const s=Gp.get(e);if(!s)return;let u=[];if(t==="clear")u=[...s.values()];else if(r==="length"&&it(e))s.forEach((o,l)=>{(l==="length"||l>=n)&&u.push(o)});else switch(r!==void 0&&u.push(s.get(r)),t){case"add":it(e)?$h(r)&&u.push(s.get("length")):(u.push(s.get(Gi)),Gs(e)&&u.push(s.get(Vp)));break;case"delete":it(e)||(u.push(s.get(Gi)),Gs(e)&&u.push(s.get(Vp)));break;case"set":Gs(e)&&u.push(s.get(Gi));break}if(u.length===1)u[0]&&Kp(u[0]);else{const o=[];for(const l of u)l&&o.push(...l);Kp(Th(o))}}function Kp(e,t){const r=it(e)?e:[...e];for(const n of r)n.computed&&xg(n);for(const n of r)n.computed||xg(n)}function xg(e,t){(e!==En||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const oC=mh("__proto__,__v_isRef,__isVue"),D0=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Sh)),uC=Eh(),lC=Eh(!1,!0),cC=Eh(!0),Ng=fC();function fC(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=mt(this);for(let i=0,s=this.length;i<s;i++)Yr(n,"get",i+"");const a=n[t](...r);return a===-1||a===!1?n[t](...r.map(mt)):a}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){vo();const n=mt(this)[t].apply(this,r);return ho(),n}}),e}function Eh(e=!1,t=!1){return function(n,a,i){if(a==="__v_isReactive")return!e;if(a==="__v_isReadonly")return e;if(a==="__v_isShallow")return t;if(a==="__v_raw"&&i===(e?t?IC:G0:t?W0:H0).get(n))return n;const s=it(n);if(!e&&s&&ht(Ng,a))return Reflect.get(Ng,a,i);const u=Reflect.get(n,a,i);return(Sh(a)?D0.has(a):oC(a))||(e||Yr(n,"get",a),t)?u:Kt(u)?s&&$h(a)?u:u.value:Bt(u)?e?z0(u):ts(u):u}}const dC=B0(),pC=B0(!0);function B0(e=!1){return function(r,n,a,i){let s=r[n];if(to(s)&&Kt(s)&&!Kt(a))return!1;if(!e&&(!yc(a)&&!to(a)&&(s=mt(s),a=mt(a)),!it(r)&&Kt(s)&&!Kt(a)))return s.value=a,!0;const u=it(r)&&$h(n)?Number(n)<r.length:ht(r,n),o=Reflect.set(r,n,a,i);return r===mt(i)&&(u?$u(a,s)&&ya(r,"set",n,a):ya(r,"add",n,a)),o}}function vC(e,t){const r=ht(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&ya(e,"delete",t,void 0),n}function hC(e,t){const r=Reflect.has(e,t);return(!Sh(t)||!D0.has(t))&&Yr(e,"has",t),r}function yC(e){return Yr(e,"iterate",it(e)?"length":Gi),Reflect.ownKeys(e)}const q0={get:uC,set:dC,deleteProperty:vC,has:hC,ownKeys:yC},gC={get:cC,set(e,t){return!0},deleteProperty(e,t){return!0}},mC=wr({},q0,{get:lC,set:pC}),Ih=e=>e,Qc=e=>Reflect.getPrototypeOf(e);function bl(e,t,r=!1,n=!1){e=e.__v_raw;const a=mt(e),i=mt(t);r||(t!==i&&Yr(a,"get",t),Yr(a,"get",i));const{has:s}=Qc(a),u=n?Ih:r?Ah:Tu;if(s.call(a,t))return u(e.get(t));if(s.call(a,i))return u(e.get(i));e!==a&&e.get(t)}function wl(e,t=!1){const r=this.__v_raw,n=mt(r),a=mt(e);return t||(e!==a&&Yr(n,"has",e),Yr(n,"has",a)),e===a?r.has(e):r.has(e)||r.has(a)}function _l(e,t=!1){return e=e.__v_raw,!t&&Yr(mt(e),"iterate",Gi),Reflect.get(e,"size",e)}function Lg(e){e=mt(e);const t=mt(this);return Qc(t).has.call(t,e)||(t.add(e),ya(t,"add",e,e)),this}function jg(e,t){t=mt(t);const r=mt(this),{has:n,get:a}=Qc(r);let i=n.call(r,e);i||(e=mt(e),i=n.call(r,e));const s=a.call(r,e);return r.set(e,t),i?$u(t,s)&&ya(r,"set",e,t):ya(r,"add",e,t),this}function Ug(e){const t=mt(this),{has:r,get:n}=Qc(t);let a=r.call(t,e);a||(e=mt(e),a=r.call(t,e)),n&&n.call(t,e);const i=t.delete(e);return a&&ya(t,"delete",e,void 0),i}function Fg(){const e=mt(this),t=e.size!==0,r=e.clear();return t&&ya(e,"clear",void 0,void 0),r}function Sl(e,t){return function(n,a){const i=this,s=i.__v_raw,u=mt(s),o=t?Ih:e?Ah:Tu;return!e&&Yr(u,"iterate",Gi),s.forEach((l,c)=>n.call(a,o(l),o(c),i))}}function $l(e,t,r){return function(...n){const a=this.__v_raw,i=mt(a),s=Gs(i),u=e==="entries"||e===Symbol.iterator&&s,o=e==="keys"&&s,l=a[e](...n),c=r?Ih:t?Ah:Tu;return!t&&Yr(i,"iterate",o?Vp:Gi),{next(){const{value:h,done:w}=l.next();return w?{value:h,done:w}:{value:u?[c(h[0]),c(h[1])]:c(h),done:w}},[Symbol.iterator](){return this}}}}function Fa(e){return function(...t){return e==="delete"?!1:this}}function bC(){const e={get(i){return bl(this,i)},get size(){return _l(this)},has:wl,add:Lg,set:jg,delete:Ug,clear:Fg,forEach:Sl(!1,!1)},t={get(i){return bl(this,i,!1,!0)},get size(){return _l(this)},has:wl,add:Lg,set:jg,delete:Ug,clear:Fg,forEach:Sl(!1,!0)},r={get(i){return bl(this,i,!0)},get size(){return _l(this,!0)},has(i){return wl.call(this,i,!0)},add:Fa("add"),set:Fa("set"),delete:Fa("delete"),clear:Fa("clear"),forEach:Sl(!0,!1)},n={get(i){return bl(this,i,!0,!0)},get size(){return _l(this,!0)},has(i){return wl.call(this,i,!0)},add:Fa("add"),set:Fa("set"),delete:Fa("delete"),clear:Fa("clear"),forEach:Sl(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(i=>{e[i]=$l(i,!1,!1),r[i]=$l(i,!0,!1),t[i]=$l(i,!1,!0),n[i]=$l(i,!0,!0)}),[e,r,t,n]}const[wC,_C,SC,$C]=bC();function Ch(e,t){const r=t?e?$C:SC:e?_C:wC;return(n,a,i)=>a==="__v_isReactive"?!e:a==="__v_isReadonly"?e:a==="__v_raw"?n:Reflect.get(ht(r,a)&&a in n?r:n,a,i)}const TC={get:Ch(!1,!1)},kC={get:Ch(!1,!0)},EC={get:Ch(!0,!1)},H0=new WeakMap,W0=new WeakMap,G0=new WeakMap,IC=new WeakMap;function CC(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function RC(e){return e.__v_skip||!Object.isExtensible(e)?0:CC(XI(e))}function ts(e){return to(e)?e:Rh(e,!1,q0,TC,H0)}function AC(e){return Rh(e,!1,mC,kC,W0)}function z0(e){return Rh(e,!0,gC,EC,G0)}function Rh(e,t,r,n,a){if(!Bt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const i=a.get(e);if(i)return i;const s=RC(e);if(s===0)return e;const u=new Proxy(e,s===2?n:r);return a.set(e,u),u}function Za(e){return to(e)?Za(e.__v_raw):!!(e&&e.__v_isReactive)}function to(e){return!!(e&&e.__v_isReadonly)}function yc(e){return!!(e&&e.__v_isShallow)}function V0(e){return Za(e)||to(e)}function mt(e){const t=e&&e.__v_raw;return t?mt(t):e}function ro(e){return hc(e,"__v_skip",!0),e}const Tu=e=>Bt(e)?ts(e):e,Ah=e=>Bt(e)?z0(e):e;function K0(e){Xa&&En&&(e=mt(e),F0(e.dep||(e.dep=Th())))}function Y0(e,t){e=mt(e),e.dep&&Kp(e.dep)}function Kt(e){return!!(e&&e.__v_isRef===!0)}function bt(e){return Q0(e,!1)}function J0(e){return Q0(e,!0)}function Q0(e,t){return Kt(e)?e:new OC(e,t)}class OC{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:mt(t),this._value=r?t:Tu(t)}get value(){return K0(this),this._value}set value(t){const r=this.__v_isShallow||yc(t)||to(t);t=r?t:mt(t),$u(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:Tu(t),Y0(this))}}function er(e){return Kt(e)?e.value:e}const PC={get:(e,t,r)=>er(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const a=e[t];return Kt(a)&&!Kt(r)?(a.value=r,!0):Reflect.set(e,t,r,n)}};function X0(e){return Za(e)?e:new Proxy(e,PC)}function MC(e){const t=it(e)?new Array(e.length):{};for(const r in e)t[r]=NC(e,r);return t}class xC{constructor(t,r,n){this._object=t,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function NC(e,t,r){const n=e[t];return Kt(n)?n:new xC(e,t,r)}var Z0;class LC{constructor(t,r,n,a){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[Z0]=!1,this._dirty=!0,this.effect=new kh(t,()=>{this._dirty||(this._dirty=!0,Y0(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!a,this.__v_isReadonly=n}get value(){const t=mt(this);return K0(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Z0="__v_isReadonly";function jC(e,t,r=!1){let n,a;const i=ut(e);return i?(n=e,a=Pn):(n=e.get,a=e.set),new LC(n,a,i||!a,r)}function ei(e,t,r,n){let a;try{a=n?e(...n):e()}catch(i){Xc(i,t,r)}return a}function pn(e,t,r,n){if(ut(e)){const i=ei(e,t,r,n);return i&&O0(i)&&i.catch(s=>{Xc(s,t,r)}),i}const a=[];for(let i=0;i<e.length;i++)a.push(pn(e[i],t,r,n));return a}function Xc(e,t,r,n=!0){const a=t?t.vnode:null;if(t){let i=t.parent;const s=t.proxy,u=r;for(;i;){const l=i.ec;if(l){for(let c=0;c<l.length;c++)if(l[c](e,s,u)===!1)return}i=i.parent}const o=t.appContext.config.errorHandler;if(o){ei(o,null,10,[e,s,u]);return}}UC(e,r,a,n)}function UC(e,t,r,n=!0){console.error(e)}let ku=!1,Yp=!1;const mr=[];let Wn=0;const zs=[];let ua=null,Ui=0;const e$=Promise.resolve();let Oh=null;function Ph(e){const t=Oh||e$;return e?t.then(this?e.bind(this):e):t}function FC(e){let t=Wn+1,r=mr.length;for(;t<r;){const n=t+r>>>1;Eu(mr[n])<e?t=n+1:r=n}return t}function Mh(e){(!mr.length||!mr.includes(e,ku&&e.allowRecurse?Wn+1:Wn))&&(e.id==null?mr.push(e):mr.splice(FC(e.id),0,e),t$())}function t$(){!ku&&!Yp&&(Yp=!0,Oh=e$.then(n$))}function DC(e){const t=mr.indexOf(e);t>Wn&&mr.splice(t,1)}function BC(e){it(e)?zs.push(...e):(!ua||!ua.includes(e,e.allowRecurse?Ui+1:Ui))&&zs.push(e),t$()}function Dg(e,t=ku?Wn+1:0){for(;t<mr.length;t++){const r=mr[t];r&&r.pre&&(mr.splice(t,1),t--,r())}}function r$(e){if(zs.length){const t=[...new Set(zs)];if(zs.length=0,ua){ua.push(...t);return}for(ua=t,ua.sort((r,n)=>Eu(r)-Eu(n)),Ui=0;Ui<ua.length;Ui++)ua[Ui]();ua=null,Ui=0}}const Eu=e=>e.id==null?1/0:e.id,qC=(e,t)=>{const r=Eu(e)-Eu(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function n$(e){Yp=!1,ku=!0,mr.sort(qC);const t=Pn;try{for(Wn=0;Wn<mr.length;Wn++){const r=mr[Wn];r&&r.active!==!1&&ei(r,null,14)}}finally{Wn=0,mr.length=0,r$(),ku=!1,Oh=null,(mr.length||zs.length)&&n$()}}function HC(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||xt;let a=r;const i=t.startsWith("update:"),s=i&&t.slice(7);if(s&&s in n){const c=`${s==="modelValue"?"model":s}Modifiers`,{number:h,trim:w}=n[c]||xt;w&&(a=r.map(b=>b.trim())),h&&(a=r.map(Wp))}let u,o=n[u=Qf(t)]||n[u=Qf(Yn(t))];!o&&i&&(o=n[u=Qf(es(t))]),o&&pn(o,e,6,a);const l=n[u+"Once"];if(l){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,pn(l,e,6,a)}}function a$(e,t,r=!1){const n=t.emitsCache,a=n.get(e);if(a!==void 0)return a;const i=e.emits;let s={},u=!1;if(!ut(e)){const o=l=>{const c=a$(l,t,!0);c&&(u=!0,wr(s,c))};!r&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}return!i&&!u?(Bt(e)&&n.set(e,null),null):(it(i)?i.forEach(o=>s[o]=null):wr(s,i),Bt(e)&&n.set(e,s),s)}function Zc(e,t){return!e||!Vc(t)?!1:(t=t.slice(2).replace(/Once$/,""),ht(e,t[0].toLowerCase()+t.slice(1))||ht(e,es(t))||ht(e,t))}let br=null,i$=null;function gc(e){const t=br;return br=e,i$=e&&e.type.__scopeId||null,t}function si(e,t=br,r){if(!t||e._n)return e;const n=(...a)=>{n._d&&Qg(-1);const i=gc(t),s=e(...a);return gc(i),n._d&&Qg(1),s};return n._n=!0,n._c=!0,n._d=!0,n}function Xf(e){const{type:t,vnode:r,proxy:n,withProxy:a,props:i,propsOptions:[s],slots:u,attrs:o,emit:l,render:c,renderCache:h,data:w,setupState:b,ctx:$,inheritAttrs:C}=e;let I,j;const D=gc(e);try{if(r.shapeFlag&4){const se=a||n;I=qn(c.call(se,se,h,i,b,w,$)),j=o}else{const se=t;I=qn(se.length>1?se(i,{attrs:o,slots:u,emit:l}):se(i,null)),j=t.props?o:WC(o)}}catch(se){pu.length=0,Xc(se,e,1),I=Ht(vn)}let ve=I;if(j&&C!==!1){const se=Object.keys(j),{shapeFlag:Pe}=ve;se.length&&Pe&7&&(s&&se.some(wh)&&(j=GC(j,s)),ve=ui(ve,j))}return r.dirs&&(ve=ui(ve),ve.dirs=ve.dirs?ve.dirs.concat(r.dirs):r.dirs),r.transition&&(ve.transition=r.transition),I=ve,gc(D),I}const WC=e=>{let t;for(const r in e)(r==="class"||r==="style"||Vc(r))&&((t||(t={}))[r]=e[r]);return t},GC=(e,t)=>{const r={};for(const n in e)(!wh(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function zC(e,t,r){const{props:n,children:a,component:i}=e,{props:s,children:u,patchFlag:o}=t,l=i.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&o>=0){if(o&1024)return!0;if(o&16)return n?Bg(n,s,l):!!s;if(o&8){const c=t.dynamicProps;for(let h=0;h<c.length;h++){const w=c[h];if(s[w]!==n[w]&&!Zc(l,w))return!0}}}else return(a||u)&&(!u||!u.$stable)?!0:n===s?!1:n?s?Bg(n,s,l):!0:!!s;return!1}function Bg(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let a=0;a<n.length;a++){const i=n[a];if(t[i]!==e[i]&&!Zc(r,i))return!0}return!1}function VC({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const KC=e=>e.__isSuspense;function YC(e,t){t&&t.pendingBranch?it(e)?t.effects.push(...e):t.effects.push(e):BC(e)}function ic(e,t){if(ar){let r=ar.provides;const n=ar.parent&&ar.parent.provides;n===r&&(r=ar.provides=Object.create(n)),r[e]=t}}function Vn(e,t,r=!1){const n=ar||br;if(n){const a=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(a&&e in a)return a[e];if(arguments.length>1)return r&&ut(t)?t.call(n.proxy):t}}const qg={};function zi(e,t,r){return s$(e,t,r)}function s$(e,t,{immediate:r,deep:n,flush:a,onTrack:i,onTrigger:s}=xt){const u=ar;let o,l=!1,c=!1;if(Kt(e)?(o=()=>e.value,l=yc(e)):Za(e)?(o=()=>e,n=!0):it(e)?(c=!0,l=e.some(j=>Za(j)||yc(j)),o=()=>e.map(j=>{if(Kt(j))return j.value;if(Za(j))return Hi(j);if(ut(j))return ei(j,u,2)})):ut(e)?t?o=()=>ei(e,u,2):o=()=>{if(!(u&&u.isUnmounted))return h&&h(),pn(e,u,3,[w])}:o=Pn,t&&n){const j=o;o=()=>Hi(j())}let h,w=j=>{h=I.onStop=()=>{ei(j,u,4)}};if(Cu)return w=Pn,t?r&&pn(t,u,3,[o(),c?[]:void 0,w]):o(),Pn;let b=c?[]:qg;const $=()=>{if(!!I.active)if(t){const j=I.run();(n||l||(c?j.some((D,ve)=>$u(D,b[ve])):$u(j,b)))&&(h&&h(),pn(t,u,3,[j,b===qg?void 0:b,w]),b=j)}else I.run()};$.allowRecurse=!!t;let C;a==="sync"?C=$:a==="post"?C=()=>Lr($,u&&u.suspense):($.pre=!0,u&&($.id=u.uid),C=()=>Mh($));const I=new kh(o,C);return t?r?$():b=I.run():a==="post"?Lr(I.run.bind(I),u&&u.suspense):I.run(),()=>{I.stop(),u&&u.scope&&_h(u.scope.effects,I)}}function JC(e,t,r){const n=this.proxy,a=sr(e)?e.includes(".")?o$(n,e):()=>n[e]:e.bind(n,n);let i;ut(t)?i=t:(i=t.handler,r=t);const s=ar;no(this);const u=s$(a,i.bind(n),r);return s?no(s):Vi(),u}function o$(e,t){const r=t.split(".");return()=>{let n=e;for(let a=0;a<r.length&&n;a++)n=n[r[a]];return n}}function Hi(e,t){if(!Bt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Kt(e))Hi(e.value,t);else if(it(e))for(let r=0;r<e.length;r++)Hi(e[r],t);else if(A0(e)||Gs(e))e.forEach(r=>{Hi(r,t)});else if(M0(e))for(const r in e)Hi(e[r],t);return e}function QC(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Nh(()=>{e.isMounted=!0}),d$(()=>{e.isUnmounting=!0}),e}const an=[Function,Array],XC={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:an,onEnter:an,onAfterEnter:an,onEnterCancelled:an,onBeforeLeave:an,onLeave:an,onAfterLeave:an,onLeaveCancelled:an,onBeforeAppear:an,onAppear:an,onAfterAppear:an,onAppearCancelled:an},setup(e,{slots:t}){const r=Bh(),n=QC();let a;return()=>{const i=t.default&&l$(t.default(),!0);if(!i||!i.length)return;let s=i[0];if(i.length>1){for(const C of i)if(C.type!==vn){s=C;break}}const u=mt(e),{mode:o}=u;if(n.isLeaving)return Zf(s);const l=Hg(s);if(!l)return Zf(s);const c=Jp(l,u,n,r);Qp(l,c);const h=r.subTree,w=h&&Hg(h);let b=!1;const{getTransitionKey:$}=l.type;if($){const C=$();a===void 0?a=C:C!==a&&(a=C,b=!0)}if(w&&w.type!==vn&&(!Fi(l,w)||b)){const C=Jp(w,u,n,r);if(Qp(w,C),o==="out-in")return n.isLeaving=!0,C.afterLeave=()=>{n.isLeaving=!1,r.update()},Zf(s);o==="in-out"&&l.type!==vn&&(C.delayLeave=(I,j,D)=>{const ve=u$(n,w);ve[String(w.key)]=w,I._leaveCb=()=>{j(),I._leaveCb=void 0,delete c.delayedLeave},c.delayedLeave=D})}return s}}},ZC=XC;function u$(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function Jp(e,t,r,n){const{appear:a,mode:i,persisted:s=!1,onBeforeEnter:u,onEnter:o,onAfterEnter:l,onEnterCancelled:c,onBeforeLeave:h,onLeave:w,onAfterLeave:b,onLeaveCancelled:$,onBeforeAppear:C,onAppear:I,onAfterAppear:j,onAppearCancelled:D}=t,ve=String(e.key),se=u$(r,e),Pe=(x,re)=>{x&&pn(x,n,9,re)},Me=(x,re)=>{const de=re[1];Pe(x,re),it(x)?x.every(X=>X.length<=1)&&de():x.length<=1&&de()},le={mode:i,persisted:s,beforeEnter(x){let re=u;if(!r.isMounted)if(a)re=C||u;else return;x._leaveCb&&x._leaveCb(!0);const de=se[ve];de&&Fi(e,de)&&de.el._leaveCb&&de.el._leaveCb(),Pe(re,[x])},enter(x){let re=o,de=l,X=c;if(!r.isMounted)if(a)re=I||o,de=j||l,X=D||c;else return;let xe=!1;const ce=x._enterCb=te=>{xe||(xe=!0,te?Pe(X,[x]):Pe(de,[x]),le.delayedLeave&&le.delayedLeave(),x._enterCb=void 0)};re?Me(re,[x,ce]):ce()},leave(x,re){const de=String(e.key);if(x._enterCb&&x._enterCb(!0),r.isUnmounting)return re();Pe(h,[x]);let X=!1;const xe=x._leaveCb=ce=>{X||(X=!0,re(),ce?Pe($,[x]):Pe(b,[x]),x._leaveCb=void 0,se[de]===e&&delete se[de])};se[de]=e,w?Me(w,[x,xe]):xe()},clone(x){return Jp(x,t,r,n)}};return le}function Zf(e){if(ef(e))return e=ui(e),e.children=null,e}function Hg(e){return ef(e)?e.children?e.children[0]:void 0:e}function Qp(e,t){e.shapeFlag&6&&e.component?Qp(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function l$(e,t=!1,r){let n=[],a=0;for(let i=0;i<e.length;i++){let s=e[i];const u=r==null?s.key:String(r)+String(s.key!=null?s.key:i);s.type===jr?(s.patchFlag&128&&a++,n=n.concat(l$(s.children,t,u))):(t||s.type!==vn)&&n.push(u!=null?ui(s,{key:u}):s)}if(a>1)for(let i=0;i<n.length;i++)n[i].patchFlag=-2;return n}function c$(e){return ut(e)?{setup:e,name:e.name}:e}const du=e=>!!e.type.__asyncLoader,ef=e=>e.type.__isKeepAlive;function eR(e,t){f$(e,"a",t)}function tR(e,t){f$(e,"da",t)}function f$(e,t,r=ar){const n=e.__wdc||(e.__wdc=()=>{let a=r;for(;a;){if(a.isDeactivated)return;a=a.parent}return e()});if(tf(t,n,r),r){let a=r.parent;for(;a&&a.parent;)ef(a.parent.vnode)&&rR(n,t,r,a),a=a.parent}}function rR(e,t,r,n){const a=tf(t,e,n,!0);Lh(()=>{_h(n[t],a)},r)}function tf(e,t,r=ar,n=!1){if(r){const a=r[e]||(r[e]=[]),i=t.__weh||(t.__weh=(...s)=>{if(r.isUnmounted)return;vo(),no(r);const u=pn(t,r,e,s);return Vi(),ho(),u});return n?a.unshift(i):a.push(i),i}}const Ta=e=>(t,r=ar)=>(!Cu||e==="sp")&&tf(e,t,r),xh=Ta("bm"),Nh=Ta("m"),nR=Ta("bu"),aR=Ta("u"),d$=Ta("bum"),Lh=Ta("um"),iR=Ta("sp"),sR=Ta("rtg"),oR=Ta("rtc");function uR(e,t=ar){tf("ec",e,t)}function Mt(e,t){const r=br;if(r===null)return e;const n=nf(r)||r.proxy,a=e.dirs||(e.dirs=[]);for(let i=0;i<t.length;i++){let[s,u,o,l=xt]=t[i];ut(s)&&(s={mounted:s,updated:s}),s.deep&&Hi(u),a.push({dir:s,instance:n,value:u,oldValue:void 0,arg:o,modifiers:l})}return e}function Ii(e,t,r,n){const a=e.dirs,i=t&&t.dirs;for(let s=0;s<a.length;s++){const u=a[s];i&&(u.oldValue=i[s].value);let o=u.dir[n];o&&(vo(),pn(o,r,8,[e.el,u,e,t]),ho())}}const p$="components";function oi(e,t){return cR(p$,e,!0,t)||e}const lR=Symbol();function cR(e,t,r=!0,n=!1){const a=br||ar;if(a){const i=a.type;if(e===p$){const u=DR(i,!1);if(u&&(u===t||u===Yn(t)||u===Jc(Yn(t))))return i}const s=Wg(a[e]||i[e],t)||Wg(a.appContext[e],t);return!s&&n?i:s}}function Wg(e,t){return e&&(e[t]||e[Yn(t)]||e[Jc(Yn(t))])}function v$(e,t,r,n){let a;const i=r&&r[n];if(it(e)||sr(e)){a=new Array(e.length);for(let s=0,u=e.length;s<u;s++)a[s]=t(e[s],s,void 0,i&&i[s])}else if(typeof e=="number"){a=new Array(e);for(let s=0;s<e;s++)a[s]=t(s+1,s,void 0,i&&i[s])}else if(Bt(e))if(e[Symbol.iterator])a=Array.from(e,(s,u)=>t(s,u,void 0,i&&i[u]));else{const s=Object.keys(e);a=new Array(s.length);for(let u=0,o=s.length;u<o;u++){const l=s[u];a[u]=t(e[l],l,u,i&&i[u])}}else a=[];return r&&(r[n]=a),a}function fR(e,t,r={},n,a){if(br.isCE||br.parent&&du(br.parent)&&br.parent.isCE)return Ht("slot",t==="default"?null:{name:t},n&&n());let i=e[t];i&&i._c&&(i._d=!1),_t();const s=i&&h$(i(r)),u=yo(jr,{key:r.key||s&&s.key||`_${t}`},s||(n?n():[]),s&&e._===1?64:-2);return!a&&u.scopeId&&(u.slotScopeIds=[u.scopeId+"-s"]),i&&i._c&&(i._d=!0),u}function h$(e){return e.some(t=>wc(t)?!(t.type===vn||t.type===jr&&!h$(t.children)):!0)?e:null}const Xp=e=>e?E$(e)?nf(e)||e.proxy:Xp(e.parent):null,mc=wr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Xp(e.parent),$root:e=>Xp(e.root),$emit:e=>e.emit,$options:e=>jh(e),$forceUpdate:e=>e.f||(e.f=()=>Mh(e.update)),$nextTick:e=>e.n||(e.n=Ph.bind(e.proxy)),$watch:e=>JC.bind(e)}),dR={get({_:e},t){const{ctx:r,setupState:n,data:a,props:i,accessCache:s,type:u,appContext:o}=e;let l;if(t[0]!=="$"){const b=s[t];if(b!==void 0)switch(b){case 1:return n[t];case 2:return a[t];case 4:return r[t];case 3:return i[t]}else{if(n!==xt&&ht(n,t))return s[t]=1,n[t];if(a!==xt&&ht(a,t))return s[t]=2,a[t];if((l=e.propsOptions[0])&&ht(l,t))return s[t]=3,i[t];if(r!==xt&&ht(r,t))return s[t]=4,r[t];Zp&&(s[t]=0)}}const c=mc[t];let h,w;if(c)return t==="$attrs"&&Yr(e,"get",t),c(e);if((h=u.__cssModules)&&(h=h[t]))return h;if(r!==xt&&ht(r,t))return s[t]=4,r[t];if(w=o.config.globalProperties,ht(w,t))return w[t]},set({_:e},t,r){const{data:n,setupState:a,ctx:i}=e;return a!==xt&&ht(a,t)?(a[t]=r,!0):n!==xt&&ht(n,t)?(n[t]=r,!0):ht(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(i[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:a,propsOptions:i}},s){let u;return!!r[s]||e!==xt&&ht(e,s)||t!==xt&&ht(t,s)||(u=i[0])&&ht(u,s)||ht(n,s)||ht(mc,s)||ht(a.config.globalProperties,s)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:ht(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let Zp=!0;function pR(e){const t=jh(e),r=e.proxy,n=e.ctx;Zp=!1,t.beforeCreate&&Gg(t.beforeCreate,e,"bc");const{data:a,computed:i,methods:s,watch:u,provide:o,inject:l,created:c,beforeMount:h,mounted:w,beforeUpdate:b,updated:$,activated:C,deactivated:I,beforeDestroy:j,beforeUnmount:D,destroyed:ve,unmounted:se,render:Pe,renderTracked:Me,renderTriggered:le,errorCaptured:x,serverPrefetch:re,expose:de,inheritAttrs:X,components:xe,directives:ce,filters:te}=t;if(l&&vR(l,n,null,e.appContext.config.unwrapInjectedRef),s)for(const Ie in s){const $e=s[Ie];ut($e)&&(n[Ie]=$e.bind(r))}if(a){const Ie=a.call(r,r);Bt(Ie)&&(e.data=ts(Ie))}if(Zp=!0,i)for(const Ie in i){const $e=i[Ie],N=ut($e)?$e.bind(r,r):ut($e.get)?$e.get.bind(r,r):Pn,ct=!ut($e)&&ut($e.set)?$e.set.bind(r):Pn,ft=rr({get:N,set:ct});Object.defineProperty(n,Ie,{enumerable:!0,configurable:!0,get:()=>ft.value,set:Te=>ft.value=Te})}if(u)for(const Ie in u)y$(u[Ie],n,r,Ie);if(o){const Ie=ut(o)?o.call(r):o;Reflect.ownKeys(Ie).forEach($e=>{ic($e,Ie[$e])})}c&&Gg(c,e,"c");function ie(Ie,$e){it($e)?$e.forEach(N=>Ie(N.bind(r))):$e&&Ie($e.bind(r))}if(ie(xh,h),ie(Nh,w),ie(nR,b),ie(aR,$),ie(eR,C),ie(tR,I),ie(uR,x),ie(oR,Me),ie(sR,le),ie(d$,D),ie(Lh,se),ie(iR,re),it(de))if(de.length){const Ie=e.exposed||(e.exposed={});de.forEach($e=>{Object.defineProperty(Ie,$e,{get:()=>r[$e],set:N=>r[$e]=N})})}else e.exposed||(e.exposed={});Pe&&e.render===Pn&&(e.render=Pe),X!=null&&(e.inheritAttrs=X),xe&&(e.components=xe),ce&&(e.directives=ce)}function vR(e,t,r=Pn,n=!1){it(e)&&(e=ev(e));for(const a in e){const i=e[a];let s;Bt(i)?"default"in i?s=Vn(i.from||a,i.default,!0):s=Vn(i.from||a):s=Vn(i),Kt(s)&&n?Object.defineProperty(t,a,{enumerable:!0,configurable:!0,get:()=>s.value,set:u=>s.value=u}):t[a]=s}}function Gg(e,t,r){pn(it(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function y$(e,t,r,n){const a=n.includes(".")?o$(r,n):()=>r[n];if(sr(e)){const i=t[e];ut(i)&&zi(a,i)}else if(ut(e))zi(a,e.bind(r));else if(Bt(e))if(it(e))e.forEach(i=>y$(i,t,r,n));else{const i=ut(e.handler)?e.handler.bind(r):t[e.handler];ut(i)&&zi(a,i,e)}}function jh(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:a,optionsCache:i,config:{optionMergeStrategies:s}}=e.appContext,u=i.get(t);let o;return u?o=u:!a.length&&!r&&!n?o=t:(o={},a.length&&a.forEach(l=>bc(o,l,s,!0)),bc(o,t,s)),Bt(t)&&i.set(t,o),o}function bc(e,t,r,n=!1){const{mixins:a,extends:i}=t;i&&bc(e,i,r,!0),a&&a.forEach(s=>bc(e,s,r,!0));for(const s in t)if(!(n&&s==="expose")){const u=hR[s]||r&&r[s];e[s]=u?u(e[s],t[s]):t[s]}return e}const hR={data:zg,props:ji,emits:ji,methods:ji,computed:ji,beforeCreate:Rr,created:Rr,beforeMount:Rr,mounted:Rr,beforeUpdate:Rr,updated:Rr,beforeDestroy:Rr,beforeUnmount:Rr,destroyed:Rr,unmounted:Rr,activated:Rr,deactivated:Rr,errorCaptured:Rr,serverPrefetch:Rr,components:ji,directives:ji,watch:gR,provide:zg,inject:yR};function zg(e,t){return t?e?function(){return wr(ut(e)?e.call(this,this):e,ut(t)?t.call(this,this):t)}:t:e}function yR(e,t){return ji(ev(e),ev(t))}function ev(e){if(it(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function Rr(e,t){return e?[...new Set([].concat(e,t))]:t}function ji(e,t){return e?wr(wr(Object.create(null),e),t):t}function gR(e,t){if(!e)return t;if(!t)return e;const r=wr(Object.create(null),e);for(const n in t)r[n]=Rr(e[n],t[n]);return r}function mR(e,t,r,n=!1){const a={},i={};hc(i,rf,1),e.propsDefaults=Object.create(null),g$(e,t,a,i);for(const s in e.propsOptions[0])s in a||(a[s]=void 0);r?e.props=n?a:AC(a):e.type.props?e.props=a:e.props=i,e.attrs=i}function bR(e,t,r,n){const{props:a,attrs:i,vnode:{patchFlag:s}}=e,u=mt(a),[o]=e.propsOptions;let l=!1;if((n||s>0)&&!(s&16)){if(s&8){const c=e.vnode.dynamicProps;for(let h=0;h<c.length;h++){let w=c[h];if(Zc(e.emitsOptions,w))continue;const b=t[w];if(o)if(ht(i,w))b!==i[w]&&(i[w]=b,l=!0);else{const $=Yn(w);a[$]=tv(o,u,$,b,e,!1)}else b!==i[w]&&(i[w]=b,l=!0)}}}else{g$(e,t,a,i)&&(l=!0);let c;for(const h in u)(!t||!ht(t,h)&&((c=es(h))===h||!ht(t,c)))&&(o?r&&(r[h]!==void 0||r[c]!==void 0)&&(a[h]=tv(o,u,h,void 0,e,!0)):delete a[h]);if(i!==u)for(const h in i)(!t||!ht(t,h)&&!0)&&(delete i[h],l=!0)}l&&ya(e,"set","$attrs")}function g$(e,t,r,n){const[a,i]=e.propsOptions;let s=!1,u;if(t)for(let o in t){if(nc(o))continue;const l=t[o];let c;a&&ht(a,c=Yn(o))?!i||!i.includes(c)?r[c]=l:(u||(u={}))[c]=l:Zc(e.emitsOptions,o)||(!(o in n)||l!==n[o])&&(n[o]=l,s=!0)}if(i){const o=mt(r),l=u||xt;for(let c=0;c<i.length;c++){const h=i[c];r[h]=tv(a,o,h,l[h],e,!ht(l,h))}}return s}function tv(e,t,r,n,a,i){const s=e[r];if(s!=null){const u=ht(s,"default");if(u&&n===void 0){const o=s.default;if(s.type!==Function&&ut(o)){const{propsDefaults:l}=a;r in l?n=l[r]:(no(a),n=l[r]=o.call(null,t),Vi())}else n=o}s[0]&&(i&&!u?n=!1:s[1]&&(n===""||n===es(r))&&(n=!0))}return n}function m$(e,t,r=!1){const n=t.propsCache,a=n.get(e);if(a)return a;const i=e.props,s={},u=[];let o=!1;if(!ut(e)){const c=h=>{o=!0;const[w,b]=m$(h,t,!0);wr(s,w),b&&u.push(...b)};!r&&t.mixins.length&&t.mixins.forEach(c),e.extends&&c(e.extends),e.mixins&&e.mixins.forEach(c)}if(!i&&!o)return Bt(e)&&n.set(e,Ws),Ws;if(it(i))for(let c=0;c<i.length;c++){const h=Yn(i[c]);Vg(h)&&(s[h]=xt)}else if(i)for(const c in i){const h=Yn(c);if(Vg(h)){const w=i[c],b=s[h]=it(w)||ut(w)?{type:w}:w;if(b){const $=Jg(Boolean,b.type),C=Jg(String,b.type);b[0]=$>-1,b[1]=C<0||$<C,($>-1||ht(b,"default"))&&u.push(h)}}}const l=[s,u];return Bt(e)&&n.set(e,l),l}function Vg(e){return e[0]!=="$"}function Kg(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function Yg(e,t){return Kg(e)===Kg(t)}function Jg(e,t){return it(t)?t.findIndex(r=>Yg(r,e)):ut(t)&&Yg(t,e)?0:-1}const b$=e=>e[0]==="_"||e==="$stable",Uh=e=>it(e)?e.map(qn):[qn(e)],wR=(e,t,r)=>{if(t._n)return t;const n=si((...a)=>Uh(t(...a)),r);return n._c=!1,n},w$=(e,t,r)=>{const n=e._ctx;for(const a in e){if(b$(a))continue;const i=e[a];if(ut(i))t[a]=wR(a,i,n);else if(i!=null){const s=Uh(i);t[a]=()=>s}}},_$=(e,t)=>{const r=Uh(t);e.slots.default=()=>r},_R=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=mt(t),hc(t,"_",r)):w$(t,e.slots={})}else e.slots={},t&&_$(e,t);hc(e.slots,rf,1)},SR=(e,t,r)=>{const{vnode:n,slots:a}=e;let i=!0,s=xt;if(n.shapeFlag&32){const u=t._;u?r&&u===1?i=!1:(wr(a,t),!r&&u===1&&delete a._):(i=!t.$stable,w$(t,a)),s=t}else t&&(_$(e,t),s={default:1});if(i)for(const u in a)!b$(u)&&!(u in s)&&delete a[u]};function S$(){return{app:null,config:{isNativeTag:YI,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let $R=0;function TR(e,t){return function(n,a=null){ut(n)||(n=Object.assign({},n)),a!=null&&!Bt(a)&&(a=null);const i=S$(),s=new Set;let u=!1;const o=i.app={_uid:$R++,_component:n,_props:a,_container:null,_context:i,_instance:null,version:qR,get config(){return i.config},set config(l){},use(l,...c){return s.has(l)||(l&&ut(l.install)?(s.add(l),l.install(o,...c)):ut(l)&&(s.add(l),l(o,...c))),o},mixin(l){return i.mixins.includes(l)||i.mixins.push(l),o},component(l,c){return c?(i.components[l]=c,o):i.components[l]},directive(l,c){return c?(i.directives[l]=c,o):i.directives[l]},mount(l,c,h){if(!u){const w=Ht(n,a);return w.appContext=i,c&&t?t(w,l):e(w,l,h),u=!0,o._container=l,l.__vue_app__=o,nf(w.component)||w.component.proxy}},unmount(){u&&(e(null,o._container),delete o._container.__vue_app__)},provide(l,c){return i.provides[l]=c,o}};return o}}function rv(e,t,r,n,a=!1){if(it(e)){e.forEach((w,b)=>rv(w,t&&(it(t)?t[b]:t),r,n,a));return}if(du(n)&&!a)return;const i=n.shapeFlag&4?nf(n.component)||n.component.proxy:n.el,s=a?null:i,{i:u,r:o}=e,l=t&&t.r,c=u.refs===xt?u.refs={}:u.refs,h=u.setupState;if(l!=null&&l!==o&&(sr(l)?(c[l]=null,ht(h,l)&&(h[l]=null)):Kt(l)&&(l.value=null)),ut(o))ei(o,u,12,[s,c]);else{const w=sr(o),b=Kt(o);if(w||b){const $=()=>{if(e.f){const C=w?c[o]:o.value;a?it(C)&&_h(C,i):it(C)?C.includes(i)||C.push(i):w?(c[o]=[i],ht(h,o)&&(h[o]=c[o])):(o.value=[i],e.k&&(c[e.k]=o.value))}else w?(c[o]=s,ht(h,o)&&(h[o]=s)):b&&(o.value=s,e.k&&(c[e.k]=s))};s?($.id=-1,Lr($,r)):$()}}}const Lr=YC;function kR(e){return ER(e)}function ER(e,t){const r=tC();r.__VUE__=!0;const{insert:n,remove:a,patchProp:i,createElement:s,createText:u,createComment:o,setText:l,setElementText:c,parentNode:h,nextSibling:w,setScopeId:b=Pn,cloneNode:$,insertStaticContent:C}=e,I=(O,R,V,fe=null,W=null,Re=null,me=!1,be=null,Ce=!!R.dynamicChildren)=>{if(O===R)return;O&&!Fi(O,R)&&(fe=pe(O),Xe(O,W,Re,!0),O=null),R.patchFlag===-2&&(Ce=!1,R.dynamicChildren=null);const{type:Q,ref:Fe,shapeFlag:Ue}=R;switch(Q){case Fh:j(O,R,V,fe);break;case vn:D(O,R,V,fe);break;case ed:O==null&&ve(R,V,fe,me);break;case jr:ce(O,R,V,fe,W,Re,me,be,Ce);break;default:Ue&1?Me(O,R,V,fe,W,Re,me,be,Ce):Ue&6?te(O,R,V,fe,W,Re,me,be,Ce):(Ue&64||Ue&128)&&Q.process(O,R,V,fe,W,Re,me,be,Ce,Qe)}Fe!=null&&W&&rv(Fe,O&&O.ref,Re,R||O,!R)},j=(O,R,V,fe)=>{if(O==null)n(R.el=u(R.children),V,fe);else{const W=R.el=O.el;R.children!==O.children&&l(W,R.children)}},D=(O,R,V,fe)=>{O==null?n(R.el=o(R.children||""),V,fe):R.el=O.el},ve=(O,R,V,fe)=>{[O.el,O.anchor]=C(O.children,R,V,fe,O.el,O.anchor)},se=({el:O,anchor:R},V,fe)=>{let W;for(;O&&O!==R;)W=w(O),n(O,V,fe),O=W;n(R,V,fe)},Pe=({el:O,anchor:R})=>{let V;for(;O&&O!==R;)V=w(O),a(O),O=V;a(R)},Me=(O,R,V,fe,W,Re,me,be,Ce)=>{me=me||R.type==="svg",O==null?le(R,V,fe,W,Re,me,be,Ce):de(O,R,W,Re,me,be,Ce)},le=(O,R,V,fe,W,Re,me,be)=>{let Ce,Q;const{type:Fe,props:Ue,shapeFlag:Ae,transition:ae,patchFlag:F,dirs:H}=O;if(O.el&&$!==void 0&&F===-1)Ce=O.el=$(O.el);else{if(Ce=O.el=s(O.type,Re,Ue&&Ue.is,Ue),Ae&8?c(Ce,O.children):Ae&16&&re(O.children,Ce,null,fe,W,Re&&Fe!=="foreignObject",me,be),H&&Ii(O,null,fe,"created"),Ue){for(const ye in Ue)ye!=="value"&&!nc(ye)&&i(Ce,ye,null,Ue[ye],Re,O.children,fe,W,Se);"value"in Ue&&i(Ce,"value",null,Ue.value),(Q=Ue.onVnodeBeforeMount)&&Dn(Q,fe,O)}x(Ce,O,O.scopeId,me,fe)}H&&Ii(O,null,fe,"beforeMount");const K=(!W||W&&!W.pendingBranch)&&ae&&!ae.persisted;K&&ae.beforeEnter(Ce),n(Ce,R,V),((Q=Ue&&Ue.onVnodeMounted)||K||H)&&Lr(()=>{Q&&Dn(Q,fe,O),K&&ae.enter(Ce),H&&Ii(O,null,fe,"mounted")},W)},x=(O,R,V,fe,W)=>{if(V&&b(O,V),fe)for(let Re=0;Re<fe.length;Re++)b(O,fe[Re]);if(W){let Re=W.subTree;if(R===Re){const me=W.vnode;x(O,me,me.scopeId,me.slotScopeIds,W.parent)}}},re=(O,R,V,fe,W,Re,me,be,Ce=0)=>{for(let Q=Ce;Q<O.length;Q++){const Fe=O[Q]=be?za(O[Q]):qn(O[Q]);I(null,Fe,R,V,fe,W,Re,me,be)}},de=(O,R,V,fe,W,Re,me)=>{const be=R.el=O.el;let{patchFlag:Ce,dynamicChildren:Q,dirs:Fe}=R;Ce|=O.patchFlag&16;const Ue=O.props||xt,Ae=R.props||xt;let ae;V&&Ci(V,!1),(ae=Ae.onVnodeBeforeUpdate)&&Dn(ae,V,R,O),Fe&&Ii(R,O,V,"beforeUpdate"),V&&Ci(V,!0);const F=W&&R.type!=="foreignObject";if(Q?X(O.dynamicChildren,Q,be,V,fe,F,Re):me||N(O,R,be,null,V,fe,F,Re,!1),Ce>0){if(Ce&16)xe(be,R,Ue,Ae,V,fe,W);else if(Ce&2&&Ue.class!==Ae.class&&i(be,"class",null,Ae.class,W),Ce&4&&i(be,"style",Ue.style,Ae.style,W),Ce&8){const H=R.dynamicProps;for(let K=0;K<H.length;K++){const ye=H[K],Ne=Ue[ye],qe=Ae[ye];(qe!==Ne||ye==="value")&&i(be,ye,Ne,qe,W,O.children,V,fe,Se)}}Ce&1&&O.children!==R.children&&c(be,R.children)}else!me&&Q==null&&xe(be,R,Ue,Ae,V,fe,W);((ae=Ae.onVnodeUpdated)||Fe)&&Lr(()=>{ae&&Dn(ae,V,R,O),Fe&&Ii(R,O,V,"updated")},fe)},X=(O,R,V,fe,W,Re,me)=>{for(let be=0;be<R.length;be++){const Ce=O[be],Q=R[be],Fe=Ce.el&&(Ce.type===jr||!Fi(Ce,Q)||Ce.shapeFlag&70)?h(Ce.el):V;I(Ce,Q,Fe,null,fe,W,Re,me,!0)}},xe=(O,R,V,fe,W,Re,me)=>{if(V!==fe){for(const be in fe){if(nc(be))continue;const Ce=fe[be],Q=V[be];Ce!==Q&&be!=="value"&&i(O,be,Q,Ce,me,R.children,W,Re,Se)}if(V!==xt)for(const be in V)!nc(be)&&!(be in fe)&&i(O,be,V[be],null,me,R.children,W,Re,Se);"value"in fe&&i(O,"value",V.value,fe.value)}},ce=(O,R,V,fe,W,Re,me,be,Ce)=>{const Q=R.el=O?O.el:u(""),Fe=R.anchor=O?O.anchor:u("");let{patchFlag:Ue,dynamicChildren:Ae,slotScopeIds:ae}=R;ae&&(be=be?be.concat(ae):ae),O==null?(n(Q,V,fe),n(Fe,V,fe),re(R.children,V,Fe,W,Re,me,be,Ce)):Ue>0&&Ue&64&&Ae&&O.dynamicChildren?(X(O.dynamicChildren,Ae,V,W,Re,me,be),(R.key!=null||W&&R===W.subTree)&&$$(O,R,!0)):N(O,R,V,Fe,W,Re,me,be,Ce)},te=(O,R,V,fe,W,Re,me,be,Ce)=>{R.slotScopeIds=be,O==null?R.shapeFlag&512?W.ctx.activate(R,V,fe,me,Ce):ue(R,V,fe,W,Re,me,Ce):ie(O,R,Ce)},ue=(O,R,V,fe,W,Re,me)=>{const be=O.component=NR(O,fe,W);if(ef(O)&&(be.ctx.renderer=Qe),LR(be),be.asyncDep){if(W&&W.registerDep(be,Ie),!O.el){const Ce=be.subTree=Ht(vn);D(null,Ce,R,V)}return}Ie(be,O,R,V,W,Re,me)},ie=(O,R,V)=>{const fe=R.component=O.component;if(zC(O,R,V))if(fe.asyncDep&&!fe.asyncResolved){$e(fe,R,V);return}else fe.next=R,DC(fe.update),fe.update();else R.el=O.el,fe.vnode=R},Ie=(O,R,V,fe,W,Re,me)=>{const be=()=>{if(O.isMounted){let{next:Fe,bu:Ue,u:Ae,parent:ae,vnode:F}=O,H=Fe,K;Ci(O,!1),Fe?(Fe.el=F.el,$e(O,Fe,me)):Fe=F,Ue&&ac(Ue),(K=Fe.props&&Fe.props.onVnodeBeforeUpdate)&&Dn(K,ae,Fe,F),Ci(O,!0);const ye=Xf(O),Ne=O.subTree;O.subTree=ye,I(Ne,ye,h(Ne.el),pe(Ne),O,W,Re),Fe.el=ye.el,H===null&&VC(O,ye.el),Ae&&Lr(Ae,W),(K=Fe.props&&Fe.props.onVnodeUpdated)&&Lr(()=>Dn(K,ae,Fe,F),W)}else{let Fe;const{el:Ue,props:Ae}=R,{bm:ae,m:F,parent:H}=O,K=du(R);if(Ci(O,!1),ae&&ac(ae),!K&&(Fe=Ae&&Ae.onVnodeBeforeMount)&&Dn(Fe,H,R),Ci(O,!0),Ue&&Ge){const ye=()=>{O.subTree=Xf(O),Ge(Ue,O.subTree,O,W,null)};K?R.type.__asyncLoader().then(()=>!O.isUnmounted&&ye()):ye()}else{const ye=O.subTree=Xf(O);I(null,ye,V,fe,O,W,Re),R.el=ye.el}if(F&&Lr(F,W),!K&&(Fe=Ae&&Ae.onVnodeMounted)){const ye=R;Lr(()=>Dn(Fe,H,ye),W)}(R.shapeFlag&256||H&&du(H.vnode)&&H.vnode.shapeFlag&256)&&O.a&&Lr(O.a,W),O.isMounted=!0,R=V=fe=null}},Ce=O.effect=new kh(be,()=>Mh(Q),O.scope),Q=O.update=()=>Ce.run();Q.id=O.uid,Ci(O,!0),Q()},$e=(O,R,V)=>{R.component=O;const fe=O.vnode.props;O.vnode=R,O.next=null,bR(O,R.props,fe,V),SR(O,R.children,V),vo(),Dg(),ho()},N=(O,R,V,fe,W,Re,me,be,Ce=!1)=>{const Q=O&&O.children,Fe=O?O.shapeFlag:0,Ue=R.children,{patchFlag:Ae,shapeFlag:ae}=R;if(Ae>0){if(Ae&128){ft(Q,Ue,V,fe,W,Re,me,be,Ce);return}else if(Ae&256){ct(Q,Ue,V,fe,W,Re,me,be,Ce);return}}ae&8?(Fe&16&&Se(Q,W,Re),Ue!==Q&&c(V,Ue)):Fe&16?ae&16?ft(Q,Ue,V,fe,W,Re,me,be,Ce):Se(Q,W,Re,!0):(Fe&8&&c(V,""),ae&16&&re(Ue,V,fe,W,Re,me,be,Ce))},ct=(O,R,V,fe,W,Re,me,be,Ce)=>{O=O||Ws,R=R||Ws;const Q=O.length,Fe=R.length,Ue=Math.min(Q,Fe);let Ae;for(Ae=0;Ae<Ue;Ae++){const ae=R[Ae]=Ce?za(R[Ae]):qn(R[Ae]);I(O[Ae],ae,V,null,W,Re,me,be,Ce)}Q>Fe?Se(O,W,Re,!0,!1,Ue):re(R,V,fe,W,Re,me,be,Ce,Ue)},ft=(O,R,V,fe,W,Re,me,be,Ce)=>{let Q=0;const Fe=R.length;let Ue=O.length-1,Ae=Fe-1;for(;Q<=Ue&&Q<=Ae;){const ae=O[Q],F=R[Q]=Ce?za(R[Q]):qn(R[Q]);if(Fi(ae,F))I(ae,F,V,null,W,Re,me,be,Ce);else break;Q++}for(;Q<=Ue&&Q<=Ae;){const ae=O[Ue],F=R[Ae]=Ce?za(R[Ae]):qn(R[Ae]);if(Fi(ae,F))I(ae,F,V,null,W,Re,me,be,Ce);else break;Ue--,Ae--}if(Q>Ue){if(Q<=Ae){const ae=Ae+1,F=ae<Fe?R[ae].el:fe;for(;Q<=Ae;)I(null,R[Q]=Ce?za(R[Q]):qn(R[Q]),V,F,W,Re,me,be,Ce),Q++}}else if(Q>Ae)for(;Q<=Ue;)Xe(O[Q],W,Re,!0),Q++;else{const ae=Q,F=Q,H=new Map;for(Q=F;Q<=Ae;Q++){const Le=R[Q]=Ce?za(R[Q]):qn(R[Q]);Le.key!=null&&H.set(Le.key,Q)}let K,ye=0;const Ne=Ae-F+1;let qe=!1,ze=0;const De=new Array(Ne);for(Q=0;Q<Ne;Q++)De[Q]=0;for(Q=ae;Q<=Ue;Q++){const Le=O[Q];if(ye>=Ne){Xe(Le,W,Re,!0);continue}let J;if(Le.key!=null)J=H.get(Le.key);else for(K=F;K<=Ae;K++)if(De[K-F]===0&&Fi(Le,R[K])){J=K;break}J===void 0?Xe(Le,W,Re,!0):(De[J-F]=Q+1,J>=ze?ze=J:qe=!0,I(Le,R[J],V,null,W,Re,me,be,Ce),ye++)}const He=qe?IR(De):Ws;for(K=He.length-1,Q=Ne-1;Q>=0;Q--){const Le=F+Q,J=R[Le],ee=Le+1<Fe?R[Le+1].el:fe;De[Q]===0?I(null,J,V,ee,W,Re,me,be,Ce):qe&&(K<0||Q!==He[K]?Te(J,V,ee,2):K--)}}},Te=(O,R,V,fe,W=null)=>{const{el:Re,type:me,transition:be,children:Ce,shapeFlag:Q}=O;if(Q&6){Te(O.component.subTree,R,V,fe);return}if(Q&128){O.suspense.move(R,V,fe);return}if(Q&64){me.move(O,R,V,Qe);return}if(me===jr){n(Re,R,V);for(let Ue=0;Ue<Ce.length;Ue++)Te(Ce[Ue],R,V,fe);n(O.anchor,R,V);return}if(me===ed){se(O,R,V);return}if(fe!==2&&Q&1&&be)if(fe===0)be.beforeEnter(Re),n(Re,R,V),Lr(()=>be.enter(Re),W);else{const{leave:Ue,delayLeave:Ae,afterLeave:ae}=be,F=()=>n(Re,R,V),H=()=>{Ue(Re,()=>{F(),ae&&ae()})};Ae?Ae(Re,F,H):H()}else n(Re,R,V)},Xe=(O,R,V,fe=!1,W=!1)=>{const{type:Re,props:me,ref:be,children:Ce,dynamicChildren:Q,shapeFlag:Fe,patchFlag:Ue,dirs:Ae}=O;if(be!=null&&rv(be,null,V,O,!0),Fe&256){R.ctx.deactivate(O);return}const ae=Fe&1&&Ae,F=!du(O);let H;if(F&&(H=me&&me.onVnodeBeforeUnmount)&&Dn(H,R,O),Fe&6)T(O.component,V,fe);else{if(Fe&128){O.suspense.unmount(V,fe);return}ae&&Ii(O,null,R,"beforeUnmount"),Fe&64?O.type.remove(O,R,V,W,Qe,fe):Q&&(Re!==jr||Ue>0&&Ue&64)?Se(Q,R,V,!1,!0):(Re===jr&&Ue&384||!W&&Fe&16)&&Se(Ce,R,V),fe&&Je(O)}(F&&(H=me&&me.onVnodeUnmounted)||ae)&&Lr(()=>{H&&Dn(H,R,O),ae&&Ii(O,null,R,"unmounted")},V)},Je=O=>{const{type:R,el:V,anchor:fe,transition:W}=O;if(R===jr){B(V,fe);return}if(R===ed){Pe(O);return}const Re=()=>{a(V),W&&!W.persisted&&W.afterLeave&&W.afterLeave()};if(O.shapeFlag&1&&W&&!W.persisted){const{leave:me,delayLeave:be}=W,Ce=()=>me(V,Re);be?be(O.el,Re,Ce):Ce()}else Re()},B=(O,R)=>{let V;for(;O!==R;)V=w(O),a(O),O=V;a(R)},T=(O,R,V)=>{const{bum:fe,scope:W,update:Re,subTree:me,um:be}=O;fe&&ac(fe),W.stop(),Re&&(Re.active=!1,Xe(me,O,R,V)),be&&Lr(be,R),Lr(()=>{O.isUnmounted=!0},R),R&&R.pendingBranch&&!R.isUnmounted&&O.asyncDep&&!O.asyncResolved&&O.suspenseId===R.pendingId&&(R.deps--,R.deps===0&&R.resolve())},Se=(O,R,V,fe=!1,W=!1,Re=0)=>{for(let me=Re;me<O.length;me++)Xe(O[me],R,V,fe,W)},pe=O=>O.shapeFlag&6?pe(O.component.subTree):O.shapeFlag&128?O.suspense.next():w(O.anchor||O.el),Ke=(O,R,V)=>{O==null?R._vnode&&Xe(R._vnode,null,null,!0):I(R._vnode||null,O,R,null,null,null,V),Dg(),r$(),R._vnode=O},Qe={p:I,um:Xe,m:Te,r:Je,mt:ue,mc:re,pc:N,pbc:X,n:pe,o:e};let we,Ge;return t&&([we,Ge]=t(Qe)),{render:Ke,hydrate:we,createApp:TR(Ke,we)}}function Ci({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function $$(e,t,r=!1){const n=e.children,a=t.children;if(it(n)&&it(a))for(let i=0;i<n.length;i++){const s=n[i];let u=a[i];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=a[i]=za(a[i]),u.el=s.el),r||$$(s,u))}}function IR(e){const t=e.slice(),r=[0];let n,a,i,s,u;const o=e.length;for(n=0;n<o;n++){const l=e[n];if(l!==0){if(a=r[r.length-1],e[a]<l){t[n]=a,r.push(n);continue}for(i=0,s=r.length-1;i<s;)u=i+s>>1,e[r[u]]<l?i=u+1:s=u;l<e[r[i]]&&(i>0&&(t[n]=r[i-1]),r[i]=n)}}for(i=r.length,s=r[i-1];i-- >0;)r[i]=s,s=t[s];return r}const CR=e=>e.__isTeleport,jr=Symbol(void 0),Fh=Symbol(void 0),vn=Symbol(void 0),ed=Symbol(void 0),pu=[];let Cn=null;function _t(e=!1){pu.push(Cn=e?null:[])}function RR(){pu.pop(),Cn=pu[pu.length-1]||null}let Iu=1;function Qg(e){Iu+=e}function T$(e){return e.dynamicChildren=Iu>0?Cn||Ws:null,RR(),Iu>0&&Cn&&Cn.push(e),e}function Ut(e,t,r,n,a,i){return T$(he(e,t,r,n,a,i,!0))}function yo(e,t,r,n,a){return T$(Ht(e,t,r,n,a,!0))}function wc(e){return e?e.__v_isVNode===!0:!1}function Fi(e,t){return e.type===t.type&&e.key===t.key}const rf="__vInternal",k$=({key:e})=>e!=null?e:null,sc=({ref:e,ref_key:t,ref_for:r})=>e!=null?sr(e)||Kt(e)||ut(e)?{i:br,r:e,k:t,f:!!r}:e:null;function he(e,t=null,r=null,n=0,a=null,i=e===jr?0:1,s=!1,u=!1){const o={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&k$(t),ref:t&&sc(t),scopeId:i$,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:i,patchFlag:n,dynamicProps:a,dynamicChildren:null,appContext:null};return u?(Dh(o,r),i&128&&e.normalize(o)):r&&(o.shapeFlag|=sr(r)?8:16),Iu>0&&!s&&Cn&&(o.patchFlag>0||i&6)&&o.patchFlag!==32&&Cn.push(o),o}const Ht=AR;function AR(e,t=null,r=null,n=0,a=null,i=!1){if((!e||e===lR)&&(e=vn),wc(e)){const u=ui(e,t,!0);return r&&Dh(u,r),Iu>0&&!i&&Cn&&(u.shapeFlag&6?Cn[Cn.indexOf(e)]=u:Cn.push(u)),u.patchFlag|=-2,u}if(BR(e)&&(e=e.__vccOpts),t){t=OR(t);let{class:u,style:o}=t;u&&!sr(u)&&(t.class=zc(u)),Bt(o)&&(V0(o)&&!it(o)&&(o=wr({},o)),t.style=bh(o))}const s=sr(e)?1:KC(e)?128:CR(e)?64:Bt(e)?4:ut(e)?2:0;return he(e,t,r,n,a,s,i,!0)}function OR(e){return e?V0(e)||rf in e?wr({},e):e:null}function ui(e,t,r=!1){const{props:n,ref:a,patchFlag:i,children:s}=e,u=t?PR(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&k$(u),ref:t&&t.ref?r&&a?it(a)?a.concat(sc(t)):[a,sc(t)]:sc(t):a,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==jr?i===-1?16:i|16:i,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&ui(e.ssContent),ssFallback:e.ssFallback&&ui(e.ssFallback),el:e.el,anchor:e.anchor}}function Jt(e=" ",t=0){return Ht(Fh,null,e,t)}function gr(e="",t=!1){return t?(_t(),yo(vn,null,e)):Ht(vn,null,e)}function qn(e){return e==null||typeof e=="boolean"?Ht(vn):it(e)?Ht(jr,null,e.slice()):typeof e=="object"?za(e):Ht(Fh,null,String(e))}function za(e){return e.el===null||e.memo?e:ui(e)}function Dh(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(it(t))r=16;else if(typeof t=="object")if(n&65){const a=t.default;a&&(a._c&&(a._d=!1),Dh(e,a()),a._c&&(a._d=!0));return}else{r=32;const a=t._;!a&&!(rf in t)?t._ctx=br:a===3&&br&&(br.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ut(t)?(t={default:t,_ctx:br},r=32):(t=String(t),n&64?(r=16,t=[Jt(t)]):r=8);e.children=t,e.shapeFlag|=r}function PR(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const a in n)if(a==="class")t.class!==n.class&&(t.class=zc([t.class,n.class]));else if(a==="style")t.style=bh([t.style,n.style]);else if(Vc(a)){const i=t[a],s=n[a];s&&i!==s&&!(it(i)&&i.includes(s))&&(t[a]=i?[].concat(i,s):s)}else a!==""&&(t[a]=n[a])}return t}function Dn(e,t,r,n=null){pn(e,t,7,[r,n])}const MR=S$();let xR=0;function NR(e,t,r){const n=e.type,a=(t?t.appContext:e.appContext)||MR,i={uid:xR++,vnode:e,type:n,parent:t,appContext:a,root:null,next:null,subTree:null,effect:null,update:null,scope:new x0(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(a.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:m$(n,a),emitsOptions:a$(n,a),emit:null,emitted:null,propsDefaults:xt,inheritAttrs:n.inheritAttrs,ctx:xt,data:xt,props:xt,attrs:xt,slots:xt,refs:xt,setupState:xt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return i.ctx={_:i},i.root=t?t.root:i,i.emit=HC.bind(null,i),e.ce&&e.ce(i),i}let ar=null;const Bh=()=>ar||br,no=e=>{ar=e,e.scope.on()},Vi=()=>{ar&&ar.scope.off(),ar=null};function E$(e){return e.vnode.shapeFlag&4}let Cu=!1;function LR(e,t=!1){Cu=t;const{props:r,children:n}=e.vnode,a=E$(e);mR(e,r,a,t),_R(e,n);const i=a?jR(e,t):void 0;return Cu=!1,i}function jR(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=ro(new Proxy(e.ctx,dR));const{setup:n}=r;if(n){const a=e.setupContext=n.length>1?FR(e):null;no(e),vo();const i=ei(n,e,0,[e.props,a]);if(ho(),Vi(),O0(i)){if(i.then(Vi,Vi),t)return i.then(s=>{Xg(e,s,t)}).catch(s=>{Xc(s,e,0)});e.asyncDep=i}else Xg(e,i,t)}else I$(e,t)}function Xg(e,t,r){ut(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Bt(t)&&(e.setupState=X0(t)),I$(e,r)}let Zg;function I$(e,t,r){const n=e.type;if(!e.render){if(!t&&Zg&&!n.render){const a=n.template||jh(e).template;if(a){const{isCustomElement:i,compilerOptions:s}=e.appContext.config,{delimiters:u,compilerOptions:o}=n,l=wr(wr({isCustomElement:i,delimiters:u},s),o);n.render=Zg(a,l)}}e.render=n.render||Pn}no(e),vo(),pR(e),ho(),Vi()}function UR(e){return new Proxy(e.attrs,{get(t,r){return Yr(e,"get","$attrs"),t[r]}})}function FR(e){const t=n=>{e.exposed=n||{}};let r;return{get attrs(){return r||(r=UR(e))},slots:e.slots,emit:e.emit,expose:t}}function nf(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(X0(ro(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in mc)return mc[r](e)}}))}function DR(e,t=!0){return ut(e)?e.displayName||e.name:e.name||t&&e.__name}function BR(e){return ut(e)&&"__vccOpts"in e}const rr=(e,t)=>jC(e,t,Cu);function C$(e,t,r){const n=arguments.length;return n===2?Bt(t)&&!it(t)?wc(t)?Ht(e,null,[t]):Ht(e,t):Ht(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&wc(r)&&(r=[r]),Ht(e,t,r))}const qR="3.2.39",HR="http://www.w3.org/2000/svg",Di=typeof document<"u"?document:null,em=Di&&Di.createElement("template"),WR={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const a=t?Di.createElementNS(HR,e):Di.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&a.setAttribute("multiple",n.multiple),a},createText:e=>Di.createTextNode(e),createComment:e=>Di.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Di.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n,a,i){const s=r?r.previousSibling:t.lastChild;if(a&&(a===i||a.nextSibling))for(;t.insertBefore(a.cloneNode(!0),r),!(a===i||!(a=a.nextSibling)););else{em.innerHTML=n?`<svg>${e}</svg>`:e;const u=em.content;if(n){const o=u.firstChild;for(;o.firstChild;)u.appendChild(o.firstChild);u.removeChild(o)}t.insertBefore(u,r)}return[s?s.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function GR(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function zR(e,t,r){const n=e.style,a=sr(r);if(r&&!a){for(const i in r)nv(n,i,r[i]);if(t&&!sr(t))for(const i in t)r[i]==null&&nv(n,i,"")}else{const i=n.display;a?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=i)}}const tm=/\s*!important$/;function nv(e,t,r){if(it(r))r.forEach(n=>nv(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=VR(e,t);tm.test(r)?e.setProperty(es(n),r.replace(tm,""),"important"):e[n]=r}}const rm=["Webkit","Moz","ms"],td={};function VR(e,t){const r=td[t];if(r)return r;let n=Yn(t);if(n!=="filter"&&n in e)return td[t]=n;n=Jc(n);for(let a=0;a<rm.length;a++){const i=rm[a]+n;if(i in e)return td[t]=i}return t}const nm="http://www.w3.org/1999/xlink";function KR(e,t,r,n,a){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(nm,t.slice(6,t.length)):e.setAttributeNS(nm,t,r);else{const i=GI(t);r==null||i&&!C0(r)?e.removeAttribute(t):e.setAttribute(t,i?"":r)}}function YR(e,t,r,n,a,i,s){if(t==="innerHTML"||t==="textContent"){n&&s(n,a,i),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const o=r==null?"":r;(e.value!==o||e.tagName==="OPTION")&&(e.value=o),r==null&&e.removeAttribute(t);return}let u=!1;if(r===""||r==null){const o=typeof e[t];o==="boolean"?r=C0(r):r==null&&o==="string"?(r="",u=!0):o==="number"&&(r=0,u=!0)}try{e[t]=r}catch{}u&&e.removeAttribute(t)}const[R$,JR]=(()=>{let e=Date.now,t=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const r=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(r&&Number(r[1])<=53)}return[e,t]})();let av=0;const QR=Promise.resolve(),XR=()=>{av=0},ZR=()=>av||(QR.then(XR),av=R$());function Ns(e,t,r,n){e.addEventListener(t,r,n)}function eA(e,t,r,n){e.removeEventListener(t,r,n)}function tA(e,t,r,n,a=null){const i=e._vei||(e._vei={}),s=i[t];if(n&&s)s.value=n;else{const[u,o]=rA(t);if(n){const l=i[t]=nA(n,a);Ns(e,u,l,o)}else s&&(eA(e,u,s,o),i[t]=void 0)}}const am=/(?:Once|Passive|Capture)$/;function rA(e){let t;if(am.test(e)){t={};let n;for(;n=e.match(am);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):es(e.slice(2)),t]}function nA(e,t){const r=n=>{const a=n.timeStamp||R$();(JR||a>=r.attached-1)&&pn(aA(n,r.value),t,5,[n])};return r.value=e,r.attached=ZR(),r}function aA(e,t){if(it(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>a=>!a._stopped&&n&&n(a))}else return t}const im=/^on[a-z]/,iA=(e,t,r,n,a=!1,i,s,u,o)=>{t==="class"?GR(e,n,a):t==="style"?zR(e,r,n):Vc(t)?wh(t)||tA(e,t,r,n,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):sA(e,t,n,a))?YR(e,t,n,i,s,u,o):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),KR(e,t,n,a))};function sA(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&im.test(t)&&ut(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||im.test(t)&&sr(r)?!1:t in e}const oA={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};ZC.props;const sm=e=>{const t=e.props["onUpdate:modelValue"]||!1;return it(t)?r=>ac(t,r):t};function uA(e){e.target.composing=!0}function om(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const A$={created(e,{modifiers:{lazy:t,trim:r,number:n}},a){e._assign=sm(a);const i=n||a.props&&a.props.type==="number";Ns(e,t?"change":"input",s=>{if(s.target.composing)return;let u=e.value;r&&(u=u.trim()),i&&(u=Wp(u)),e._assign(u)}),r&&Ns(e,"change",()=>{e.value=e.value.trim()}),t||(Ns(e,"compositionstart",uA),Ns(e,"compositionend",om),Ns(e,"change",om))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:n,number:a}},i){if(e._assign=sm(i),e.composing||document.activeElement===e&&e.type!=="range"&&(r||n&&e.value.trim()===t||(a||e.type==="number")&&Wp(e.value)===t))return;const s=t==null?"":t;e.value!==s&&(e.value=s)}},lA=["ctrl","shift","alt","meta"],cA={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>lA.some(r=>e[`${r}Key`]&&!t.includes(r))},fA=(e,t)=>(r,...n)=>{for(let a=0;a<t.length;a++){const i=cA[t[a]];if(i&&i(r,t))return}return e(r,...n)},dA={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},pA=(e,t)=>r=>{if(!("key"in r))return;const n=es(r.key);if(t.some(a=>a===n||dA[a]===n))return e(r)},Ft={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):Ho(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),Ho(e,!0),n.enter(e)):n.leave(e,()=>{Ho(e,!1)}):Ho(e,t))},beforeUnmount(e,{value:t}){Ho(e,t)}};function Ho(e,t){e.style.display=t?e._vod:"none"}const vA=wr({patchProp:iA},WR);let um;function hA(){return um||(um=kR(vA))}const yA=(...e)=>{const t=hA().createApp(...e),{mount:r}=t;return t.mount=n=>{const a=gA(n);if(!a)return;const i=t._component;!ut(i)&&!i.render&&!i.template&&(i.template=a.innerHTML),a.innerHTML="";const s=r(a,!1,a instanceof SVGElement);return a instanceof Element&&(a.removeAttribute("v-cloak"),a.setAttribute("data-v-app","")),s},t};function gA(e){return sr(e)?document.querySelector(e):e}var mA=!1;/*!
  * pinia v2.0.22
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let O$;const af=e=>O$=e,P$=Symbol();function iv(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var vu;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(vu||(vu={}));function bA(){const e=N0(!0),t=e.run(()=>bt({}));let r=[],n=[];const a=ro({install(i){af(a),a._a=i,i.provide(P$,a),i.config.globalProperties.$pinia=a,n.forEach(s=>r.push(s)),n=[]},use(i){return!this._a&&!mA?n.push(i):r.push(i),this},_p:r,_a:null,_e:e,_s:new Map,state:t});return a}const M$=()=>{};function lm(e,t,r,n=M$){e.push(t);const a=()=>{const i=e.indexOf(t);i>-1&&(e.splice(i,1),n())};return!r&&Bh()&&Lh(a),a}function _s(e,...t){e.slice().forEach(r=>{r(...t)})}function sv(e,t){e instanceof Map&&t instanceof Map&&t.forEach((r,n)=>e.set(n,r)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const r in t){if(!t.hasOwnProperty(r))continue;const n=t[r],a=e[r];iv(a)&&iv(n)&&e.hasOwnProperty(r)&&!Kt(n)&&!Za(n)?e[r]=sv(a,n):e[r]=n}return e}const wA=Symbol();function _A(e){return!iv(e)||!e.hasOwnProperty(wA)}const{assign:la}=Object;function SA(e){return!!(Kt(e)&&e.effect)}function $A(e,t,r,n){const{state:a,actions:i,getters:s}=t,u=r.state.value[e];let o;function l(){u||(r.state.value[e]=a?a():{});const c=MC(r.state.value[e]);return la(c,i,Object.keys(s||{}).reduce((h,w)=>(h[w]=ro(rr(()=>{af(r);const b=r._s.get(e);return s[w].call(b,b)})),h),{}))}return o=x$(e,l,t,r,n,!0),o.$reset=function(){const h=a?a():{};this.$patch(w=>{la(w,h)})},o}function x$(e,t,r={},n,a,i){let s;const u=la({actions:{}},r),o={deep:!0};let l,c,h=ro([]),w=ro([]),b;const $=n.state.value[e];!i&&!$&&(n.state.value[e]={}),bt({});let C;function I(le){let x;l=c=!1,typeof le=="function"?(le(n.state.value[e]),x={type:vu.patchFunction,storeId:e,events:b}):(sv(n.state.value[e],le),x={type:vu.patchObject,payload:le,storeId:e,events:b});const re=C=Symbol();Ph().then(()=>{C===re&&(l=!0)}),c=!0,_s(h,x,n.state.value[e])}const j=M$;function D(){s.stop(),h=[],w=[],n._s.delete(e)}function ve(le,x){return function(){af(n);const re=Array.from(arguments),de=[],X=[];function xe(ue){de.push(ue)}function ce(ue){X.push(ue)}_s(w,{args:re,name:le,store:Pe,after:xe,onError:ce});let te;try{te=x.apply(this&&this.$id===e?this:Pe,re)}catch(ue){throw _s(X,ue),ue}return te instanceof Promise?te.then(ue=>(_s(de,ue),ue)).catch(ue=>(_s(X,ue),Promise.reject(ue))):(_s(de,te),te)}}const se={_p:n,$id:e,$onAction:lm.bind(null,w),$patch:I,$reset:j,$subscribe(le,x={}){const re=lm(h,le,x.detached,()=>de()),de=s.run(()=>zi(()=>n.state.value[e],X=>{(x.flush==="sync"?c:l)&&le({storeId:e,type:vu.direct,events:b},X)},la({},o,x)));return re},$dispose:D},Pe=ts(la({},se));n._s.set(e,Pe);const Me=n._e.run(()=>(s=N0(),s.run(()=>t())));for(const le in Me){const x=Me[le];if(Kt(x)&&!SA(x)||Za(x))i||($&&_A(x)&&(Kt(x)?x.value=$[le]:sv(x,$[le])),n.state.value[e][le]=x);else if(typeof x=="function"){const re=ve(le,x);Me[le]=re,u.actions[le]=x}}return la(Pe,Me),la(mt(Pe),Me),Object.defineProperty(Pe,"$state",{get:()=>n.state.value[e],set:le=>{I(x=>{la(x,le)})}}),n._p.forEach(le=>{la(Pe,s.run(()=>le({store:Pe,app:n._a,pinia:n,options:u})))}),$&&i&&r.hydrate&&r.hydrate(Pe.$state,$),l=!0,c=!0,Pe}function TA(e,t,r){let n,a;const i=typeof t=="function";typeof e=="string"?(n=e,a=i?r:t):(a=e,n=e.id);function s(u,o){const l=Bh();return u=u||l&&Vn(P$),u&&af(u),u=O$,u._s.has(n)||(i?x$(n,t,a,u):$A(n,a,u)),u._s.get(n)}return s.$id=n,s}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Ls=typeof window<"u";function kA(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const It=Object.assign;function rd(e,t){const r={};for(const n in t){const a=t[n];r[n]=Mn(a)?a.map(e):e(a)}return r}const hu=()=>{},Mn=Array.isArray,EA=/\/$/,IA=e=>e.replace(EA,"");function nd(e,t,r="/"){let n,a={},i="",s="";const u=t.indexOf("#");let o=t.indexOf("?");return u<o&&u>=0&&(o=-1),o>-1&&(n=t.slice(0,o),i=t.slice(o+1,u>-1?u:t.length),a=e(i)),u>-1&&(n=n||t.slice(0,u),s=t.slice(u,t.length)),n=OA(n!=null?n:t,r),{fullPath:n+(i&&"?")+i+s,path:n,query:a,hash:s}}function CA(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function cm(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function RA(e,t,r){const n=t.matched.length-1,a=r.matched.length-1;return n>-1&&n===a&&ao(t.matched[n],r.matched[a])&&N$(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function ao(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function N$(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!AA(e[r],t[r]))return!1;return!0}function AA(e,t){return Mn(e)?fm(e,t):Mn(t)?fm(t,e):e===t}function fm(e,t){return Mn(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function OA(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/");let a=r.length-1,i,s;for(i=0;i<n.length;i++)if(s=n[i],s!==".")if(s==="..")a>1&&a--;else break;return r.slice(0,a).join("/")+"/"+n.slice(i-(i===n.length?1:0)).join("/")}var Ru;(function(e){e.pop="pop",e.push="push"})(Ru||(Ru={}));var yu;(function(e){e.back="back",e.forward="forward",e.unknown=""})(yu||(yu={}));function PA(e){if(!e)if(Ls){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),IA(e)}const MA=/^[^#]+#/;function xA(e,t){return e.replace(MA,"#")+t}function NA(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const sf=()=>({left:window.pageXOffset,top:window.pageYOffset});function LA(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),a=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!a)return;t=NA(a,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function dm(e,t){return(history.state?history.state.position-t:-1)+e}const ov=new Map;function jA(e,t){ov.set(e,t)}function UA(e){const t=ov.get(e);return ov.delete(e),t}let FA=()=>location.protocol+"//"+location.host;function L$(e,t){const{pathname:r,search:n,hash:a}=t,i=e.indexOf("#");if(i>-1){let u=a.includes(e.slice(i))?e.slice(i).length:1,o=a.slice(u);return o[0]!=="/"&&(o="/"+o),cm(o,"")}return cm(r,e)+n+a}function DA(e,t,r,n){let a=[],i=[],s=null;const u=({state:w})=>{const b=L$(e,location),$=r.value,C=t.value;let I=0;if(w){if(r.value=b,t.value=w,s&&s===$){s=null;return}I=C?w.position-C.position:0}else n(b);a.forEach(j=>{j(r.value,$,{delta:I,type:Ru.pop,direction:I?I>0?yu.forward:yu.back:yu.unknown})})};function o(){s=r.value}function l(w){a.push(w);const b=()=>{const $=a.indexOf(w);$>-1&&a.splice($,1)};return i.push(b),b}function c(){const{history:w}=window;!w.state||w.replaceState(It({},w.state,{scroll:sf()}),"")}function h(){for(const w of i)w();i=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",c)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",c),{pauseListeners:o,listen:l,destroy:h}}function pm(e,t,r,n=!1,a=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:a?sf():null}}function BA(e){const{history:t,location:r}=window,n={value:L$(e,r)},a={value:t.state};a.value||i(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function i(o,l,c){const h=e.indexOf("#"),w=h>-1?(r.host&&document.querySelector("base")?e:e.slice(h))+o:FA()+e+o;try{t[c?"replaceState":"pushState"](l,"",w),a.value=l}catch(b){console.error(b),r[c?"replace":"assign"](w)}}function s(o,l){const c=It({},t.state,pm(a.value.back,o,a.value.forward,!0),l,{position:a.value.position});i(o,c,!0),n.value=o}function u(o,l){const c=It({},a.value,t.state,{forward:o,scroll:sf()});i(c.current,c,!0);const h=It({},pm(n.value,o,null),{position:c.position+1},l);i(o,h,!1),n.value=o}return{location:n,state:a,push:u,replace:s}}function qA(e){e=PA(e);const t=BA(e),r=DA(e,t.state,t.location,t.replace);function n(i,s=!0){s||r.pauseListeners(),history.go(i)}const a=It({location:"",base:e,go:n,createHref:xA.bind(null,e)},t,r);return Object.defineProperty(a,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(a,"state",{enumerable:!0,get:()=>t.state.value}),a}function HA(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),qA(e)}function WA(e){return typeof e=="string"||e&&typeof e=="object"}function j$(e){return typeof e=="string"||typeof e=="symbol"}const Da={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},U$=Symbol("");var vm;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(vm||(vm={}));function io(e,t){return It(new Error,{type:e,[U$]:!0},t)}function ia(e,t){return e instanceof Error&&U$ in e&&(t==null||!!(e.type&t))}const hm="[^/]+?",GA={sensitive:!1,strict:!1,start:!0,end:!0},zA=/[.+*?^${}()[\]/\\]/g;function VA(e,t){const r=It({},GA,t),n=[];let a=r.start?"^":"";const i=[];for(const l of e){const c=l.length?[]:[90];r.strict&&!l.length&&(a+="/");for(let h=0;h<l.length;h++){const w=l[h];let b=40+(r.sensitive?.25:0);if(w.type===0)h||(a+="/"),a+=w.value.replace(zA,"\\$&"),b+=40;else if(w.type===1){const{value:$,repeatable:C,optional:I,regexp:j}=w;i.push({name:$,repeatable:C,optional:I});const D=j||hm;if(D!==hm){b+=10;try{new RegExp(`(${D})`)}catch(se){throw new Error(`Invalid custom RegExp for param "${$}" (${D}): `+se.message)}}let ve=C?`((?:${D})(?:/(?:${D}))*)`:`(${D})`;h||(ve=I&&l.length<2?`(?:/${ve})`:"/"+ve),I&&(ve+="?"),a+=ve,b+=20,I&&(b+=-8),C&&(b+=-20),D===".*"&&(b+=-50)}c.push(b)}n.push(c)}if(r.strict&&r.end){const l=n.length-1;n[l][n[l].length-1]+=.7000000000000001}r.strict||(a+="/?"),r.end?a+="$":r.strict&&(a+="(?:/|$)");const s=new RegExp(a,r.sensitive?"":"i");function u(l){const c=l.match(s),h={};if(!c)return null;for(let w=1;w<c.length;w++){const b=c[w]||"",$=i[w-1];h[$.name]=b&&$.repeatable?b.split("/"):b}return h}function o(l){let c="",h=!1;for(const w of e){(!h||!c.endsWith("/"))&&(c+="/"),h=!1;for(const b of w)if(b.type===0)c+=b.value;else if(b.type===1){const{value:$,repeatable:C,optional:I}=b,j=$ in l?l[$]:"";if(Mn(j)&&!C)throw new Error(`Provided param "${$}" is an array but it is not repeatable (* or + modifiers)`);const D=Mn(j)?j.join("/"):j;if(!D)if(I)w.length<2&&(c.endsWith("/")?c=c.slice(0,-1):h=!0);else throw new Error(`Missing required param "${$}"`);c+=D}}return c||"/"}return{re:s,score:n,keys:i,parse:u,stringify:o}}function KA(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function YA(e,t){let r=0;const n=e.score,a=t.score;for(;r<n.length&&r<a.length;){const i=KA(n[r],a[r]);if(i)return i;r++}if(Math.abs(a.length-n.length)===1){if(ym(n))return 1;if(ym(a))return-1}return a.length-n.length}function ym(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const JA={type:0,value:""},QA=/[a-zA-Z0-9_]/;function XA(e){if(!e)return[[]];if(e==="/")return[[JA]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(b){throw new Error(`ERR (${r})/"${l}": ${b}`)}let r=0,n=r;const a=[];let i;function s(){i&&a.push(i),i=[]}let u=0,o,l="",c="";function h(){!l||(r===0?i.push({type:0,value:l}):r===1||r===2||r===3?(i.length>1&&(o==="*"||o==="+")&&t(`A repeatable param (${l}) must be alone in its segment. eg: '/:ids+.`),i.push({type:1,value:l,regexp:c,repeatable:o==="*"||o==="+",optional:o==="*"||o==="?"})):t("Invalid state to consume buffer"),l="")}function w(){l+=o}for(;u<e.length;){if(o=e[u++],o==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:o==="/"?(l&&h(),s()):o===":"?(h(),r=1):w();break;case 4:w(),r=n;break;case 1:o==="("?r=2:QA.test(o)?w():(h(),r=0,o!=="*"&&o!=="?"&&o!=="+"&&u--);break;case 2:o===")"?c[c.length-1]=="\\"?c=c.slice(0,-1)+o:r=3:c+=o;break;case 3:h(),r=0,o!=="*"&&o!=="?"&&o!=="+"&&u--,c="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${l}"`),h(),s(),a}function ZA(e,t,r){const n=VA(XA(e.path),r),a=It(n,{record:e,parent:t,children:[],alias:[]});return t&&!a.record.aliasOf==!t.record.aliasOf&&t.children.push(a),a}function eO(e,t){const r=[],n=new Map;t=bm({strict:!1,end:!0,sensitive:!1},t);function a(c){return n.get(c)}function i(c,h,w){const b=!w,$=tO(c);$.aliasOf=w&&w.record;const C=bm(t,c),I=[$];if("alias"in c){const ve=typeof c.alias=="string"?[c.alias]:c.alias;for(const se of ve)I.push(It({},$,{components:w?w.record.components:$.components,path:se,aliasOf:w?w.record:$}))}let j,D;for(const ve of I){const{path:se}=ve;if(h&&se[0]!=="/"){const Pe=h.record.path,Me=Pe[Pe.length-1]==="/"?"":"/";ve.path=h.record.path+(se&&Me+se)}if(j=ZA(ve,h,C),w?w.alias.push(j):(D=D||j,D!==j&&D.alias.push(j),b&&c.name&&!mm(j)&&s(c.name)),$.children){const Pe=$.children;for(let Me=0;Me<Pe.length;Me++)i(Pe[Me],j,w&&w.children[Me])}w=w||j,o(j)}return D?()=>{s(D)}:hu}function s(c){if(j$(c)){const h=n.get(c);h&&(n.delete(c),r.splice(r.indexOf(h),1),h.children.forEach(s),h.alias.forEach(s))}else{const h=r.indexOf(c);h>-1&&(r.splice(h,1),c.record.name&&n.delete(c.record.name),c.children.forEach(s),c.alias.forEach(s))}}function u(){return r}function o(c){let h=0;for(;h<r.length&&YA(c,r[h])>=0&&(c.record.path!==r[h].record.path||!F$(c,r[h]));)h++;r.splice(h,0,c),c.record.name&&!mm(c)&&n.set(c.record.name,c)}function l(c,h){let w,b={},$,C;if("name"in c&&c.name){if(w=n.get(c.name),!w)throw io(1,{location:c});C=w.record.name,b=It(gm(h.params,w.keys.filter(D=>!D.optional).map(D=>D.name)),c.params&&gm(c.params,w.keys.map(D=>D.name))),$=w.stringify(b)}else if("path"in c)$=c.path,w=r.find(D=>D.re.test($)),w&&(b=w.parse($),C=w.record.name);else{if(w=h.name?n.get(h.name):r.find(D=>D.re.test(h.path)),!w)throw io(1,{location:c,currentLocation:h});C=w.record.name,b=It({},h.params,c.params),$=w.stringify(b)}const I=[];let j=w;for(;j;)I.unshift(j.record),j=j.parent;return{name:C,path:$,params:b,matched:I,meta:nO(I)}}return e.forEach(c=>i(c)),{addRoute:i,resolve:l,removeRoute:s,getRoutes:u,getRecordMatcher:a}}function gm(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function tO(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:rO(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function rO(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function mm(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function nO(e){return e.reduce((t,r)=>It(t,r.meta),{})}function bm(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function F$(e,t){return t.children.some(r=>r===e||F$(e,r))}const D$=/#/g,aO=/&/g,iO=/\//g,sO=/=/g,oO=/\?/g,B$=/\+/g,uO=/%5B/g,lO=/%5D/g,q$=/%5E/g,cO=/%60/g,H$=/%7B/g,fO=/%7C/g,W$=/%7D/g,dO=/%20/g;function qh(e){return encodeURI(""+e).replace(fO,"|").replace(uO,"[").replace(lO,"]")}function pO(e){return qh(e).replace(H$,"{").replace(W$,"}").replace(q$,"^")}function uv(e){return qh(e).replace(B$,"%2B").replace(dO,"+").replace(D$,"%23").replace(aO,"%26").replace(cO,"`").replace(H$,"{").replace(W$,"}").replace(q$,"^")}function vO(e){return uv(e).replace(sO,"%3D")}function hO(e){return qh(e).replace(D$,"%23").replace(oO,"%3F")}function yO(e){return e==null?"":hO(e).replace(iO,"%2F")}function _c(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function gO(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let a=0;a<n.length;++a){const i=n[a].replace(B$," "),s=i.indexOf("="),u=_c(s<0?i:i.slice(0,s)),o=s<0?null:_c(i.slice(s+1));if(u in t){let l=t[u];Mn(l)||(l=t[u]=[l]),l.push(o)}else t[u]=o}return t}function wm(e){let t="";for(let r in e){const n=e[r];if(r=vO(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(Mn(n)?n.map(i=>i&&uv(i)):[n&&uv(n)]).forEach(i=>{i!==void 0&&(t+=(t.length?"&":"")+r,i!=null&&(t+="="+i))})}return t}function mO(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=Mn(n)?n.map(a=>a==null?null:""+a):n==null?n:""+n)}return t}const bO=Symbol(""),_m=Symbol(""),Hh=Symbol(""),Wh=Symbol(""),lv=Symbol("");function Wo(){let e=[];function t(n){return e.push(n),()=>{const a=e.indexOf(n);a>-1&&e.splice(a,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function Va(e,t,r,n,a){const i=n&&(n.enterCallbacks[a]=n.enterCallbacks[a]||[]);return()=>new Promise((s,u)=>{const o=h=>{h===!1?u(io(4,{from:r,to:t})):h instanceof Error?u(h):WA(h)?u(io(2,{from:t,to:h})):(i&&n.enterCallbacks[a]===i&&typeof h=="function"&&i.push(h),s())},l=e.call(n&&n.instances[a],t,r,o);let c=Promise.resolve(l);e.length<3&&(c=c.then(o)),c.catch(h=>u(h))})}function ad(e,t,r,n){const a=[];for(const i of e)for(const s in i.components){let u=i.components[s];if(!(t!=="beforeRouteEnter"&&!i.instances[s]))if(wO(u)){const l=(u.__vccOpts||u)[t];l&&a.push(Va(l,r,n,i,s))}else{let o=u();a.push(()=>o.then(l=>{if(!l)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${i.path}"`));const c=kA(l)?l.default:l;i.components[s]=c;const w=(c.__vccOpts||c)[t];return w&&Va(w,r,n,i,s)()}))}}return a}function wO(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Sm(e){const t=Vn(Hh),r=Vn(Wh),n=rr(()=>t.resolve(er(e.to))),a=rr(()=>{const{matched:o}=n.value,{length:l}=o,c=o[l-1],h=r.matched;if(!c||!h.length)return-1;const w=h.findIndex(ao.bind(null,c));if(w>-1)return w;const b=$m(o[l-2]);return l>1&&$m(c)===b&&h[h.length-1].path!==b?h.findIndex(ao.bind(null,o[l-2])):w}),i=rr(()=>a.value>-1&&$O(r.params,n.value.params)),s=rr(()=>a.value>-1&&a.value===r.matched.length-1&&N$(r.params,n.value.params));function u(o={}){return SO(o)?t[er(e.replace)?"replace":"push"](er(e.to)).catch(hu):Promise.resolve()}return{route:n,href:rr(()=>n.value.href),isActive:i,isExactActive:s,navigate:u}}const _O=c$({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Sm,setup(e,{slots:t}){const r=ts(Sm(e)),{options:n}=Vn(Hh),a=rr(()=>({[Tm(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Tm(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const i=t.default&&t.default(r);return e.custom?i:C$("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:a.value},i)}}}),G$=_O;function SO(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function $O(e,t){for(const r in t){const n=t[r],a=e[r];if(typeof n=="string"){if(n!==a)return!1}else if(!Mn(a)||a.length!==n.length||n.some((i,s)=>i!==a[s]))return!1}return!0}function $m(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Tm=(e,t,r)=>e!=null?e:t!=null?t:r,TO=c$({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=Vn(lv),a=rr(()=>e.route||n.value),i=Vn(_m,0),s=rr(()=>{let l=er(i);const{matched:c}=a.value;let h;for(;(h=c[l])&&!h.components;)l++;return l}),u=rr(()=>a.value.matched[s.value]);ic(_m,rr(()=>s.value+1)),ic(bO,u),ic(lv,a);const o=bt();return zi(()=>[o.value,u.value,e.name],([l,c,h],[w,b,$])=>{c&&(c.instances[h]=l,b&&b!==c&&l&&l===w&&(c.leaveGuards.size||(c.leaveGuards=b.leaveGuards),c.updateGuards.size||(c.updateGuards=b.updateGuards))),l&&c&&(!b||!ao(c,b)||!w)&&(c.enterCallbacks[h]||[]).forEach(C=>C(l))},{flush:"post"}),()=>{const l=a.value,c=e.name,h=u.value,w=h&&h.components[c];if(!w)return km(r.default,{Component:w,route:l});const b=h.props[c],$=b?b===!0?l.params:typeof b=="function"?b(l):b:null,I=C$(w,It({},$,t,{onVnodeUnmounted:j=>{j.component.isUnmounted&&(h.instances[c]=null)},ref:o}));return km(r.default,{Component:I,route:l})||I}}});function km(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const z$=TO;function kO(e){const t=eO(e.routes,e),r=e.parseQuery||gO,n=e.stringifyQuery||wm,a=e.history,i=Wo(),s=Wo(),u=Wo(),o=J0(Da);let l=Da;Ls&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const c=rd.bind(null,B=>""+B),h=rd.bind(null,yO),w=rd.bind(null,_c);function b(B,T){let Se,pe;return j$(B)?(Se=t.getRecordMatcher(B),pe=T):pe=B,t.addRoute(pe,Se)}function $(B){const T=t.getRecordMatcher(B);T&&t.removeRoute(T)}function C(){return t.getRoutes().map(B=>B.record)}function I(B){return!!t.getRecordMatcher(B)}function j(B,T){if(T=It({},T||o.value),typeof B=="string"){const Ge=nd(r,B,T.path),O=t.resolve({path:Ge.path},T),R=a.createHref(Ge.fullPath);return It(Ge,O,{params:w(O.params),hash:_c(Ge.hash),redirectedFrom:void 0,href:R})}let Se;if("path"in B)Se=It({},B,{path:nd(r,B.path,T.path).path});else{const Ge=It({},B.params);for(const O in Ge)Ge[O]==null&&delete Ge[O];Se=It({},B,{params:h(B.params)}),T.params=h(T.params)}const pe=t.resolve(Se,T),Ke=B.hash||"";pe.params=c(w(pe.params));const Qe=CA(n,It({},B,{hash:pO(Ke),path:pe.path})),we=a.createHref(Qe);return It({fullPath:Qe,hash:Ke,query:n===wm?mO(B.query):B.query||{}},pe,{redirectedFrom:void 0,href:we})}function D(B){return typeof B=="string"?nd(r,B,o.value.path):It({},B)}function ve(B,T){if(l!==B)return io(8,{from:T,to:B})}function se(B){return le(B)}function Pe(B){return se(It(D(B),{replace:!0}))}function Me(B){const T=B.matched[B.matched.length-1];if(T&&T.redirect){const{redirect:Se}=T;let pe=typeof Se=="function"?Se(B):Se;return typeof pe=="string"&&(pe=pe.includes("?")||pe.includes("#")?pe=D(pe):{path:pe},pe.params={}),It({query:B.query,hash:B.hash,params:"path"in pe?{}:B.params},pe)}}function le(B,T){const Se=l=j(B),pe=o.value,Ke=B.state,Qe=B.force,we=B.replace===!0,Ge=Me(Se);if(Ge)return le(It(D(Ge),{state:typeof Ge=="object"?It({},Ke,Ge.state):Ke,force:Qe,replace:we}),T||Se);const O=Se;O.redirectedFrom=T;let R;return!Qe&&RA(n,pe,Se)&&(R=io(16,{to:O,from:pe}),ct(pe,pe,!0,!1)),(R?Promise.resolve(R):re(O,pe)).catch(V=>ia(V)?ia(V,2)?V:N(V):Ie(V,O,pe)).then(V=>{if(V){if(ia(V,2))return le(It({replace:we},D(V.to),{state:typeof V.to=="object"?It({},Ke,V.to.state):Ke,force:Qe}),T||O)}else V=X(O,pe,!0,we,Ke);return de(O,pe,V),V})}function x(B,T){const Se=ve(B,T);return Se?Promise.reject(Se):Promise.resolve()}function re(B,T){let Se;const[pe,Ke,Qe]=EO(B,T);Se=ad(pe.reverse(),"beforeRouteLeave",B,T);for(const Ge of pe)Ge.leaveGuards.forEach(O=>{Se.push(Va(O,B,T))});const we=x.bind(null,B,T);return Se.push(we),Ss(Se).then(()=>{Se=[];for(const Ge of i.list())Se.push(Va(Ge,B,T));return Se.push(we),Ss(Se)}).then(()=>{Se=ad(Ke,"beforeRouteUpdate",B,T);for(const Ge of Ke)Ge.updateGuards.forEach(O=>{Se.push(Va(O,B,T))});return Se.push(we),Ss(Se)}).then(()=>{Se=[];for(const Ge of B.matched)if(Ge.beforeEnter&&!T.matched.includes(Ge))if(Mn(Ge.beforeEnter))for(const O of Ge.beforeEnter)Se.push(Va(O,B,T));else Se.push(Va(Ge.beforeEnter,B,T));return Se.push(we),Ss(Se)}).then(()=>(B.matched.forEach(Ge=>Ge.enterCallbacks={}),Se=ad(Qe,"beforeRouteEnter",B,T),Se.push(we),Ss(Se))).then(()=>{Se=[];for(const Ge of s.list())Se.push(Va(Ge,B,T));return Se.push(we),Ss(Se)}).catch(Ge=>ia(Ge,8)?Ge:Promise.reject(Ge))}function de(B,T,Se){for(const pe of u.list())pe(B,T,Se)}function X(B,T,Se,pe,Ke){const Qe=ve(B,T);if(Qe)return Qe;const we=T===Da,Ge=Ls?history.state:{};Se&&(pe||we?a.replace(B.fullPath,It({scroll:we&&Ge&&Ge.scroll},Ke)):a.push(B.fullPath,Ke)),o.value=B,ct(B,T,Se,we),N()}let xe;function ce(){xe||(xe=a.listen((B,T,Se)=>{if(!Je.listening)return;const pe=j(B),Ke=Me(pe);if(Ke){le(It(Ke,{replace:!0}),pe).catch(hu);return}l=pe;const Qe=o.value;Ls&&jA(dm(Qe.fullPath,Se.delta),sf()),re(pe,Qe).catch(we=>ia(we,12)?we:ia(we,2)?(le(we.to,pe).then(Ge=>{ia(Ge,20)&&!Se.delta&&Se.type===Ru.pop&&a.go(-1,!1)}).catch(hu),Promise.reject()):(Se.delta&&a.go(-Se.delta,!1),Ie(we,pe,Qe))).then(we=>{we=we||X(pe,Qe,!1),we&&(Se.delta&&!ia(we,8)?a.go(-Se.delta,!1):Se.type===Ru.pop&&ia(we,20)&&a.go(-1,!1)),de(pe,Qe,we)}).catch(hu)}))}let te=Wo(),ue=Wo(),ie;function Ie(B,T,Se){N(B);const pe=ue.list();return pe.length?pe.forEach(Ke=>Ke(B,T,Se)):console.error(B),Promise.reject(B)}function $e(){return ie&&o.value!==Da?Promise.resolve():new Promise((B,T)=>{te.add([B,T])})}function N(B){return ie||(ie=!B,ce(),te.list().forEach(([T,Se])=>B?Se(B):T()),te.reset()),B}function ct(B,T,Se,pe){const{scrollBehavior:Ke}=e;if(!Ls||!Ke)return Promise.resolve();const Qe=!Se&&UA(dm(B.fullPath,0))||(pe||!Se)&&history.state&&history.state.scroll||null;return Ph().then(()=>Ke(B,T,Qe)).then(we=>we&&LA(we)).catch(we=>Ie(we,B,T))}const ft=B=>a.go(B);let Te;const Xe=new Set,Je={currentRoute:o,listening:!0,addRoute:b,removeRoute:$,hasRoute:I,getRoutes:C,resolve:j,options:e,push:se,replace:Pe,go:ft,back:()=>ft(-1),forward:()=>ft(1),beforeEach:i.add,beforeResolve:s.add,afterEach:u.add,onError:ue.add,isReady:$e,install(B){const T=this;B.component("RouterLink",G$),B.component("RouterView",z$),B.config.globalProperties.$router=T,Object.defineProperty(B.config.globalProperties,"$route",{enumerable:!0,get:()=>er(o)}),Ls&&!Te&&o.value===Da&&(Te=!0,se(a.location).catch(Ke=>{}));const Se={};for(const Ke in Da)Se[Ke]=rr(()=>o.value[Ke]);B.provide(Hh,T),B.provide(Wh,ts(Se)),B.provide(lv,o);const pe=B.unmount;Xe.add(B),B.unmount=function(){Xe.delete(B),Xe.size<1&&(l=Da,xe&&xe(),xe=null,o.value=Da,Te=!1,ie=!1),pe()}}};return Je}function Ss(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function EO(e,t){const r=[],n=[],a=[],i=Math.max(t.matched.length,e.matched.length);for(let s=0;s<i;s++){const u=t.matched[s];u&&(e.matched.find(l=>ao(l,u))?n.push(u):r.push(u));const o=e.matched[s];o&&(t.matched.find(l=>ao(l,o))||a.push(o))}return[r,n,a]}function IO(){return Vn(Wh)}const CO={__name:"App",setup(e){return(t,r)=>(_t(),yo(er(z$)))}},go=(e,t)=>{const r=e.__vccOpts||e;for(const[n,a]of t)r[n]=a;return r},RO={name:"Header",setup(){return{}}},AO={class:"container-fluid"},OO={class:"d-flex flex-wrap justify-content-center py-3 mb-4 border-bottom"},PO=he("img",{class:"me-4",width:"107",height:"32",src:"https://www.twilio.com/docs/static/dist/img/559bc7cf.svg"},null,-1),MO=he("span",{class:"fs-4",style:{color:"#f22f46"}},"Conversations (End User)",-1),xO={class:"nav nav-pills"},NO={class:"nav-item"},LO=he("i",{class:"bi-house"},null,-1),jO=Jt(" Home");function UO(e,t,r,n,a,i){const s=oi("router-link");return _t(),Ut("div",AO,[he("header",OO,[Ht(s,{class:"d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none",to:"/"},{default:si(()=>[PO,MO]),_:1}),he("ul",xO,[he("li",NO,[Ht(s,{class:"btn btn-info btn-sm",to:"/"},{default:si(()=>[LO,jO]),_:1})])])])])}const FO=go(RO,[["render",UO]]),DO={name:"Footer"},BO={class:"footer mt-auto py-3 bg-light pb-5"},qO=he("div",{class:"container text-center pb-5"},[he("img",{class:"",width:"107",height:"32",src:"https://www.twilio.com/docs/static/dist/img/559bc7cf.svg"})],-1),HO=[qO];function WO(e,t,r,n,a,i){return _t(),Ut("footer",BO,HO)}const GO=go(DO,[["render",WO]]),zO={name:"Layout",components:{Header:FO,Footer:GO}};function VO(e,t,r,n,a,i){const s=oi("Header"),u=oi("Footer");return _t(),Ut("div",null,[Ht(s),fR(e.$slots,"default"),Ht(u)])}const V$=go(zO,[["render",VO]]);var Em;const Bu=typeof window<"u",KO=e=>typeof e=="function",YO=e=>typeof e=="string",id=()=>{};Bu&&((Em=window==null?void 0:window.navigator)==null?void 0:Em.userAgent)&&/iP(ad|hone|od)/.test(window.navigator.userAgent);function K$(e){return typeof e=="function"?e():er(e)}function JO(e,t){function r(...n){e(()=>t.apply(this,n),{fn:t,thisArg:this,args:n})}return r}const Y$=e=>e();function QO(e=Y$){const t=bt(!0);function r(){t.value=!1}function n(){t.value=!0}return{isActive:t,pause:r,resume:n,eventFilter:(...i)=>{t.value&&e(...i)}}}function XO(e){return e}function ZO(e){return nC()?(aC(e),!0):!1}var Im=Object.getOwnPropertySymbols,eP=Object.prototype.hasOwnProperty,tP=Object.prototype.propertyIsEnumerable,rP=(e,t)=>{var r={};for(var n in e)eP.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Im)for(var n of Im(e))t.indexOf(n)<0&&tP.call(e,n)&&(r[n]=e[n]);return r};function nP(e,t,r={}){const n=r,{eventFilter:a=Y$}=n,i=rP(n,["eventFilter"]);return zi(e,JO(a,t),i)}var aP=Object.defineProperty,iP=Object.defineProperties,sP=Object.getOwnPropertyDescriptors,Sc=Object.getOwnPropertySymbols,J$=Object.prototype.hasOwnProperty,Q$=Object.prototype.propertyIsEnumerable,Cm=(e,t,r)=>t in e?aP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,oP=(e,t)=>{for(var r in t||(t={}))J$.call(t,r)&&Cm(e,r,t[r]);if(Sc)for(var r of Sc(t))Q$.call(t,r)&&Cm(e,r,t[r]);return e},uP=(e,t)=>iP(e,sP(t)),lP=(e,t)=>{var r={};for(var n in e)J$.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&Sc)for(var n of Sc(e))t.indexOf(n)<0&&Q$.call(e,n)&&(r[n]=e[n]);return r};function cP(e,t,r={}){const n=r,{eventFilter:a}=n,i=lP(n,["eventFilter"]),{eventFilter:s,pause:u,resume:o,isActive:l}=QO(a);return{stop:nP(e,t,uP(oP({},i),{eventFilter:s})),pause:u,resume:o,isActive:l}}function fP(e){var t;const r=K$(e);return(t=r==null?void 0:r.$el)!=null?t:r}const cv=Bu?window:void 0;Bu&&window.document;Bu&&window.navigator;Bu&&window.location;function dP(...e){let t,r,n,a;if(YO(e[0])?([r,n,a]=e,t=cv):[t,r,n,a]=e,!t)return id;let i=id;const s=zi(()=>fP(t),o=>{i(),o&&(o.addEventListener(r,n,a),i=()=>{o.removeEventListener(r,n,a),i=id})},{immediate:!0,flush:"post"}),u=()=>{s(),i()};return ZO(u),u}const fv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},dv="__vueuse_ssr_handlers__";fv[dv]=fv[dv]||{};const pP=fv[dv];function vP(e,t){return pP[e]||t}function hP(e){return e==null?"any":e instanceof Set?"set":e instanceof Map?"map":e instanceof Date?"date":typeof e=="boolean"?"boolean":typeof e=="string"?"string":typeof e=="object"||Array.isArray(e)?"object":Number.isNaN(e)?"any":"number"}var yP=Object.defineProperty,Rm=Object.getOwnPropertySymbols,gP=Object.prototype.hasOwnProperty,mP=Object.prototype.propertyIsEnumerable,Am=(e,t,r)=>t in e?yP(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Om=(e,t)=>{for(var r in t||(t={}))gP.call(t,r)&&Am(e,r,t[r]);if(Rm)for(var r of Rm(t))mP.call(t,r)&&Am(e,r,t[r]);return e};const bP={boolean:{read:e=>e==="true",write:e=>String(e)},object:{read:e=>JSON.parse(e),write:e=>JSON.stringify(e)},number:{read:e=>Number.parseFloat(e),write:e=>String(e)},any:{read:e=>e,write:e=>String(e)},string:{read:e=>e,write:e=>String(e)},map:{read:e=>new Map(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e.entries()))},set:{read:e=>new Set(JSON.parse(e)),write:e=>JSON.stringify(Array.from(e))},date:{read:e=>new Date(e),write:e=>e.toISOString()}};function wP(e,t,r,n={}){var a;const{flush:i="pre",deep:s=!0,listenToStorageChanges:u=!0,writeDefaults:o=!0,mergeDefaults:l=!1,shallow:c,window:h=cv,eventFilter:w,onError:b=le=>{console.error(le)}}=n,$=(c?J0:bt)(t);if(!r)try{r=vP("getDefaultStorage",()=>{var le;return(le=cv)==null?void 0:le.localStorage})()}catch(le){b(le)}if(!r)return $;const C=K$(t),I=hP(C),j=(a=n.serializer)!=null?a:bP[I],{pause:D,resume:ve}=cP($,()=>se($.value),{flush:i,deep:s,eventFilter:w});return h&&u&&dP(h,"storage",Me),Me(),$;function se(le){try{le==null?r.removeItem(e):r.setItem(e,j.write(le))}catch(x){b(x)}}function Pe(le){if(!(le&&le.key!==e)){D();try{const x=le?le.newValue:r.getItem(e);if(x==null)return o&&C!==null&&r.setItem(e,j.write(C)),C;if(!le&&l){const re=j.read(x);return KO(l)?l(re,C):I==="object"&&!Array.isArray(re)?Om(Om({},C),re):re}else return typeof x!="string"?x:j.read(x)}catch(x){b(x)}finally{ve()}}}function Me(le){le&&le.key!==e||($.value=Pe(le))}}var Pm;(function(e){e.UP="UP",e.RIGHT="RIGHT",e.DOWN="DOWN",e.LEFT="LEFT",e.NONE="NONE"})(Pm||(Pm={}));var _P=Object.defineProperty,Mm=Object.getOwnPropertySymbols,SP=Object.prototype.hasOwnProperty,$P=Object.prototype.propertyIsEnumerable,xm=(e,t,r)=>t in e?_P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,TP=(e,t)=>{for(var r in t||(t={}))SP.call(t,r)&&xm(e,r,t[r]);if(Mm)for(var r of Mm(t))$P.call(t,r)&&xm(e,r,t[r]);return e};const kP={easeInSine:[.12,0,.39,0],easeOutSine:[.61,1,.88,1],easeInOutSine:[.37,0,.63,1],easeInQuad:[.11,0,.5,0],easeOutQuad:[.5,1,.89,1],easeInOutQuad:[.45,0,.55,1],easeInCubic:[.32,0,.67,0],easeOutCubic:[.33,1,.68,1],easeInOutCubic:[.65,0,.35,1],easeInQuart:[.5,0,.75,0],easeOutQuart:[.25,1,.5,1],easeInOutQuart:[.76,0,.24,1],easeInQuint:[.64,0,.78,0],easeOutQuint:[.22,1,.36,1],easeInOutQuint:[.83,0,.17,1],easeInExpo:[.7,0,.84,0],easeOutExpo:[.16,1,.3,1],easeInOutExpo:[.87,0,.13,1],easeInCirc:[.55,0,1,.45],easeOutCirc:[0,.55,.45,1],easeInOutCirc:[.85,0,.15,1],easeInBack:[.36,0,.66,-.56],easeOutBack:[.34,1.56,.64,1],easeInOutBack:[.68,-.6,.32,1.6]};TP({linear:XO},kP);const X$=TA("end-user",{state:()=>({endUser:wP("endUser",{name:"",accessToken:"",activeConversation:"none"},localStorage,{mergeDefaults:!0})}),getters:{},actions:{async getToken(){try{let e=`/auth/token?identity=${this.endUser.name}`;const t=await fetch(e,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(t.ok){let r=await t.json();this.endUser.accessToken=r.accessToken,console.log("token value set...")}}catch(e){console.log("getToken error => ",e)}},logout(){this.endUser.name="",this.endUser.accessToken="",this.endUser.activeConversation="none"}}});function EP(e,t,r){let n={displayName:r,sms:!1,chat:!1,whatsapp:!1,enduser:!1,agent:!1};switch(e){case"sms":n.sms=!0;break;case"chat":n.chat=!0;break;case"whatsapp":n.whatsapp=!0;break}switch(t){case"enduser":n.enduser=!0;break;case"agent":n.agent=!0;break}return JSON.stringify(n)}const IP={class:"container-fluid"},CP={class:"row pb-5 mb-5"},RP={class:"col"},AP=he("h2",{class:"mb-5"},"Twilio Conversations Web Chat Demo!",-1),OP=he("p",{class:"lead fs-4 mb-5"}," With this demo, you can experience a custom web chat client powered by Twilio Conversations. ",-1),PP={class:"lead fs-4 mb-5"},MP=Jt(" Initiate a conversation from a web chat client. Click the "),xP=he("b",null,[he("i",null,"Start New Chat Conversation")],-1),NP=Jt(" button below. "),LP=[MP,xP,NP],jP={class:"lead fs-4 mb-5"},UP=Jt(" You have an active conversation. Click the "),FP=he("b",null,[he("i",null,"Start Chatting")],-1),DP=Jt(" button below. "),BP=[UP,FP,DP],qP={class:"mb-5 text-center"},HP=["onClick"],WP=he("i",{class:"bi-chat-left-dots-fill"},null,-1),GP=Jt(" Start Chatting "),zP=[WP,GP],VP={class:"mb-5 text-center"},KP=he("i",{class:"bi-chat-left-dots-fill"},null,-1),YP=Jt(" Start New Chat Conversation "),JP=[KP,YP],QP={class:"mb-3"},XP=he("label",{for:"exampleFormControlInput1",class:"form-label"},"Enter Your Name",-1),ZP={class:"d-grid"},eM=he("i",{class:"bi-lightning"},null,-1),tM=Jt(" Initiate Chat Session "),rM=[eM,tM],nM={class:"card text-dark bg-info mb-5"},aM=he("div",{class:"card-header fs-4"},[he("b",null,"Access Token")],-1),iM={class:"card-body"},sM=he("p",{class:"card-text fs-5"}," In order order to enter a conversation, you need a valid access token. ",-1),oM={class:"card-text fs-5"},uM=he("i",{class:"bi-recycle"},null,-1),lM=Jt(" Refresh Token "),cM=[uM,lM],fM={class:"spinner-border",role:"status"},dM=he("span",{class:"visually-hidden"},"Loading...",-1),pM=[dM],vM={disabled:"",class:"btn btn-success"},hM=he("i",{class:"bi-check"},null,-1),yM=Jt(" Token Refreshed "),gM=[hM,yM],mM=he("i",{class:"bi-eye"},null,-1),bM=Jt(" View Token "),wM=[mM,bM],_M={class:"text-break"},SM=he("i",{class:"bi-box-arrow-left"},null,-1),$M=Jt(" Logout "),TM=[SM,$M],kM=he("div",{class:"col"},[he("div",{class:"text-center"},[he("img",{class:"img-fluid",style:{"max-width":"450px"},src:"https://twilio-cms-prod.s3.amazonaws.com/images/diagram-conversat.width-1200.format-webp.webpquality-75.webp"})])],-1),EM={__name:"Home",setup(e){const t=X$(),r=bt(""),n=bt(!1),a=bt(!1),i=bt("notset"),s=bt(!1),u=bt(!1),o=bt(!1),l=rr(()=>t.endUser!=null&&t.endUser.activeConversation!==""&&t.endUser.activeConversation!=="none"),c=async()=>{u.value=!0,await t.getToken(),u.value=!1,o.value=!0},h=async()=>{try{const C=await fetch("/conversations/conversation-create",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationName:"InboundChat: "+r.value}})});if(C.ok){console.log("Success! Created a new conversation...");let I=await C.json();t.endUser.name="EndUser:"+r.value,i.value=I.sid,n.value=!1,await t.getToken(),await w(),a.value=!0,t.endUser.activeConversation=I.sid}else console.log("Error! Unable to create new conversation...")}catch($){console.log("createNewConversation error => ",$)}},w=async()=>{try{let $=EP("chat","enduser",r.value);(await fetch("/conversations/conversation-add-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:i.value,identity:"EndUser:"+r.value,attributes:$}})})).ok?console.log("Success! Added End User to conversation..."):console.log("Error! Unable to add End User to conversation...")}catch($){console.log("addEndUserToConversation error => ",$)}};function b(){t.logout(),s.value=!1,u.value=!1,o.value=!1}return($,C)=>(_t(),Ut("div",IP,[he("div",CP,[he("div",RP,[AP,OP,Mt(he("p",PP,LP,512),[[Ft,!er(l)]]),Mt(he("p",jP,BP,512),[[Ft,er(l)]]),Mt(he("div",qP,[Ht(er(G$),{to:{name:"conversation",params:{sid:er(t).endUser.activeConversation}},custom:""},{default:si(({navigate:I})=>[he("button",{class:"btn btn-lg btn-primary",onClick:I},zP,8,HP)]),_:1},8,["to"])],512),[[Ft,er(l)]]),Mt(he("div",VP,[Mt(he("button",{class:"btn btn-lg btn-success",onClick:C[0]||(C[0]=I=>n.value=!0)},JP,512),[[Ft,!n.value]]),Mt(he("div",null,[he("div",QP,[XP,Mt(he("input",{type:"text","onUpdate:modelValue":C[1]||(C[1]=I=>r.value=I),class:"form-control",id:"exampleFormControlInput1",placeholder:""},null,512),[[A$,r.value]])]),he("div",ZP,[he("button",{onClick:C[2]||(C[2]=I=>h()),class:"btn btn-success btn-lg"},rM)])],512),[[Ft,n.value]])],512),[[Ft,!er(l)]]),he("div",nM,[aM,he("div",iM,[sM,Mt(he("p",oM," Start a new conversation by clicking the button above. ",512),[[Ft,!er(l)]]),he("p",null,[Mt(he("button",{onClick:C[3]||(C[3]=I=>c()),class:"btn btn-secondary"},[Mt(he("span",null,cM,512),[[Ft,!u.value]]),Mt(he("div",fM,pM,512),[[Ft,u.value]])],512),[[Ft,er(t).endUser.accessToken!=""&&!o.value]]),Mt(he("button",vM,gM,512),[[Ft,o.value]]),Mt(he("button",{onClick:C[4]||(C[4]=I=>s.value=!s.value),class:"btn btn-light ms-2"},wM,512),[[Ft,er(t).endUser.accessToken!=""]])]),Mt(he("p",_M,[he("i",null,Ar(er(t).endUser.accessToken),1)],512),[[Ft,s.value]]),he("p",null,[Mt(he("button",{onClick:C[5]||(C[5]=I=>b()),class:"btn btn-danger float-end"},TM,512),[[Ft,er(l)]])])])])]),kM])]))}},IM={name:"App",components:{Layout:V$,Home:EM}};function CM(e,t,r,n,a,i){const s=oi("Home"),u=oi("Layout");return _t(),yo(u,null,{default:si(()=>[Ht(s)]),_:1})}const RM=go(IM,[["render",CM]]);var Rn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function AM(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var Z$={},Tl=function(e){return e&&e.Math==Math&&e},lt=Tl(typeof globalThis=="object"&&globalThis)||Tl(typeof window=="object"&&window)||Tl(typeof self=="object"&&self)||Tl(typeof Rn=="object"&&Rn)||function(){return this}()||Function("return this")(),Qn={},nt=function(e){try{return!!e()}catch{return!0}},OM=nt,Dt=!OM(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),PM=nt,qu=!PM(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),MM=qu,kl=Function.prototype.call,Ct=MM?kl.bind(kl):function(){return kl.apply(kl,arguments)},Hu={},e1={}.propertyIsEnumerable,t1=Object.getOwnPropertyDescriptor,xM=t1&&!e1.call({1:2},1);Hu.f=xM?function(t){var r=t1(this,t);return!!r&&r.enumerable}:e1;var rs=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},r1=qu,n1=Function.prototype,NM=n1.bind,pv=n1.call,LM=r1&&NM.bind(pv,pv),et=r1?function(e){return e&&LM(e)}:function(e){return e&&function(){return pv.apply(e,arguments)}},a1=et,jM=a1({}.toString),UM=a1("".slice),fi=function(e){return UM(jM(e),8,-1)},FM=et,DM=nt,BM=fi,sd=Object,qM=FM("".split),Wu=DM(function(){return!sd("z").propertyIsEnumerable(0)})?function(e){return BM(e)=="String"?qM(e,""):sd(e)}:sd,Xn=function(e){return e==null},HM=Xn,WM=TypeError,Zn=function(e){if(HM(e))throw WM("Can't call method on "+e);return e},GM=Wu,zM=Zn,Jr=function(e){return GM(zM(e))},vv=typeof document=="object"&&document.all,VM=typeof vv>"u"&&vv!==void 0,i1={all:vv,IS_HTMLDDA:VM},s1=i1,KM=s1.all,Rt=s1.IS_HTMLDDA?function(e){return typeof e=="function"||e===KM}:function(e){return typeof e=="function"},Nm=Rt,o1=i1,YM=o1.all,Wt=o1.IS_HTMLDDA?function(e){return typeof e=="object"?e!==null:Nm(e)||e===YM}:function(e){return typeof e=="object"?e!==null:Nm(e)},od=lt,JM=Rt,QM=function(e){return JM(e)?e:void 0},hn=function(e,t){return arguments.length<2?QM(od[e]):od[e]&&od[e][t]},XM=et,ka=XM({}.isPrototypeOf),ZM=hn,ns=ZM("navigator","userAgent")||"",u1=lt,ud=ns,Lm=u1.process,jm=u1.Deno,Um=Lm&&Lm.versions||jm&&jm.version,Fm=Um&&Um.v8,kn,$c;Fm&&(kn=Fm.split("."),$c=kn[0]>0&&kn[0]<4?1:+(kn[0]+kn[1]));!$c&&ud&&(kn=ud.match(/Edge\/(\d+)/),(!kn||kn[1]>=74)&&(kn=ud.match(/Chrome\/(\d+)/),kn&&($c=+kn[1])));var as=$c,Dm=as,e2=nt,mo=!!Object.getOwnPropertySymbols&&!e2(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&Dm&&Dm<41}),t2=mo,l1=t2&&!Symbol.sham&&typeof Symbol.iterator=="symbol",r2=hn,n2=Rt,a2=ka,i2=l1,s2=Object,bo=i2?function(e){return typeof e=="symbol"}:function(e){var t=r2("Symbol");return n2(t)&&a2(t.prototype,s2(e))},o2=String,is=function(e){try{return o2(e)}catch{return"Object"}},u2=Rt,l2=is,c2=TypeError,xn=function(e){if(u2(e))return e;throw c2(l2(e)+" is not a function")},f2=xn,d2=Xn,ss=function(e,t){var r=e[t];return d2(r)?void 0:f2(r)},ld=Ct,cd=Rt,fd=Wt,p2=TypeError,v2=function(e,t){var r,n;if(t==="string"&&cd(r=e.toString)&&!fd(n=ld(r,e))||cd(r=e.valueOf)&&!fd(n=ld(r,e))||t!=="string"&&cd(r=e.toString)&&!fd(n=ld(r,e)))return n;throw p2("Can't convert object to primitive value")},os={exports:{}},h2=!1,Bm=lt,y2=Object.defineProperty,Gh=function(e,t){try{y2(Bm,e,{value:t,configurable:!0,writable:!0})}catch{Bm[e]=t}return t},g2=lt,m2=Gh,qm="__core-js_shared__",b2=g2[qm]||m2(qm,{}),zh=b2,Hm=zh;(os.exports=function(e,t){return Hm[e]||(Hm[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.25.2",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.2/LICENSE",source:"https://github.com/zloirock/core-js"});var w2=Zn,_2=Object,_r=function(e){return _2(w2(e))},S2=et,$2=_r,T2=S2({}.hasOwnProperty),Gt=Object.hasOwn||function(t,r){return T2($2(t),r)},k2=et,E2=0,I2=Math.random(),C2=k2(1 .toString),Gu=function(e){return"Symbol("+(e===void 0?"":e)+")_"+C2(++E2+I2,36)},R2=lt,A2=os.exports,Wm=Gt,O2=Gu,Gm=mo,c1=l1,$s=A2("wks"),Ki=R2.Symbol,zm=Ki&&Ki.for,P2=c1?Ki:Ki&&Ki.withoutSetter||O2,At=function(e){if(!Wm($s,e)||!(Gm||typeof $s[e]=="string")){var t="Symbol."+e;Gm&&Wm(Ki,e)?$s[e]=Ki[e]:c1&&zm?$s[e]=zm(t):$s[e]=P2(t)}return $s[e]},M2=Ct,Vm=Wt,Km=bo,x2=ss,N2=v2,L2=At,j2=TypeError,U2=L2("toPrimitive"),Vh=function(e,t){if(!Vm(e)||Km(e))return e;var r=x2(e,U2),n;if(r){if(t===void 0&&(t="default"),n=M2(r,e,t),!Vm(n)||Km(n))return n;throw j2("Can't convert object to primitive value")}return t===void 0&&(t="number"),N2(e,t)},F2=Vh,D2=bo,zu=function(e){var t=F2(e,"string");return D2(t)?t:t+""},B2=lt,Ym=Wt,hv=B2.document,q2=Ym(hv)&&Ym(hv.createElement),of=function(e){return q2?hv.createElement(e):{}},H2=Dt,W2=nt,G2=of,f1=!H2&&!W2(function(){return Object.defineProperty(G2("div"),"a",{get:function(){return 7}}).a!=7}),z2=Dt,V2=Ct,K2=Hu,Y2=rs,J2=Jr,Q2=zu,X2=Gt,Z2=f1,Jm=Object.getOwnPropertyDescriptor;Qn.f=z2?Jm:function(t,r){if(t=J2(t),r=Q2(r),Z2)try{return Jm(t,r)}catch{}if(X2(t,r))return Y2(!V2(K2.f,t,r),t[r])};var Qt={},ex=Dt,tx=nt,d1=ex&&tx(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),rx=Wt,nx=String,ax=TypeError,Vt=function(e){if(rx(e))return e;throw ax(nx(e)+" is not an object")},ix=Dt,sx=f1,ox=d1,El=Vt,Qm=zu,ux=TypeError,dd=Object.defineProperty,lx=Object.getOwnPropertyDescriptor,pd="enumerable",vd="configurable",hd="writable";Qt.f=ix?ox?function(t,r,n){if(El(t),r=Qm(r),El(n),typeof t=="function"&&r==="prototype"&&"value"in n&&hd in n&&!n[hd]){var a=lx(t,r);a&&a[hd]&&(t[r]=n.value,n={configurable:vd in n?n[vd]:a[vd],enumerable:pd in n?n[pd]:a[pd],writable:!1})}return dd(t,r,n)}:dd:function(t,r,n){if(El(t),r=Qm(r),El(n),sx)try{return dd(t,r,n)}catch{}if("get"in n||"set"in n)throw ux("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var cx=Dt,fx=Qt,dx=rs,Ea=cx?function(e,t,r){return fx.f(e,t,dx(1,r))}:function(e,t,r){return e[t]=r,e},Kh={exports:{}},yv=Dt,px=Gt,p1=Function.prototype,vx=yv&&Object.getOwnPropertyDescriptor,Yh=px(p1,"name"),hx=Yh&&function(){}.name==="something",yx=Yh&&(!yv||yv&&vx(p1,"name").configurable),Vu={EXISTS:Yh,PROPER:hx,CONFIGURABLE:yx},gx=et,mx=Rt,gv=zh,bx=gx(Function.toString);mx(gv.inspectSource)||(gv.inspectSource=function(e){return bx(e)});var Jh=gv.inspectSource,wx=lt,_x=Rt,Xm=wx.WeakMap,Sx=_x(Xm)&&/native code/.test(String(Xm)),$x=os.exports,Tx=Gu,Zm=$x("keys"),uf=function(e){return Zm[e]||(Zm[e]=Tx(e))},Ku={},kx=Sx,v1=lt,yd=et,Ex=Wt,Ix=Ea,gd=Gt,md=zh,Cx=uf,Rx=Ku,eb="Object already initialized",mv=v1.TypeError,Ax=v1.WeakMap,Tc,Au,kc,Ox=function(e){return kc(e)?Au(e):Tc(e,{})},Px=function(e){return function(t){var r;if(!Ex(t)||(r=Au(t)).type!==e)throw mv("Incompatible receiver, "+e+" required");return r}};if(kx||md.state){var Ri=md.state||(md.state=new Ax),Mx=yd(Ri.get),tb=yd(Ri.has),xx=yd(Ri.set);Tc=function(e,t){if(tb(Ri,e))throw mv(eb);return t.facade=e,xx(Ri,e,t),t},Au=function(e){return Mx(Ri,e)||{}},kc=function(e){return tb(Ri,e)}}else{var Ts=Cx("state");Rx[Ts]=!0,Tc=function(e,t){if(gd(e,Ts))throw mv(eb);return t.facade=e,Ix(e,Ts,t),t},Au=function(e){return gd(e,Ts)?e[Ts]:{}},kc=function(e){return gd(e,Ts)}}var yn={set:Tc,get:Au,has:kc,enforce:Ox,getterFor:Px},Nx=nt,Lx=Rt,Il=Gt,bv=Dt,jx=Vu.CONFIGURABLE,Ux=Jh,h1=yn,Fx=h1.enforce,Dx=h1.get,oc=Object.defineProperty,Bx=bv&&!Nx(function(){return oc(function(){},"length",{value:8}).length!==8}),qx=String(String).split("String"),Hx=Kh.exports=function(e,t,r){String(t).slice(0,7)==="Symbol("&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!Il(e,"name")||jx&&e.name!==t)&&(bv?oc(e,"name",{value:t,configurable:!0}):e.name=t),Bx&&r&&Il(r,"arity")&&e.length!==r.arity&&oc(e,"length",{value:r.arity});try{r&&Il(r,"constructor")&&r.constructor?bv&&oc(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=Fx(e);return Il(n,"source")||(n.source=qx.join(typeof t=="string"?t:"")),e};Function.prototype.toString=Hx(function(){return Lx(this)&&Dx(this).source||Ux(this)},"toString");var Wx=Rt,Gx=Qt,zx=Kh.exports,Vx=Gh,Sr=function(e,t,r,n){n||(n={});var a=n.enumerable,i=n.name!==void 0?n.name:t;if(Wx(r)&&zx(r,i,n),n.global)a?e[t]=r:Vx(t,r);else{try{n.unsafe?e[t]&&(a=!0):delete e[t]}catch{}a?e[t]=r:Gx.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},di={},Kx=Math.ceil,Yx=Math.floor,Jx=Math.trunc||function(t){var r=+t;return(r>0?Yx:Kx)(r)},Qx=Jx,ea=function(e){var t=+e;return t!==t||t===0?0:Qx(t)},Xx=ea,Zx=Math.max,eN=Math.min,us=function(e,t){var r=Xx(e);return r<0?Zx(r+t,0):eN(r,t)},tN=ea,rN=Math.min,Ia=function(e){return e>0?rN(tN(e),9007199254740991):0},nN=Ia,cr=function(e){return nN(e.length)},aN=Jr,iN=us,sN=cr,rb=function(e){return function(t,r,n){var a=aN(t),i=sN(a),s=iN(n,i),u;if(e&&r!=r){for(;i>s;)if(u=a[s++],u!=u)return!0}else for(;i>s;s++)if((e||s in a)&&a[s]===r)return e||s||0;return!e&&-1}},lf={includes:rb(!0),indexOf:rb(!1)},oN=et,bd=Gt,uN=Jr,lN=lf.indexOf,cN=Ku,nb=oN([].push),y1=function(e,t){var r=uN(e),n=0,a=[],i;for(i in r)!bd(cN,i)&&bd(r,i)&&nb(a,i);for(;t.length>n;)bd(r,i=t[n++])&&(~lN(a,i)||nb(a,i));return a},Qh=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],fN=y1,dN=Qh,pN=dN.concat("length","prototype");di.f=Object.getOwnPropertyNames||function(t){return fN(t,pN)};var Yu={};Yu.f=Object.getOwnPropertySymbols;var vN=hn,hN=et,yN=di,gN=Yu,mN=Vt,bN=hN([].concat),g1=vN("Reflect","ownKeys")||function(t){var r=yN.f(mN(t)),n=gN.f;return n?bN(r,n(t)):r},ab=Gt,wN=g1,_N=Qn,SN=Qt,m1=function(e,t,r){for(var n=wN(t),a=SN.f,i=_N.f,s=0;s<n.length;s++){var u=n[s];!ab(e,u)&&!(r&&ab(r,u))&&a(e,u,i(t,u))}},$N=nt,TN=Rt,kN=/#|\.prototype\./,Ju=function(e,t){var r=IN[EN(e)];return r==RN?!0:r==CN?!1:TN(t)?$N(t):!!t},EN=Ju.normalize=function(e){return String(e).replace(kN,".").toLowerCase()},IN=Ju.data={},CN=Ju.NATIVE="N",RN=Ju.POLYFILL="P",cf=Ju,wd=lt,AN=Qn.f,ON=Ea,PN=Sr,MN=Gh,xN=m1,NN=cf,st=function(e,t){var r=e.target,n=e.global,a=e.stat,i,s,u,o,l,c;if(n?s=wd:a?s=wd[r]||MN(r,{}):s=(wd[r]||{}).prototype,s)for(u in t){if(l=t[u],e.dontCallGetSet?(c=AN(s,u),o=c&&c.value):o=s[u],i=NN(n?u:r+(a?".":"#")+u,e.forced),!i&&o!==void 0){if(typeof l==typeof o)continue;xN(l,o)}(e.sham||o&&o.sham)&&ON(l,"sham",!0),PN(s,u,l,e)}},LN=Qt.f,jN=Gt,UN=At,ib=UN("toStringTag"),Ca=function(e,t,r){e&&!r&&(e=e.prototype),e&&!jN(e,ib)&&LN(e,ib,{configurable:!0,value:t})},FN=st,DN=lt,BN=Ca;FN({global:!0},{Reflect:{}});BN(DN.Reflect,"Reflect",!0);var qN=qu,b1=Function.prototype,sb=b1.apply,ob=b1.call,pi=typeof Reflect=="object"&&Reflect.apply||(qN?ob.bind(sb):function(){return ob.apply(sb,arguments)}),HN=et,wo=HN([].slice),w1=et,WN=xn,GN=Wt,zN=Gt,ub=wo,VN=qu,_1=Function,KN=w1([].concat),YN=w1([].join),_d={},JN=function(e,t,r){if(!zN(_d,t)){for(var n=[],a=0;a<t;a++)n[a]="a["+a+"]";_d[t]=_1("C,a","return new C("+YN(n,",")+")")}return _d[t](e,r)},QN=VN?_1.bind:function(t){var r=WN(this),n=r.prototype,a=ub(arguments,1),i=function(){var u=KN(a,ub(arguments));return this instanceof i?JN(r,u.length,u):r.apply(t,u)};return GN(n)&&(i.prototype=n),i},XN=At,ZN=XN("toStringTag"),S1={};S1[ZN]="z";var Xh=String(S1)==="[object z]",eL=Xh,tL=Rt,uc=fi,rL=At,nL=rL("toStringTag"),aL=Object,iL=uc(function(){return arguments}())=="Arguments",sL=function(e,t){try{return e[t]}catch{}},Ra=eL?uc:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=sL(t=aL(e),nL))=="string"?r:iL?uc(t):(n=uc(t))=="Object"&&tL(t.callee)?"Arguments":n},oL=et,uL=nt,$1=Rt,lL=Ra,cL=hn,fL=Jh,T1=function(){},dL=[],k1=cL("Reflect","construct"),Zh=/^\s*(?:class|function)\b/,pL=oL(Zh.exec),vL=!Zh.exec(T1),Go=function(t){if(!$1(t))return!1;try{return k1(T1,dL,t),!0}catch{return!1}},E1=function(t){if(!$1(t))return!1;switch(lL(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return vL||!!pL(Zh,fL(t))}catch{return!0}};E1.sham=!0;var ff=!k1||uL(function(){var e;return Go(Go.call)||!Go(Object)||!Go(function(){e=!0})||e})?E1:Go,hL=ff,yL=is,gL=TypeError,ey=function(e){if(hL(e))return e;throw gL(yL(e)+" is not a constructor")},ty={},mL=y1,bL=Qh,Qu=Object.keys||function(t){return mL(t,bL)},wL=Dt,_L=d1,SL=Qt,$L=Vt,TL=Jr,kL=Qu;ty.f=wL&&!_L?Object.defineProperties:function(t,r){$L(t);for(var n=TL(r),a=kL(r),i=a.length,s=0,u;i>s;)SL.f(t,u=a[s++],n[u]);return t};var EL=hn,I1=EL("document","documentElement"),IL=Vt,CL=ty,lb=Qh,RL=Ku,AL=I1,OL=of,PL=uf,cb=">",fb="<",wv="prototype",_v="script",C1=PL("IE_PROTO"),Sd=function(){},R1=function(e){return fb+_v+cb+e+fb+"/"+_v+cb},db=function(e){e.write(R1("")),e.close();var t=e.parentWindow.Object;return e=null,t},ML=function(){var e=OL("iframe"),t="java"+_v+":",r;return e.style.display="none",AL.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(R1("document.F=Object")),r.close(),r.F},Cl,lc=function(){try{Cl=new ActiveXObject("htmlfile")}catch{}lc=typeof document<"u"?document.domain&&Cl?db(Cl):ML():db(Cl);for(var e=lb.length;e--;)delete lc[wv][lb[e]];return lc()};RL[C1]=!0;var vi=Object.create||function(t,r){var n;return t!==null?(Sd[wv]=IL(t),n=new Sd,Sd[wv]=null,n[C1]=t):n=lc(),r===void 0?n:CL.f(n,r)},xL=st,NL=hn,$d=pi,LL=QN,pb=ey,jL=Vt,vb=Wt,UL=vi,A1=nt,ry=NL("Reflect","construct"),FL=Object.prototype,DL=[].push,O1=A1(function(){function e(){}return!(ry(function(){},[],e)instanceof e)}),P1=!A1(function(){ry(function(){})}),hb=O1||P1;xL({target:"Reflect",stat:!0,forced:hb,sham:hb},{construct:function(t,r){pb(t),jL(r);var n=arguments.length<3?t:pb(arguments[2]);if(P1&&!O1)return ry(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var a=[null];return $d(DL,a,r),new($d(LL,t,a))}var i=n.prototype,s=UL(vb(i)?i:FL),u=$d(t,s,r);return vb(u)?u:s}});var BL=st,qL=_r,M1=Qu,HL=nt,WL=HL(function(){M1(1)});BL({target:"Object",stat:!0,forced:WL},{keys:function(t){return M1(qL(t))}});var GL=Ra,zL=String,or=function(e){if(GL(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return zL(e)},ny={},VL=zu,KL=Qt,YL=rs,_o=function(e,t,r){var n=VL(t);n in e?KL.f(e,n,YL(0,r)):e[n]=r},yb=us,JL=cr,QL=_o,XL=Array,ZL=Math.max,Xu=function(e,t,r){for(var n=JL(e),a=yb(t,n),i=yb(r===void 0?n:r,n),s=XL(ZL(i-a,0)),u=0;a<i;a++,u++)QL(s,u,e[a]);return s.length=u,s},ej=fi,tj=Jr,x1=di.f,rj=Xu,N1=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],nj=function(e){try{return x1(e)}catch{return rj(N1)}};ny.f=function(t){return N1&&ej(t)=="Window"?nj(t):x1(tj(t))};var ay={},aj=At;ay.f=aj;var ij=lt,sj=ij,gb=sj,oj=Gt,uj=ay,lj=Qt.f,L1=function(e){var t=gb.Symbol||(gb.Symbol={});oj(t,e)||lj(t,e,{value:uj.f(e)})},cj=Ct,fj=hn,dj=At,pj=Sr,vj=function(){var e=fj("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=dj("toPrimitive");t&&!t[n]&&pj(t,n,function(a){return cj(r,this)},{arity:1})},mb=et,hj=xn,yj=qu,gj=mb(mb.bind),Aa=function(e,t){return hj(e),t===void 0?e:yj?gj(e,t):function(){return e.apply(t,arguments)}},mj=fi,Zu=Array.isArray||function(t){return mj(t)=="Array"},bb=Zu,bj=ff,wj=Wt,_j=At,Sj=_j("species"),wb=Array,$j=function(e){var t;return bb(e)&&(t=e.constructor,bj(t)&&(t===wb||bb(t.prototype))?t=void 0:wj(t)&&(t=t[Sj],t===null&&(t=void 0))),t===void 0?wb:t},Tj=$j,iy=function(e,t){return new(Tj(e))(t===0?0:t)},kj=Aa,Ej=et,Ij=Wu,Cj=_r,Rj=cr,Aj=iy,_b=Ej([].push),Ba=function(e){var t=e==1,r=e==2,n=e==3,a=e==4,i=e==6,s=e==7,u=e==5||i;return function(o,l,c,h){for(var w=Cj(o),b=Ij(w),$=kj(l,c),C=Rj(b),I=0,j=h||Aj,D=t?j(o,C):r||s?j(o,0):void 0,ve,se;C>I;I++)if((u||I in b)&&(ve=b[I],se=$(ve,I,w),e))if(t)D[I]=se;else if(se)switch(e){case 3:return!0;case 5:return ve;case 6:return I;case 2:_b(D,ve)}else switch(e){case 4:return!1;case 7:_b(D,ve)}return i?-1:n||a?a:D}},Qr={forEach:Ba(0),map:Ba(1),filter:Ba(2),some:Ba(3),every:Ba(4),find:Ba(5),findIndex:Ba(6),filterReject:Ba(7)},df=st,sy=lt,oy=Ct,Oj=et,so=Dt,oo=mo,Pj=nt,ir=Gt,Mj=ka,Sv=Vt,pf=Jr,uy=zu,xj=or,$v=rs,Ou=vi,j1=Qu,Nj=di,U1=ny,Lj=Yu,F1=Qn,D1=Qt,jj=ty,B1=Hu,Td=Sr,ly=os.exports,Uj=uf,q1=Ku,Sb=Gu,Fj=At,Dj=ay,Bj=L1,qj=vj,Hj=Ca,H1=yn,vf=Qr.forEach,Ur=Uj("hidden"),hf="Symbol",Pu="prototype",Wj=H1.set,$b=H1.getterFor(hf),dn=Object[Pu],Yi=sy.Symbol,ou=Yi&&Yi[Pu],Gj=sy.TypeError,kd=sy.QObject,W1=F1.f,Ka=D1.f,G1=U1.f,zj=B1.f,z1=Oj([].push),ga=ly("symbols"),el=ly("op-symbols"),Vj=ly("wks"),Tv=!kd||!kd[Pu]||!kd[Pu].findChild,kv=so&&Pj(function(){return Ou(Ka({},"a",{get:function(){return Ka(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=W1(dn,t);n&&delete dn[t],Ka(e,t,r),n&&e!==dn&&Ka(dn,t,n)}:Ka,Ed=function(e,t){var r=ga[e]=Ou(ou);return Wj(r,{type:hf,tag:e,description:t}),so||(r.description=t),r},yf=function(t,r,n){t===dn&&yf(el,r,n),Sv(t);var a=uy(r);return Sv(n),ir(ga,a)?(n.enumerable?(ir(t,Ur)&&t[Ur][a]&&(t[Ur][a]=!1),n=Ou(n,{enumerable:$v(0,!1)})):(ir(t,Ur)||Ka(t,Ur,$v(1,{})),t[Ur][a]=!0),kv(t,a,n)):Ka(t,a,n)},cy=function(t,r){Sv(t);var n=pf(r),a=j1(n).concat(Y1(n));return vf(a,function(i){(!so||oy(Ev,n,i))&&yf(t,i,n[i])}),t},Kj=function(t,r){return r===void 0?Ou(t):cy(Ou(t),r)},Ev=function(t){var r=uy(t),n=oy(zj,this,r);return this===dn&&ir(ga,r)&&!ir(el,r)?!1:n||!ir(this,r)||!ir(ga,r)||ir(this,Ur)&&this[Ur][r]?n:!0},V1=function(t,r){var n=pf(t),a=uy(r);if(!(n===dn&&ir(ga,a)&&!ir(el,a))){var i=W1(n,a);return i&&ir(ga,a)&&!(ir(n,Ur)&&n[Ur][a])&&(i.enumerable=!0),i}},K1=function(t){var r=G1(pf(t)),n=[];return vf(r,function(a){!ir(ga,a)&&!ir(q1,a)&&z1(n,a)}),n},Y1=function(e){var t=e===dn,r=G1(t?el:pf(e)),n=[];return vf(r,function(a){ir(ga,a)&&(!t||ir(dn,a))&&z1(n,ga[a])}),n};oo||(Yi=function(){if(Mj(ou,this))throw Gj("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:xj(arguments[0]),r=Sb(t),n=function(a){this===dn&&oy(n,el,a),ir(this,Ur)&&ir(this[Ur],r)&&(this[Ur][r]=!1),kv(this,r,$v(1,a))};return so&&Tv&&kv(dn,r,{configurable:!0,set:n}),Ed(r,t)},ou=Yi[Pu],Td(ou,"toString",function(){return $b(this).tag}),Td(Yi,"withoutSetter",function(e){return Ed(Sb(e),e)}),B1.f=Ev,D1.f=yf,jj.f=cy,F1.f=V1,Nj.f=U1.f=K1,Lj.f=Y1,Dj.f=function(e){return Ed(Fj(e),e)},so&&(Ka(ou,"description",{configurable:!0,get:function(){return $b(this).description}}),Td(dn,"propertyIsEnumerable",Ev,{unsafe:!0})));df({global:!0,constructor:!0,wrap:!0,forced:!oo,sham:!oo},{Symbol:Yi});vf(j1(Vj),function(e){Bj(e)});df({target:hf,stat:!0,forced:!oo},{useSetter:function(){Tv=!0},useSimple:function(){Tv=!1}});df({target:"Object",stat:!0,forced:!oo,sham:!so},{create:Kj,defineProperty:yf,defineProperties:cy,getOwnPropertyDescriptor:V1});df({target:"Object",stat:!0,forced:!oo},{getOwnPropertyNames:K1});qj();Hj(Yi,hf);q1[Ur]=!0;var Yj=mo,J1=Yj&&!!Symbol.for&&!!Symbol.keyFor,Jj=st,Qj=hn,Xj=Gt,Zj=or,Q1=os.exports,eU=J1,Id=Q1("string-to-symbol-registry"),tU=Q1("symbol-to-string-registry");Jj({target:"Symbol",stat:!0,forced:!eU},{for:function(e){var t=Zj(e);if(Xj(Id,t))return Id[t];var r=Qj("Symbol")(t);return Id[t]=r,tU[r]=t,r}});var rU=st,nU=Gt,aU=bo,iU=is,sU=os.exports,oU=J1,Tb=sU("symbol-to-string-registry");rU({target:"Symbol",stat:!0,forced:!oU},{keyFor:function(t){if(!aU(t))throw TypeError(iU(t)+" is not a symbol");if(nU(Tb,t))return Tb[t]}});var uU=st,X1=hn,Z1=pi,lU=Ct,tl=et,eT=nt,cU=Zu,fU=Rt,dU=Wt,kb=bo,tT=wo,pU=mo,ti=X1("JSON","stringify"),Rl=tl(/./.exec),Eb=tl("".charAt),vU=tl("".charCodeAt),hU=tl("".replace),yU=tl(1 .toString),gU=/[\uD800-\uDFFF]/g,Ib=/^[\uD800-\uDBFF]$/,Cb=/^[\uDC00-\uDFFF]$/,Rb=!pU||eT(function(){var e=X1("Symbol")();return ti([e])!="[null]"||ti({a:e})!="{}"||ti(Object(e))!="{}"}),Ab=eT(function(){return ti("\uDF06\uD834")!=='"\\udf06\\ud834"'||ti("\uDEAD")!=='"\\udead"'}),mU=function(e,t){var r=tT(arguments),n=t;if(!(!dU(t)&&e===void 0||kb(e)))return cU(t)||(t=function(a,i){if(fU(n)&&(i=lU(n,this,a,i)),!kb(i))return i}),r[1]=t,Z1(ti,null,r)},bU=function(e,t,r){var n=Eb(r,t-1),a=Eb(r,t+1);return Rl(Ib,e)&&!Rl(Cb,a)||Rl(Cb,e)&&!Rl(Ib,n)?"\\u"+yU(vU(e,0),16):e};ti&&uU({target:"JSON",stat:!0,arity:3,forced:Rb||Ab},{stringify:function(t,r,n){var a=tT(arguments),i=Z1(Rb?mU:ti,null,a);return Ab&&typeof i=="string"?hU(i,gU,bU):i}});var wU=st,_U=mo,SU=nt,rT=Yu,$U=_r,TU=!_U||SU(function(){rT.f(1)});wU({target:"Object",stat:!0,forced:TU},{getOwnPropertySymbols:function(t){var r=rT.f;return r?r($U(t)):[]}});var kU=nt,EU=At,IU=as,CU=EU("species"),rl=function(e){return IU>=51||!kU(function(){var t=[],r=t.constructor={};return r[CU]=function(){return{foo:1}},t[e](Boolean).foo!==1})},RU=st,AU=Qr.filter,OU=rl,PU=OU("filter");RU({target:"Array",proto:!0,forced:!PU},{filter:function(t){return AU(this,t,arguments.length>1?arguments[1]:void 0)}});var MU=st,xU=nt,NU=Jr,nT=Qn.f,aT=Dt,LU=xU(function(){nT(1)}),jU=!aT||LU;MU({target:"Object",stat:!0,forced:jU,sham:!aT},{getOwnPropertyDescriptor:function(t,r){return nT(NU(t),r)}});var UU=st,FU=Dt,DU=g1,BU=Jr,qU=Qn,HU=_o;UU({target:"Object",stat:!0,sham:!FU},{getOwnPropertyDescriptors:function(t){for(var r=BU(t),n=qU.f,a=DU(r),i={},s=0,u,o;a.length>s;)o=n(r,u=a[s++]),o!==void 0&&HU(i,u,o);return i}});var So={exports:{}};(function(e){function t(n,a,i,s,u,o,l){try{var c=n[o](l),h=c.value}catch(w){i(w);return}c.done?a(h):Promise.resolve(h).then(s,u)}function r(n){return function(){var a=this,i=arguments;return new Promise(function(s,u){var o=n.apply(a,i);function l(h){t(o,s,u,l,c,"next",h)}function c(h){t(o,s,u,l,c,"throw",h)}l(void 0)})}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(So);var hi={exports:{}};(function(e){function t(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(hi);var Nn={exports:{}},gf={exports:{}};(function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,s){return i.__proto__=s,i},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(gf);(function(e){var t=gf.exports;function r(n,a){if(typeof a!="function"&&a!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(a&&a.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),a&&t(n,a)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Nn);var Ln={exports:{}},jn={exports:{}};(function(e){function t(r){return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(jn);(function(e){var t=jn.exports.default,r=hi.exports;function n(a,i){if(i&&(t(i)==="object"||typeof i=="function"))return i;if(i!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(a)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(Ln);var Xr={exports:{}};(function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(a){return a.__proto__||Object.getPrototypeOf(a)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Xr);var yi={exports:{}};(function(e){function t(r,n,a){return n in r?Object.defineProperty(r,n,{value:a,enumerable:!0,configurable:!0,writable:!0}):r[n]=a,r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(yi);var ta={exports:{}};(function(e){function t(n,a){for(var i=0;i<a.length;i++){var s=a[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}function r(n,a,i){return a&&t(n.prototype,a),i&&t(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(ta);var Un={exports:{}};(function(e){function t(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Un);var WU=Xh,GU=Ra,zU=WU?{}.toString:function(){return"[object "+GU(this)+"]"},VU=Xh,KU=Sr,YU=zU;VU||KU(Object.prototype,"toString",YU,{unsafe:!0});var JU=fi,QU=lt,nl=JU(QU.process)=="process",XU=Rt,ZU=String,eF=TypeError,tF=function(e){if(typeof e=="object"||XU(e))return e;throw eF("Can't set "+ZU(e)+" as a prototype")},rF=et,nF=Vt,aF=tF,$o=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=rF(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),r(t,[]),e=t instanceof Array}catch{}return function(a,i){return nF(a),aF(i),e?r(a,i):a.__proto__=i,a}}():void 0),iF=hn,sF=Qt,oF=At,uF=Dt,Ob=oF("species"),mf=function(e){var t=iF(e),r=sF.f;uF&&t&&!t[Ob]&&r(t,Ob,{configurable:!0,get:function(){return this}})},lF=ka,cF=TypeError,ls=function(e,t){if(lF(t,e))return e;throw cF("Incorrect invocation")},Pb=Vt,fF=ey,dF=Xn,pF=At,vF=pF("species"),fy=function(e,t){var r=Pb(e).constructor,n;return r===void 0||dF(n=Pb(r)[vF])?t:fF(n)},hF=TypeError,dy=function(e,t){if(e<t)throw hF("Not enough arguments");return e},yF=ns,iT=/(?:ipad|iphone|ipod).*applewebkit/i.test(yF),Kr=lt,gF=pi,mF=Aa,Mb=Rt,bF=Gt,wF=nt,xb=I1,_F=wo,Nb=of,SF=dy,$F=iT,TF=nl,Iv=Kr.setImmediate,Cv=Kr.clearImmediate,kF=Kr.process,Cd=Kr.Dispatch,EF=Kr.Function,Lb=Kr.MessageChannel,IF=Kr.String,Rd=0,gu={},jb="onreadystatechange",Mu,Ai,Ad,Od;try{Mu=Kr.location}catch{}var py=function(e){if(bF(gu,e)){var t=gu[e];delete gu[e],t()}},Pd=function(e){return function(){py(e)}},Ub=function(e){py(e.data)},Fb=function(e){Kr.postMessage(IF(e),Mu.protocol+"//"+Mu.host)};(!Iv||!Cv)&&(Iv=function(t){SF(arguments.length,1);var r=Mb(t)?t:EF(t),n=_F(arguments,1);return gu[++Rd]=function(){gF(r,void 0,n)},Ai(Rd),Rd},Cv=function(t){delete gu[t]},TF?Ai=function(e){kF.nextTick(Pd(e))}:Cd&&Cd.now?Ai=function(e){Cd.now(Pd(e))}:Lb&&!$F?(Ad=new Lb,Od=Ad.port2,Ad.port1.onmessage=Ub,Ai=mF(Od.postMessage,Od)):Kr.addEventListener&&Mb(Kr.postMessage)&&!Kr.importScripts&&Mu&&Mu.protocol!=="file:"&&!wF(Fb)?(Ai=Fb,Kr.addEventListener("message",Ub,!1)):jb in Nb("script")?Ai=function(e){xb.appendChild(Nb("script"))[jb]=function(){xb.removeChild(this),py(e)}}:Ai=function(e){setTimeout(Pd(e),0)});var sT={set:Iv,clear:Cv},CF=ns,RF=lt,AF=/ipad|iphone|ipod/i.test(CF)&&RF.Pebble!==void 0,OF=ns,PF=/web0s(?!.*chrome)/i.test(OF),Qi=lt,Db=Aa,MF=Qn.f,Md=sT.set,xF=iT,NF=AF,LF=PF,xd=nl,Bb=Qi.MutationObserver||Qi.WebKitMutationObserver,qb=Qi.document,Hb=Qi.process,Al=Qi.Promise,Wb=MF(Qi,"queueMicrotask"),oT=Wb&&Wb.value,zo,Bi,mu,js,Nd,Ld,Ol,Gb;oT||(zo=function(){var e,t;for(xd&&(e=Hb.domain)&&e.exit();Bi;){t=Bi.fn,Bi=Bi.next;try{t()}catch(r){throw Bi?js():mu=void 0,r}}mu=void 0,e&&e.enter()},!xF&&!xd&&!LF&&Bb&&qb?(Nd=!0,Ld=qb.createTextNode(""),new Bb(zo).observe(Ld,{characterData:!0}),js=function(){Ld.data=Nd=!Nd}):!NF&&Al&&Al.resolve?(Ol=Al.resolve(void 0),Ol.constructor=Al,Gb=Db(Ol.then,Ol),js=function(){Gb(zo)}):xd?js=function(){Hb.nextTick(zo)}:(Md=Db(Md,Qi),js=function(){Md(zo)}));var jF=oT||function(e){var t={fn:e,next:void 0};mu&&(mu.next=t),Bi||(Bi=t,js()),mu=t},UF=lt,FF=function(e,t){var r=UF.console;r&&r.error&&(arguments.length==1?r.error(e):r.error(e,t))},vy=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},uT=function(){this.head=null,this.tail=null};uT.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var DF=uT,BF=lt,bf=BF.Promise,lT=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",qF=lT,HF=nl,WF=!qF&&!HF&&typeof window=="object"&&typeof document=="object",GF=lt,bu=bf,zF=Rt,VF=cf,KF=Jh,YF=At,JF=WF,QF=lT,jd=as;bu&&bu.prototype;var XF=YF("species"),Rv=!1,cT=zF(GF.PromiseRejectionEvent),ZF=VF("Promise",function(){var e=KF(bu),t=e!==String(bu);if(!t&&jd===66)return!0;if(!jd||jd<51||!/native code/.test(e)){var r=new bu(function(i){i(1)}),n=function(i){i(function(){},function(){})},a=r.constructor={};if(a[XF]=n,Rv=r.then(function(){})instanceof n,!Rv)return!0}return!t&&(JF||QF)&&!cT}),al={CONSTRUCTOR:ZF,REJECTION_EVENT:cT,SUBCLASSING:Rv},To={},zb=xn,eD=TypeError,tD=function(e){var t,r;this.promise=new e(function(n,a){if(t!==void 0||r!==void 0)throw eD("Bad Promise constructor");t=n,r=a}),this.resolve=zb(t),this.reject=zb(r)};To.f=function(e){return new tD(e)};var rD=st,Ec=nl,li=lt,uo=Ct,Vb=Sr,Kb=$o,nD=Ca,aD=mf,iD=xn,cc=Rt,sD=Wt,oD=ls,uD=fy,fT=sT.set,hy=jF,lD=FF,cD=vy,fD=DF,dT=yn,Ic=bf,yy=al,pT=To,wf="Promise",vT=yy.CONSTRUCTOR,dD=yy.REJECTION_EVENT,pD=yy.SUBCLASSING,Ud=dT.getterFor(wf),vD=dT.set,Us=Ic&&Ic.prototype,qi=Ic,Pl=Us,hT=li.TypeError,Av=li.document,gy=li.process,Ov=pT.f,hD=Ov,yD=!!(Av&&Av.createEvent&&li.dispatchEvent),yT="unhandledrejection",gD="rejectionhandled",Yb=0,gT=1,mD=2,my=1,mT=2,Ml,Jb,bD,Qb,bT=function(e){var t;return sD(e)&&cc(t=e.then)?t:!1},wT=function(e,t){var r=t.value,n=t.state==gT,a=n?e.ok:e.fail,i=e.resolve,s=e.reject,u=e.domain,o,l,c;try{a?(n||(t.rejection===mT&&_D(t),t.rejection=my),a===!0?o=r:(u&&u.enter(),o=a(r),u&&(u.exit(),c=!0)),o===e.promise?s(hT("Promise-chain cycle")):(l=bT(o))?uo(l,o,i,s):i(o)):s(r)}catch(h){u&&!c&&u.exit(),s(h)}},_T=function(e,t){e.notified||(e.notified=!0,hy(function(){for(var r=e.reactions,n;n=r.get();)wT(n,e);e.notified=!1,t&&!e.rejection&&wD(e)}))},ST=function(e,t,r){var n,a;yD?(n=Av.createEvent("Event"),n.promise=t,n.reason=r,n.initEvent(e,!1,!0),li.dispatchEvent(n)):n={promise:t,reason:r},!dD&&(a=li["on"+e])?a(n):e===yT&&lD("Unhandled promise rejection",r)},wD=function(e){uo(fT,li,function(){var t=e.facade,r=e.value,n=Xb(e),a;if(n&&(a=cD(function(){Ec?gy.emit("unhandledRejection",r,t):ST(yT,t,r)}),e.rejection=Ec||Xb(e)?mT:my,a.error))throw a.value})},Xb=function(e){return e.rejection!==my&&!e.parent},_D=function(e){uo(fT,li,function(){var t=e.facade;Ec?gy.emit("rejectionHandled",t):ST(gD,t,e.value)})},Bs=function(e,t,r){return function(n){e(t,n,r)}},Vs=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=mD,_T(e,!0))},Pv=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw hT("Promise can't be resolved itself");var n=bT(t);n?hy(function(){var a={done:!1};try{uo(n,t,Bs(Pv,a,e),Bs(Vs,a,e))}catch(i){Vs(a,i,e)}}):(e.value=t,e.state=gT,_T(e,!1))}catch(a){Vs({done:!1},a,e)}}};if(vT&&(qi=function(t){oD(this,Pl),iD(t),uo(Ml,this);var r=Ud(this);try{t(Bs(Pv,r),Bs(Vs,r))}catch(n){Vs(r,n)}},Pl=qi.prototype,Ml=function(t){vD(this,{type:wf,done:!1,notified:!1,parent:!1,reactions:new fD,rejection:!1,state:Yb,value:void 0})},Ml.prototype=Vb(Pl,"then",function(t,r){var n=Ud(this),a=Ov(uD(this,qi));return n.parent=!0,a.ok=cc(t)?t:!0,a.fail=cc(r)&&r,a.domain=Ec?gy.domain:void 0,n.state==Yb?n.reactions.add(a):hy(function(){wT(a,n)}),a.promise}),Jb=function(){var e=new Ml,t=Ud(e);this.promise=e,this.resolve=Bs(Pv,t),this.reject=Bs(Vs,t)},pT.f=Ov=function(e){return e===qi||e===bD?new Jb(e):hD(e)},cc(Ic)&&Us!==Object.prototype)){Qb=Us.then,pD||Vb(Us,"then",function(t,r){var n=this;return new qi(function(a,i){uo(Qb,n,a,i)}).then(t,r)},{unsafe:!0});try{delete Us.constructor}catch{}Kb&&Kb(Us,Pl)}rD({global:!0,constructor:!0,wrap:!0,forced:vT},{Promise:qi});nD(qi,wf,!1);aD(wf);var il={},SD=At,$D=il,TD=SD("iterator"),kD=Array.prototype,by=function(e){return e!==void 0&&($D.Array===e||kD[TD]===e)},ED=Ra,Zb=ss,ID=Xn,CD=il,RD=At,AD=RD("iterator"),sl=function(e){if(!ID(e))return Zb(e,AD)||Zb(e,"@@iterator")||CD[ED(e)]},OD=Ct,PD=xn,MD=Vt,xD=is,ND=sl,LD=TypeError,_f=function(e,t){var r=arguments.length<2?ND(e):t;if(PD(r))return MD(OD(r,e));throw LD(xD(e)+" is not iterable")},jD=Ct,ew=Vt,UD=ss,$T=function(e,t,r){var n,a;ew(e);try{if(n=UD(e,"return"),!n){if(t==="throw")throw r;return r}n=jD(n,e)}catch(i){a=!0,n=i}if(t==="throw")throw r;if(a)throw n;return ew(n),r},FD=Aa,DD=Ct,BD=Vt,qD=is,HD=by,WD=cr,tw=ka,GD=_f,zD=sl,rw=$T,VD=TypeError,fc=function(e,t){this.stopped=e,this.result=t},nw=fc.prototype,Sf=function(e,t,r){var n=r&&r.that,a=!!(r&&r.AS_ENTRIES),i=!!(r&&r.IS_RECORD),s=!!(r&&r.IS_ITERATOR),u=!!(r&&r.INTERRUPTED),o=FD(t,n),l,c,h,w,b,$,C,I=function(D){return l&&rw(l,"normal",D),new fc(!0,D)},j=function(D){return a?(BD(D),u?o(D[0],D[1],I):o(D[0],D[1])):u?o(D,I):o(D)};if(i)l=e.iterator;else if(s)l=e;else{if(c=zD(e),!c)throw VD(qD(e)+" is not iterable");if(HD(c)){for(h=0,w=WD(e);w>h;h++)if(b=j(e[h]),b&&tw(nw,b))return b;return new fc(!1)}l=GD(e,c)}for($=i?e.next:l.next;!(C=DD($,l)).done;){try{b=j(C.value)}catch(D){rw(l,"throw",D)}if(typeof b=="object"&&b&&tw(nw,b))return b}return new fc(!1)},KD=At,TT=KD("iterator"),kT=!1;try{var YD=0,aw={next:function(){return{done:!!YD++}},return:function(){kT=!0}};aw[TT]=function(){return this},Array.from(aw,function(){throw 2})}catch{}var $f=function(e,t){if(!t&&!kT)return!1;var r=!1;try{var n={};n[TT]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},JD=bf,QD=$f,XD=al.CONSTRUCTOR,ET=XD||!QD(function(e){JD.all(e).then(void 0,function(){})}),ZD=st,e3=Ct,t3=xn,r3=To,n3=vy,a3=Sf,i3=ET;ZD({target:"Promise",stat:!0,forced:i3},{all:function(t){var r=this,n=r3.f(r),a=n.resolve,i=n.reject,s=n3(function(){var u=t3(r.resolve),o=[],l=0,c=1;a3(t,function(h){var w=l++,b=!1;c++,e3(u,r,h).then(function($){b||(b=!0,o[w]=$,--c||a(o))},i)}),--c||a(o)});return s.error&&i(s.value),n.promise}});var s3=st,o3=al.CONSTRUCTOR,Mv=bf,u3=hn,l3=Rt,c3=Sr,iw=Mv&&Mv.prototype;s3({target:"Promise",proto:!0,forced:o3,real:!0},{catch:function(e){return this.then(void 0,e)}});if(l3(Mv)){var sw=u3("Promise").prototype.catch;iw.catch!==sw&&c3(iw,"catch",sw,{unsafe:!0})}var f3=st,d3=Ct,p3=xn,v3=To,h3=vy,y3=Sf,g3=ET;f3({target:"Promise",stat:!0,forced:g3},{race:function(t){var r=this,n=v3.f(r),a=n.reject,i=h3(function(){var s=p3(r.resolve);y3(t,function(u){d3(s,r,u).then(n.resolve,a)})});return i.error&&a(i.value),n.promise}});var m3=st,b3=Ct,w3=To,_3=al.CONSTRUCTOR;m3({target:"Promise",stat:!0,forced:_3},{reject:function(t){var r=w3.f(this);return b3(r.reject,void 0,t),r.promise}});var S3=Vt,$3=Wt,T3=To,k3=function(e,t){if(S3(e),$3(t)&&t.constructor===e)return t;var r=T3.f(e),n=r.resolve;return n(t),r.promise},E3=st,I3=hn,C3=al.CONSTRUCTOR,R3=k3;I3("Promise");E3({target:"Promise",stat:!0,forced:C3},{resolve:function(t){return R3(this,t)}});var A3=st,O3=Qr.map,P3=rl,M3=P3("map");A3({target:"Array",proto:!0,forced:!M3},{map:function(t){return O3(this,t,arguments.length>1?arguments[1]:void 0)}});var IT={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},x3=of,Fd=x3("span").classList,ow=Fd&&Fd.constructor&&Fd.constructor.prototype,CT=ow===Object.prototype?void 0:ow,N3=nt,ol=function(e,t){var r=[][e];return!!r&&N3(function(){r.call(null,t||function(){return 1},1)})},L3=Qr.forEach,j3=ol,U3=j3("forEach"),F3=U3?[].forEach:function(t){return L3(this,t,arguments.length>1?arguments[1]:void 0)},uw=lt,lw=IT,D3=CT,Dd=F3,B3=Ea,RT=function(e){if(e&&e.forEach!==Dd)try{B3(e,"forEach",Dd)}catch{e.forEach=Dd}};for(var Bd in lw)lw[Bd]&&RT(uw[Bd]&&uw[Bd].prototype);RT(D3);var AT={exports:{}};(function(e){var t=jn.exports.default;function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},a=Object.prototype,i=a.hasOwnProperty,s=typeof Symbol=="function"?Symbol:{},u=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",l=s.toStringTag||"@@toStringTag";function c(ce,te,ue){return Object.defineProperty(ce,te,{value:ue,enumerable:!0,configurable:!0,writable:!0}),ce[te]}try{c({},"")}catch{c=function(ue,ie,Ie){return ue[ie]=Ie}}function h(ce,te,ue,ie){var Ie=te&&te.prototype instanceof $?te:$,$e=Object.create(Ie.prototype),N=new de(ie||[]);return $e._invoke=function(ct,ft,Te){var Xe="suspendedStart";return function(Je,B){if(Xe==="executing")throw new Error("Generator is already running");if(Xe==="completed"){if(Je==="throw")throw B;return xe()}for(Te.method=Je,Te.arg=B;;){var T=Te.delegate;if(T){var Se=le(T,Te);if(Se){if(Se===b)continue;return Se}}if(Te.method==="next")Te.sent=Te._sent=Te.arg;else if(Te.method==="throw"){if(Xe==="suspendedStart")throw Xe="completed",Te.arg;Te.dispatchException(Te.arg)}else Te.method==="return"&&Te.abrupt("return",Te.arg);Xe="executing";var pe=w(ct,ft,Te);if(pe.type==="normal"){if(Xe=Te.done?"completed":"suspendedYield",pe.arg===b)continue;return{value:pe.arg,done:Te.done}}pe.type==="throw"&&(Xe="completed",Te.method="throw",Te.arg=pe.arg)}}}(ce,ue,N),$e}function w(ce,te,ue){try{return{type:"normal",arg:ce.call(te,ue)}}catch(ie){return{type:"throw",arg:ie}}}n.wrap=h;var b={};function $(){}function C(){}function I(){}var j={};c(j,u,function(){return this});var D=Object.getPrototypeOf,ve=D&&D(D(X([])));ve&&ve!==a&&i.call(ve,u)&&(j=ve);var se=I.prototype=$.prototype=Object.create(j);function Pe(ce){["next","throw","return"].forEach(function(te){c(ce,te,function(ue){return this._invoke(te,ue)})})}function Me(ce,te){function ue(Ie,$e,N,ct){var ft=w(ce[Ie],ce,$e);if(ft.type!=="throw"){var Te=ft.arg,Xe=Te.value;return Xe&&t(Xe)=="object"&&i.call(Xe,"__await")?te.resolve(Xe.__await).then(function(Je){ue("next",Je,N,ct)},function(Je){ue("throw",Je,N,ct)}):te.resolve(Xe).then(function(Je){Te.value=Je,N(Te)},function(Je){return ue("throw",Je,N,ct)})}ct(ft.arg)}var ie;this._invoke=function(Ie,$e){function N(){return new te(function(ct,ft){ue(Ie,$e,ct,ft)})}return ie=ie?ie.then(N,N):N()}}function le(ce,te){var ue=ce.iterator[te.method];if(ue===void 0){if(te.delegate=null,te.method==="throw"){if(ce.iterator.return&&(te.method="return",te.arg=void 0,le(ce,te),te.method==="throw"))return b;te.method="throw",te.arg=new TypeError("The iterator does not provide a 'throw' method")}return b}var ie=w(ue,ce.iterator,te.arg);if(ie.type==="throw")return te.method="throw",te.arg=ie.arg,te.delegate=null,b;var Ie=ie.arg;return Ie?Ie.done?(te[ce.resultName]=Ie.value,te.next=ce.nextLoc,te.method!=="return"&&(te.method="next",te.arg=void 0),te.delegate=null,b):Ie:(te.method="throw",te.arg=new TypeError("iterator result is not an object"),te.delegate=null,b)}function x(ce){var te={tryLoc:ce[0]};1 in ce&&(te.catchLoc=ce[1]),2 in ce&&(te.finallyLoc=ce[2],te.afterLoc=ce[3]),this.tryEntries.push(te)}function re(ce){var te=ce.completion||{};te.type="normal",delete te.arg,ce.completion=te}function de(ce){this.tryEntries=[{tryLoc:"root"}],ce.forEach(x,this),this.reset(!0)}function X(ce){if(ce){var te=ce[u];if(te)return te.call(ce);if(typeof ce.next=="function")return ce;if(!isNaN(ce.length)){var ue=-1,ie=function Ie(){for(;++ue<ce.length;)if(i.call(ce,ue))return Ie.value=ce[ue],Ie.done=!1,Ie;return Ie.value=void 0,Ie.done=!0,Ie};return ie.next=ie}}return{next:xe}}function xe(){return{value:void 0,done:!0}}return C.prototype=I,c(se,"constructor",I),c(I,"constructor",C),C.displayName=c(I,l,"GeneratorFunction"),n.isGeneratorFunction=function(ce){var te=typeof ce=="function"&&ce.constructor;return!!te&&(te===C||(te.displayName||te.name)==="GeneratorFunction")},n.mark=function(ce){return Object.setPrototypeOf?Object.setPrototypeOf(ce,I):(ce.__proto__=I,c(ce,l,"GeneratorFunction")),ce.prototype=Object.create(se),ce},n.awrap=function(ce){return{__await:ce}},Pe(Me.prototype),c(Me.prototype,o,function(){return this}),n.AsyncIterator=Me,n.async=function(ce,te,ue,ie,Ie){Ie===void 0&&(Ie=Promise);var $e=new Me(h(ce,te,ue,ie),Ie);return n.isGeneratorFunction(te)?$e:$e.next().then(function(N){return N.done?N.value:$e.next()})},Pe(se),c(se,l,"Generator"),c(se,u,function(){return this}),c(se,"toString",function(){return"[object Generator]"}),n.keys=function(ce){var te=[];for(var ue in ce)te.push(ue);return te.reverse(),function ie(){for(;te.length;){var Ie=te.pop();if(Ie in ce)return ie.value=Ie,ie.done=!1,ie}return ie.done=!0,ie}},n.values=X,de.prototype={constructor:de,reset:function(te){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(re),!te)for(var ue in this)ue.charAt(0)==="t"&&i.call(this,ue)&&!isNaN(+ue.slice(1))&&(this[ue]=void 0)},stop:function(){this.done=!0;var te=this.tryEntries[0].completion;if(te.type==="throw")throw te.arg;return this.rval},dispatchException:function(te){if(this.done)throw te;var ue=this;function ie(Te,Xe){return N.type="throw",N.arg=te,ue.next=Te,Xe&&(ue.method="next",ue.arg=void 0),!!Xe}for(var Ie=this.tryEntries.length-1;Ie>=0;--Ie){var $e=this.tryEntries[Ie],N=$e.completion;if($e.tryLoc==="root")return ie("end");if($e.tryLoc<=this.prev){var ct=i.call($e,"catchLoc"),ft=i.call($e,"finallyLoc");if(ct&&ft){if(this.prev<$e.catchLoc)return ie($e.catchLoc,!0);if(this.prev<$e.finallyLoc)return ie($e.finallyLoc)}else if(ct){if(this.prev<$e.catchLoc)return ie($e.catchLoc,!0)}else{if(!ft)throw new Error("try statement without catch or finally");if(this.prev<$e.finallyLoc)return ie($e.finallyLoc)}}}},abrupt:function(te,ue){for(var ie=this.tryEntries.length-1;ie>=0;--ie){var Ie=this.tryEntries[ie];if(Ie.tryLoc<=this.prev&&i.call(Ie,"finallyLoc")&&this.prev<Ie.finallyLoc){var $e=Ie;break}}$e&&(te==="break"||te==="continue")&&$e.tryLoc<=ue&&ue<=$e.finallyLoc&&($e=null);var N=$e?$e.completion:{};return N.type=te,N.arg=ue,$e?(this.method="next",this.next=$e.finallyLoc,b):this.complete(N)},complete:function(te,ue){if(te.type==="throw")throw te.arg;return te.type==="break"||te.type==="continue"?this.next=te.arg:te.type==="return"?(this.rval=this.arg=te.arg,this.method="return",this.next="end"):te.type==="normal"&&ue&&(this.next=ue),b},finish:function(te){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var ie=this.tryEntries[ue];if(ie.finallyLoc===te)return this.complete(ie.completion,ie.afterLoc),re(ie),b}},catch:function(te){for(var ue=this.tryEntries.length-1;ue>=0;--ue){var ie=this.tryEntries[ue];if(ie.tryLoc===te){var Ie=ie.completion;if(Ie.type==="throw"){var $e=Ie.arg;re(ie)}return $e}}throw new Error("illegal catch attempt")},delegateYield:function(te,ue,ie){return this.delegate={iterator:X(te),resultName:ue,nextLoc:ie},this.method==="next"&&(this.arg=void 0),b}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(AT);var dc=AT.exports(),ul=dc;try{regeneratorRuntime=dc}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=dc:Function("r","regeneratorRuntime = r")(dc)}var q3=TypeError,H3=9007199254740991,OT=function(e){if(e>H3)throw q3("Maximum allowed index exceeded");return e},W3=st,G3=nt,z3=Zu,V3=Wt,K3=_r,Y3=cr,cw=OT,fw=_o,J3=iy,Q3=rl,X3=At,Z3=as,PT=X3("isConcatSpreadable"),eB=Z3>=51||!G3(function(){var e=[];return e[PT]=!1,e.concat()[0]!==e}),tB=Q3("concat"),rB=function(e){if(!V3(e))return!1;var t=e[PT];return t!==void 0?!!t:z3(e)},nB=!eB||!tB;W3({target:"Array",proto:!0,arity:1,forced:nB},{concat:function(t){var r=K3(this),n=J3(r,0),a=0,i,s,u,o,l;for(i=-1,u=arguments.length;i<u;i++)if(l=i===-1?r:arguments[i],rB(l))for(o=Y3(l),cw(a+o),s=0;s<o;s++,a++)s in l&&fw(n,a,l[s]);else cw(a+1),fw(n,a++,l);return n.length=a,n}});var aB=Vt,iB=$T,sB=function(e,t,r,n){try{return n?t(aB(r)[0],r[1]):t(r)}catch(a){iB(e,"throw",a)}},oB=Aa,uB=Ct,lB=_r,cB=sB,fB=by,dB=ff,pB=cr,dw=_o,vB=_f,hB=sl,pw=Array,MT=function(t){var r=lB(t),n=dB(this),a=arguments.length,i=a>1?arguments[1]:void 0,s=i!==void 0;s&&(i=oB(i,a>2?arguments[2]:void 0));var u=hB(r),o=0,l,c,h,w,b,$;if(u&&!(this===pw&&fB(u)))for(w=vB(r,u),b=w.next,c=n?new this:[];!(h=uB(b,w)).done;o++)$=s?cB(w,i,[h.value,o],!0):h.value,dw(c,o,$);else for(l=pB(r),c=n?new this(l):pw(l);l>o;o++)$=s?i(r[o],o):r[o],dw(c,o,$);return c.length=o,c},yB=st,gB=MT,mB=$f,bB=!mB(function(e){Array.from(e)});yB({target:"Array",stat:!0,forced:bB},{from:gB});var wy=et,wB=ea,_B=or,SB=Zn,$B=wy("".charAt),vw=wy("".charCodeAt),TB=wy("".slice),hw=function(e){return function(t,r){var n=_B(SB(t)),a=wB(r),i=n.length,s,u;return a<0||a>=i?e?"":void 0:(s=vw(n,a),s<55296||s>56319||a+1===i||(u=vw(n,a+1))<56320||u>57343?e?$B(n,a):s:e?TB(n,a,a+2):(s-55296<<10)+(u-56320)+65536)}},_y={codeAt:hw(!1),charAt:hw(!0)},kB=nt,EB=!kB(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),IB=Gt,CB=Rt,RB=_r,AB=uf,OB=EB,yw=AB("IE_PROTO"),xv=Object,PB=xv.prototype,Tf=OB?xv.getPrototypeOf:function(e){var t=RB(e);if(IB(t,yw))return t[yw];var r=t.constructor;return CB(r)&&t instanceof r?r.prototype:t instanceof xv?PB:null},MB=nt,xB=Rt,NB=Wt,gw=Tf,LB=Sr,jB=At,Nv=jB("iterator"),xT=!1,Xi,qd,Hd;[].keys&&(Hd=[].keys(),"next"in Hd?(qd=gw(gw(Hd)),qd!==Object.prototype&&(Xi=qd)):xT=!0);var UB=!NB(Xi)||MB(function(){var e={};return Xi[Nv].call(e)!==e});UB&&(Xi={});xB(Xi[Nv])||LB(Xi,Nv,function(){return this});var NT={IteratorPrototype:Xi,BUGGY_SAFARI_ITERATORS:xT},FB=NT.IteratorPrototype,DB=vi,BB=rs,qB=Ca,HB=il,WB=function(){return this},LT=function(e,t,r,n){var a=t+" Iterator";return e.prototype=DB(FB,{next:BB(+!n,r)}),qB(e,a,!1),HB[a]=WB,e},GB=st,zB=Ct,jT=Vu,VB=Rt,KB=LT,mw=Tf,bw=$o,YB=Ca,JB=Ea,Wd=Sr,QB=At,XB=il,UT=NT,ZB=jT.PROPER,e4=jT.CONFIGURABLE,ww=UT.IteratorPrototype,xl=UT.BUGGY_SAFARI_ITERATORS,Vo=QB("iterator"),_w="keys",Ko="values",Sw="entries",t4=function(){return this},Sy=function(e,t,r,n,a,i,s){KB(r,t,n);var u=function(j){if(j===a&&w)return w;if(!xl&&j in c)return c[j];switch(j){case _w:return function(){return new r(this,j)};case Ko:return function(){return new r(this,j)};case Sw:return function(){return new r(this,j)}}return function(){return new r(this)}},o=t+" Iterator",l=!1,c=e.prototype,h=c[Vo]||c["@@iterator"]||a&&c[a],w=!xl&&h||u(a),b=t=="Array"&&c.entries||h,$,C,I;if(b&&($=mw(b.call(new e)),$!==Object.prototype&&$.next&&(mw($)!==ww&&(bw?bw($,ww):VB($[Vo])||Wd($,Vo,t4)),YB($,o,!0))),ZB&&a==Ko&&h&&h.name!==Ko&&(e4?JB(c,"name",Ko):(l=!0,w=function(){return zB(h,this)})),a)if(C={values:u(Ko),keys:i?w:u(_w),entries:u(Sw)},s)for(I in C)(xl||l||!(I in c))&&Wd(c,I,C[I]);else GB({target:t,proto:!0,forced:xl||l},C);return c[Vo]!==w&&Wd(c,Vo,w,{name:a}),XB[t]=w,C},$y=function(e,t){return{value:e,done:t}},r4=_y.charAt,n4=or,FT=yn,a4=Sy,$w=$y,DT="String Iterator",i4=FT.set,s4=FT.getterFor(DT);a4(String,"String",function(e){i4(this,{type:DT,string:n4(e),index:0})},function(){var t=s4(this),r=t.string,n=t.index,a;return n>=r.length?$w(void 0,!0):(a=r4(r,n),t.index+=a.length,$w(a,!1))});var cs={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.log=r()})(Rn,function(){var t=function(){},r="undefined",n=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),a=["trace","debug","info","warn","error"];function i(C,I){var j=C[I];if(typeof j.bind=="function")return j.bind(C);try{return Function.prototype.bind.call(j,C)}catch{return function(){return Function.prototype.apply.apply(j,[C,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function u(C){return C==="debug"&&(C="log"),typeof console===r?!1:C==="trace"&&n?s:console[C]!==void 0?i(console,C):console.log!==void 0?i(console,"log"):t}function o(C,I){for(var j=0;j<a.length;j++){var D=a[j];this[D]=j<C?t:this.methodFactory(D,C,I)}this.log=this.debug}function l(C,I,j){return function(){typeof console!==r&&(o.call(this,I,j),this[C].apply(this,arguments))}}function c(C,I,j){return u(C)||l.apply(this,arguments)}function h(C,I,j){var D=this,ve;I=I==null?"WARN":I;var se="loglevel";typeof C=="string"?se+=":"+C:typeof C=="symbol"&&(se=void 0);function Pe(re){var de=(a[re]||"silent").toUpperCase();if(!(typeof window===r||!se)){try{window.localStorage[se]=de;return}catch{}try{window.document.cookie=encodeURIComponent(se)+"="+de+";"}catch{}}}function Me(){var re;if(!(typeof window===r||!se)){try{re=window.localStorage[se]}catch{}if(typeof re===r)try{var de=window.document.cookie,X=de.indexOf(encodeURIComponent(se)+"=");X!==-1&&(re=/^([^;]+)/.exec(de.slice(X))[1])}catch{}return D.levels[re]===void 0&&(re=void 0),re}}function le(){if(!(typeof window===r||!se)){try{window.localStorage.removeItem(se);return}catch{}try{window.document.cookie=encodeURIComponent(se)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}D.name=C,D.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},D.methodFactory=j||c,D.getLevel=function(){return ve},D.setLevel=function(re,de){if(typeof re=="string"&&D.levels[re.toUpperCase()]!==void 0&&(re=D.levels[re.toUpperCase()]),typeof re=="number"&&re>=0&&re<=D.levels.SILENT){if(ve=re,de!==!1&&Pe(re),o.call(D,re,C),typeof console===r&&re<D.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+re},D.setDefaultLevel=function(re){I=re,Me()||D.setLevel(re,!1)},D.resetLevel=function(){D.setLevel(I,!1),le()},D.enableAll=function(re){D.setLevel(D.levels.TRACE,re)},D.disableAll=function(re){D.setLevel(D.levels.SILENT,re)};var x=Me();x==null&&(x=I),D.setLevel(x,!1)}var w=new h,b={};w.getLogger=function(I){if(typeof I!="symbol"&&typeof I!="string"||I==="")throw new TypeError("You must supply a name when creating a logger.");var j=b[I];return j||(j=b[I]=new h(I,w.getLevel(),w.methodFactory)),j};var $=typeof window!==r?window.log:void 0;return w.noConflict=function(){return typeof window!==r&&window.log===w&&(window.log=$),w},w.getLoggers=function(){return b},w.default=w,w})})(cs);const Ji="\\d+(?:[\\.,]\\d+)?",o4=`(${Ji}W)`,u4=`(${Ji}Y)?(${Ji}M)?(${Ji}D)?`,l4=`T(${Ji}H)?(${Ji}M)?(${Ji}S)?`,c4=`P(?:${o4}|${u4}(?:${l4})?)`,f4=["weeks","years","months","days","hours","minutes","seconds"],Ty=new RegExp(c4),BT=e=>e.match(Ty).slice(1).reduce((t,r,n)=>(t[f4[n]]=parseFloat(r)||0,t),{}),ky=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return n.setFullYear(n.getFullYear()+e.years),n.setMonth(n.getMonth()+e.months),n.setDate(n.getDate()+e.days),n.setHours(n.getHours()+e.hours),n.setMinutes(n.getMinutes()+e.minutes),n.setMilliseconds(n.getMilliseconds()+e.seconds*1e3),n.setDate(n.getDate()+e.weeks*7),n},qT=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return(ky(e,n).getTime()-n.getTime())/1e3},d4={end:ky,toSeconds:qT,pattern:Ty,parse:BT},p4=Object.freeze(Object.defineProperty({__proto__:null,pattern:Ty,parse:BT,end:ky,toSeconds:qT,default:d4},Symbol.toStringTag,{value:"Module"})),v4=AM(p4);var h4=At,y4=vi,g4=Qt.f,Lv=h4("unscopables"),jv=Array.prototype;jv[Lv]==null&&g4(jv,Lv,{configurable:!0,value:y4(null)});var Ey=function(e){jv[Lv][e]=!0},m4=Jr,Iy=Ey,Tw=il,HT=yn,b4=Qt.f,w4=Sy,Nl=$y,_4=Dt,WT="Array Iterator",S4=HT.set,$4=HT.getterFor(WT),GT=w4(Array,"Array",function(e,t){S4(this,{type:WT,target:m4(e),index:0,kind:t})},function(){var e=$4(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Nl(void 0,!0)):r=="keys"?Nl(n,!1):r=="values"?Nl(t[n],!1):Nl([n,t[n]],!1)},"values"),kw=Tw.Arguments=Tw.Array;Iy("keys");Iy("values");Iy("entries");if(_4&&kw.name!=="values")try{b4(kw,"name",{value:"values"})}catch{}var Ew=lt,zT=IT,T4=CT,uu=GT,Gd=Ea,VT=At,zd=VT("iterator"),Iw=VT("toStringTag"),Vd=uu.values,KT=function(e,t){if(e){if(e[zd]!==Vd)try{Gd(e,zd,Vd)}catch{e[zd]=Vd}if(e[Iw]||Gd(e,Iw,t),zT[t]){for(var r in uu)if(e[r]!==uu[r])try{Gd(e,r,uu[r])}catch{e[r]=uu[r]}}}};for(var Kd in zT)KT(Ew[Kd]&&Ew[Kd].prototype,Kd);KT(T4,"DOMTokenList");var k4=Rt,E4=Wt,Cw=$o,Cy=function(e,t,r){var n,a;return Cw&&k4(n=t.constructor)&&n!==r&&E4(a=n.prototype)&&a!==r.prototype&&Cw(e,a),e},I4=et,C4=I4(1 .valueOf),R4=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,A4=et,O4=Zn,P4=or,M4=R4,Rw=A4("".replace),Cc="["+M4+"]",x4=RegExp("^"+Cc+Cc+"*"),N4=RegExp(Cc+Cc+"*$"),Yd=function(e){return function(t){var r=P4(O4(t));return e&1&&(r=Rw(r,x4,"")),e&2&&(r=Rw(r,N4,"")),r}},L4={start:Yd(1),end:Yd(2),trim:Yd(3)},j4=Dt,Ry=lt,YT=et,U4=cf,F4=Sr,Aw=Gt,D4=Cy,B4=ka,q4=bo,JT=Vh,H4=nt,W4=di.f,G4=Qn.f,z4=Qt.f,V4=C4,K4=L4.trim,Uv="Number",Ga=Ry[Uv],Jd=Ga.prototype,Y4=Ry.TypeError,J4=YT("".slice),Ll=YT("".charCodeAt),Q4=function(e){var t=JT(e,"number");return typeof t=="bigint"?t:X4(t)},X4=function(e){var t=JT(e,"number"),r,n,a,i,s,u,o,l;if(q4(t))throw Y4("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=K4(t),r=Ll(t,0),r===43||r===45){if(n=Ll(t,2),n===88||n===120)return NaN}else if(r===48){switch(Ll(t,1)){case 66:case 98:a=2,i=49;break;case 79:case 111:a=8,i=55;break;default:return+t}for(s=J4(t,2),u=s.length,o=0;o<u;o++)if(l=Ll(s,o),l<48||l>i)return NaN;return parseInt(s,a)}}return+t};if(U4(Uv,!Ga(" 0o1")||!Ga("0b1")||Ga("+0x1"))){for(var ks=function(t){var r=arguments.length<1?0:Ga(Q4(t)),n=this;return B4(Jd,n)&&H4(function(){V4(n)})?D4(Object(r),n,ks):r},Ow=j4?W4(Ga):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Qd=0,jl;Ow.length>Qd;Qd++)Aw(Ga,jl=Ow[Qd])&&!Aw(ks,jl)&&z4(ks,jl,G4(Ga,jl));ks.prototype=Jd,Jd.constructor=ks,F4(Ry,Uv,ks,{constructor:!0})}var Z4=Vt,QT=function(){var e=Z4(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},Ay=nt,e6=lt,Oy=e6.RegExp,Py=Ay(function(){var e=Oy("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),t6=Py||Ay(function(){return!Oy("a","y").sticky}),r6=Py||Ay(function(){var e=Oy("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),XT={BROKEN_CARET:r6,MISSED_STICKY:t6,UNSUPPORTED_Y:Py},n6=nt,a6=lt,i6=a6.RegExp,s6=n6(function(){var e=i6(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),o6=nt,u6=lt,l6=u6.RegExp,c6=o6(function(){var e=l6("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),qs=Ct,kf=et,f6=or,d6=QT,p6=XT,v6=os.exports,h6=vi,y6=yn.get,g6=s6,m6=c6,b6=v6("native-string-replace",String.prototype.replace),Rc=RegExp.prototype.exec,Fv=Rc,w6=kf("".charAt),_6=kf("".indexOf),S6=kf("".replace),Xd=kf("".slice),Dv=function(){var e=/a/,t=/b*/g;return qs(Rc,e,"a"),qs(Rc,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),ZT=p6.BROKEN_CARET,Bv=/()??/.exec("")[1]!==void 0,$6=Dv||Bv||ZT||g6||m6;$6&&(Fv=function(t){var r=this,n=y6(r),a=f6(t),i=n.raw,s,u,o,l,c,h,w;if(i)return i.lastIndex=r.lastIndex,s=qs(Fv,i,a),r.lastIndex=i.lastIndex,s;var b=n.groups,$=ZT&&r.sticky,C=qs(d6,r),I=r.source,j=0,D=a;if($&&(C=S6(C,"y",""),_6(C,"g")===-1&&(C+="g"),D=Xd(a,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&w6(a,r.lastIndex-1)!==`
`)&&(I="(?: "+I+")",D=" "+D,j++),u=new RegExp("^(?:"+I+")",C)),Bv&&(u=new RegExp("^"+I+"$(?!\\s)",C)),Dv&&(o=r.lastIndex),l=qs(Rc,$?u:r,D),$?l?(l.input=Xd(l.input,j),l[0]=Xd(l[0],j),l.index=r.lastIndex,r.lastIndex+=l[0].length):r.lastIndex=0:Dv&&l&&(r.lastIndex=r.global?l.index+l[0].length:o),Bv&&l&&l.length>1&&qs(b6,l[0],u,function(){for(c=1;c<arguments.length-2;c++)arguments[c]===void 0&&(l[c]=void 0)}),l&&b)for(l.groups=h=h6(null),c=0;c<b.length;c++)w=b[c],h[w[0]]=l[w[1]];return l});var Ef=Fv,T6=st,Pw=Ef;T6({target:"RegExp",proto:!0,forced:/./.exec!==Pw},{exec:Pw});var Mw=et,xw=Sr,k6=Ef,Nw=nt,ek=At,E6=Ea,I6=ek("species"),Zd=RegExp.prototype,If=function(e,t,r,n){var a=ek(e),i=!Nw(function(){var l={};return l[a]=function(){return 7},""[e](l)!=7}),s=i&&!Nw(function(){var l=!1,c=/a/;return e==="split"&&(c={},c.constructor={},c.constructor[I6]=function(){return c},c.flags="",c[a]=/./[a]),c.exec=function(){return l=!0,null},c[a](""),!l});if(!i||!s||r){var u=Mw(/./[a]),o=t(a,""[e],function(l,c,h,w,b){var $=Mw(l),C=c.exec;return C===k6||C===Zd.exec?i&&!b?{done:!0,value:u(c,h,w)}:{done:!0,value:$(h,c,w)}:{done:!1}});xw(String.prototype,e,o[0]),xw(Zd,a,o[1])}n&&E6(Zd[a],"sham",!0)},C6=_y.charAt,My=function(e,t,r){return t+(r?C6(e,t).length:1)},xy=et,R6=_r,A6=Math.floor,ep=xy("".charAt),O6=xy("".replace),tp=xy("".slice),P6=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,M6=/\$([$&'`]|\d{1,2})/g,x6=function(e,t,r,n,a,i){var s=r+e.length,u=n.length,o=M6;return a!==void 0&&(a=R6(a),o=P6),O6(i,o,function(l,c){var h;switch(ep(c,0)){case"$":return"$";case"&":return e;case"`":return tp(t,0,r);case"'":return tp(t,s);case"<":h=a[tp(c,1,-1)];break;default:var w=+c;if(w===0)return l;if(w>u){var b=A6(w/10);return b===0?l:b<=u?n[b-1]===void 0?ep(c,1):n[b-1]+ep(c,1):l}h=n[w-1]}return h===void 0?"":h})},Lw=Ct,N6=Vt,L6=Rt,j6=fi,U6=Ef,F6=TypeError,Cf=function(e,t){var r=e.exec;if(L6(r)){var n=Lw(r,e,t);return n!==null&&N6(n),n}if(j6(e)==="RegExp")return Lw(U6,e,t);throw F6("RegExp#exec called on incompatible receiver")},D6=pi,jw=Ct,Rf=et,B6=If,q6=nt,H6=Vt,W6=Rt,G6=Xn,z6=ea,V6=Ia,Es=or,K6=Zn,Y6=My,J6=ss,Q6=x6,X6=Cf,Z6=At,qv=Z6("replace"),e5=Math.max,t5=Math.min,r5=Rf([].concat),rp=Rf([].push),Uw=Rf("".indexOf),Fw=Rf("".slice),n5=function(e){return e===void 0?e:String(e)},a5=function(){return"a".replace(/./,"$0")==="$0"}(),Dw=function(){return/./[qv]?/./[qv]("a","$0")==="":!1}(),i5=!q6(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});B6("replace",function(e,t,r){var n=Dw?"$":"$0";return[function(i,s){var u=K6(this),o=G6(i)?void 0:J6(i,qv);return o?jw(o,i,u,s):jw(t,Es(u),i,s)},function(a,i){var s=H6(this),u=Es(a);if(typeof i=="string"&&Uw(i,n)===-1&&Uw(i,"$<")===-1){var o=r(t,s,u,i);if(o.done)return o.value}var l=W6(i);l||(i=Es(i));var c=s.global;if(c){var h=s.unicode;s.lastIndex=0}for(var w=[];;){var b=X6(s,u);if(b===null||(rp(w,b),!c))break;var $=Es(b[0]);$===""&&(s.lastIndex=Y6(u,V6(s.lastIndex),h))}for(var C="",I=0,j=0;j<w.length;j++){b=w[j];for(var D=Es(b[0]),ve=e5(t5(z6(b.index),u.length),0),se=[],Pe=1;Pe<b.length;Pe++)rp(se,n5(b[Pe]));var Me=b.groups;if(l){var le=r5([D],se,ve,u);Me!==void 0&&rp(le,Me);var x=Es(D6(i,void 0,le))}else x=Q6(D,u,ve,se,Me,i);ve>=I&&(C+=Fw(u,I,ve)+x,I=ve+D.length)}return C+Fw(u,I)}]},!i5||!a5||Dw);var s5=st,o5=et,u5=Wu,l5=Jr,c5=ol,f5=o5([].join),d5=u5!=Object,p5=c5("join",",");s5({target:"Array",proto:!0,forced:d5||!p5},{join:function(t){return f5(l5(this),t===void 0?",":t)}});var $r={},v5=st,Bw=Zu,h5=ff,y5=Wt,qw=us,g5=cr,m5=Jr,b5=_o,w5=At,_5=rl,S5=wo,$5=_5("slice"),T5=w5("species"),np=Array,k5=Math.max;v5({target:"Array",proto:!0,forced:!$5},{slice:function(t,r){var n=m5(this),a=g5(n),i=qw(t,a),s=qw(r===void 0?a:r,a),u,o,l;if(Bw(n)&&(u=n.constructor,h5(u)&&(u===np||Bw(u.prototype))?u=void 0:y5(u)&&(u=u[T5],u===null&&(u=void 0)),u===np||u===void 0))return S5(n,i,s);for(o=new(u===void 0?np:u)(k5(s-i,0)),l=0;i<s;i++,l++)i in n&&b5(o,l,n[i]);return o.length=l,o}});var E5=st,Hw=Ct,I5=Rt,Ww=Vt,C5=or,R5=function(){var e=!1,t=/[ac]/;return t.exec=function(){return e=!0,/./.exec.apply(this,arguments)},t.test("abc")===!0&&e}(),A5=/./.test;E5({target:"RegExp",proto:!0,forced:!R5},{test:function(e){var t=Ww(this),r=C5(e),n=t.exec;if(!I5(n))return Hw(A5,t,r);var a=Hw(n,t,r);return a===null?!1:(Ww(a),!0)}});var O5=st,P5=Dt,M5=lt,Ul=et,x5=Gt,N5=Rt,L5=ka,j5=or,U5=Qt.f,F5=m1,ca=M5.Symbol,Oi=ca&&ca.prototype;if(P5&&N5(ca)&&(!("description"in Oi)||ca().description!==void 0)){var Gw={},Fl=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:j5(arguments[0]),r=L5(Oi,this)?new ca(t):t===void 0?ca():ca(t);return t===""&&(Gw[r]=!0),r};F5(Fl,ca),Fl.prototype=Oi,Oi.constructor=Fl;var D5=String(ca("test"))=="Symbol(test)",B5=Ul(Oi.valueOf),q5=Ul(Oi.toString),H5=/^Symbol\((.*)\)[^)]+$/,W5=Ul("".replace),G5=Ul("".slice);U5(Oi,"description",{configurable:!0,get:function(){var t=B5(this);if(x5(Gw,t))return"";var r=q5(t),n=D5?G5(r,7,-1):W5(r,H5,"$1");return n===""?void 0:n}}),O5({global:!0,constructor:!0,forced:!0},{Symbol:Fl})}var z5=L1;z5("iterator");var V5=Dt,K5=Vu.EXISTS,tk=et,Y5=Qt.f,rk=Function.prototype,J5=tk(rk.toString),nk=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Q5=tk(nk.exec),X5="name";V5&&!K5&&Y5(rk,X5,{configurable:!0,get:function(){try{return Q5(nk,J5(this))[1]}catch{return""}}});var gi={exports:{}},ak={exports:{}};(function(e){function t(r){if(Array.isArray(r))return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ak);var ik={exports:{}};(function(e){function t(r,n){var a=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(a!=null){var i=[],s=!0,u=!1,o,l;try{for(a=a.call(r);!(s=(o=a.next()).done)&&(i.push(o.value),!(n&&i.length===n));s=!0);}catch(c){u=!0,l=c}finally{try{!s&&a.return!=null&&a.return()}finally{if(u)throw l}}return i}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ik);var Ny={exports:{}},Ly={exports:{}};(function(e){function t(r,n){(n==null||n>r.length)&&(n=r.length);for(var a=0,i=new Array(n);a<n;a++)i[a]=r[a];return i}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Ly);(function(e){var t=Ly.exports;function r(n,a){if(!!n){if(typeof n=="string")return t(n,a);var i=Object.prototype.toString.call(n).slice(8,-1);if(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")return Array.from(n);if(i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return t(n,a)}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Ny);var sk={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(sk);(function(e){var t=ak.exports,r=ik.exports,n=Ny.exports,a=sk.exports;function i(s,u){return t(s)||r(s,u)||n(s,u)||a()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports})(gi);var mi={exports:{}},ok={exports:{}};(function(e){var t=Ly.exports;function r(n){if(Array.isArray(n))return t(n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(ok);var uk={exports:{}};(function(e){function t(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(uk);var lk={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(lk);(function(e){var t=ok.exports,r=uk.exports,n=Ny.exports,a=lk.exports;function i(s){return t(s)||r(s)||n(s)||a()}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports})(mi);var Z5=st,eq=lf.includes,tq=nt,rq=Ey,nq=tq(function(){return!Array(1).includes()});Z5({target:"Array",proto:!0,forced:nq},{includes:function(t){return eq(this,t,arguments.length>1?arguments[1]:void 0)}});rq("includes");var aq=Wt,iq=Math.floor,ck=Number.isInteger||function(t){return!aq(t)&&isFinite(t)&&iq(t)===t},sq=st,oq=ck;sq({target:"Number",stat:!0},{isInteger:oq});var uq=Dt,fk=et,lq=Qu,cq=Jr,fq=Hu.f,dq=fk(fq),pq=fk([].push),zw=function(e){return function(t){for(var r=cq(t),n=lq(r),a=n.length,i=0,s=[],u;a>i;)u=n[i++],(!uq||dq(r,u))&&pq(s,e?[u,r[u]]:r[u]);return s}},vq={entries:zw(!0),values:zw(!1)},hq=st,yq=vq.entries;hq({target:"Object",stat:!0},{entries:function(t){return yq(t)}});/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty($r,"__esModule",{value:!0});var gq=jn.exports,mq=gi.exports,bq=mi.exports,wq=ta.exports,_q=Un.exports,Sq=Nn.exports,$q=Ln.exports,Tq=Xr.exports;function bi(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Ks=bi(gq),ma=bi(mq),ap=bi(bq),kq=bi(wq),Eq=bi(_q),Iq=bi(Sq),Cq=bi($q),Vw=bi(Tq),Oa=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function Rq(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Aq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function Aq(e,t){if(!!e){if(typeof e=="string")return Kw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Kw(e,t)}}function Kw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var dk=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Oa(function(a){var i=!1,s=[],u=Rq(r),o;try{for(u.s();!(o=u.n()).done;){var l=o.value;if(typeof l=="string"){i=i||Ks.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){u.e(c)}finally{u.f()}return[i,s]})};function Oq(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Pq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function Pq(e,t){if(!!e){if(typeof e=="string")return Yw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Yw(e,t)}}function Yw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Mq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Oa(function(a){var i=!1,s=[],u=Oq(r),o;try{for(u.s();!(o=u.n()).done;){var l=o.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){u.e(c)}finally{u.f()}return[i,s]})};function xq(e){var t=Nq();return function(){var n=Vw.default(e),a;if(t){var i=Vw.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Cq.default(this,a)}}function Nq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function xu(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Lq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function Lq(e,t){if(!!e){if(typeof e=="string")return Jw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Jw(e,t)}}function Jw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Af=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=xu(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=ma.default(a.value,2),s=i[0],u=i[1],o=Pf(t[s],u),l=ma.default(o,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(C){n.e(C)}finally{n.f()}},pk=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(Ks.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),Ks.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=Ks.default(t)),n},jq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=jy(r);return function(i){return function(s){Iq.default(o,s);var u=xq(o);function o(){Eq.default(this,o);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Af(a,c),u.call.apply(u,[this].concat(c))}return kq.default(o)}(i)}},Uq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=jy(r);return function(i,s,u){if(typeof u.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var o=u.value;u.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Af(a,c),o.apply(this,c)}}},Fq=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=jy(r);return function(i,s,u){if(typeof u.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var o=u.value;u.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{Af(a,c)}catch(w){return Promise.reject(w)}return o.apply(this,c)}}},jy=function(t){var r=[],n=xu(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Of(i))}}catch(s){n.e(s)}finally{n.f()}return r},Of=function(t){var r=[],n=Array.isArray(t)?t:[t],a=xu(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(dk(s));continue}r.push(s)}}catch(u){a.e(u)}finally{a.f()}return r},Pf=function(t,r){var n=[],a,i=!1,s=xu(t),u;try{for(s.s();!(u=s.n()).done;){var o=u.value,l=xu(o.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=ma.default(w,3),$=b[0],C=b[1],I=b[2];i=i||$,!a&&I&&(a=I),C&&(n=typeof C=="string"?[].concat(ap.default(n),[C]):[].concat(ap.default(n),ap.default(C)))}}catch(se){l.e(se)}finally{l.f()}}}catch(se){s.e(se)}finally{s.f()}if(i)return[!0];var j=a||pk(r),D=n.length-1,ve=D>0?"".concat(n.slice(0,D).join(", ")," or ").concat(n[D]):n.join(", ");return[!1,j,ve,D>1?";":","]};function Dq(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Bq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function Bq(e,t){if(!!e){if(typeof e=="string")return Qw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Qw(e,t)}}function Qw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var qq=function(t,r){return Oa(function(n){if(!Array.isArray(n)||n.length<1)return[!1,"a non-empty array of ".concat(t)];var a=Dq(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=ma.default(i.value,2),u=s[0],o=s[1],l=Pf(Of(r),o),c=ma.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid non-empty array of ".concat(t," (index ").concat(u," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(u," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})},Hq=Oa(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),Wq=Oa(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),Gq=Oa(function(e){return[Ks.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]}),zq=function(t,r){return Oa(function(n){if(Ks.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=ma.default(i[a],2),u=s[0],o=s[1],l=Pf(Of(o),n[u]),c=ma.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(u,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(u,'" is ').concat(w,")")]}return[!0]})};function Vq(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=Kq(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function Kq(e,t){if(!!e){if(typeof e=="string")return Xw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return Xw(e,t)}}function Xw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Yq=function(t,r){return Oa(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=Vq(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=ma.default(i.value,2),u=s[0],o=s[1],l=Pf(Of(r),o),c=ma.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(u," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(u," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};$r.array=Yq;$r.custom=Oa;$r.literal=Mq;$r.nonEmptyArray=qq;$r.nonEmptyString=Hq;$r.nonNegativeInteger=Wq;$r.objectSchema=zq;$r.pureObject=Gq;$r.runtimeTypeValidation=Af;$r.stringifyReceivedType=pk;$r.type=dk;$r.validateConstructorTypes=jq;$r.validateTypes=Uq;$r.validateTypesAsync=Fq;var Uy={},Mf={exports:{}},vk={exports:{}};(function(e){var t=Xr.exports;function r(n,a){for(;!Object.prototype.hasOwnProperty.call(n,a)&&(n=t(n),n!==null););return n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(vk);(function(e){var t=vk.exports;function r(){return typeof Reflect<"u"&&Reflect.get?(e.exports=r=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=r=function(a,i,s){var u=t(a,i);if(!!u){var o=Object.getOwnPropertyDescriptor(u,i);return o.get?o.get.call(arguments.length<3?a:s):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),r.apply(this,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Mf);/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/Object.defineProperty(Uy,"__esModule",{value:!0});var Jq=mi.exports,Qq=Un.exports,Xq=ta.exports,Zq=hi.exports,e8=Mf.exports,t8=Nn.exports,r8=Ln.exports,n8=Xr.exports,a8=yi.exports;function Pa(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Zw=Pa(Jq),i8=Pa(Qq),s8=Pa(Xq),o8=Pa(Zq),Pi=Pa(e8),u8=Pa(t8),l8=Pa(r8),fa=Pa(n8),c8=Pa(a8),f8;function ri(){}ri.prototype=Object.create(null);function Ot(){Ot.init.call(this)}Ot.EventEmitter=Ot;Ot.usingDomains=!1;Ot.prototype.domain=void 0;Ot.prototype._events=void 0;Ot.prototype._maxListeners=void 0;Ot.defaultMaxListeners=10;Ot.init=function(){this.domain=null,Ot.usingDomains&&f8.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new ri,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Ot.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function hk(e){return e._maxListeners===void 0?Ot.defaultMaxListeners:e._maxListeners}Ot.prototype.getMaxListeners=function(){return hk(this)};function d8(e,t,r){if(t)e.call(r);else for(var n=e.length,a=ll(e,n),i=0;i<n;++i)a[i].call(r)}function p8(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=ll(e,a),s=0;s<a;++s)i[s].call(r,n)}function v8(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,s=ll(e,i),u=0;u<i;++u)s[u].call(r,n,a)}function h8(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var s=e.length,u=ll(e,s),o=0;o<s;++o)u[o].call(r,n,a,i)}function y8(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=ll(e,a),s=0;s<a;++s)i[s].apply(r,n)}Ot.prototype.emit=function(t){var r,n,a,i,s,u,o,l=t==="error";if(u=this._events,u)l=l&&u.error==null;else if(!l)return!1;if(o=this.domain,l){if(r=arguments[1],o)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=o,r.domainThrown=!1,o.emit("error",r);else{if(r instanceof Error)throw r;var c=new Error('Uncaught, unspecified "error" event. ('+r+")");throw c.context=r,c}return!1}if(n=u[t],!n)return!1;var h=typeof n=="function";switch(a=arguments.length,a){case 1:d8(n,h,this);break;case 2:p8(n,h,this,arguments[1]);break;case 3:v8(n,h,this,arguments[1],arguments[2]);break;case 4:h8(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(a-1),s=1;s<a;s++)i[s-1]=arguments[s];y8(n,h,this,i)}return!0};function yk(e,t,r,n){var a,i,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=new ri,e._eventsCount=0),!s)s=i[t]=r,++e._eventsCount;else if(typeof s=="function"?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(a=hk(e),a&&a>0&&s.length>a)){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,g8(u)}return e}function g8(e){typeof console.warn=="function"?console.warn(e):console.log(e)}Ot.prototype.addListener=function(t,r){return yk(this,t,r,!1)};Ot.prototype.on=Ot.prototype.addListener;Ot.prototype.prependListener=function(t,r){return yk(this,t,r,!0)};function gk(e,t,r){var n=!1;function a(){e.removeListener(t,a),n||(n=!0,r.apply(e,arguments))}return a.listener=r,a}Ot.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,gk(this,t,r)),this};Ot.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,gk(this,t,r)),this};Ot.prototype.removeListener=function(t,r){var n,a,i,s,u;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=this._events,!a)return this;if(n=a[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new ri:(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){u=n[s].listener,i=s;break}if(i<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new ri,this;delete a[t]}else m8(n,i);a.removeListener&&this.emit("removeListener",t,u||r)}return this};Ot.prototype.off=function(e,t){return this.removeListener(e,t)};Ot.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new ri,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new ri:delete n[t]),this;if(arguments.length===0){for(var a=Object.keys(n),i=0,s;i<a.length;++i)s=a[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new ri,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};Ot.prototype.listeners=function(t){var r,n,a=this._events;return a?(r=a[t],r?typeof r=="function"?n=[r.listener||r]:n=b8(r):n=[]):n=[],n};Ot.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):mk.call(e,t)};Ot.prototype.listenerCount=mk;function mk(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}Ot.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function m8(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}function ll(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function b8(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function w8(e){var t=_8();return function(){var n=fa.default(e),a;if(t){var i=fa.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return l8.default(this,a)}}function _8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var S8=function(e){u8.default(r,e);var t=w8(r);function r(){var n;return i8.default(this,r),n=t.call(this),c8.default(o8.default(n),"eventHistory",new Map),n}return s8.default(r,[{key:"on",value:function(a,i){return Pi.default(fa.default(r.prototype),"on",this).call(this,a,i)}},{key:"once",value:function(a,i){return Pi.default(fa.default(r.prototype),"once",this).call(this,a,i)}},{key:"off",value:function(a,i){return Pi.default(fa.default(r.prototype),"off",this).call(this,a,i)}},{key:"emit",value:function(a){for(var i,s=arguments.length,u=new Array(s>1?s-1:0),o=1;o<s;o++)u[o-1]=arguments[o];return this.eventHistory.set(a,u),(i=Pi.default(fa.default(r.prototype),"emit",this)).call.apply(i,[this,a].concat(u))}},{key:"addListener",value:function(a,i){return Pi.default(fa.default(r.prototype),"addListener",this).call(this,a,i)}},{key:"removeListener",value:function(a,i){return Pi.default(fa.default(r.prototype),"removeListener",this).call(this,a,i)}},{key:"addListenerWithReplay",value:function(a,i){var s=this.eventHistory.get(a);return s!==void 0&&i.apply(void 0,Zw.default(s)),this.addListener(a,i)}},{key:"onWithReplay",value:function(a,i){return this.addListenerWithReplay(a,i)}},{key:"onceWithReplay",value:function(a,i){var s=this.eventHistory.get(a);return s!==void 0?(i.apply(void 0,Zw.default(s)),this):Pi.default(fa.default(r.prototype),"once",this).call(this,a,i)}}]),r}(Ot);Uy.ReplayEventEmitter=S8;var Hv={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",a=1,i=2,s=9007199254740991,u="[object Arguments]",o="[object Array]",l="[object AsyncFunction]",c="[object Boolean]",h="[object Date]",w="[object Error]",b="[object Function]",$="[object GeneratorFunction]",C="[object Map]",I="[object Number]",j="[object Null]",D="[object Object]",ve="[object Promise]",se="[object Proxy]",Pe="[object RegExp]",Me="[object Set]",le="[object String]",x="[object Symbol]",re="[object Undefined]",de="[object WeakMap]",X="[object ArrayBuffer]",xe="[object DataView]",ce="[object Float32Array]",te="[object Float64Array]",ue="[object Int8Array]",ie="[object Int16Array]",Ie="[object Int32Array]",$e="[object Uint8Array]",N="[object Uint8ClampedArray]",ct="[object Uint16Array]",ft="[object Uint32Array]",Te=/[\\^$.*+?()[\]{}|]/g,Xe=/^\[object .+?Constructor\]$/,Je=/^(?:0|[1-9]\d*)$/,B={};B[ce]=B[te]=B[ue]=B[ie]=B[Ie]=B[$e]=B[N]=B[ct]=B[ft]=!0,B[u]=B[o]=B[X]=B[c]=B[xe]=B[h]=B[w]=B[b]=B[C]=B[I]=B[D]=B[Pe]=B[Me]=B[le]=B[de]=!1;var T=typeof Rn=="object"&&Rn&&Rn.Object===Object&&Rn,Se=typeof self=="object"&&self&&self.Object===Object&&self,pe=T||Se||Function("return this")(),Ke=t&&!t.nodeType&&t,Qe=Ke&&!0&&e&&!e.nodeType&&e,we=Qe&&Qe.exports===Ke,Ge=we&&T.process,O=function(){try{return Ge&&Ge.binding&&Ge.binding("util")}catch{}}(),R=O&&O.isTypedArray;function V(M,Y){for(var ne=-1,Be=M==null?0:M.length,jt=0,ot=[];++ne<Be;){var zt=M[ne];Y(zt,ne,M)&&(ot[jt++]=zt)}return ot}function fe(M,Y){for(var ne=-1,Be=Y.length,jt=M.length;++ne<Be;)M[jt+ne]=Y[ne];return M}function W(M,Y){for(var ne=-1,Be=M==null?0:M.length;++ne<Be;)if(Y(M[ne],ne,M))return!0;return!1}function Re(M,Y){for(var ne=-1,Be=Array(M);++ne<M;)Be[ne]=Y(ne);return Be}function me(M){return function(Y){return M(Y)}}function be(M,Y){return M.has(Y)}function Ce(M,Y){return M==null?void 0:M[Y]}function Q(M){var Y=-1,ne=Array(M.size);return M.forEach(function(Be,jt){ne[++Y]=[jt,Be]}),ne}function Fe(M,Y){return function(ne){return M(Y(ne))}}function Ue(M){var Y=-1,ne=Array(M.size);return M.forEach(function(Be){ne[++Y]=Be}),ne}var Ae=Array.prototype,ae=Function.prototype,F=Object.prototype,H=pe["__core-js_shared__"],K=ae.toString,ye=F.hasOwnProperty,Ne=function(){var M=/[^.]+$/.exec(H&&H.keys&&H.keys.IE_PROTO||"");return M?"Symbol(src)_1."+M:""}(),qe=F.toString,ze=RegExp("^"+K.call(ye).replace(Te,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=we?pe.Buffer:void 0,He=pe.Symbol,Le=pe.Uint8Array,J=F.propertyIsEnumerable,ee=Ae.splice,q=He?He.toStringTag:void 0,z=Object.getOwnPropertySymbols,Z=De?De.isBuffer:void 0,ge=Fe(Object.keys,Object),oe=dt(pe,"DataView"),je=dt(pe,"Map"),Ve=dt(pe,"Promise"),at=dt(pe,"Set"),tt=dt(pe,"WeakMap"),We=dt(Object,"create"),fr=p(oe),rt=p(je),Ir=p(Ve),Nt=p(at),mn=p(tt),Zt=He?He.prototype:void 0,Fn=Zt?Zt.valueOf:void 0;function Et(M){var Y=-1,ne=M==null?0:M.length;for(this.clear();++Y<ne;){var Be=M[Y];this.set(Be[0],Be[1])}}function dr(){this.__data__=We?We(null):{},this.size=0}function qr(M){var Y=this.has(M)&&delete this.__data__[M];return this.size-=Y?1:0,Y}function Hr(M){var Y=this.__data__;if(We){var ne=Y[M];return ne===n?void 0:ne}return ye.call(Y,M)?Y[M]:void 0}function pr(M){var Y=this.__data__;return We?Y[M]!==void 0:ye.call(Y,M)}function vs(M,Y){var ne=this.__data__;return this.size+=this.has(M)?0:1,ne[M]=We&&Y===void 0?n:Y,this}Et.prototype.clear=dr,Et.prototype.delete=qr,Et.prototype.get=Hr,Et.prototype.has=pr,Et.prototype.set=vs;function xr(M){var Y=-1,ne=M==null?0:M.length;for(this.clear();++Y<ne;){var Be=M[Y];this.set(Be[0],Be[1])}}function hs(){this.__data__=[],this.size=0}function Io(M){var Y=this.__data__,ne=_n(Y,M);if(ne<0)return!1;var Be=Y.length-1;return ne==Be?Y.pop():ee.call(Y,ne,1),--this.size,!0}function Co(M){var Y=this.__data__,ne=_n(Y,M);return ne<0?void 0:Y[ne][1]}function ys(M){return _n(this.__data__,M)>-1}function Ro(M,Y){var ne=this.__data__,Be=_n(ne,M);return Be<0?(++this.size,ne.push([M,Y])):ne[Be][1]=Y,this}xr.prototype.clear=hs,xr.prototype.delete=Io,xr.prototype.get=Co,xr.prototype.has=ys,xr.prototype.set=Ro;function bn(M){var Y=-1,ne=M==null?0:M.length;for(this.clear();++Y<ne;){var Be=M[Y];this.set(Be[0],Be[1])}}function wn(){this.size=0,this.__data__={hash:new Et,map:new(je||xr),string:new Et}}function wt(M){var Y=na(this,M).delete(M);return this.size-=Y?1:0,Y}function Ao(M){return na(this,M).get(M)}function Oo(M){return na(this,M).has(M)}function Po(M,Y){var ne=na(this,M),Be=ne.size;return ne.set(M,Y),this.size+=ne.size==Be?0:1,this}bn.prototype.clear=wn,bn.prototype.delete=wt,bn.prototype.get=Ao,bn.prototype.has=Oo,bn.prototype.set=Po;function ra(M){var Y=-1,ne=M==null?0:M.length;for(this.__data__=new bn;++Y<ne;)this.add(M[Y])}function gs(M){return this.__data__.set(M,n),this}function Mo(M){return this.__data__.has(M)}ra.prototype.add=ra.prototype.push=gs,ra.prototype.has=Mo;function tn(M){var Y=this.__data__=new xr(M);this.size=Y.size}function xo(){this.__data__=new xr,this.size=0}function vr(M){var Y=this.__data__,ne=Y.delete(M);return this.size=Y.size,ne}function No(M){return this.__data__.get(M)}function Lo(M){return this.__data__.has(M)}function jo(M,Y){var ne=this.__data__;if(ne instanceof xr){var Be=ne.__data__;if(!je||Be.length<r-1)return Be.push([M,Y]),this.size=++ne.size,this;ne=this.__data__=new bn(Be)}return ne.set(M,Y),this.size=ne.size,this}tn.prototype.clear=xo,tn.prototype.delete=vr,tn.prototype.get=No,tn.prototype.has=Lo,tn.prototype.set=jo;function Uo(M,Y){var ne=y(M),Be=!ne&&m(M),jt=!ne&&!Be&&E(M),ot=!ne&&!Be&&!jt&&Ze(M),zt=ne||Be||jt||ot,nr=zt?Re(M.length,String):[],lr=nr.length;for(var qt in M)(Y||ye.call(M,qt))&&!(zt&&(qt=="length"||jt&&(qt=="offset"||qt=="parent")||ot&&(qt=="buffer"||qt=="byteLength"||qt=="byteOffset")||S(qt,lr)))&&nr.push(qt);return nr}function _n(M,Y){for(var ne=M.length;ne--;)if(f(M[ne][0],Y))return ne;return-1}function Fo(M,Y,ne){var Be=Y(M);return y(M)?Be:fe(Be,ne(M))}function Nr(M){return M==null?M===void 0?re:j:q&&q in Object(M)?ws(M):d(M)}function La(M){return Lt(M)&&Nr(M)==u}function Ti(M,Y,ne,Be,jt){return M===Y?!0:M==null||Y==null||!Lt(M)&&!Lt(Y)?M!==M&&Y!==Y:Do(M,Y,ne,Be,Ti,jt)}function Do(M,Y,ne,Be,jt,ot){var zt=y(M),nr=y(Y),lr=zt?o:P(M),qt=nr?o:P(Y);lr=lr==u?D:lr,qt=qt==u?D:qt;var Wr=lr==D,Sn=qt==D,yr=lr==qt;if(yr&&E(M)){if(!E(Y))return!1;zt=!0,Wr=!1}if(yr&&!Wr)return ot||(ot=new tn),zt||Ze(M)?pt(M,Y,ne,Be,jt,ot):bs(M,Y,lr,ne,Be,jt,ot);if(!(ne&a)){var rn=Wr&&ye.call(M,"__wrapped__"),nn=Sn&&ye.call(Y,"__wrapped__");if(rn||nn){var Ua=rn?M.value():M,aa=nn?Y.value():Y;return ot||(ot=new tn),jt(Ua,aa,ne,Be,ot)}}return yr?(ot||(ot=new tn),ja(M,Y,ne,Be,jt,ot)):!1}function ms(M){if(!Ye(M)||v(M))return!1;var Y=U(M)?ze:Xe;return Y.test(p(M))}function Bo(M){return Lt(M)&&ke(M.length)&&!!B[Nr(M)]}function qo(M){if(!g(M))return ge(M);var Y=[];for(var ne in Object(M))ye.call(M,ne)&&ne!="constructor"&&Y.push(ne);return Y}function pt(M,Y,ne,Be,jt,ot){var zt=ne&a,nr=M.length,lr=Y.length;if(nr!=lr&&!(zt&&lr>nr))return!1;var qt=ot.get(M);if(qt&&ot.get(Y))return qt==Y;var Wr=-1,Sn=!0,yr=ne&i?new ra:void 0;for(ot.set(M,Y),ot.set(Y,M);++Wr<nr;){var rn=M[Wr],nn=Y[Wr];if(Be)var Ua=zt?Be(nn,rn,Wr,Y,M,ot):Be(rn,nn,Wr,M,Y,ot);if(Ua!==void 0){if(Ua)continue;Sn=!1;break}if(yr){if(!W(Y,function(aa,Ei){if(!be(yr,Ei)&&(rn===aa||jt(rn,aa,ne,Be,ot)))return yr.push(Ei)})){Sn=!1;break}}else if(!(rn===nn||jt(rn,nn,ne,Be,ot))){Sn=!1;break}}return ot.delete(M),ot.delete(Y),Sn}function bs(M,Y,ne,Be,jt,ot,zt){switch(ne){case xe:if(M.byteLength!=Y.byteLength||M.byteOffset!=Y.byteOffset)return!1;M=M.buffer,Y=Y.buffer;case X:return!(M.byteLength!=Y.byteLength||!ot(new Le(M),new Le(Y)));case c:case h:case I:return f(+M,+Y);case w:return M.name==Y.name&&M.message==Y.message;case Pe:case le:return M==Y+"";case C:var nr=Q;case Me:var lr=Be&a;if(nr||(nr=Ue),M.size!=Y.size&&!lr)return!1;var qt=zt.get(M);if(qt)return qt==Y;Be|=i,zt.set(M,Y);var Wr=pt(nr(M),nr(Y),Be,jt,ot,zt);return zt.delete(M),Wr;case x:if(Fn)return Fn.call(M)==Fn.call(Y)}return!1}function ja(M,Y,ne,Be,jt,ot){var zt=ne&a,nr=ki(M),lr=nr.length,qt=ki(Y),Wr=qt.length;if(lr!=Wr&&!zt)return!1;for(var Sn=lr;Sn--;){var yr=nr[Sn];if(!(zt?yr in Y:ye.call(Y,yr)))return!1}var rn=ot.get(M);if(rn&&ot.get(Y))return rn==Y;var nn=!0;ot.set(M,Y),ot.set(Y,M);for(var Ua=zt;++Sn<lr;){yr=nr[Sn];var aa=M[yr],Ei=Y[yr];if(Be)var Og=zt?Be(Ei,aa,yr,Y,M,ot):Be(aa,Ei,yr,M,Y,ot);if(!(Og===void 0?aa===Ei||jt(aa,Ei,ne,Be,ot):Og)){nn=!1;break}Ua||(Ua=yr=="constructor")}if(nn&&!Ua){var gl=M.constructor,ml=Y.constructor;gl!=ml&&"constructor"in M&&"constructor"in Y&&!(typeof gl=="function"&&gl instanceof gl&&typeof ml=="function"&&ml instanceof ml)&&(nn=!1)}return ot.delete(M),ot.delete(Y),nn}function ki(M){return Fo(M,hr,A)}function na(M,Y){var ne=M.__data__;return _(Y)?ne[typeof Y=="string"?"string":"hash"]:ne.map}function dt(M,Y){var ne=Ce(M,Y);return ms(ne)?ne:void 0}function ws(M){var Y=ye.call(M,q),ne=M[q];try{M[q]=void 0;var Be=!0}catch{}var jt=qe.call(M);return Be&&(Y?M[q]=ne:delete M[q]),jt}var A=z?function(M){return M==null?[]:(M=Object(M),V(z(M),function(Y){return J.call(M,Y)}))}:ur,P=Nr;(oe&&P(new oe(new ArrayBuffer(1)))!=xe||je&&P(new je)!=C||Ve&&P(Ve.resolve())!=ve||at&&P(new at)!=Me||tt&&P(new tt)!=de)&&(P=function(M){var Y=Nr(M),ne=Y==D?M.constructor:void 0,Be=ne?p(ne):"";if(Be)switch(Be){case fr:return xe;case rt:return C;case Ir:return ve;case Nt:return Me;case mn:return de}return Y});function S(M,Y){return Y=Y==null?s:Y,!!Y&&(typeof M=="number"||Je.test(M))&&M>-1&&M%1==0&&M<Y}function _(M){var Y=typeof M;return Y=="string"||Y=="number"||Y=="symbol"||Y=="boolean"?M!=="__proto__":M===null}function v(M){return!!Ne&&Ne in M}function g(M){var Y=M&&M.constructor,ne=typeof Y=="function"&&Y.prototype||F;return M===ne}function d(M){return qe.call(M)}function p(M){if(M!=null){try{return K.call(M)}catch{}try{return M+""}catch{}}return""}function f(M,Y){return M===Y||M!==M&&Y!==Y}var m=La(function(){return arguments}())?La:function(M){return Lt(M)&&ye.call(M,"callee")&&!J.call(M,"callee")},y=Array.isArray;function k(M){return M!=null&&ke(M.length)&&!U(M)}var E=Z||Cr;function L(M,Y){return Ti(M,Y)}function U(M){if(!Ye(M))return!1;var Y=Nr(M);return Y==b||Y==$||Y==l||Y==se}function ke(M){return typeof M=="number"&&M>-1&&M%1==0&&M<=s}function Ye(M){var Y=typeof M;return M!=null&&(Y=="object"||Y=="function")}function Lt(M){return M!=null&&typeof M=="object"}var Ze=R?me(R):Bo;function hr(M){return k(M)?Uo(M):qo(M)}function ur(){return[]}function Cr(){return!1}e.exports=L})(Hv,Hv.exports);var Fy={exports:{}},$8=nt,T8=$8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),k8=nt,E8=Wt,I8=fi,e_=T8,pc=Object.isExtensible,C8=k8(function(){pc(1)}),R8=C8||e_?function(t){return!E8(t)||e_&&I8(t)=="ArrayBuffer"?!1:pc?pc(t):!0}:pc,A8=nt,O8=!A8(function(){return Object.isExtensible(Object.preventExtensions({}))}),P8=st,M8=et,x8=Ku,N8=Wt,Dy=Gt,L8=Qt.f,t_=di,j8=ny,By=R8,U8=Gu,F8=O8,bk=!1,ba=U8("meta"),D8=0,qy=function(e){L8(e,ba,{value:{objectID:"O"+D8++,weakData:{}}})},B8=function(e,t){if(!N8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!Dy(e,ba)){if(!By(e))return"F";if(!t)return"E";qy(e)}return e[ba].objectID},q8=function(e,t){if(!Dy(e,ba)){if(!By(e))return!0;if(!t)return!1;qy(e)}return e[ba].weakData},H8=function(e){return F8&&bk&&By(e)&&!Dy(e,ba)&&qy(e),e},W8=function(){G8.enable=function(){},bk=!0;var e=t_.f,t=M8([].splice),r={};r[ba]=1,e(r).length&&(t_.f=function(n){for(var a=e(n),i=0,s=a.length;i<s;i++)if(a[i]===ba){t(a,i,1);break}return a},P8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:j8.f}))},G8=Fy.exports={enable:W8,fastKey:B8,getWeakData:q8,onFreeze:H8};x8[ba]=!0;var z8=st,V8=lt,K8=et,r_=cf,Y8=Sr,J8=Fy.exports,Q8=Sf,X8=ls,Z8=Rt,eH=Xn,ip=Wt,sp=nt,tH=$f,rH=Ca,nH=Cy,wk=function(e,t,r){var n=e.indexOf("Map")!==-1,a=e.indexOf("Weak")!==-1,i=n?"set":"add",s=V8[e],u=s&&s.prototype,o=s,l={},c=function(j){var D=K8(u[j]);Y8(u,j,j=="add"?function(se){return D(this,se===0?0:se),this}:j=="delete"?function(ve){return a&&!ip(ve)?!1:D(this,ve===0?0:ve)}:j=="get"?function(se){return a&&!ip(se)?void 0:D(this,se===0?0:se)}:j=="has"?function(se){return a&&!ip(se)?!1:D(this,se===0?0:se)}:function(se,Pe){return D(this,se===0?0:se,Pe),this})},h=r_(e,!Z8(s)||!(a||u.forEach&&!sp(function(){new s().entries().next()})));if(h)o=r.getConstructor(t,e,n,i),J8.enable();else if(r_(e,!0)){var w=new o,b=w[i](a?{}:-0,1)!=w,$=sp(function(){w.has(1)}),C=tH(function(j){new s(j)}),I=!a&&sp(function(){for(var j=new s,D=5;D--;)j[i](D,D);return!j.has(-0)});C||(o=t(function(j,D){X8(j,u);var ve=nH(new s,j,o);return eH(D)||Q8(D,ve[i],{that:ve,AS_ENTRIES:n}),ve}),o.prototype=u,u.constructor=o),($||I)&&(c("delete"),c("has"),n&&c("get")),(I||b)&&c(i),a&&u.clear&&delete u.clear}return l[e]=o,z8({global:!0,constructor:!0,forced:o!=s},l),rH(o,e),a||r.setStrong(o,e,n),o},aH=Sr,Hy=function(e,t,r){for(var n in t)aH(e,n,t[n],r);return e},iH=Qt.f,sH=vi,n_=Hy,oH=Aa,uH=ls,lH=Xn,cH=Sf,fH=Sy,Dl=$y,dH=mf,Yo=Dt,a_=Fy.exports.fastKey,_k=yn,i_=_k.set,op=_k.getterFor,Sk={getConstructor:function(e,t,r,n){var a=e(function(l,c){uH(l,i),i_(l,{type:t,index:sH(null),first:void 0,last:void 0,size:0}),Yo||(l.size=0),lH(c)||cH(c,l[n],{that:l,AS_ENTRIES:r})}),i=a.prototype,s=op(t),u=function(l,c,h){var w=s(l),b=o(l,c),$,C;return b?b.value=h:(w.last=b={index:C=a_(c,!0),key:c,value:h,previous:$=w.last,next:void 0,removed:!1},w.first||(w.first=b),$&&($.next=b),Yo?w.size++:l.size++,C!=="F"&&(w.index[C]=b)),l},o=function(l,c){var h=s(l),w=a_(c),b;if(w!=="F")return h.index[w];for(b=h.first;b;b=b.next)if(b.key==c)return b};return n_(i,{clear:function(){for(var c=this,h=s(c),w=h.index,b=h.first;b;)b.removed=!0,b.previous&&(b.previous=b.previous.next=void 0),delete w[b.index],b=b.next;h.first=h.last=void 0,Yo?h.size=0:c.size=0},delete:function(l){var c=this,h=s(c),w=o(c,l);if(w){var b=w.next,$=w.previous;delete h.index[w.index],w.removed=!0,$&&($.next=b),b&&(b.previous=$),h.first==w&&(h.first=b),h.last==w&&(h.last=$),Yo?h.size--:c.size--}return!!w},forEach:function(c){for(var h=s(this),w=oH(c,arguments.length>1?arguments[1]:void 0),b;b=b?b.next:h.first;)for(w(b.value,b.key,this);b&&b.removed;)b=b.previous},has:function(c){return!!o(this,c)}}),n_(i,r?{get:function(c){var h=o(this,c);return h&&h.value},set:function(c,h){return u(this,c===0?0:c,h)}}:{add:function(c){return u(this,c=c===0?0:c,c)}}),Yo&&iH(i,"size",{get:function(){return s(this).size}}),a},setStrong:function(e,t,r){var n=t+" Iterator",a=op(t),i=op(n);fH(e,t,function(s,u){i_(this,{type:n,target:s,state:a(s),kind:u,last:void 0})},function(){for(var s=i(this),u=s.kind,o=s.last;o&&o.removed;)o=o.previous;return!s.target||!(s.last=o=o?o.next:s.state.first)?(s.target=void 0,Dl(void 0,!0)):u=="keys"?Dl(o.key,!1):u=="values"?Dl(o.value,!1):Dl([o.key,o.value],!1)},r?"entries":"values",!r,!0),dH(t)}},pH=wk,vH=Sk;pH("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},vH);var Ma={};/*
@license
Copyright (c) 2016, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/Object.defineProperty(Ma,"__esModule",{value:!0});var hH=Un.exports,yH=ta.exports,gH=hi.exports,mH=Nn.exports,bH=Ln.exports,wH=Xr.exports,_H=yi.exports;function fs(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Wy=fs(hH),Gy=fs(yH),pa=fs(gH),zy=fs(mH),$k=fs(bH),Ac=fs(wH),va=fs(_H),SH;function ni(){}ni.prototype=Object.create(null);function Tt(){Tt.init.call(this)}Tt.EventEmitter=Tt;Tt.usingDomains=!1;Tt.prototype.domain=void 0;Tt.prototype._events=void 0;Tt.prototype._maxListeners=void 0;Tt.defaultMaxListeners=10;Tt.init=function(){this.domain=null,Tt.usingDomains&&SH.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new ni,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Tt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function Tk(e){return e._maxListeners===void 0?Tt.defaultMaxListeners:e._maxListeners}Tt.prototype.getMaxListeners=function(){return Tk(this)};function $H(e,t,r){if(t)e.call(r);else for(var n=e.length,a=cl(e,n),i=0;i<n;++i)a[i].call(r)}function TH(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=cl(e,a),s=0;s<a;++s)i[s].call(r,n)}function kH(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,s=cl(e,i),u=0;u<i;++u)s[u].call(r,n,a)}function EH(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var s=e.length,u=cl(e,s),o=0;o<s;++o)u[o].call(r,n,a,i)}function IH(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=cl(e,a),s=0;s<a;++s)i[s].apply(r,n)}Tt.prototype.emit=function(t){var r,n,a,i,s,u,o,l=t==="error";if(u=this._events,u)l=l&&u.error==null;else if(!l)return!1;if(o=this.domain,l){if(r=arguments[1],o)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=o,r.domainThrown=!1,o.emit("error",r);else{if(r instanceof Error)throw r;var c=new Error('Uncaught, unspecified "error" event. ('+r+")");throw c.context=r,c}return!1}if(n=u[t],!n)return!1;var h=typeof n=="function";switch(a=arguments.length,a){case 1:$H(n,h,this);break;case 2:TH(n,h,this,arguments[1]);break;case 3:kH(n,h,this,arguments[1],arguments[2]);break;case 4:EH(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(a-1),s=1;s<a;s++)i[s-1]=arguments[s];IH(n,h,this,i)}return!0};function kk(e,t,r,n){var a,i,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=new ni,e._eventsCount=0),!s)s=i[t]=r,++e._eventsCount;else if(typeof s=="function"?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(a=Tk(e),a&&a>0&&s.length>a)){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,CH(u)}return e}function CH(e){typeof console.warn=="function"?console.warn(e):console.log(e)}Tt.prototype.addListener=function(t,r){return kk(this,t,r,!1)};Tt.prototype.on=Tt.prototype.addListener;Tt.prototype.prependListener=function(t,r){return kk(this,t,r,!0)};function Ek(e,t,r){var n=!1;function a(){e.removeListener(t,a),n||(n=!0,r.apply(e,arguments))}return a.listener=r,a}Tt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,Ek(this,t,r)),this};Tt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,Ek(this,t,r)),this};Tt.prototype.removeListener=function(t,r){var n,a,i,s,u;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=this._events,!a)return this;if(n=a[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new ni:(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){u=n[s].listener,i=s;break}if(i<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new ni,this;delete a[t]}else RH(n,i);a.removeListener&&this.emit("removeListener",t,u||r)}return this};Tt.prototype.off=function(e,t){return this.removeListener(e,t)};Tt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new ni,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new ni:delete n[t]),this;if(arguments.length===0){for(var a=Object.keys(n),i=0,s;i<a.length;++i)s=a[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new ni,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};Tt.prototype.listeners=function(t){var r,n,a=this._events;return a?(r=a[t],r?typeof r=="function"?n=[r.listener||r]:n=AH(r):n=[]):n=[],n};Tt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Ik.call(e,t)};Tt.prototype.listenerCount=Ik;function Ik(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}Tt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function RH(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}function cl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function AH(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function Ck(e){var t=OH();return function(){var n=Ac.default(e),a;if(t){var i=Ac.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $k.default(this,a)}}function OH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Rk=function(e){zy.default(r,e);var t=Ck(r);function r(n){var a;return Wy.default(this,r),a=t.call(this),va.default(pa.default(a),"timeout",null),va.default(pa.default(a),"startTimestamp",-1),a.minDelay=n.min,a.maxDelay=n.max,a.initialDelay=n.initial||0,a.maxAttemptsCount=n.maxAttemptsCount||0,a.maxAttemptsTime=n.maxAttemptsTime||0,a.randomness=n.randomness||0,a.inProgress=!1,a.attemptNum=0,a.prevDelay=0,a.currDelay=0,a}return Gy.default(r,[{key:"attempt",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.attemptNum++,this.emit("attempt",this)}},{key:"nextDelay",value:function(a){if(typeof a=="number")return this.prevDelay=0,this.currDelay=a,a;if(this.attemptNum==0)return this.initialDelay;if(this.attemptNum==1)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;var i=this.currDelay+this.prevDelay;return this.maxDelay&&i>this.maxDelay&&(this.currDelay=this.maxDelay,i=this.maxDelay),this.currDelay=i,i}},{key:"randomize",value:function(a){var i=a*this.randomness,s=Math.round(Math.random()*i*2-i);return Math.max(0,a+s)}},{key:"scheduleAttempt",value:function(a){var i=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount){this.cleanup(),this.emit("failed",new Error("Maximum attempt count limit reached"));return}var s=this.nextDelay(a);if(s=this.randomize(s),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+s){this.cleanup(),this.emit("failed",new Error("Maximum attempt time limit reached"));return}this.timeout=setTimeout(function(){return i.attempt()},s)}},{key:"cleanup",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}},{key:"start",value:function(){if(this.inProgress)throw new Error("Retrier is already in progress");this.inProgress=!0,this.startTimestamp=Date.now(),this.scheduleAttempt(this.initialDelay)}},{key:"cancel",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"))}},{key:"succeeded",value:function(a){this.emit("succeeded",a)}},{key:"failed",value:function(a,i){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(i)}}]),r}(Tt),PH=function(e){zy.default(r,e);var t=Ck(r);function r(n){var a;return Wy.default(this,r),a=t.call(this),va.default(pa.default(a),"resolve",function(){}),va.default(pa.default(a),"reject",function(){}),a.retrier=new Rk(n),a}return Gy.default(r,[{key:"run",value:function(a){var i=this;return this.retrier.on("attempt",function(){a().then(function(s){return i.retrier.succeeded(s)}).catch(function(s){return i.retrier.failed(s)})}),this.retrier.on("succeeded",function(s){return i.resolve(s)}),this.retrier.on("cancelled",function(){return i.reject(new Error("Cancelled"))}),this.retrier.on("failed",function(s){return i.reject(s)}),new Promise(function(s,u){i.resolve=s,i.reject=u,i.retrier.start()})}},{key:"cancel",value:function(){this.retrier.cancel()}}]),r}(Tt);function MH(e){var t=xH();return function(){var n=Ac.default(e),a;if(t){var i=Ac.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return $k.default(this,a)}}function xH(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Bl(e){return e!=null}var NH=function(e){zy.default(r,e);var t=MH(r);function r(n){var a;Wy.default(this,r),a=t.call(this),va.default(pa.default(a),"backoffDelay",0),va.default(pa.default(a),"nextBackoffDelay",0),va.default(pa.default(a),"backoffNumber",0),va.default(pa.default(a),"timeoutID",null),va.default(pa.default(a),"maxNumberOfRetry",-1),n=n||{};var i=n,s=i.initialDelay,u=i.maxDelay,o=i.randomisationFactor,l=i.factor;if(Bl(s)&&s<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(Bl(u)&&u<=1)throw new Error("The maximal timeout must be greater than 1.");if(Bl(o)&&(o<0||o>1))throw new Error("The randomisation factor must be between 0 and 1.");if(Bl(l)&&l<=1)throw new Error("Exponential factor should be greater than 1.");if(a.initialDelay=s||100,a.maxDelay=u||1e4,a.maxDelay<=a.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");return a.randomisationFactor=o||0,a.factor=l||2,a.reset(),a}return Gy.default(r,[{key:"backoff",value:function(a){this.timeoutID==null&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",a),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,a)))}},{key:"reset",value:function(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=null}},{key:"failAfter",value:function(a){if(a<=0)throw new Error("Expected a maximum number of retry greater than 0 but got ".concat(a));this.maxNumberOfRetry=a}},{key:"next",value:function(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;var a=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*a))}},{key:"onBackoff",value:function(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}],[{key:"exponential",value:function(a){return new r(a)}}]),r}(Tt);Ma.AsyncRetrier=PH;Ma.Backoff=NH;Ma.Retrier=Rk;var xf={},LH=Ct,jH=Gt,UH=ka,FH=QT,s_=RegExp.prototype,DH=function(e){var t=e.flags;return t===void 0&&!("flags"in s_)&&!jH(e,"flags")&&UH(s_,e)?LH(FH,e):t},BH=Vu.PROPER,qH=Sr,HH=Vt,o_=or,WH=nt,GH=DH,Vy="toString",zH=RegExp.prototype,Ak=zH[Vy],VH=WH(function(){return Ak.call({source:"a",flags:"b"})!="/a/b"}),KH=BH&&Ak.name!=Vy;(VH||KH)&&qH(RegExp.prototype,Vy,function(){var t=HH(this),r=o_(t.source),n=o_(GH(t));return"/"+r+"/"+n},{unsafe:!0});var Tr={};/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(Tr,"__esModule",{value:!0});var YH=jn.exports,JH=gi.exports,QH=mi.exports,XH=Un.exports,ZH=Nn.exports,eW=Ln.exports,tW=Xr.exports;function ds(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Ys=ds(YH),Zi=ds(JH),up=ds(QH),rW=ds(XH),nW=ds(ZH),aW=ds(eW),u_=ds(tW),wi=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function iW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=sW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function sW(e,t){if(!!e){if(typeof e=="string")return l_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l_(e,t)}}function l_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Ok=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wi(function(a){var i=!1,s=[],u=iW(r),o;try{for(u.s();!(o=u.n()).done;){var l=o.value;if(typeof l=="string"){i=i||Ys.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){u.e(c)}finally{u.f()}return[i,s]})};function oW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=uW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function uW(e,t){if(!!e){if(typeof e=="string")return c_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c_(e,t)}}function c_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return wi(function(a){var i=!1,s=[],u=oW(r),o;try{for(u.s();!(o=u.n()).done;){var l=o.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){u.e(c)}finally{u.f()}return[i,s]})},cW=wi(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),fW=wi(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),dW=wi(function(e){return[Ys.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]});function pW(e){var t=vW();return function(){var n=u_.default(e),a;if(t){var i=u_.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return aW.default(this,a)}}function vW(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Nu(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=hW(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function hW(e,t){if(!!e){if(typeof e=="string")return f_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return f_(e,t)}}function f_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Nf=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=Nu(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=Zi.default(a.value,2),s=i[0],u=i[1],o=Jy(t[s],u),l=Zi.default(o,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(C){n.e(C)}finally{n.f()}},Pk=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(Ys.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),Ys.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=Ys.default(t)),n},yW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Ky(r);return function(i){return function(s){nW.default(o,s);var u=pW(o);function o(){rW.default(this,o);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Nf(a,c),u.call.apply(u,[this].concat(c))}return o}(i)}},gW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Ky(r);return function(i,s,u){if(typeof u.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var o=u.value;u.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Nf(a,c),o.apply(this,c)}}},mW=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Ky(r);return function(i,s,u){if(typeof u.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var o=u.value;u.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{Nf(a,c)}catch(w){return Promise.reject(w)}return o.apply(this,c)}}},Ky=function(t){var r=[],n=Nu(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Yy(i))}}catch(s){n.e(s)}finally{n.f()}return r},Yy=function(t){var r=[],n=Array.isArray(t)?t:[t],a=Nu(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(Ok(s));continue}r.push(s)}}catch(u){a.e(u)}finally{a.f()}return r},Jy=function(t,r){var n=[],a,i=!1,s=Nu(t),u;try{for(s.s();!(u=s.n()).done;){var o=u.value,l=Nu(o.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=Zi.default(w,3),$=b[0],C=b[1],I=b[2];i=i||$,!a&&I&&(a=I),C&&(n=typeof C=="string"?[].concat(up.default(n),[C]):[].concat(up.default(n),up.default(C)))}}catch(se){l.e(se)}finally{l.f()}}}catch(se){s.e(se)}finally{s.f()}if(i)return[!0];var j=a||Pk(r),D=n.length-1,ve=D>0?"".concat(n.slice(0,D).join(", ")," or ").concat(n[D]):n.join(", ");return[!1,j,ve,D>1?";":","]},bW=function(t,r){return wi(function(n){if(Ys.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=Zi.default(i[a],2),u=s[0],o=s[1],l=Jy(Yy(o),n[u]),c=Zi.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(u,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(u,'" is ').concat(w,")")]}return[!0]})};function wW(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_W(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function _W(e,t){if(!!e){if(typeof e=="string")return d_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return d_(e,t)}}function d_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var SW=function(t,r){return wi(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=wW(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=Zi.default(i.value,2),u=s[0],o=s[1],l=Jy(Yy(r),o),c=Zi.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(u," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(u," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};Tr.array=SW;Tr.custom=wi;Tr.literal=lW;Tr.nonEmptyString=cW;Tr.nonNegativeInteger=fW;Tr.objectSchema=bW;Tr.pureObject=dW;Tr.runtimeTypeValidation=Nf;Tr.stringifyReceivedType=Pk;Tr.type=Ok;Tr.validateConstructorTypes=yW;Tr.validateTypes=gW;Tr.validateTypesAsync=mW;var $W=wk,TW=Sk;$W("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},TW);var Mk={exports:{}};(function(e,t){(function(n,a){e.exports=a()})(Rn,function(){return function(r){var n={};function a(i){if(n[i])return n[i].exports;var s=n[i]={i,l:!1,exports:{}};return r[i].call(s.exports,s,s.exports,a),s.l=!0,s.exports}return a.m=r,a.c=n,a.i=function(i){return i},a.d=function(i,s,u){a.o(i,s)||Object.defineProperty(i,s,{configurable:!1,enumerable:!0,get:u})},a.n=function(i){var s=i&&i.__esModule?function(){return i.default}:function(){return i};return a.d(s,"a",s),s},a.o=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)},a.p="",a(a.s=5)}([function(r,n,a){r.exports=function(i,s){var u,o,l;for(u=1;u<arguments.length;u++){o=arguments[u];for(l in o)o.hasOwnProperty(l)&&(i[l]=o[l])}return i}},function(r,n,a){var i=a(0);r.exports={build:function(s,u){var o,l,c,h=u.plugins;for(o=0,l=h.length;o<l;o++)c=h[o],c.methods&&i(s,c.methods),c.properties&&Object.defineProperties(s,c.properties)},hook:function(s,u,o){var l,c,h,w,b=s.config.plugins,$=[s.context];for(o&&($=$.concat(o)),l=0,c=b.length;l<c;l++)w=b[l],h=b[l][u],h&&h.apply(w,$)}}},function(r,n,a){function i(s){if(s.length===0)return s;var u,o,l=s.split(/[_-]/);if(l.length===1&&l[0][0].toLowerCase()===l[0][0])return s;for(o=l[0].toLowerCase(),u=1;u<l.length;u++)o=o+l[u].charAt(0).toUpperCase()+l[u].substring(1).toLowerCase();return o}i.prepended=function(s,u){return u=i(u),s+u[0].toUpperCase()+u.substring(1)},r.exports=i},function(r,n,a){var i=a(0),s=a(2);function u(o,l){o=o||{},this.options=o,this.defaults=l.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(o.init),this.data=this.configureData(o.data),this.methods=this.configureMethods(o.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(o.transitions||[]),this.plugins=this.configurePlugins(o.plugins,l.plugin)}i(u.prototype,{addState:function(o){this.map[o]||(this.states.push(o),this.addStateLifecycleNames(o),this.map[o]={})},addStateLifecycleNames:function(o){this.lifecycle.onEnter[o]=s.prepended("onEnter",o),this.lifecycle.onLeave[o]=s.prepended("onLeave",o),this.lifecycle.on[o]=s.prepended("on",o)},addTransition:function(o){this.transitions.indexOf(o)<0&&(this.transitions.push(o),this.addTransitionLifecycleNames(o))},addTransitionLifecycleNames:function(o){this.lifecycle.onBefore[o]=s.prepended("onBefore",o),this.lifecycle.onAfter[o]=s.prepended("onAfter",o),this.lifecycle.on[o]=s.prepended("on",o)},mapTransition:function(o){var l=o.name,c=o.from,h=o.to;return this.addState(c),typeof h!="function"&&this.addState(h),this.addTransition(l),this.map[c][l]=o,o},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(o){return typeof o=="string"?this.mapTransition(i({},this.defaults.init,{to:o,active:!0})):typeof o=="object"?this.mapTransition(i({},this.defaults.init,o,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(o){return typeof o=="function"?o:typeof o=="object"?function(){return o}:function(){return{}}},configureMethods:function(o){return o||{}},configurePlugins:function(o,l){o=o||[];var c,h,w;for(c=0,h=o.length;c<h;c++)w=o[c],typeof w=="function"&&(o[c]=w=w()),w.configure&&w.configure(this);return o},configureTransitions:function(o){var l,c,h,w,b,$=this.defaults.wildcard;for(c=0;c<o.length;c++)for(h=o[c],w=Array.isArray(h.from)?h.from:[h.from||$],b=h.to||$,l=0;l<w.length;l++)this.mapTransition({name:h.name,from:w[l],to:b})},transitionFor:function(o,l){var c=this.defaults.wildcard;return this.map[o][l]||this.map[c][l]},transitionsFor:function(o){var l=this.defaults.wildcard;return Object.keys(this.map[o]).concat(Object.keys(this.map[l]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),r.exports=u},function(r,n,a){var i=a(0),s=a(6),u=a(1),o=[null,[]];function l(c,h){this.context=c,this.config=h,this.state=h.init.from,this.observers=[c]}i(l.prototype,{init:function(c){if(i(this.context,this.config.data.apply(this.context,c)),u.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(c){return Array.isArray(c)?c.indexOf(this.state)>=0:this.state===c},isPending:function(){return this.pending},can:function(c){return!this.isPending()&&!!this.seek(c)},cannot:function(c){return!this.can(c)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(c,h){var w=this.config.defaults.wildcard,b=this.config.transitionFor(this.state,c),$=b&&b.to;return typeof $=="function"?$.apply(this.context,h):$===w?this.state:$},fire:function(c,h){return this.transit(c,this.state,this.seek(c,h),h)},transit:function(c,h,w,b){var $=this.config.lifecycle,C=this.config.options.observeUnchangedState||h!==w;return w?this.isPending()?this.context.onPendingTransition(c,h,w):(this.config.addState(w),this.beginTransit(),b.unshift({transition:c,from:h,to:w,fsm:this.context}),this.observeEvents([this.observersForEvent($.onBefore.transition),this.observersForEvent($.onBefore[c]),C?this.observersForEvent($.onLeave.state):o,C?this.observersForEvent($.onLeave[h]):o,this.observersForEvent($.on.transition),C?["doTransit",[this]]:o,C?this.observersForEvent($.onEnter.state):o,C?this.observersForEvent($.onEnter[w]):o,C?this.observersForEvent($.on[w]):o,this.observersForEvent($.onAfter.transition),this.observersForEvent($.onAfter[c]),this.observersForEvent($.on[c])],b)):this.context.onInvalidTransition(c,h,w)},beginTransit:function(){this.pending=!0},endTransit:function(c){return this.pending=!1,c},failTransit:function(c){throw this.pending=!1,c},doTransit:function(c){this.state=c.to},observe:function(c){if(c.length===2){var h={};h[c[0]]=c[1],this.observers.push(h)}else this.observers.push(c[0])},observersForEvent:function(c){for(var h=0,w=this.observers.length,b,$=[];h<w;h++)b=this.observers[h],b[c]&&$.push(b);return[c,$,!0]},observeEvents:function(c,h,w,b){if(c.length===0)return this.endTransit(b===void 0?!0:b);var $=c[0][0],C=c[0][1],I=c[0][2];if(h[0].event=$,$&&I&&$!==w&&u.hook(this,"lifecycle",h),C.length===0)return c.shift(),this.observeEvents(c,h,$,b);var j=C.shift(),D=j[$].apply(j,h);return D&&typeof D.then=="function"?D.then(this.observeEvents.bind(this,c,h,$)).catch(this.failTransit.bind(this)):D===!1?this.endTransit(!1):this.observeEvents(c,h,$,D)},onInvalidTransition:function(c,h,w){throw new s("transition is invalid in current state",c,h,w,this.state)},onPendingTransition:function(c,h,w){throw new s("transition is invalid while previous transition is still in progress",c,h,w,this.state)}}),r.exports=l},function(r,n,a){var i=a(0),s=a(2),u=a(1),o=a(3),l=a(4),c={is:function(I){return this._fsm.is(I)},can:function(I){return this._fsm.can(I)},cannot:function(I){return this._fsm.cannot(I)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(I,j,D){return this._fsm.onInvalidTransition(I,j,D)},onPendingTransition:function(I,j,D){return this._fsm.onPendingTransition(I,j,D)}},h={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(I){throw Error("use transitions to change state")}}};function w(I){return $(this||{},I)}function b(){var I,j;typeof arguments[0]=="function"?(I=arguments[0],j=arguments[1]||{}):(I=function(){this._fsm.apply(this,arguments)},j=arguments[0]||{});var D=new o(j,w);return C(I.prototype,D),I.prototype._fsm.config=D,I}function $(I,j){var D=new o(j,w);return C(I,D),I._fsm(),I}function C(I,j){if(typeof I!="object"||Array.isArray(I))throw Error("StateMachine can only be applied to objects");u.build(I,j),Object.defineProperties(I,h),i(I,c),i(I,j.methods),j.allTransitions().forEach(function(D){I[s(D)]=function(){return this._fsm.fire(D,[].slice.call(arguments))}}),I._fsm=function(){this._fsm=new l(this,j),this._fsm.init(arguments)}}w.version="3.0.1",w.factory=b,w.apply=$,w.defaults={wildcard:"*",init:{name:"init",from:"none"}},r.exports=w},function(r,n,a){r.exports=function(i,s,u,o,l){this.message=i,this.transition=s,this.from=u,this.to=o,this.current=l}}])})})(Mk);var Oc={exports:{}},p_=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(p_){var v_=new Uint8Array(16);Oc.exports=function(){return p_(v_),v_}}else{var h_=new Array(16);Oc.exports=function(){for(var t=0,r;t<16;t++)(t&3)===0&&(r=Math.random()*4294967296),h_[t]=r>>>((t&3)<<3)&255;return h_}}var xk=[];for(var ql=0;ql<256;++ql)xk[ql]=(ql+256).toString(16).substr(1);function kW(e,t){var r=t||0,n=xk;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}var Nk=kW,EW=Oc.exports,IW=Nk,y_,lp,cp=0,fp=0;function CW(e,t,r){var n=t&&r||0,a=t||[];e=e||{};var i=e.node||y_,s=e.clockseq!==void 0?e.clockseq:lp;if(i==null||s==null){var u=EW();i==null&&(i=y_=[u[0]|1,u[1],u[2],u[3],u[4],u[5]]),s==null&&(s=lp=(u[6]<<8|u[7])&16383)}var o=e.msecs!==void 0?e.msecs:new Date().getTime(),l=e.nsecs!==void 0?e.nsecs:fp+1,c=o-cp+(l-fp)/1e4;if(c<0&&e.clockseq===void 0&&(s=s+1&16383),(c<0||o>cp)&&e.nsecs===void 0&&(l=0),l>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");cp=o,fp=l,lp=s,o+=122192928e5;var h=((o&268435455)*1e4+l)%4294967296;a[n++]=h>>>24&255,a[n++]=h>>>16&255,a[n++]=h>>>8&255,a[n++]=h&255;var w=o/4294967296*1e4&268435455;a[n++]=w>>>8&255,a[n++]=w&255,a[n++]=w>>>24&15|16,a[n++]=w>>>16&255,a[n++]=s>>>8|128,a[n++]=s&255;for(var b=0;b<6;++b)a[n+b]=i[b];return t||IW(a)}var RW=CW,AW=Oc.exports,OW=Nk;function PW(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var a=e.random||(e.rng||AW)();if(a[6]=a[6]&15|64,a[8]=a[8]&63|128,t)for(var i=0;i<16;++i)t[n+i]=a[i];return t||OW(a)}var MW=PW,xW=RW,Lk=MW,Qy=Lk;Qy.v1=xW;Qy.v4=Lk;var Lf=Qy,Wv={exports:{}},jk=typeof ArrayBuffer<"u"&&typeof DataView<"u",NW=jk,Xy=Dt,Pr=lt,Uk=Rt,jf=Wt,ci=Gt,Zy=Ra,LW=is,jW=Ea,Gv=Sr,UW=Qt.f,FW=ka,Uf=Tf,ko=$o,DW=At,BW=Gu,Fk=yn,Dk=Fk.enforce,qW=Fk.get,Pc=Pr.Int8Array,zv=Pc&&Pc.prototype,g_=Pr.Uint8ClampedArray,m_=g_&&g_.prototype,zn=Pc&&Uf(Pc),An=zv&&Uf(zv),HW=Object.prototype,eg=Pr.TypeError,b_=DW("toStringTag"),Vv=BW("TYPED_ARRAY_TAG"),Mc="TypedArrayConstructor",wa=NW&&!!ko&&Zy(Pr.opera)!=="Opera",Bk=!1,Fr,Ya,Js,_a={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},tg={BigInt64Array:8,BigUint64Array:8},WW=function(t){if(!jf(t))return!1;var r=Zy(t);return r==="DataView"||ci(_a,r)||ci(tg,r)},qk=function(e){var t=Uf(e);if(!!jf(t)){var r=qW(t);return r&&ci(r,Mc)?r[Mc]:qk(t)}},Hk=function(e){if(!jf(e))return!1;var t=Zy(e);return ci(_a,t)||ci(tg,t)},GW=function(e){if(Hk(e))return e;throw eg("Target is not a typed array")},zW=function(e){if(Uk(e)&&(!ko||FW(zn,e)))return e;throw eg(LW(e)+" is not a typed array constructor")},VW=function(e,t,r,n){if(!!Xy){if(r)for(var a in _a){var i=Pr[a];if(i&&ci(i.prototype,e))try{delete i.prototype[e]}catch{try{i.prototype[e]=t}catch{}}}(!An[e]||r)&&Gv(An,e,r?t:wa&&zv[e]||t,n)}},KW=function(e,t,r){var n,a;if(!!Xy){if(ko){if(r){for(n in _a)if(a=Pr[n],a&&ci(a,e))try{delete a[e]}catch{}}if(!zn[e]||r)try{return Gv(zn,e,r?t:wa&&zn[e]||t)}catch{}else return}for(n in _a)a=Pr[n],a&&(!a[e]||r)&&Gv(a,e,t)}};for(Fr in _a)Ya=Pr[Fr],Js=Ya&&Ya.prototype,Js?Dk(Js)[Mc]=Ya:wa=!1;for(Fr in tg)Ya=Pr[Fr],Js=Ya&&Ya.prototype,Js&&(Dk(Js)[Mc]=Ya);if((!wa||!Uk(zn)||zn===Function.prototype)&&(zn=function(){throw eg("Incorrect invocation")},wa))for(Fr in _a)Pr[Fr]&&ko(Pr[Fr],zn);if((!wa||!An||An===HW)&&(An=zn.prototype,wa))for(Fr in _a)Pr[Fr]&&ko(Pr[Fr].prototype,An);wa&&Uf(m_)!==An&&ko(m_,An);if(Xy&&!ci(An,b_)){Bk=!0,UW(An,b_,{get:function(){return jf(this)?this[Vv]:void 0}});for(Fr in _a)Pr[Fr]&&jW(Pr[Fr],Vv,Fr)}var Pt={NATIVE_ARRAY_BUFFER_VIEWS:wa,TYPED_ARRAY_TAG:Bk&&Vv,aTypedArray:GW,aTypedArrayConstructor:zW,exportTypedArrayMethod:VW,exportTypedArrayStaticMethod:KW,getTypedArrayConstructor:qk,isView:WW,isTypedArray:Hk,TypedArray:zn,TypedArrayPrototype:An},Wk=lt,dp=nt,YW=$f,JW=Pt.NATIVE_ARRAY_BUFFER_VIEWS,QW=Wk.ArrayBuffer,Mi=Wk.Int8Array,XW=!JW||!dp(function(){Mi(1)})||!dp(function(){new Mi(-1)})||!YW(function(e){new Mi,new Mi(null),new Mi(1.5),new Mi(e)},!0)||dp(function(){return new Mi(new QW(2),1,void 0).length!==1}),ZW=ea,eG=Ia,tG=RangeError,Gk=function(e){if(e===void 0)return 0;var t=ZW(e),r=eG(t);if(t!==r)throw tG("Wrong length or index");return r},rG=Array,nG=Math.abs,da=Math.pow,aG=Math.floor,iG=Math.log,sG=Math.LN2,oG=function(e,t,r){var n=rG(r),a=r*8-t-1,i=(1<<a)-1,s=i>>1,u=t===23?da(2,-24)-da(2,-77):0,o=e<0||e===0&&1/e<0?1:0,l=0,c,h,w;for(e=nG(e),e!=e||e===1/0?(h=e!=e?1:0,c=i):(c=aG(iG(e)/sG),w=da(2,-c),e*w<1&&(c--,w*=2),c+s>=1?e+=u/w:e+=u*da(2,1-s),e*w>=2&&(c++,w/=2),c+s>=i?(h=0,c=i):c+s>=1?(h=(e*w-1)*da(2,t),c=c+s):(h=e*da(2,s-1)*da(2,t),c=0));t>=8;)n[l++]=h&255,h/=256,t-=8;for(c=c<<t|h,a+=t;a>0;)n[l++]=c&255,c/=256,a-=8;return n[--l]|=o*128,n},uG=function(e,t){var r=e.length,n=r*8-t-1,a=(1<<n)-1,i=a>>1,s=n-7,u=r-1,o=e[u--],l=o&127,c;for(o>>=7;s>0;)l=l*256+e[u--],s-=8;for(c=l&(1<<-s)-1,l>>=-s,s+=t;s>0;)c=c*256+e[u--],s-=8;if(l===0)l=1-i;else{if(l===a)return c?NaN:o?-1/0:1/0;c=c+da(2,t),l=l-i}return(o?-1:1)*c*da(2,l-t)},lG={pack:oG,unpack:uG},cG=_r,w_=us,fG=cr,zk=function(t){for(var r=cG(this),n=fG(r),a=arguments.length,i=w_(a>1?arguments[1]:void 0,n),s=a>2?arguments[2]:void 0,u=s===void 0?n:w_(s,n);u>i;)r[i++]=t;return r},Ff=lt,rg=et,pp=Dt,dG=jk,Vk=Vu,__=Ea,S_=Hy,vp=nt,Hl=ls,pG=ea,vG=Ia,xc=Gk,Kk=lG,hG=Tf,$_=$o,yG=di.f,gG=Qt.f,mG=zk,bG=Xu,Yk=Ca,Jk=yn,wG=Vk.PROPER,T_=Vk.CONFIGURABLE,lo=Jk.get,k_=Jk.set,Nc="ArrayBuffer",Qk="DataView",Qs="prototype",_G="Wrong length",Xk="Wrong index",ln=Ff[Nc],zr=ln,Is=zr&&zr[Qs],Hn=Ff[Qk],xi=Hn&&Hn[Qs],E_=Object.prototype,SG=Ff.Array,Lc=Ff.RangeError,$G=rg(mG),TG=rg([].reverse),Zk=Kk.pack,I_=Kk.unpack,C_=function(e){return[e&255]},R_=function(e){return[e&255,e>>8&255]},A_=function(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]},O_=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},kG=function(e){return Zk(e,23,4)},EG=function(e){return Zk(e,52,8)},Wl=function(e,t){gG(e[Qs],t,{get:function(){return lo(this)[t]}})},qa=function(e,t,r,n){var a=xc(r),i=lo(e);if(a+t>i.byteLength)throw Lc(Xk);var s=lo(i.buffer).bytes,u=a+i.byteOffset,o=bG(s,u,u+t);return n?o:TG(o)},Ha=function(e,t,r,n,a,i){var s=xc(r),u=lo(e);if(s+t>u.byteLength)throw Lc(Xk);for(var o=lo(u.buffer).bytes,l=s+u.byteOffset,c=n(+a),h=0;h<t;h++)o[l+h]=c[i?h:t-h-1]};if(!dG)zr=function(t){Hl(this,Is);var r=xc(t);k_(this,{bytes:$G(SG(r),0),byteLength:r}),pp||(this.byteLength=r)},Is=zr[Qs],Hn=function(t,r,n){Hl(this,xi),Hl(t,Is);var a=lo(t).byteLength,i=pG(r);if(i<0||i>a)throw Lc("Wrong offset");if(n=n===void 0?a-i:vG(n),i+n>a)throw Lc(_G);k_(this,{buffer:t,byteLength:n,byteOffset:i}),pp||(this.buffer=t,this.byteLength=n,this.byteOffset=i)},xi=Hn[Qs],pp&&(Wl(zr,"byteLength"),Wl(Hn,"buffer"),Wl(Hn,"byteLength"),Wl(Hn,"byteOffset")),S_(xi,{getInt8:function(t){return qa(this,1,t)[0]<<24>>24},getUint8:function(t){return qa(this,1,t)[0]},getInt16:function(t){var r=qa(this,2,t,arguments.length>1?arguments[1]:void 0);return(r[1]<<8|r[0])<<16>>16},getUint16:function(t){var r=qa(this,2,t,arguments.length>1?arguments[1]:void 0);return r[1]<<8|r[0]},getInt32:function(t){return O_(qa(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return O_(qa(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return I_(qa(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return I_(qa(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,r){Ha(this,1,t,C_,r)},setUint8:function(t,r){Ha(this,1,t,C_,r)},setInt16:function(t,r){Ha(this,2,t,R_,r,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,r){Ha(this,2,t,R_,r,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,r){Ha(this,4,t,A_,r,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,r){Ha(this,4,t,A_,r,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,r){Ha(this,4,t,kG,r,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,r){Ha(this,8,t,EG,r,arguments.length>2?arguments[2]:void 0)}});else{var P_=wG&&ln.name!==Nc;if(!vp(function(){ln(1)})||!vp(function(){new ln(-1)})||vp(function(){return new ln,new ln(1.5),new ln(NaN),ln.length!=1||P_&&!T_})){zr=function(t){return Hl(this,Is),new ln(xc(t))},zr[Qs]=Is;for(var M_=yG(ln),x_=0,hp;M_.length>x_;)(hp=M_[x_++])in zr||__(zr,hp,ln[hp]);Is.constructor=zr}else P_&&T_&&__(ln,"name",Nc);$_&&hG(xi)!==E_&&$_(xi,E_);var Gl=new Hn(new zr(2)),N_=rg(xi.setInt8);Gl.setInt8(0,2147483648),Gl.setInt8(1,2147483649),(Gl.getInt8(0)||!Gl.getInt8(1))&&S_(xi,{setInt8:function(t,r){N_(this,t,r<<24>>24)},setUint8:function(t,r){N_(this,t,r<<24>>24)}},{unsafe:!0})}Yk(zr,Nc);Yk(Hn,Qk);var eE={ArrayBuffer:zr,DataView:Hn},IG=ea,CG=RangeError,RG=function(e){var t=IG(e);if(t<0)throw CG("The argument can't be less than 0");return t},AG=RG,OG=RangeError,tE=function(e,t){var r=AG(e);if(r%t)throw OG("Wrong offset");return r},PG=Ra,MG=et,xG=MG("".slice),NG=function(e){return xG(PG(e),0,3)==="Big"},LG=Vh,jG=TypeError,rE=function(e){var t=LG(e,"number");if(typeof t=="number")throw jG("Can't convert number to bigint");return BigInt(t)},UG=Aa,FG=Ct,DG=ey,BG=_r,qG=cr,HG=_f,WG=sl,GG=by,zG=NG,VG=Pt.aTypedArrayConstructor,KG=rE,YG=function(t){var r=DG(this),n=BG(t),a=arguments.length,i=a>1?arguments[1]:void 0,s=i!==void 0,u=WG(n),o,l,c,h,w,b,$,C;if(u&&!GG(u))for($=HG(n,u),C=$.next,n=[];!(b=FG(C,$)).done;)n.push(b.value);for(s&&a>2&&(i=UG(i,arguments[2])),l=qG(n),c=new(VG(r))(l),h=zG(c),o=0;l>o;o++)w=s?i(n[o],o):n[o],c[o]=h?KG(w):+w;return c},L_=st,nE=lt,j_=Ct,JG=Dt,QG=XW,Eo=Pt,aE=eE,U_=ls,XG=rs,Jo=Ea,ZG=ck,ez=Ia,F_=Gk,yp=tE,iE=zu,Qo=Gt,tz=Ra,Kv=Wt,rz=bo,nz=vi,az=ka,zl=$o,iz=di.f,D_=YG,sz=Qr.forEach,oz=mf,sE=Qt,oE=Qn,ng=yn,uz=Cy,Yv=ng.get,lz=ng.set,cz=ng.enforce,ag=sE.f,fz=oE.f,dz=Math.round,gp=nE.RangeError,uE=aE.ArrayBuffer,pz=uE.prototype,vz=aE.DataView,Vl=Eo.NATIVE_ARRAY_BUFFER_VIEWS,B_=Eo.TYPED_ARRAY_TAG,q_=Eo.TypedArray,Xo=Eo.TypedArrayPrototype,hz=Eo.aTypedArrayConstructor,Jv=Eo.isTypedArray,Kl="BYTES_PER_ELEMENT",mp="Wrong length",H_=function(e,t){hz(e);for(var r=0,n=t.length,a=new e(n);n>r;)a[r]=t[r++];return a},Yl=function(e,t){ag(e,t,{get:function(){return Yv(this)[t]}})},W_=function(e){var t;return az(pz,e)||(t=tz(e))=="ArrayBuffer"||t=="SharedArrayBuffer"},lE=function(e,t){return Jv(e)&&!rz(t)&&t in e&&ZG(+t)&&t>=0},G_=function(t,r){return r=iE(r),lE(t,r)?XG(2,t[r]):fz(t,r)},z_=function(t,r,n){return r=iE(r),lE(t,r)&&Kv(n)&&Qo(n,"value")&&!Qo(n,"get")&&!Qo(n,"set")&&!n.configurable&&(!Qo(n,"writable")||n.writable)&&(!Qo(n,"enumerable")||n.enumerable)?(t[r]=n.value,t):ag(t,r,n)};JG?(Vl||(oE.f=G_,sE.f=z_,Yl(Xo,"buffer"),Yl(Xo,"byteOffset"),Yl(Xo,"byteLength"),Yl(Xo,"length")),L_({target:"Object",stat:!0,forced:!Vl},{getOwnPropertyDescriptor:G_,defineProperty:z_}),Wv.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,a=e+(r?"Clamped":"")+"Array",i="get"+e,s="set"+e,u=nE[a],o=u,l=o&&o.prototype,c={},h=function(C,I){var j=Yv(C);return j.view[i](I*n+j.byteOffset,!0)},w=function(C,I,j){var D=Yv(C);r&&(j=(j=dz(j))<0?0:j>255?255:j&255),D.view[s](I*n+D.byteOffset,j,!0)},b=function(C,I){ag(C,I,{get:function(){return h(this,I)},set:function(j){return w(this,I,j)},enumerable:!0})};Vl?QG&&(o=t(function(C,I,j,D){return U_(C,l),uz(function(){return Kv(I)?W_(I)?D!==void 0?new u(I,yp(j,n),D):j!==void 0?new u(I,yp(j,n)):new u(I):Jv(I)?H_(o,I):j_(D_,o,I):new u(F_(I))}(),C,o)}),zl&&zl(o,q_),sz(iz(u),function(C){C in o||Jo(o,C,u[C])}),o.prototype=l):(o=t(function(C,I,j,D){U_(C,l);var ve=0,se=0,Pe,Me,le;if(!Kv(I))le=F_(I),Me=le*n,Pe=new uE(Me);else if(W_(I)){Pe=I,se=yp(j,n);var x=I.byteLength;if(D===void 0){if(x%n||(Me=x-se,Me<0))throw gp(mp)}else if(Me=ez(D)*n,Me+se>x)throw gp(mp);le=Me/n}else return Jv(I)?H_(o,I):j_(D_,o,I);for(lz(C,{buffer:Pe,byteOffset:se,byteLength:Me,length:le,view:new vz(Pe)});ve<le;)b(C,ve++)}),zl&&zl(o,q_),l=o.prototype=nz(Xo)),l.constructor!==o&&Jo(l,"constructor",o),cz(l).TypedArrayConstructor=o,B_&&Jo(l,B_,a);var $=o!=u;c[a]=o,L_({global:!0,constructor:!0,forced:$,sham:!Vl},c),Kl in o||Jo(o,Kl,n),Kl in l||Jo(l,Kl,n),oz(a)}):Wv.exports=function(){};var yz=Wv.exports;yz("Uint8",function(e){return function(r,n,a){return e(this,r,n,a)}});var V_=is,gz=TypeError,ig=function(e,t){if(!delete e[t])throw gz("Cannot delete property "+V_(t)+" of "+V_(e))},mz=_r,bp=us,bz=cr,wz=ig,_z=Math.min,Sz=[].copyWithin||function(t,r){var n=mz(this),a=bz(n),i=bp(t,a),s=bp(r,a),u=arguments.length>2?arguments[2]:void 0,o=_z((u===void 0?a:bp(u,a))-s,a-i),l=1;for(s<i&&i<s+o&&(l=-1,s+=o-1,i+=o-1);o-- >0;)s in n?n[i]=n[s]:wz(n,i),i+=l,s+=l;return n},$z=et,cE=Pt,Tz=Sz,kz=$z(Tz),Ez=cE.aTypedArray,Iz=cE.exportTypedArrayMethod;Iz("copyWithin",function(t,r){return kz(Ez(this),t,r,arguments.length>2?arguments[2]:void 0)});var fE=Pt,Cz=Qr.every,Rz=fE.aTypedArray,Az=fE.exportTypedArrayMethod;Az("every",function(t){return Cz(Rz(this),t,arguments.length>1?arguments[1]:void 0)});var dE=Pt,Oz=zk,Pz=rE,Mz=Ra,xz=Ct,Nz=et,Lz=nt,jz=dE.aTypedArray,Uz=dE.exportTypedArrayMethod,Fz=Nz("".slice),Dz=Lz(function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),e!==1});Uz("fill",function(t){var r=arguments.length;jz(this);var n=Fz(Mz(this),0,3)==="Big"?Pz(t):+t;return xz(Oz,this,n,r>1?arguments[1]:void 0,r>2?arguments[2]:void 0)},Dz);var Bz=cr,qz=function(e,t){for(var r=0,n=Bz(t),a=new e(n);n>r;)a[r]=t[r++];return a},pE=Pt,Hz=fy,Wz=pE.aTypedArrayConstructor,Gz=pE.getTypedArrayConstructor,Df=function(e){return Wz(Hz(e,Gz(e)))},zz=qz,Vz=Df,Kz=function(e,t){return zz(Vz(e),t)},vE=Pt,Yz=Qr.filter,Jz=Kz,Qz=vE.aTypedArray,Xz=vE.exportTypedArrayMethod;Xz("filter",function(t){var r=Yz(Qz(this),t,arguments.length>1?arguments[1]:void 0);return Jz(this,r)});var hE=Pt,Zz=Qr.find,eV=hE.aTypedArray,tV=hE.exportTypedArrayMethod;tV("find",function(t){return Zz(eV(this),t,arguments.length>1?arguments[1]:void 0)});var yE=Pt,rV=Qr.findIndex,nV=yE.aTypedArray,aV=yE.exportTypedArrayMethod;aV("findIndex",function(t){return rV(nV(this),t,arguments.length>1?arguments[1]:void 0)});var gE=Pt,iV=Qr.forEach,sV=gE.aTypedArray,oV=gE.exportTypedArrayMethod;oV("forEach",function(t){iV(sV(this),t,arguments.length>1?arguments[1]:void 0)});var mE=Pt,uV=lf.includes,lV=mE.aTypedArray,cV=mE.exportTypedArrayMethod;cV("includes",function(t){return uV(lV(this),t,arguments.length>1?arguments[1]:void 0)});var bE=Pt,fV=lf.indexOf,dV=bE.aTypedArray,pV=bE.exportTypedArrayMethod;pV("indexOf",function(t){return fV(dV(this),t,arguments.length>1?arguments[1]:void 0)});var vV=lt,hV=nt,sg=et,wE=Pt,og=GT,yV=At,ug=yV("iterator"),K_=vV.Uint8Array,gV=sg(og.values),mV=sg(og.keys),bV=sg(og.entries),lg=wE.aTypedArray,Bf=wE.exportTypedArrayMethod,Fs=K_&&K_.prototype,qf=!hV(function(){Fs[ug].call([1])}),_E=!!Fs&&Fs.values&&Fs[ug]===Fs.values&&Fs.values.name==="values",SE=function(){return gV(lg(this))};Bf("entries",function(){return bV(lg(this))},qf);Bf("keys",function(){return mV(lg(this))},qf);Bf("values",SE,qf||!_E,{name:"values"});Bf(ug,SE,qf||!_E,{name:"values"});var $E=Pt,wV=et,_V=$E.aTypedArray,SV=$E.exportTypedArrayMethod,$V=wV([].join);SV("join",function(t){return $V(_V(this),t)});var TV=pi,kV=Jr,EV=ea,IV=cr,CV=ol,RV=Math.min,Qv=[].lastIndexOf,TE=!!Qv&&1/[1].lastIndexOf(1,-0)<0,AV=CV("lastIndexOf"),OV=TE||!AV,PV=OV?function(t){if(TE)return TV(Qv,this,arguments)||0;var r=kV(this),n=IV(r),a=n-1;for(arguments.length>1&&(a=RV(a,EV(arguments[1]))),a<0&&(a=n+a);a>=0;a--)if(a in r&&r[a]===t)return a||0;return-1}:Qv,kE=Pt,MV=pi,xV=PV,NV=kE.aTypedArray,LV=kE.exportTypedArrayMethod;LV("lastIndexOf",function(t){var r=arguments.length;return MV(xV,NV(this),r>1?[t,arguments[1]]:[t])});var EE=Pt,jV=Qr.map,UV=Df,FV=EE.aTypedArray,DV=EE.exportTypedArrayMethod;DV("map",function(t){return jV(FV(this),t,arguments.length>1?arguments[1]:void 0,function(r,n){return new(UV(r))(n)})});var BV=xn,qV=_r,HV=Wu,WV=cr,GV=TypeError,Y_=function(e){return function(t,r,n,a){BV(r);var i=qV(t),s=HV(i),u=WV(i),o=e?u-1:0,l=e?-1:1;if(n<2)for(;;){if(o in s){a=s[o],o+=l;break}if(o+=l,e?o<0:u<=o)throw GV("Reduce of empty array with no initial value")}for(;e?o>=0:u>o;o+=l)o in s&&(a=r(a,s[o],o,i));return a}},cg={left:Y_(!1),right:Y_(!0)},IE=Pt,zV=cg.left,VV=IE.aTypedArray,KV=IE.exportTypedArrayMethod;KV("reduce",function(t){var r=arguments.length;return zV(VV(this),t,r,r>1?arguments[1]:void 0)});var CE=Pt,YV=cg.right,JV=CE.aTypedArray,QV=CE.exportTypedArrayMethod;QV("reduceRight",function(t){var r=arguments.length;return YV(JV(this),t,r,r>1?arguments[1]:void 0)});var RE=Pt,XV=RE.aTypedArray,ZV=RE.exportTypedArrayMethod,e7=Math.floor;ZV("reverse",function(){for(var t=this,r=XV(t).length,n=e7(r/2),a=0,i;a<n;)i=t[a],t[a++]=t[--r],t[r]=i;return t});var AE=lt,OE=Ct,fg=Pt,t7=cr,r7=tE,n7=_r,PE=nt,a7=AE.RangeError,Xv=AE.Int8Array,J_=Xv&&Xv.prototype,ME=J_&&J_.set,i7=fg.aTypedArray,s7=fg.exportTypedArrayMethod,Zv=!PE(function(){var e=new Uint8ClampedArray(2);return OE(ME,e,{length:1,0:3},1),e[1]!==3}),o7=Zv&&fg.NATIVE_ARRAY_BUFFER_VIEWS&&PE(function(){var e=new Xv(2);return e.set(1),e.set("2",1),e[0]!==0||e[1]!==2});s7("set",function(t){i7(this);var r=r7(arguments.length>1?arguments[1]:void 0,1),n=n7(t);if(Zv)return OE(ME,this,n,r);var a=this.length,i=t7(n),s=0;if(i+r>a)throw a7("Wrong length");for(;s<i;)this[r+s]=n[s++]},!Zv||o7);var xE=Pt,u7=Df,l7=nt,c7=wo,f7=xE.aTypedArray,d7=xE.exportTypedArrayMethod,p7=l7(function(){new Int8Array(1).slice()});d7("slice",function(t,r){for(var n=c7(f7(this),t,r),a=u7(this),i=0,s=n.length,u=new a(s);s>i;)u[i]=n[i++];return u},p7);var NE=Pt,v7=Qr.some,h7=NE.aTypedArray,y7=NE.exportTypedArrayMethod;y7("some",function(t){return v7(h7(this),t,arguments.length>1?arguments[1]:void 0)});var Q_=Xu,g7=Math.floor,eh=function(e,t){var r=e.length,n=g7(r/2);return r<8?m7(e,t):b7(e,eh(Q_(e,0,n),t),eh(Q_(e,n),t),t)},m7=function(e,t){for(var r=e.length,n=1,a,i;n<r;){for(i=n,a=e[n];i&&t(e[i-1],a)>0;)e[i]=e[--i];i!==n++&&(e[i]=a)}return e},b7=function(e,t,r,n){for(var a=t.length,i=r.length,s=0,u=0;s<a||u<i;)e[s+u]=s<a&&u<i?n(t[s],r[u])<=0?t[s++]:r[u++]:s<a?t[s++]:r[u++];return e},dg=eh,w7=ns,X_=w7.match(/firefox\/(\d+)/i),LE=!!X_&&+X_[1],_7=ns,jE=/MSIE|Trident/.test(_7),S7=ns,Z_=S7.match(/AppleWebKit\/(\d+)\./),UE=!!Z_&&+Z_[1],$7=lt,T7=et,th=nt,k7=xn,E7=dg,FE=Pt,eS=LE,I7=jE,tS=as,rS=UE,C7=FE.aTypedArray,R7=FE.exportTypedArrayMethod,Lu=$7.Uint16Array,Xs=Lu&&T7(Lu.prototype.sort),A7=!!Xs&&!(th(function(){Xs(new Lu(2),null)})&&th(function(){Xs(new Lu(2),{})})),nS=!!Xs&&!th(function(){if(tS)return tS<74;if(eS)return eS<67;if(I7)return!0;if(rS)return rS<602;var e=new Lu(516),t=Array(516),r,n;for(r=0;r<516;r++)n=r%4,e[r]=515-r,t[r]=r-2*n+3;for(Xs(e,function(a,i){return(a/4|0)-(i/4|0)}),r=0;r<516;r++)if(e[r]!==t[r])return!0}),O7=function(e){return function(t,r){return e!==void 0?+e(t,r)||0:r!==r?-1:t!==t?1:t===0&&r===0?1/t>0&&1/r<0?1:-1:t>r}};R7("sort",function(t){return t!==void 0&&k7(t),nS?Xs(this,t):E7(C7(this),O7(t))},!nS||A7);var DE=Pt,P7=Ia,aS=us,M7=Df,x7=DE.aTypedArray,N7=DE.exportTypedArrayMethod;N7("subarray",function(t,r){var n=x7(this),a=n.length,i=aS(t,a),s=M7(n);return new s(n.buffer,n.byteOffset+i*n.BYTES_PER_ELEMENT,P7((r===void 0?a:aS(r,a))-i))});var L7=lt,j7=pi,BE=Pt,rh=nt,iS=wo,jc=L7.Int8Array,sS=BE.aTypedArray,U7=BE.exportTypedArrayMethod,qE=[].toLocaleString,F7=!!jc&&rh(function(){qE.call(new jc(1))}),D7=rh(function(){return[1,2].toLocaleString()!=new jc([1,2]).toLocaleString()})||!rh(function(){jc.prototype.toLocaleString.call([1,2])});U7("toLocaleString",function(){return j7(qE,F7?iS(sS(this)):sS(this),iS(arguments))},D7);var B7=Pt.exportTypedArrayMethod,q7=nt,H7=lt,W7=et,oS=H7.Uint8Array,G7=oS&&oS.prototype||{},Uc=[].toString,z7=W7([].join);q7(function(){Uc.call({})})&&(Uc=function(){return z7(this)});var V7=G7.toString!=Uc;B7("toString",Uc,V7);var K7=Wt,Y7=fi,J7=At,Q7=J7("match"),HE=function(e){var t;return K7(e)&&((t=e[Q7])!==void 0?!!t:Y7(e)=="RegExp")},X7=pi,Zo=Ct,pg=et,Z7=If,eK=Vt,tK=Xn,rK=HE,uS=Zn,nK=fy,aK=My,iK=Ia,wp=or,sK=ss,lS=Xu,cS=Cf,oK=Ef,uK=XT,lK=nt,Cs=uK.UNSUPPORTED_Y,fS=4294967295,cK=Math.min,WE=[].push,fK=pg(/./.exec),Rs=pg(WE),eu=pg("".slice),dK=!lK(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});Z7("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(a,i){var s=wp(uS(this)),u=i===void 0?fS:i>>>0;if(u===0)return[];if(a===void 0)return[s];if(!rK(a))return Zo(t,s,a,u);for(var o=[],l=(a.ignoreCase?"i":"")+(a.multiline?"m":"")+(a.unicode?"u":"")+(a.sticky?"y":""),c=0,h=new RegExp(a.source,l+"g"),w,b,$;(w=Zo(oK,h,s))&&(b=h.lastIndex,!(b>c&&(Rs(o,eu(s,c,w.index)),w.length>1&&w.index<s.length&&X7(WE,o,lS(w,1)),$=w[0].length,c=b,o.length>=u)));)h.lastIndex===w.index&&h.lastIndex++;return c===s.length?($||!fK(h,""))&&Rs(o,""):Rs(o,eu(s,c)),o.length>u?lS(o,0,u):o}:"0".split(void 0,0).length?n=function(a,i){return a===void 0&&i===0?[]:Zo(t,this,a,i)}:n=t,[function(i,s){var u=uS(this),o=tK(i)?void 0:sK(i,e);return o?Zo(o,i,u,s):Zo(n,wp(u),i,s)},function(a,i){var s=eK(this),u=wp(a),o=r(n,s,u,i,n!==t);if(o.done)return o.value;var l=nK(s,RegExp),c=s.unicode,h=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(Cs?"g":"y"),w=new l(Cs?"^(?:"+s.source+")":s,h),b=i===void 0?fS:i>>>0;if(b===0)return[];if(u.length===0)return cS(w,u)===null?[u]:[];for(var $=0,C=0,I=[];C<u.length;){w.lastIndex=Cs?0:C;var j=cS(w,Cs?eu(u,C):u),D;if(j===null||(D=cK(iK(w.lastIndex+(Cs?C:0)),u.length))===$)C=aK(u,C,c);else{if(Rs(I,eu(u,$,C)),I.length===b)return I;for(var ve=1;ve<=j.length-1;ve++)if(Rs(I,j[ve]),I.length===b)return I;C=$=D}}return Rs(I,eu(u,$)),I}]},!dK,Cs);var vg={exports:{}},GE={exports:{}};(function(e){function t(r){return Function.toString.call(r).indexOf("[native code]")!==-1}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(GE);var zE={exports:{}},VE={exports:{}};(function(e){function t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(VE);(function(e){var t=gf.exports,r=VE.exports;function n(a,i,s){return r()?(e.exports=n=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=n=function(o,l,c){var h=[null];h.push.apply(h,l);var w=Function.bind.apply(o,h),b=new w;return c&&t(b,c.prototype),b},e.exports.__esModule=!0,e.exports.default=e.exports),n.apply(null,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(zE);(function(e){var t=Xr.exports,r=gf.exports,n=GE.exports,a=zE.exports;function i(s){var u=typeof Map=="function"?new Map:void 0;return e.exports=i=function(l){if(l===null||!n(l))return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(typeof u<"u"){if(u.has(l))return u.get(l);u.set(l,c)}function c(){return a(l,arguments,t(this).constructor)}return c.prototype=Object.create(l.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}),r(c,l)},e.exports.__esModule=!0,e.exports.default=e.exports,i(s)}e.exports=i,e.exports.__esModule=!0,e.exports.default=e.exports})(vg);var Fc={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */(function(e,t){(function(){var r={function:!0,object:!0},n=r[typeof window]&&window||this,a=t,i=e&&!e.nodeType&&e,s=a&&i&&typeof Rn=="object"&&Rn;s&&(s.global===s||s.window===s||s.self===s)&&(n=s);var u=Math.pow(2,53)-1,o=/\bOpera/,l=Object.prototype,c=l.hasOwnProperty,h=l.toString;function w(x){return x=String(x),x.charAt(0).toUpperCase()+x.slice(1)}function b(x,re,de){var X={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return re&&de&&/^Win/i.test(x)&&!/^Windows Phone /i.test(x)&&(X=X[/[\d.]+$/.exec(x)])&&(x="Windows "+X),x=String(x),re&&de&&(x=x.replace(RegExp(re,"i"),de)),x=C(x.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),x}function $(x,re){var de=-1,X=x?x.length:0;if(typeof X=="number"&&X>-1&&X<=u)for(;++de<X;)re(x[de],de,x);else I(x,re)}function C(x){return x=Pe(x),/^(?:webOS|i(?:OS|P))/.test(x)?x:w(x)}function I(x,re){for(var de in x)c.call(x,de)&&re(x[de],de,x)}function j(x){return x==null?w(x):h.call(x).slice(8,-1)}function D(x,re){var de=x!=null?typeof x[re]:"number";return!/^(?:boolean|number|string|undefined)$/.test(de)&&(de=="object"?!!x[re]:!0)}function ve(x){return String(x).replace(/([ -])(?!$)/g,"$1?")}function se(x,re){var de=null;return $(x,function(X,xe){de=re(de,X,xe,x)}),de}function Pe(x){return String(x).replace(/^ +| +$/g,"")}function Me(x){var re=n,de=x&&typeof x=="object"&&j(x)!="String";de&&(re=x,x=null);var X=re.navigator||{},xe=X.userAgent||"";x||(x=xe);var ce=de?!!X.likeChrome:/\bChrome\b/.test(x)&&!/internal|\n/i.test(h.toString()),te="Object",ue=de?te:"ScriptBridgingProxyObject",ie=de?te:"Environment",Ie=de&&re.java?"JavaPackage":j(re.java),$e=de?te:"RuntimeObject",N=/\bJava/.test(Ie)&&re.java,ct=N&&j(re.environment)==ie,ft=N?"a":"\u03B1",Te=N?"b":"\u03B2",Xe=re.document||{},Je=re.operamini||re.opera,B=o.test(B=de&&Je?Je["[[Class]]"]:j(Je))?B:Je=null,T,Se=x,pe=[],Ke=null,Qe=x==xe,we=Qe&&Je&&typeof Je.version=="function"&&Je.version(),Ge,O=Re([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),R=be(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),V=Q([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),fe=me({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),W=Ce(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function Re(ae){return se(ae,function(F,H){return F||RegExp("\\b"+(H.pattern||ve(H))+"\\b","i").exec(x)&&(H.label||H)})}function me(ae){return se(ae,function(F,H,K){return F||(H[V]||H[/^[a-z]+(?: +[a-z]+\b)*/i.exec(V)]||RegExp("\\b"+ve(K)+"(?:\\b|\\w*\\d)","i").exec(x))&&K})}function be(ae){return se(ae,function(F,H){return F||RegExp("\\b"+(H.pattern||ve(H))+"\\b","i").exec(x)&&(H.label||H)})}function Ce(ae){return se(ae,function(F,H){var K=H.pattern||ve(H);return!F&&(F=RegExp("\\b"+K+"(?:/[\\d.]+|[ \\w.]*)","i").exec(x))&&(F=b(F,K,H.label||H)),F})}function Q(ae){return se(ae,function(F,H){var K=H.pattern||ve(H);return!F&&(F=RegExp("\\b"+K+" *\\d+[.\\w_]*","i").exec(x)||RegExp("\\b"+K+" *\\w+-[\\w]*","i").exec(x)||RegExp("\\b"+K+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(x))&&((F=String(H.label&&!RegExp(K,"i").test(H.label)?H.label:F).split("/"))[1]&&!/[\d.]+/.test(F[0])&&(F[0]+=" "+F[1]),H=H.label||H,F=C(F[0].replace(RegExp(K,"i"),H).replace(RegExp("; *(?:"+H+"[_-])?","i")," ").replace(RegExp("("+H+")[-_.]?(\\w)","i"),"$1 $2"))),F})}function Fe(ae){return se(ae,function(F,H){return F||(RegExp(H+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(x)||0)[1]||null})}function Ue(){return this.description||""}if(O&&(O=[O]),/\bAndroid\b/.test(W)&&!V&&(T=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(x))&&(V=Pe(T[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),fe&&!V?V=Q([fe]):fe&&V&&(V=V.replace(RegExp("^("+ve(fe)+")[-_.\\s]","i"),fe+" ").replace(RegExp("^("+ve(fe)+")[-_.]?(\\w)","i"),fe+" $2")),(T=/\bGoogle TV\b/.exec(V))&&(V=T[0]),/\bSimulator\b/i.test(x)&&(V=(V?V+" ":"")+"Simulator"),R=="Opera Mini"&&/\bOPiOS\b/.test(x)&&pe.push("running in Turbo/Uncompressed mode"),R=="IE"&&/\blike iPhone OS\b/.test(x)?(T=Me(x.replace(/like iPhone OS/,"")),fe=T.manufacturer,V=T.product):/^iP/.test(V)?(R||(R="Safari"),W="iOS"+((T=/ OS ([\d_]+)/i.exec(x))?" "+T[1].replace(/_/g,"."):"")):R=="Konqueror"&&/^Linux\b/i.test(W)?W="Kubuntu":fe&&fe!="Google"&&(/Chrome/.test(R)&&!/\bMobile Safari\b/i.test(x)||/\bVita\b/.test(V))||/\bAndroid\b/.test(W)&&/^Chrome/.test(R)&&/\bVersion\//i.test(x)?(R="Android Browser",W=/\bAndroid\b/.test(W)?W:"Android"):R=="Silk"?(/\bMobi/i.test(x)||(W="Android",pe.unshift("desktop mode")),/Accelerated *= *true/i.test(x)&&pe.unshift("accelerated")):R=="UC Browser"&&/\bUCWEB\b/.test(x)?pe.push("speed mode"):R=="PaleMoon"&&(T=/\bFirefox\/([\d.]+)\b/.exec(x))?pe.push("identifying as Firefox "+T[1]):R=="Firefox"&&(T=/\b(Mobile|Tablet|TV)\b/i.exec(x))?(W||(W="Firefox OS"),V||(V=T[1])):!R||(T=!/\bMinefield\b/i.test(x)&&/\b(?:Firefox|Safari)\b/.exec(R))?(R&&!V&&/[\/,]|^[^(]+?\)/.test(x.slice(x.indexOf(T+"/")+8))&&(R=null),(T=V||fe||W)&&(V||fe||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(W))&&(R=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(W)?W:T)+" Browser")):R=="Electron"&&(T=(/\bChrome\/([\d.]+)\b/.exec(x)||0)[1])&&pe.push("Chromium "+T),we||(we=Fe(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",ve(R),"(?:Firefox|Minefield|NetFront)"])),(T=O=="iCab"&&parseFloat(we)>3&&"WebKit"||/\bOpera\b/.test(R)&&(/\bOPR\b/.test(x)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(x)&&!/^(?:Trident|EdgeHTML)$/.test(O)&&"WebKit"||!O&&/\bMSIE\b/i.test(x)&&(W=="Mac OS"?"Tasman":"Trident")||O=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(R)&&"NetFront")&&(O=[T]),R=="IE"&&(T=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(x)||0)[1])?(R+=" Mobile",W="Windows Phone "+(/\+$/.test(T)?T:T+".x"),pe.unshift("desktop mode")):/\bWPDesktop\b/i.test(x)?(R="IE Mobile",W="Windows Phone 8.x",pe.unshift("desktop mode"),we||(we=(/\brv:([\d.]+)/.exec(x)||0)[1])):R!="IE"&&O=="Trident"&&(T=/\brv:([\d.]+)/.exec(x))&&(R&&pe.push("identifying as "+R+(we?" "+we:"")),R="IE",we=T[1]),Qe){if(D(re,"global"))if(N&&(T=N.lang.System,Se=T.getProperty("os.arch"),W=W||T.getProperty("os.name")+" "+T.getProperty("os.version")),ct){try{we=re.require("ringo/engine").version.join("."),R="RingoJS"}catch{(T=re.system)&&T.global.system==re.system&&(R="Narwhal",W||(W=T[0].os||null))}R||(R="Rhino")}else typeof re.process=="object"&&!re.process.browser&&(T=re.process)&&(typeof T.versions=="object"&&(typeof T.versions.electron=="string"?(pe.push("Node "+T.versions.node),R="Electron",we=T.versions.electron):typeof T.versions.nw=="string"&&(pe.push("Chromium "+we,"Node "+T.versions.node),R="NW.js",we=T.versions.nw)),R||(R="Node.js",Se=T.arch,W=T.platform,we=/[\d.]+/.exec(T.version),we=we?we[0]:null));else j(T=re.runtime)==ue?(R="Adobe AIR",W=T.flash.system.Capabilities.os):j(T=re.phantom)==$e?(R="PhantomJS",we=(T=T.version||null)&&T.major+"."+T.minor+"."+T.patch):typeof Xe.documentMode=="number"&&(T=/\bTrident\/(\d+)/i.exec(x))?(we=[we,Xe.documentMode],(T=+T[1]+4)!=we[1]&&(pe.push("IE "+we[1]+" mode"),O&&(O[1]=""),we[1]=T),we=R=="IE"?String(we[1].toFixed(1)):we[0]):typeof Xe.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(R)&&(pe.push("masking as "+R+" "+we),R="IE",we="11.0",O=["Trident"],W="Windows");W=W&&C(W)}if(we&&(T=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(we)||/(?:alpha|beta)(?: ?\d)?/i.exec(x+";"+(Qe&&X.appMinorVersion))||/\bMinefield\b/i.test(x)&&"a")&&(Ke=/b/i.test(T)?"beta":"alpha",we=we.replace(RegExp(T+"\\+?$"),"")+(Ke=="beta"?Te:ft)+(/\d+\+?/.exec(T)||"")),R=="Fennec"||R=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(W))R="Firefox Mobile";else if(R=="Maxthon"&&we)we=we.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(V))V=="Xbox 360"&&(W=null),V=="Xbox 360"&&/\bIEMobile\b/.test(x)&&pe.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(R)||R&&!V&&!/Browser|Mobi/.test(R))&&(W=="Windows CE"||/Mobi/i.test(x)))R+=" Mobile";else if(R=="IE"&&Qe)try{re.external===null&&pe.unshift("platform preview")}catch{pe.unshift("embedded")}else(/\bBlackBerry\b/.test(V)||/\bBB10\b/.test(x))&&(T=(RegExp(V.replace(/ +/g," *")+"/([.\\d]+)","i").exec(x)||0)[1]||we)?(T=[T,/BB10/.test(x)],W=(T[1]?(V=null,fe="BlackBerry"):"Device Software")+" "+T[0],we=null):this!=I&&V!="Wii"&&(Qe&&Je||/Opera/.test(R)&&/\b(?:MSIE|Firefox)\b/i.test(x)||R=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(W)||R=="IE"&&(W&&!/^Win/.test(W)&&we>5.5||/\bWindows XP\b/.test(W)&&we>8||we==8&&!/\bTrident\b/.test(x)))&&!o.test(T=Me.call(I,x.replace(o,"")+";"))&&T.name&&(T="ing as "+T.name+((T=T.version)?" "+T:""),o.test(R)?(/\bIE\b/.test(T)&&W=="Mac OS"&&(W=null),T="identify"+T):(T="mask"+T,B?R=C(B.replace(/([a-z])([A-Z])/g,"$1 $2")):R="Opera",/\bIE\b/.test(T)&&(W=null),Qe||(we=null)),O=["Presto"],pe.push(T));(T=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(x)||0)[1])&&(T=[parseFloat(T.replace(/\.(\d)$/,".0$1")),T],R=="Safari"&&T[1].slice(-1)=="+"?(R="WebKit Nightly",Ke="alpha",we=T[1].slice(0,-1)):(we==T[1]||we==(T[2]=(/\bSafari\/([\d.]+\+?)/i.exec(x)||0)[1]))&&(we=null),T[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(x)||0)[1],T[0]==537.36&&T[2]==537.36&&parseFloat(T[1])>=28&&O=="WebKit"&&(O=["Blink"]),!Qe||!ce&&!T[1]?(O&&(O[1]="like Safari"),T=(T=T[0],T<400?1:T<500?2:T<526?3:T<533?4:T<534?"4+":T<535?5:T<537?6:T<538?7:T<601?8:T<602?9:T<604?10:T<606?11:T<608?12:"12")):(O&&(O[1]="like Chrome"),T=T[1]||(T=T[0],T<530?1:T<532?2:T<532.05?3:T<533?4:T<534.03?5:T<534.07?6:T<534.1?7:T<534.13?8:T<534.16?9:T<534.24?10:T<534.3?11:T<535.01?12:T<535.02?"13+":T<535.07?15:T<535.11?16:T<535.19?17:T<536.05?18:T<536.1?19:T<537.01?20:T<537.11?"21+":T<537.13?23:T<537.18?24:T<537.24?25:T<537.36?26:O!="Blink"?"27":"28")),O&&(O[1]+=" "+(T+=typeof T=="number"?".x":/[.+]/.test(T)?"":"+")),R=="Safari"&&(!we||parseInt(we)>45)?we=T:R=="Chrome"&&/\bHeadlessChrome/i.test(x)&&pe.unshift("headless")),R=="Opera"&&(T=/\bzbov|zvav$/.exec(W))?(R+=" ",pe.unshift("desktop mode"),T=="zvav"?(R+="Mini",we=null):R+="Mobile",W=W.replace(RegExp(" *"+T+"$"),"")):R=="Safari"&&/\bChrome\b/.exec(O&&O[1])?(pe.unshift("desktop mode"),R="Chrome Mobile",we=null,/\bOS X\b/.test(W)?(fe="Apple",W="iOS 4.3+"):W=null):/\bSRWare Iron\b/.test(R)&&!we&&(we=Fe("Chrome")),we&&we.indexOf(T=/[\d.]+$/.exec(W))==0&&x.indexOf("/"+T+"-")>-1&&(W=Pe(W.replace(T,""))),W&&W.indexOf(R)!=-1&&!RegExp(R+" OS").test(W)&&(W=W.replace(RegExp(" *"+ve(R)+" *"),"")),O&&!/\b(?:Avant|Nook)\b/.test(R)&&(/Browser|Lunascape|Maxthon/.test(R)||R!="Safari"&&/^iOS/.test(W)&&/\bSafari\b/.test(O[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(R)&&O[1])&&(T=O[O.length-1])&&pe.push(T),pe.length&&(pe=["("+pe.join("; ")+")"]),fe&&V&&V.indexOf(fe)<0&&pe.push("on "+fe),V&&pe.push((/^on /.test(pe[pe.length-1])?"":"on ")+V),W&&(T=/ ([\d.+]+)$/.exec(W),Ge=T&&W.charAt(W.length-T[0].length-1)=="/",W={architecture:32,family:T&&!Ge?W.replace(T[0],""):W,version:T?T[1]:null,toString:function(){var ae=this.version;return this.family+(ae&&!Ge?" "+ae:"")+(this.architecture==64?" 64-bit":"")}}),(T=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Se))&&!/\bi686\b/i.test(Se)?(W&&(W.architecture=64,W.family=W.family.replace(RegExp(" *"+T),"")),R&&(/\bWOW64\b/i.test(x)||Qe&&/\w(?:86|32)$/.test(X.cpuClass||X.platform)&&!/\bWin64; x64\b/i.test(x))&&pe.unshift("32-bit")):W&&/^OS X/.test(W.family)&&R=="Chrome"&&parseFloat(we)>=39&&(W.architecture=64),x||(x=null);var Ae={};return Ae.description=x,Ae.layout=O&&O[0],Ae.manufacturer=fe,Ae.name=R,Ae.prerelease=Ke,Ae.product=V,Ae.ua=x,Ae.version=R&&we,Ae.os=W||{architecture:null,family:null,version:null,toString:function(){return"null"}},Ae.parse=Me,Ae.toString=Ue,Ae.version&&pe.unshift(we),Ae.name&&pe.unshift(R),W&&R&&!(W==String(W).split(" ")[0]&&(W==R.split(" ")[0]||V))&&pe.push(V?"("+W+")":"on "+W),pe.length&&(Ae.description=pe.join(" ")),Ae}var le=Me();a&&i?I(le,function(x,re){a[re]=x}):n.platform=le}).call(Rn)})(Fc,Fc.exports);var pK=Ct,vK=If,hK=Vt,yK=Xn,gK=Ia,_p=or,mK=Zn,bK=ss,wK=My,dS=Cf;vK("match",function(e,t,r){return[function(a){var i=mK(this),s=yK(a)?void 0:bK(a,e);return s?pK(s,a,i):new RegExp(a)[e](_p(i))},function(n){var a=hK(this),i=_p(n),s=r(t,a,i);if(s.done)return s.value;if(!a.global)return dS(a,i);var u=a.unicode;a.lastIndex=0;for(var o=[],l=0,c;(c=dS(a,i))!==null;){var h=_p(c[0]);o[l]=h,h===""&&(a.lastIndex=wK(i,gK(a.lastIndex),u)),l++}return l===0?null:o}]});var _K=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},SK=Ct,$K=If,TK=Vt,kK=Xn,EK=Zn,pS=_K,vS=or,IK=ss,CK=Cf;$K("search",function(e,t,r){return[function(a){var i=EK(this),s=kK(a)?void 0:IK(a,e);return s?SK(s,a,i):new RegExp(a)[e](vS(i))},function(n){var a=TK(this),i=vS(n),s=r(t,a,i);if(s.done)return s.value;var u=a.lastIndex;pS(u,0)||(a.lastIndex=0);var o=CK(a,i);return pS(a.lastIndex,u)||(a.lastIndex=u),o===null?-1:o.index}]});var RK=Dt,AK=Zu,OK=TypeError,PK=Object.getOwnPropertyDescriptor,MK=RK&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),xK=MK?function(e,t){if(AK(e)&&!PK(e,"length").writable)throw OK("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},NK=st,LK=_r,jK=us,UK=ea,FK=cr,DK=xK,BK=OT,qK=iy,HK=_o,Sp=ig,WK=rl,GK=WK("splice"),zK=Math.max,VK=Math.min;NK({target:"Array",proto:!0,forced:!GK},{splice:function(t,r){var n=LK(this),a=FK(n),i=jK(t,a),s=arguments.length,u,o,l,c,h,w;for(s===0?u=o=0:s===1?(u=0,o=a-i):(u=s-2,o=VK(zK(UK(r),0),a-i)),BK(a+u-o),l=qK(n,o),c=0;c<o;c++)h=i+c,h in n&&HK(l,c,n[h]);if(l.length=o,u<o){for(c=i;c<a-o;c++)h=c+o,w=c+u,h in n?n[w]=n[h]:Sp(n,w);for(c=a;c>a-o+u;c--)Sp(n,c-1)}else if(u>o)for(c=a-o;c>i;c--)h=c+o-1,w=c+u-1,h in n?n[w]=n[h]:Sp(n,w);for(c=0;c<u;c++)n[c+i]=arguments[c+2];return DK(n,a-o+u),l}});/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.


*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=So.exports,n=ta.exports,a=hi.exports,i=Mf.exports,s=Nn.exports,u=Ln.exports,o=Xr.exports,l=Un.exports,c=yi.exports,h=ul,w=jn.exports,b=Tr,$=cs.exports,C=Mk.exports,I=Lf,j=vg.exports,D=Ma,ve=Fc.exports;function se(v){return v&&typeof v=="object"&&"default"in v?v:{default:v}}function Pe(v){if(v&&v.__esModule)return v;var g=Object.create(null);return v&&Object.keys(v).forEach(function(d){if(d!=="default"){var p=Object.getOwnPropertyDescriptor(v,d);Object.defineProperty(g,d,p.get?p:{enumerable:!0,get:function(){return v[d]}})}}),g.default=v,Object.freeze(g)}var Me=se(r),le=se(n),x=se(a),re=se(i),de=se(s),X=se(u),xe=se(o),ce=se(l),te=se(c),ue=se(h),ie=se(w),Ie=Pe($),$e=Pe(C),N=se(j),ct=Pe(ve);function ft(v,g,d,p){var f=arguments.length,m=f<3?g:p===null?p=Object.getOwnPropertyDescriptor(g,d):p,y;if((typeof Reflect>"u"?"undefined":ie.default(Reflect))==="object"&&typeof Reflect.decorate=="function")m=Reflect.decorate(v,g,d,p);else for(var k=v.length-1;k>=0;k--)(y=v[k])&&(m=(f<3?y(m):f>3?y(g,d,m):y(g,d))||m);return f>3&&m&&Object.defineProperty(g,d,m),m}function Te(v,g){if((typeof Reflect>"u"?"undefined":ie.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(v,g)}var Xe;function Je(){}Je.prototype=Object.create(null);function B(){B.init.call(this)}B.EventEmitter=B,B.usingDomains=!1,B.prototype.domain=void 0,B.prototype._events=void 0,B.prototype._maxListeners=void 0,B.defaultMaxListeners=10,B.init=function(){this.domain=null,B.usingDomains&&Xe.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Je,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},B.prototype.setMaxListeners=function(g){if(typeof g!="number"||g<0||isNaN(g))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=g,this};function T(v){return v._maxListeners===void 0?B.defaultMaxListeners:v._maxListeners}B.prototype.getMaxListeners=function(){return T(this)};function Se(v,g,d){if(g)v.call(d);else for(var p=v.length,f=W(v,p),m=0;m<p;++m)f[m].call(d)}function pe(v,g,d,p){if(g)v.call(d,p);else for(var f=v.length,m=W(v,f),y=0;y<f;++y)m[y].call(d,p)}function Ke(v,g,d,p,f){if(g)v.call(d,p,f);else for(var m=v.length,y=W(v,m),k=0;k<m;++k)y[k].call(d,p,f)}function Qe(v,g,d,p,f,m){if(g)v.call(d,p,f,m);else for(var y=v.length,k=W(v,y),E=0;E<y;++E)k[E].call(d,p,f,m)}function we(v,g,d,p){if(g)v.apply(d,p);else for(var f=v.length,m=W(v,f),y=0;y<f;++y)m[y].apply(d,p)}B.prototype.emit=function(g){var d,p,f,m,y,k,E,L=g==="error";if(k=this._events,k)L=L&&k.error==null;else if(!L)return!1;if(E=this.domain,L){if(d=arguments[1],E)d||(d=new Error('Uncaught, unspecified "error" event')),d.domainEmitter=this,d.domain=E,d.domainThrown=!1,E.emit("error",d);else{if(d instanceof Error)throw d;var U=new Error('Uncaught, unspecified "error" event. ('+d+")");throw U.context=d,U}return!1}if(p=k[g],!p)return!1;var ke=typeof p=="function";switch(f=arguments.length,f){case 1:Se(p,ke,this);break;case 2:pe(p,ke,this,arguments[1]);break;case 3:Ke(p,ke,this,arguments[1],arguments[2]);break;case 4:Qe(p,ke,this,arguments[1],arguments[2],arguments[3]);break;default:for(m=new Array(f-1),y=1;y<f;y++)m[y-1]=arguments[y];we(p,ke,this,m)}return!0};function Ge(v,g,d,p){var f,m,y;if(typeof d!="function")throw new TypeError('"listener" argument must be a function');if(m=v._events,m?(m.newListener&&(v.emit("newListener",g,d.listener?d.listener:d),m=v._events),y=m[g]):(m=v._events=new Je,v._eventsCount=0),!y)y=m[g]=d,++v._eventsCount;else if(typeof y=="function"?y=m[g]=p?[d,y]:[y,d]:p?y.unshift(d):y.push(d),!y.warned&&(f=T(v),f&&f>0&&y.length>f)){y.warned=!0;var k=new Error("Possible EventEmitter memory leak detected. "+y.length+" "+g+" listeners added. Use emitter.setMaxListeners() to increase limit");k.name="MaxListenersExceededWarning",k.emitter=v,k.type=g,k.count=y.length,O(k)}return v}function O(v){typeof console.warn=="function"?console.warn(v):console.log(v)}B.prototype.addListener=function(g,d){return Ge(this,g,d,!1)},B.prototype.on=B.prototype.addListener,B.prototype.prependListener=function(g,d){return Ge(this,g,d,!0)};function R(v,g,d){var p=!1;function f(){v.removeListener(g,f),p||(p=!0,d.apply(v,arguments))}return f.listener=d,f}B.prototype.once=function(g,d){if(typeof d!="function")throw new TypeError('"listener" argument must be a function');return this.on(g,R(this,g,d)),this},B.prototype.prependOnceListener=function(g,d){if(typeof d!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(g,R(this,g,d)),this},B.prototype.removeListener=function(g,d){var p,f,m,y,k;if(typeof d!="function")throw new TypeError('"listener" argument must be a function');if(f=this._events,!f)return this;if(p=f[g],!p)return this;if(p===d||p.listener&&p.listener===d)--this._eventsCount===0?this._events=new Je:(delete f[g],f.removeListener&&this.emit("removeListener",g,p.listener||d));else if(typeof p!="function"){for(m=-1,y=p.length;y-- >0;)if(p[y]===d||p[y].listener&&p[y].listener===d){k=p[y].listener,m=y;break}if(m<0)return this;if(p.length===1){if(p[0]=void 0,--this._eventsCount===0)return this._events=new Je,this;delete f[g]}else fe(p,m);f.removeListener&&this.emit("removeListener",g,k||d)}return this},B.prototype.off=function(v,g){return this.removeListener(v,g)},B.prototype.removeAllListeners=function(g){var d,p;if(p=this._events,!p)return this;if(!p.removeListener)return arguments.length===0?(this._events=new Je,this._eventsCount=0):p[g]&&(--this._eventsCount===0?this._events=new Je:delete p[g]),this;if(arguments.length===0){for(var f=Object.keys(p),m=0,y;m<f.length;++m)y=f[m],y!=="removeListener"&&this.removeAllListeners(y);return this.removeAllListeners("removeListener"),this._events=new Je,this._eventsCount=0,this}if(d=p[g],typeof d=="function")this.removeListener(g,d);else if(d)do this.removeListener(g,d[d.length-1]);while(d[0]);return this},B.prototype.listeners=function(g){var d,p,f=this._events;return f?(d=f[g],d?typeof d=="function"?p=[d.listener||d]:p=Re(d):p=[]):p=[],p},B.listenerCount=function(v,g){return typeof v.listenerCount=="function"?v.listenerCount(g):V.call(v,g)},B.prototype.listenerCount=V;function V(v){var g=this._events;if(g){var d=g[v];if(typeof d=="function")return 1;if(d)return d.length}return 0}B.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function fe(v,g){for(var d=g,p=d+1,f=v.length;p<f;d+=1,p+=1)v[d]=v[p];v.pop()}function W(v,g){for(var d=new Array(g);g--;)d[g]=v[g];return d}function Re(v){for(var g=new Array(v.length),d=0;d<g.length;++d)g[d]=v[d].listener||v[d];return g}var me=Ie.getLogger("twilsock");function be(v,g){return["".concat(new Date().toISOString()," Twilsock ").concat(v,":")].concat(Array.from(g))}var Ce=function(){function v(g){ce.default(this,v),te.default(this,"prefix",""),this.prefix=g!=null&&g.length>0?" "+g+":":""}return le.default(v,[{key:"setLevel",value:function(d){me.setLevel(d)}},{key:"trace",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];me.trace.apply(null,be("T",p))}},{key:"debug",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];me.debug.apply(null,be("D",p))}},{key:"info",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];me.info.apply(null,be("I",p))}},{key:"warn",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];me.warn.apply(null,be("W",p))}},{key:"error",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];me.error.apply(null,be("E",p))}}],[{key:"setLevel",value:function(d){me.setLevel(d)}},{key:"trace",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];me.trace.apply(null,be("T",p))}},{key:"debug",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];me.debug.apply(null,be("D",p))}},{key:"info",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];me.info.apply(null,be("I",p))}},{key:"warn",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];me.warn.apply(null,be("W",p))}},{key:"error",value:function(){for(var d=arguments.length,p=new Array(d),f=0;f<d;f++)p[f]=arguments[f];me.error.apply(null,be("E",p))}}]),v}(),Q=new Ce(""),Fe="0.12.2",Ue=function(){function v(g,d,p){ce.default(this,v),te.default(this,"confirmedCapabilities",new Set),this.activeGrant=d,this._token=g;var f=p.region||"us1",m="wss://tsock.".concat(f,".twilio.com/v3/wsconnect"),y=p.twilsock||p.Twilsock||{};this.url=y.uri||m,this._continuationToken=p.continuationToken?p.continuationToken:null,this.logLevel=p.logLevel?p.logLevel:"error",this.retryPolicy=p.retryPolicy?p.retryPolicy:{min:1*1e3,max:2*60*1e3,randomness:.2},this.clientMetadata=p.clientMetadata?p.clientMetadata:{},this.clientMetadata.ver=Fe,this.initRegistrations=p.initRegistrations?p.initRegistrations:null,this.tweaks=p.tweaks?p.tweaks:null}return le.default(v,[{key:"token",get:function(){return this._token}},{key:"continuationToken",get:function(){return this._continuationToken}},{key:"updateToken",value:function(d){this._token=d}},{key:"updateContinuationToken",value:function(d){this._continuationToken=d}}]),v}(),Ae=function v(g){ce.default(this,v),this.id=g||"TM".concat(I.v4())};function ae(v){var g=F();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var H=function(v){de.default(d,v);var g=ae(d);function d(p,f,m,y,k){var E;return ce.default(this,d),E=g.call(this),te.default(x.default(E),"method","init"),E.token=p,E.continuation_token=f,E.metadata=m,E.registrations=y,E.tweaks=k,E.capabilities=["client_update","offline_storage","telemetry.v1"],E}return d}(Ae);function K(v){var g=ye();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function ye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ne=function(v){de.default(d,v);var g=K(d);function d(p,f,m,y,k,E,L){var U;return ce.default(this,d),U=g.call(this,p),U.continuationToken=f,U.continuationTokenStatus=y,U.offlineStorage=k,U.initRegistrations=E,U.debugInfo=L,U.confirmedCapabilities=m,U}return d}(Ae);function qe(v){var g=ze();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function ze(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var De=function(v){de.default(d,v);var g=qe(d);function d(p){var f;return ce.default(this,d),f=g.call(this),te.default(x.default(f),"method","update"),f.token=p,f}return d}(Ae);function He(v){var g=Le();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function Le(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var J=function(v){de.default(d,v);var g=He(d);function d(p,f,m){var y;return ce.default(this,d),y=g.call(this),te.default(x.default(y),"method","message"),y.active_grant=p,y.payload_type=f,y.http_request=m,y}return d}(Ae);function ee(v){var g=q();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function q(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var z=function(v){de.default(d,v);var g=ee(d);function d(p){var f;return ce.default(this,d),f=g.call(this,p),te.default(x.default(f),"method","reply"),te.default(x.default(f),"payload_type","application/json"),te.default(x.default(f),"status",{code:200,status:"OK"}),f}return d}(Ae);function Z(v){var g=ge();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function ge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var oe=function(v){de.default(d,v);var g=Z(d);function d(){var p;return ce.default(this,d),p=g.call(this),te.default(x.default(p),"method","close"),p}return d}(Ae);function je(v){var g=Ve();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function Ve(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var at=function v(g,d,p,f,m,y){ce.default(this,v),this.start=g,this.end=d,this.title=p,this.details=f,this.id=m,this.type=y},tt=function(v){de.default(d,v);var g=je(d);function d(p){var f;return ce.default(this,d),f=g.call(this),te.default(x.default(f),"method","telemetry.v1"),f.events=p,f}return d}(Ae);function We(v){var g=encodeURIComponent(v),d=g.replace(/%([0-9A-F]{2})/g,function(p,f){return String.fromCharCode(Number("0x"+f))});return d.length}function fr(v){var g=encodeURIComponent(v),d=g.replace(/%([0-9A-F]{2})/g,function(f,m){return String.fromCharCode(Number("0x"+m))}),p=new Uint8Array(d.length);return Array.prototype.forEach.call(d,function(f,m){p[m]=f.charCodeAt(0)}),p}function rt(v){var g=Array.prototype.map.call(v,function(p){return String.fromCharCode(p)}).join(""),d=g.replace(/(.)/g,function(p,f){var m=f.charCodeAt(0).toString(16).toUpperCase();return m.length<2&&(m="0"+m),"%"+m});return decodeURIComponent(d)}function Ir(v){return JSON.parse(rt(v))}function Nt(v){for(var g="",d=0;d<v.length;++d){var p=String.fromCharCode(v[d]);if(g+=p,p==="\r"){d+=2;break}}var f=g.split(" ");return{size:d,protocol:f[0],version:f[1],headerSize:Number(f[2])}}var mn=function(){function v(){ce.default(this,v)}return le.default(v,null,[{key:"parse",value:function(d){var p=2,f=new Uint8Array(d),m=Nt(f);if(m.protocol!=="TWILSOCK"||m.version!=="V3.0")return Q.error("unsupported protocol: ".concat(m.protocol," ver ").concat(m.version)),null;var y;try{y=Ir(f.subarray(m.size,m.size+m.headerSize))}catch(U){return Q.error("failed to parse message header",U,d),null}Q.debug("message received: ",y.method),Q.trace("message received: ",y);var k;if(y.payload_size>0){var E=p+m.size+m.headerSize,L=y.payload_size;if(!y.hasOwnProperty("payload_type")||y.payload_type.indexOf("application/json")===0)try{k=Ir(f.subarray(E,E+L))}catch(U){return Q.error("failed to parse message body",U,d),null}else y.payload_type.indexOf("text/plain")===0&&(k=rt(f.subarray(E,E+L)))}return{method:y.method,header:y,payload:k}}},{key:"createPacket",value:function(d){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";d.payload_size=We(p);var f=JSON.stringify(d),m="TWILSOCK V3.0 "+We(f);Q.debug("send request:",m+f+p);var y=fr(m+`\r
`+f+`\r
`+p);return y.buffer}}]),v}();function Zt(v){var g=Fn();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function Fn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Et=function(v){de.default(d,v);var g=Zt(d);function d(p){return ce.default(this,d),g.call(this,p)}return d}(N.default(Error));function dr(v){var g=qr();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function qr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Hr=function(v){de.default(d,v);var g=dr(d);function d(p,f){var m;return ce.default(this,d),m=g.call(this,p),m.reply=f,m}return d}(Et);function pr(v,g){var d=Object.keys(v);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(v);g&&(p=p.filter(function(f){return Object.getOwnPropertyDescriptor(v,f).enumerable})),d.push.apply(d,p)}return d}function vs(v){for(var g=1;g<arguments.length;g++){var d=arguments[g]!=null?arguments[g]:{};g%2?pr(Object(d),!0).forEach(function(p){te.default(v,p,d[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(d)):pr(Object(d)).forEach(function(p){Object.defineProperty(v,p,Object.getOwnPropertyDescriptor(d,p))})}return v}function xr(v){var g=hs();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function hs(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Io=function(v){de.default(d,v);var g=xr(d);function d(p){var f;return ce.default(this,d),f=g.call(this),te.default(x.default(f),"newBackoff",null),te.default(x.default(f),"usedBackoff",null),te.default(x.default(f),"retrier",null),f.options=p?vs({},p):{},f}return le.default(d,[{key:"inProgress",get:function(){return!!this.retrier}},{key:"start",value:function(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}},{key:"stop",value:function(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}},{key:"modifyBackoff",value:function(f){this.newBackoff=f}},{key:"attemptFailed",value:function(){if(!this.inProgress)throw new Error("No attempt is in progress");if(this.newBackoff){var f=!this.usedBackoff||this.usedBackoff<this.newBackoff;if(f)this.createRetrier();else{var m;(m=this.retrier)===null||m===void 0||m.failed(new Error)}}else{var y;(y=this.retrier)===null||y===void 0||y.failed(new Error)}}},{key:"cancel",value:function(){var f;(f=this.retrier)===null||f===void 0||f.cancel()}},{key:"cleanRetrier",value:function(){var f,m;(f=this.retrier)===null||f===void 0||f.removeAllListeners(),(m=this.retrier)===null||m===void 0||m.cancel(),this.retrier=null}},{key:"getRetryPolicy",value:function(){var f=vs({},this.options);return this.newBackoff&&(f.min=this.newBackoff,f.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),f.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,f}},{key:"createRetrier",value:function(){var f=this;this.cleanRetrier();var m=this.getRetryPolicy();this.retrier=new D.Retrier(m),this.retrier.once("attempt",function(){var y,k;(y=f.retrier)===null||y===void 0||y.on("attempt",function(){return f.emit("attempt")}),(k=f.retrier)===null||k===void 0||k.failed(new Error("Skipping first attempt"))}),this.retrier.on("failed",function(y){return f.emit("failed",y)}),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start()}}]),d}(B);function Co(v){var g=ys();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function ys(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ro=3e3;function bn(v){setTimeout(v,0)}var wn=function(v){de.default(d,v);var g=Co(d);function d(p,f,m){var y;ce.default(this,d),y=g.call(this),te.default(x.default(y),"disconnectingTimer",null),te.default(x.default(y),"disconnectedPromiseResolve",null),te.default(x.default(y),"terminalStates",["disconnected","rejected"]),te.default(x.default(y),"tokenExpiredSasCode",20104),te.default(x.default(y),"terminationReason","Connection is not initialized"),y.websocket=p,y.websocket.on("connected",function(){return y.fsm.socketConnected()}),y.websocket.on("disconnected",function(){return y.fsm.socketClosed()}),y.websocket.on("message",function(E){return y.onIncomingMessage(E)}),y.websocket.on("socketError",function(E){return y.emit("connectionError",{terminal:!1,message:"Socket error: ".concat(E.message),httpStatusCode:null,errorCode:null})}),y.transport=f,y.config=m,y.retrier=new Io(m.retryPolicy),y.retrier.on("attempt",function(){return y.retry()}),y.retrier.on("failed",function(E){Q.warn("Retrying failed: ".concat(E.message)),y.disconnect()}),typeof window<"u"&&typeof window.addEventListener<"u"&&(window.addEventListener("online",function(){Q.debug("Browser reported connectivity state: online"),y.resetBackoff(),y.fsm.systemOnline()}),window.addEventListener("offline",function(){Q.debug("Browser reported connectivity state: offline"),y.websocket.close(),y.fsm.socketClosed()}));var k=$e.factory({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:function(){y.setupSocket(),y.emit("connecting")},onEnterInitialising:function(){y.sendInit()},onLeaveInitialising:function(){y.cancelInit()},onEnterUpdating:function(){y.sendUpdate()},onLeaveUpdating:function(){y.cancelUpdate()},onEnterRetrying:function(){y.initRetry(),y.emit("connecting")},onEnterConnected:function(){y.resetBackoff(),y.onConnected()},onUserUpdateToken:function(){y.resetBackoff()},onTokenRejected:function(){y.resetBackoff(),y.closeSocket(!0),y.finalizeSocket()},onUserDisconnect:function(){y.closeSocket(!0)},onEnterDisconnecting:function(){y.startDisconnectTimer()},onLeaveDisconnecting:function(){y.cancelDisconnectTimer()},onEnterWaitSocketClosed:function(){y.startDisconnectTimer()},onLeaveWaitSocketClosed:function(){y.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:function(){y.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:function(){y.cancelDisconnectTimer()},onDisconnected:function(){y.resetBackoff(),y.finalizeSocket()},onReceiveClose:function(){y.onCloseReceived()},onReceiveOffload:function(L,U){Q.debug("onreceiveoffload: ",U),y.modifyBackoff(U.body),y.onCloseReceived()},onUnsupported:function(){y.closeSocket(!0),y.finalizeSocket()},onError:function(L,U){y.closeSocket(U),y.finalizeSocket()},onEnterState:function(L){L.from!=="none"&&y.changeState(L)},onInvalidTransition:function(L,U,ke){Q.warn("FSM: unexpected transition",U,ke)}}});return y.fsm=new k,y}return le.default(d,[{key:"changeState",value:function(f){Q.debug("FSM: ".concat(f.transition,": ").concat(f.from," --> ").concat(f.to)),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}},{key:"resetBackoff",value:function(){Q.trace("resetBackoff"),this.retrier.stop()}},{key:"modifyBackoff",value:function(f){Q.trace("modifyBackoff",f);var m=f?f.backoff_policy:null;m&&typeof m.reconnect_min_ms=="number"&&this.retrier.modifyBackoff(m.reconnect_min_ms)}},{key:"startDisconnectTimer",value:function(){var f=this;Q.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout(function(){Q.debug("disconnecting is timed out"),f.closeSocket(!0)},Ro)}},{key:"cancelDisconnectTimer",value:function(){Q.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}},{key:"isConnected",get:function(){return this.state==="connected"&&this.websocket.isConnected}},{key:"state",get:function(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"denied";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}},{key:"initRetry",value:function(){Q.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}},{key:"retry",value:function(){this.fsm.state!="connecting"?(Q.trace("retry"),this.websocket.close(),this.fsm.userRetry()):Q.trace("can	 retry as already connecting")}},{key:"onConnected",value:function(){this.emit("connected")}},{key:"finalizeSocket",value:function(){Q.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}},{key:"setupSocket",value:function(){Q.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}},{key:"onIncomingMessage",value:function(f){var m=mn.parse(f);if(!!m){var y=m.method,k=m.header,E=m.payload;if(y!=="reply"&&this.confirmReceiving(k),y==="notification")this.emit("message",k.message_type,E);else if(k.method==="reply")this.transport.processReply({id:k.id,status:k.status,header:k,body:E});else if(k.method==="client_update")k.client_update_type==="token_about_to_expire"&&this.emit("tokenAboutToExpire");else if(k.method==="close")if(k.status.code===308)Q.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:k.status.status,body:E});else if(k.status.code===406){var L="Server closed connection because can't parse protocol: ".concat(JSON.stringify(k.status));this.emitReplyConnectionError(L,k,!0),Q.error(L),this.fsm.receiveFatalClose()}else k.status.code===417?(Q.error("Server closed connection because can't parse client reply: ".concat(JSON.stringify(k.status))),this.fsm.receiveFatalClose(k.status.status)):k.status.code===410?(Q.warn("Server closed connection: ".concat(JSON.stringify(k.status))),this.fsm.receiveClose(k.status.status),this.emit("tokenExpired")):k.status.code===401?(Q.error("Server closed connection: ".concat(JSON.stringify(k.status))),this.fsm.receiveClose(k.status.status)):(Q.warn("unexpected message: ",k.status),this.fsm.receiveOffload({status:k.status.status,body:null}))}}},{key:"sendInit",value:function(){var p=Me.default(ue.default.mark(function m(){var y,k;return ue.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return Q.trace("sendInit"),L.prev=1,this.emit("beforeSendInit"),L.next=5,this.transport.sendInit();case 5:y=L.sent,this.config.updateContinuationToken(y.continuationToken),this.config.confirmedCapabilities=y.confirmedCapabilities,this.fsm.initSuccess(y),this.emit("initialized",y),this.emit("tokenUpdated"),L.next=17;break;case 13:L.prev=13,L.t0=L.catch(1),L.t0 instanceof Hr?(k=!1,Q.warn("Init rejected by server: ".concat(JSON.stringify(L.t0.reply.status))),this.emit("sendInitFailed"),L.t0.reply.status.code===401||L.t0.reply.status.code===403?(k=!0,this.fsm.tokenRejected(L.t0.reply.status),L.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):L.t0.reply.status.code===429?(this.modifyBackoff(L.t0.reply.body),this.fsm.initError(!0)):L.t0.reply.status.code===500?this.fsm.initError(!1):this.fsm.initError(!0),this.emitReplyConnectionError(L.t0.message,L.t0.reply,k)):(this.terminationReason=L.t0.message,this.emit("connectionError",{terminal:!0,message:"Unknown error during connection initialisation: ".concat(L.t0.message,`
`).concat(JSON.stringify(L.t0,null,2)),httpStatusCode:null,errorCode:null}),this.fsm.initError(!0)),this.emit("tokenUpdated",L.t0);case 17:case"end":return L.stop()}},m,this,[[1,13]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"sendUpdate",value:function(){var p=Me.default(ue.default.mark(function m(){var y,k,E;return ue.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return Q.trace("sendUpdate"),y=new De(this.config.token),U.prev=2,U.next=5,this.transport.sendWithReply(y);case 5:k=U.sent,this.fsm.updateSuccess(k.body),this.emit("tokenUpdated"),U.next=14;break;case 10:U.prev=10,U.t0=U.catch(2),U.t0 instanceof Hr?(E=!1,Q.warn("Token update rejected by server: ".concat(JSON.stringify(U.t0.reply.status))),U.t0.reply.status.code===401||U.t0.reply.status.code===403?(E=!0,this.fsm.tokenRejected(U.t0.reply.status),U.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):U.t0.reply.status.code===429?(this.modifyBackoff(U.t0.reply.body),this.fsm.updateError(U.t0.reply.status)):this.fsm.updateError(U.t0.reply.status),this.emitReplyConnectionError(U.t0.message,U.t0.reply,E)):(this.emit("error",!1,U.t0.message,null,null),this.fsm.updateError(U.t0)),this.emit("tokenUpdated",U.t0);case 14:case"end":return U.stop()}},m,this,[[2,10]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"emitReplyConnectionError",value:function(f,m,y){var k=m.status&&m.status.description?m.status.description:f,E=m.status.code,L=m.status&&m.status.errorCode?m.status.errorCode:null;y&&(this.terminationReason=k),this.emit("connectionError",{terminal:y,message:"Connection error: ".concat(k),httpStatusCode:E,errorCode:L})}},{key:"cancelInit",value:function(){Q.trace("cancelInit")}},{key:"cancelUpdate",value:function(){Q.trace("cancelUpdate")}},{key:"confirmReceiving",value:function(f){Q.trace("confirmReceiving");try{this.transport.send(new z(f.id))}catch(m){Q.debug("failed to confirm packet receiving",m)}}},{key:"closeSocket",value:function(f){var m=this;Q.trace("closeSocket (graceful: ".concat(f,")")),f&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),bn(function(){return m.fsm.socketClosed()})}},{key:"connect",value:function(){Q.trace("connect"),this.fsm.userConnect()}},{key:"disconnect",value:function(){var f=this;return Q.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise(function(m){f.disconnectedPromiseResolve=m,f.fsm.userDisconnect()})}},{key:"updateToken",value:function(f){var m=this;return Q.trace("updateToken:",f),new Promise(function(y,k){m.once("tokenUpdated",function(E){E?k(E):y()}),m.fsm.userUpdateToken()})}},{key:"isTerminalState",get:function(){return this.terminalStates.indexOf(this.fsm.state)!==-1}},{key:"getTerminationReason",get:function(){return this.terminationReason}},{key:"onCloseReceived",value:function(){this.websocket.close()}}]),d}(B),wt=function(){function v(){ce.default(this,v)}return le.default(v,null,[{key:"getMetadata",value:function(d){var p,f,m,y,k,E,L,U,ke=d&&d.clientMetadata?d.clientMetadata:{},Ye=["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"],Lt={env:(p=ct.name)!==null&&p!==void 0?p:"unknown",envv:(f=ct.version)!==null&&f!==void 0?f:"unknown",os:(m=(y=ct.os)===null||y===void 0?void 0:y.family)!==null&&m!==void 0?m:"unknown",osv:(k=(E=ct.os)===null||E===void 0?void 0:E.version)!==null&&k!==void 0?k:"unknown",osa:(L=(U=ct.os)===null||U===void 0?void 0:U.architecture)!==null&&L!==void 0?L:"unknown",sdk:"js-default"},Ze={};return Ye.filter(function(hr){return hr in ke||hr in Lt}).forEach(function(hr){return Ze[hr]=hr in ke?ke[hr]:Lt[hr]}),Ze}}]),v}(),Ao=3e4;function Oo(v){return v>=200&&v<300}function Po(v){switch(ie.default(v)){case"undefined":return"";case"object":return JSON.stringify(v);default:return v}}var ra=function(){function v(g,d){var p=this;ce.default(this,v),this.config=d,this.activeRequests=new Map,this.channel=g,this.channel.on("reply",function(f){return p.processReply(f)}),this.channel.on("disconnected",function(){p.activeRequests.forEach(function(f){clearTimeout(f.timeout),f.reject(new Et("disconnected"))}),p.activeRequests.clear()})}return le.default(v,[{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"processReply",value:function(d){var p=this.activeRequests.get(d.id);p&&(clearTimeout(p.timeout),this.activeRequests.delete(d.id),Oo(d.status.code)?p.resolve(d):(p.reject(new Hr("Transport failure: "+d.status.status,d)),Q.trace("message rejected")))}},{key:"storeRequest",value:function(d,p,f){var m={resolve:p,reject:f,timeout:setTimeout(function(){Q.trace("request",d,"is timed out"),f(new Et("Twilsock: request timeout: "+d))},Ao)};this.activeRequests.set(d,m)}},{key:"shutdown",value:function(){this.activeRequests.forEach(function(d){clearTimeout(d.timeout),d.reject(new Et("Twilsock: request cancelled by user"))}),this.activeRequests.clear()}},{key:"sendInit",value:function(){var g=Me.default(ue.default.mark(function p(){var f,m,y;return ue.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return Q.trace("sendInit"),f=wt.getMetadata(this.config),m=new H(this.config.token,this.config.continuationToken,f,this.config.initRegistrations,this.config.tweaks),E.next=5,this.sendWithReply(m);case 5:return y=E.sent,E.abrupt("return",new Ne(y.id,y.header.continuation_token,new Set(y.header.capabilities),y.header.continuation_token_status,y.header.offline_storage,y.header.init_registrations,y.header.debug_info));case 7:case"end":return E.stop()}},p,this)}));function d(){return g.apply(this,arguments)}return d}()},{key:"sendClose",value:function(){var d=new oe;this.send(d)}},{key:"sendWithReply",value:function(d,p){var f=this;return new Promise(function(m,y){var k=f.send(d,p);f.storeRequest(k,m,y)})}},{key:"send",value:function(d,p){d.id=d.id||"TM".concat(I.v4());var f=mn.createPacket(d,Po(p));try{return this.channel.send(f),d.id}catch(m){throw Q.debug("failed to send ",d,m),Q.trace(m.stack),m}}}]),v}();function gs(v){var g=Mo();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function Mo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var tn=function(v){de.default(d,v);var g=gs(d);function d(p){var f;return ce.default(this,d),f=g.call(this),te.default(x.default(f),"socket",null),f.url=p,f.url=p,f.WebSocket=t.WebSocket||t.MozWebSocket||{},f}return le.default(d,[{key:"isConnected",get:function(){return!!this.socket&&this.socket.readyState===1}},{key:"connect",value:function(){var f=this;Q.trace("connecting to socket");var m;try{m=new this.WebSocket(this.url)}catch(y){Q.debug("Socket error: ".concat(this.url)),this.emit("socketError",y);return}m.binaryType="arraybuffer",m.onopen=function(){Q.debug("socket opened ".concat(f.url)),f.emit("connected")},m.onclose=function(y){Q.debug("socket closed",y),f.emit("disconnected",y)},m.onerror=function(y){Q.debug("Socket error:",y),f.emit("socketError",y)},m.onmessage=function(y){f.emit("message",y.data)},this.socket=m}},{key:"send",value:function(f){return this.socket&&this.socket.send(f)}},{key:"close",value:function(){if(Q.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}]),d}(B);function xo(v){var g=vr();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function vr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var No=function(v){de.default(d,v);var g=xo(d);function d(p){var f;return ce.default(this,d),f=g.call(this),f.transport=p,f.registrations=new Map,f.registrationsInProgress=new Map,f}return le.default(d,[{key:"putNotificationContext",value:function(){var p=Me.default(ue.default.mark(function m(y,k){var E;return ue.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return E={method:"put_notification_ctx",notification_ctx_id:y},U.next=3,this.transport.sendWithReply(E,k);case 3:case"end":return U.stop()}},m,this)}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"deleteNotificationContext",value:function(){var p=Me.default(ue.default.mark(function m(y){var k;return ue.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return k={method:"delete_notification_ctx",notification_ctx_id:y},L.next=3,this.transport.sendWithReply(k);case 3:case"end":return L.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()},{key:"updateRegistration",value:function(){var p=Me.default(ue.default.mark(function m(y,k){var E,L;return ue.default.wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:return Q.debug("update registration for context",y),E=this.registrationsInProgress.get(y),E||(E=new Set,this.registrationsInProgress.set(y,E)),L=I.v4(),E.add(L),ke.prev=5,ke.next=8,this.putNotificationContext(y,k);case 8:Q.debug("registration attempt succeeded for context",k),E.delete(L),E.size===0&&(this.registrationsInProgress.delete(y),this.emit("registered",y)),ke.next=19;break;case 13:ke.prev=13,ke.t0=ke.catch(5),Q.warn("registration attempt failed for context",k),Q.debug(ke.t0),E.delete(L),E.size===0&&(this.registrationsInProgress.delete(y),this.emit("registrationFailed",y,ke.t0));case 19:case"end":return ke.stop()}},m,this,[[5,13]])}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"updateRegistrations",value:function(){var p=Me.default(ue.default.mark(function m(){var y=this,k;return ue.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return Q.trace("refreshing ".concat(this.registrations.size," registrations")),k=[],this.registrations.forEach(function(U,ke){k.push(y.updateRegistration(ke,U))}),L.next=5,Promise.all(k);case 5:case"end":return L.stop()}},m,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=Me.default(ue.default.mark(function m(y,k){return ue.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(!(!y||!k)){L.next=2;break}throw new Et("Invalid arguments provided");case 2:return this.registrations.set(y,k),L.next=5,this.updateRegistration(y,k);case 5:return L.abrupt("return",L.sent);case 6:case"end":return L.stop()}},m,this)}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=Me.default(ue.default.mark(function m(y){return ue.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(this.registrations.has(y)){E.next=2;break}return E.abrupt("return");case 2:return E.next=4,this.deleteNotificationContext(y);case 4:this.transport.isConnected&&this.registrations.delete(y);case 5:case"end":return E.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()}]),d}(B);function Lo(v){var g=jo();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function jo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Uo=function(v){de.default(d,v);var g=Lo(d);function d(p,f,m){var y;return ce.default(this,d),y=g.call(this,f),y.status=p,y.description=f,y.body=m,y}return d}(Et);function _n(v){var g=Fo();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function Fo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Nr=function(v){de.default(d,v);var g=_n(d);function d(p){return ce.default(this,d),g.call(this,p)}return d}(Et),La=2e4;function Ti(v){return v>=200&&v<300}function Do(v){return v&&v.header&&v.header.http_status}function ms(v){var g=v.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(g){var d={protocol:g[1],host:g[2],hostname:g[3],port:g[4],pathname:g[5],search:g[6],hash:g[7],params:{}};if(d.search.length>0){var p=d.search.substring(1);d.params=p.split("&").map(function(f){return f.split("=")}).reduce(function(f,m){return f.hasOwnProperty(m[0])?Array.isArray(f[m[0]])?f[m[0]].push(m[1]):f[m[0]]=[f[m[0]],m[1]]:f[m[0]]=m[1],f},{})}return d}throw new Et("Incorrect URI: "+v)}function Bo(v,g){var d=ms(g),p={method:v,host:d.host,path:d.pathname};return d.params&&(p.params=d.params),p}function qo(v,g,d,p,f){return{to:Bo(v,g),headers:d,body:p,grant:f}}var pt=function(){function v(g,d,p){ce.default(this,v),this.config=p,this.transport=g,this.pendingMessages=[],this.twilsock=d}return le.default(v,[{key:"saveMessage",value:function(d){var p=this;return new Promise(function(f,m){var y={message:d,resolve:f,reject:m,alreadyRejected:!1,timeout:setTimeout(function(){Q.debug("request is timed out"),m(new Et("request '".concat(d.to.method,"' to '").concat(d.to.host,"' timed out"))),y.alreadyRejected=!0},La)};p.pendingMessages.push(y)})}},{key:"sendPendingMessages",value:function(){for(var d=this,p=function(){var y=d.pendingMessages[0];if(!y.alreadyRejected)try{var k=y.message;d.actualSend(k).then(function(E){return y.resolve(E)}).catch(function(E){return y.reject(E)}),clearTimeout(y.timeout)}catch(E){return Q.debug("Failed to send pending message",E),"break"}d.pendingMessages.splice(0,1)};this.pendingMessages.length>0;){var f=p();if(f==="break")break}}},{key:"rejectPendingMessages",value:function(){var d=this;this.pendingMessages.forEach(function(p){p.reject(new Nr("Unable to connect: "+d.twilsock.getTerminationReason)),p.alreadyRejected=!0,clearTimeout(p.timeout)}),this.pendingMessages.splice(0,this.pendingMessages.length)}},{key:"actualSend",value:function(){var g=Me.default(ue.default.mark(function p(f){var m,y,k,E,L,U,ke,Ye;return ue.default.wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return y=f.to,k=f.headers,E=f.body,L=(m=f.grant)!==null&&m!==void 0?m:this.config.activeGrant,U={host:y.host,path:y.path,method:y.method,params:y.params,headers:k},ke=new J(L,k["Content-Type"]||"application/json",U),Q.trace("Sending upstream message",ke),Ze.next=9,this.transport.sendWithReply(ke,E);case 9:if(Ye=Ze.sent,Q.trace("Received upstream message response",Ye),!(Do(Ye)&&!Ti(Ye.header.http_status.code))){Ze.next=13;break}throw new Uo(Ye.header.http_status.code,Ye.header.http_status.status,Ye.body);case 13:return Ze.abrupt("return",{status:Ye.header.http_status,headers:Ye.header.http_headers,body:Ye.body});case 14:case"end":return Ze.stop()}},p,this)}));function d(p){return g.apply(this,arguments)}return d}()},{key:"send",value:function(d,p){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=arguments.length>3?arguments[3]:void 0,y=arguments.length>4?arguments[4]:void 0;if(this.twilsock.isTerminalState)return Promise.reject(new Nr("Unable to connect: "+this.twilsock.getTerminationReason));var k=qo(d,p,f,m,y);return this.twilsock.isConnected?this.actualSend(k):this.saveMessage(k)}}]),v}(),bs=function(){function v(){var g=this;ce.default(this,v),this._promise=new Promise(function(d,p){g._resolve=d,g._reject=p})}return le.default(v,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(d){this._resolve(d)}},{key:"set",value:function(d){this._resolve(d)}},{key:"fail",value:function(d){this._reject(d)}}]),v}(),ja=function(){function v(g){ce.default(this,v),this.id=g}return le.default(v,null,[{key:"create",value:function(d){if(d instanceof Object&&"storage_id"in d)return new v(d.storage_id);throw new Et('Field "storage_id" is missing')}}]),v}(),ki=function(){function v(){return ce.default(this,v),te.default(this,"initializedFlag","twilio_twilsock_token_storage"),te.default(this,"tokenStoragePrefix","twilio_continuation_token_"),v._instance||(this.initialize(),v._instance=this),v._instance}return le.default(v,[{key:"sessionStorage",value:function(){try{return t.sessionStorage}catch{return null}}},{key:"window",value:function(){try{return t.window}catch{return null}}},{key:"storeToken",value:function(d,p){this.canStore()&&this.sessionStorage.setItem(this.getKeyName(p),d)}},{key:"getStoredToken",value:function(d){return this.canStore()?this.sessionStorage.getItem(this.getKeyName(d)):null}},{key:"initialize",value:function(){var d=this;if(this.canStore()){var p=this.sessionStorage.getItem(this.initializedFlag);p&&this.clear(),this.sessionStorage.setItem(this.initializedFlag,"true");var f=this.sessionStorage.removeItem;this.window.addEventListener("unload",function(){f(d.initializedFlag)})}}},{key:"clear",value:function(){if(this.canStore()){for(var d=[],p=0;p<this.sessionStorage.length;p++){var f=this.sessionStorage.key(p);f&&f.indexOf(this.tokenStoragePrefix)===0&&d.push(f)}var m=this.sessionStorage.removeItem;d.forEach(function(y){return m(y)}),m(this.initializedFlag)}}},{key:"getKeyName",value:function(d){return"".concat(this.tokenStoragePrefix).concat(d)}},{key:"canStore",value:function(){return!!(this.sessionStorage&&this.sessionStorage.length&&this.window)}}]),v}();te.default(ki,"_instance",null);var na=new ki,dt=function(){function v(g,d,p,f,m,y){ce.default(this,v),this.title=g,this.details=d,this.start=p,this.type=m,this.id=y,this.end=f}return le.default(v,[{key:"toTelemetryEvent",value:function(){var d=new Date,p=this.start,f=this.end?this.end:d;if(f<p){var m=f;f=p,p=m}var y=p.getTime()-d.getTime(),k=f.getTime()-d.getTime(),E=new at(y,k,this.title,this.details,this.id,this.type);return E}}]),v}();e.TelemetryPoint=void 0,function(v){v[v.Start=0]="Start",v[v.End=1]="End"}(e.TelemetryPoint||(e.TelemetryPoint={})),e.EventSendingLimitation=void 0,function(v){v[v.MinEventsPortion=0]="MinEventsPortion",v[v.AnyEvents=1]="AnyEvents",v[v.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished"}(e.EventSendingLimitation||(e.EventSendingLimitation={}));var ws=function(){function v(g,d){ce.default(this,v),te.default(this,"minEventsPortionToSend",50),te.default(this,"maxEventsPortionToSend",100),te.default(this,"pendingEvents",new Map),te.default(this,"readyEvents",[]),te.default(this,"hasInitializationFinished",!1),te.default(this,"_canSendTelemetry",!1),this.config=g,this.packetInterface=d}return le.default(v,[{key:"isTelemetryEnabled",get:function(){return this.config.confirmedCapabilities.has("telemetry.v1")}},{key:"canSendTelemetry",get:function(){return this._canSendTelemetry&&this.isTelemetryEnabled},set:function(d){Q.debug("TelemetryTracker.canSendTelemetry: ".concat(d," TelemetryTracker.isTelemetryEnabled: ").concat(this.isTelemetryEnabled)),this._canSendTelemetry&&!d&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=d,d&&this.sendTelemetry(e.EventSendingLimitation.AnyEvents),d&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}},{key:"addTelemetryEvent",value:function(d){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(d)}},{key:"addPartialEvent",value:function(d,p,f){Q.debug("Adding ".concat(f===e.TelemetryPoint.Start?"starting":"ending"," timepoint for '").concat(p,"' event"));var m=this.pendingEvents.has(p);if(f===e.TelemetryPoint.Start)m&&Q.debug("Overwriting starting point for '".concat(p,"' event")),this.pendingEvents.set(p,d);else{if(!m){Q.info("Could not find started event for '".concat(p,"' event"));return}this.addTelemetryEvent(this.merge(this.pendingEvents.get(p),d)),this.pendingEvents.delete(p)}}},{key:"getTelemetryToSend",value:function(d){return!this.canSendTelemetry||this.readyEvents.length==0?[]:d==e.EventSendingLimitation.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(d==e.EventSendingLimitation.AnyEventsIncludingUnfinished)}},{key:"getTelemetryPortion",value:function(d){var p=this,f=Math.min(this.readyEvents.length,this.maxEventsPortionToSend),m=this.readyEvents.splice(0,f);return d&&m.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach(function(y,k){if(!(m.length>=p.maxEventsPortionToSend)){var E=p.pendingEvents.get(k);p.pendingEvents.delete(k),m.push(new dt("[UNFINISHED] ".concat(E.title),E.details,E.start,null,E.type,E.id))}}),m}},{key:"merge",value:function(d,p){return new dt(p.title?p.title:d.title,p.details?p.details:d.details,d.start,p.end,p.type?p.type:d.type,p.id?p.id:d.id)}},{key:"sendTelemetryIfMinimalPortionCollected",value:function(){this.sendTelemetry(e.EventSendingLimitation.MinEventsPortion)}},{key:"sendTelemetry",value:function(d){var p=this.getTelemetryToSend(d);if(p.length!==0)try{this.packetInterface.send(new tt(p.map(function(f){return f.toTelemetryEvent()})))}catch(f){Q.debug("Error while sending ".concat(p.length," telemetry events due to ").concat(f,"; they will be resubmitted")),this.readyEvents=this.readyEvents.concat(p)}}}]),v}();function A(v){var g=P();return function(){var p=xe.default(v),f;if(g){var m=xe.default(this).constructor;f=Reflect.construct(p,arguments,m)}else f=p.apply(this,arguments);return X.default(this,f)}}function P(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var S=function v(){ce.default(this,v)};te.default(S,"TWILSOCK_CONNECT","twilsock.sdk.connect"),te.default(S,"TWILSOCK_INIT","twilsock.sdk.init"),e.TwilsockClient=function(v){de.default(d,v);var g=A(d);function d(p,f,m){var y;ce.default(this,d),y=g.call(this),te.default(x.default(y),"version",Fe),te.default(x.default(y),"offlineStorageDeferred",new bs),m.continuationToken=m.continuationToken?m.continuationToken:na.getStoredToken(f);var k=y.config=new Ue(p,f,m);Q.setLevel(k.logLevel);var E=new tn(k.url),L=new ra(E,k);return y.channel=new wn(E,L,k),y.registrations=new No(L),y.upstream=new pt(L,y.channel,k),y.telemetryTracker=new ws(k,L),y.channel.on("initialized",function(){return y.telemetryTracker.canSendTelemetry=!0}),E.on("disconnected",function(){return y.telemetryTracker.canSendTelemetry=!1}),y.registrations.on("registered",function(U){return y.emit("registered",U)}),y.channel.on("message",function(U,ke){return setTimeout(function(){return y.emit("message",U,ke)},0)}),y.channel.on("stateChanged",function(U){return setTimeout(function(){return y.emit("stateChanged",U)},0)}),y.channel.on("connectionError",function(U){return setTimeout(function(){return y.emit("connectionError",U)},0)}),y.channel.on("tokenAboutToExpire",function(){return setTimeout(function(){return y.emit("tokenAboutToExpire")},0)}),y.channel.on("tokenExpired",function(){return setTimeout(function(){return y.emit("tokenExpired")},0)}),y.channel.on("connected",function(){return y.registrations.updateRegistrations()}),y.channel.on("connected",function(){return y.upstream.sendPendingMessages()}),y.channel.on("connected",function(){return setTimeout(function(){return y.emit("connected")},0)}),y.channel.on("beforeConnect",function(){return y.telemetryTracker.addPartialEvent(new dt("Establish WebSocket connection","",new Date),S.TWILSOCK_CONNECT,e.TelemetryPoint.Start)}),y.channel.on("connected",function(){return y.telemetryTracker.addPartialEvent(new dt("Establish WebSocket connection","",new Date,new Date),S.TWILSOCK_CONNECT,e.TelemetryPoint.End)}),y.channel.on("beforeSendInit",function(){return y.telemetryTracker.addPartialEvent(new dt("Send Twilsock init","",new Date),S.TWILSOCK_INIT,e.TelemetryPoint.Start)}),y.channel.on("initialized",function(){return y.telemetryTracker.addPartialEvent(new dt("Send Twilsock init","Succeeded",new Date,new Date),S.TWILSOCK_INIT,e.TelemetryPoint.End)}),y.channel.on("sendInitFailed",function(){return y.telemetryTracker.addPartialEvent(new dt("Send Twilsock init","Failed",new Date,new Date),S.TWILSOCK_INIT,e.TelemetryPoint.End)}),y.channel.on("initialized",function(U){y.handleStorageId(f,U),na.storeToken(U.continuationToken,f),setTimeout(function(){return y.emit("initialized",U)},0)}),y.channel.on("disconnected",function(){return setTimeout(function(){return y.emit("disconnected")},0)}),y.channel.on("disconnected",function(){return y.upstream.rejectPendingMessages()}),y.channel.on("disconnected",function(){return y.offlineStorageDeferred.fail(new Et("Client disconnected"))}),y.offlineStorageDeferred.promise.catch(function(){}),y}return le.default(d,[{key:"emit",value:function(f){for(var m,y=arguments.length,k=new Array(y>1?y-1:0),E=1;E<y;E++)k[E-1]=arguments[E];return Q.debug("Emitting ".concat(f.toString(),"(").concat(k.map(function(L){return JSON.stringify(L)}).join(", "),")")),(m=re.default(xe.default(d.prototype),"emit",this)).call.apply(m,[this,f].concat(k))}},{key:"handleStorageId",value:function(f,m){if(!m.offlineStorage)this.offlineStorageDeferred.fail(new Et("No offline storage id"));else if(m.offlineStorage.hasOwnProperty(f))try{this.offlineStorageDeferred.set(ja.create(m.offlineStorage[f])),Q.debug("Offline storage for '".concat(f,"' product: ").concat(JSON.stringify(m.offlineStorage[f]),"."))}catch(y){this.offlineStorageDeferred.fail(new Et("Failed to parse offline storage for ".concat(f," ").concat(JSON.stringify(m.offlineStorage[f]),". ").concat(y,".")))}else this.offlineStorageDeferred.fail(new Et("No offline storage id for '".concat(f,"' product: ").concat(JSON.stringify(m.offlineStorage))))}},{key:"storageId",value:function(){return this.offlineStorageDeferred.promise}},{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"state",get:function(){return this.channel.state}},{key:"updateToken",value:function(){var p=Me.default(ue.default.mark(function m(y){return ue.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(Q.trace("updating token '".concat(y,"'")),this.config.token!==y){E.next=3;break}return E.abrupt("return");case 3:return this.config.updateToken(y),E.next=6,this.channel.updateToken(y);case 6:return E.abrupt("return",E.sent);case 7:case"end":return E.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=Me.default(ue.default.mark(function m(y,k){return ue.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this.registrations.setNotificationsContext(y,k);case 2:case"end":return L.stop()}},m,this)}));function f(m,y){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=Me.default(ue.default.mark(function m(y){return ue.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this.registrations.removeNotificationsContext(y);case 2:case"end":return E.stop()}},m,this)}));function f(m){return p.apply(this,arguments)}return f}()},{key:"connect",value:function(){return this.channel.connect()}},{key:"disconnect",value:function(){var p=Me.default(ue.default.mark(function m(){return ue.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEventsIncludingUnfinished),k.next=3,this.channel.disconnect();case 3:return k.abrupt("return",k.sent);case 4:case"end":return k.stop()}},m,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"get",value:function(){var p=Me.default(ue.default.mark(function m(y,k,E){return ue.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),U.next=3,this.upstream.send("GET",y,k,void 0,E);case 3:return U.abrupt("return",U.sent);case 4:case"end":return U.stop()}},m,this)}));function f(m,y,k){return p.apply(this,arguments)}return f}()},{key:"post",value:function(){var p=Me.default(ue.default.mark(function m(y,k,E,L){return ue.default.wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),ke.next=3,this.upstream.send("POST",y,k,E,L);case 3:return ke.abrupt("return",ke.sent);case 4:case"end":return ke.stop()}},m,this)}));function f(m,y,k,E){return p.apply(this,arguments)}return f}()},{key:"put",value:function(){var p=Me.default(ue.default.mark(function m(y,k,E,L){return ue.default.wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),ke.next=3,this.upstream.send("PUT",y,k,E,L);case 3:return ke.abrupt("return",ke.sent);case 4:case"end":return ke.stop()}},m,this)}));function f(m,y,k,E){return p.apply(this,arguments)}return f}()},{key:"delete",value:function(){var p=Me.default(ue.default.mark(function m(y,k,E,L){return ue.default.wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),ke.next=3,this.upstream.send("DELETE",y,k,E,L);case 3:return ke.abrupt("return",ke.sent);case 4:case"end":return ke.stop()}},m,this)}));function f(m,y,k,E){return p.apply(this,arguments)}return f}()},{key:"addTelemetryEvent",value:function(f){this.telemetryTracker.addTelemetryEvent(f),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}},{key:"addPartialTelemetryEvent",value:function(f,m,y){this.telemetryTracker.addPartialEvent(f,m,y),y===e.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}]),d}(B),e.TwilsockClient=ft([b.validateConstructorTypes(b.nonEmptyString,b.nonEmptyString,[b.pureObject,"undefined",b.literal(null)]),Te("design:paramtypes",[String,String,Object])],e.TwilsockClient);var _=function(){function v(g){ce.default(this,v),this.product=g,this.type="ers",this.notification_protocol_version=0,this.message_types=[]}return le.default(v,[{key:"populateInitRegistrations",value:function(d){var p=new Set(this.message_types);for(var f in d)p.add(d[f]);this.message_types=Array.from(p)}}]),v}();e.InitRegistration=_,e.TelemetryEventDescription=dt,e.TelemetryTracker=ws,e.TransportUnavailableError=Nr,e.Twilsock=e.TwilsockClient,e.TwilsockError=Et})(xf);var KE={},hS=Dt,KK=et,YK=Ct,JK=nt,$p=Qu,QK=Yu,XK=Hu,ZK=_r,e9=Wu,As=Object.assign,yS=Object.defineProperty,t9=KK([].concat),YE=!As||JK(function(){if(hS&&As({b:1},As(yS({},"a",{enumerable:!0,get:function(){yS(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(a){t[a]=a}),As({},e)[r]!=7||$p(As({},t)).join("")!=n})?function(t,r){for(var n=ZK(t),a=arguments.length,i=1,s=QK.f,u=XK.f;a>i;)for(var o=e9(arguments[i++]),l=s?t9($p(o),s(o)):$p(o),c=l.length,h=0,w;c>h;)w=l[h++],(!hS||YK(u,o,w))&&(n[w]=o[w]);return n}:As,r9=st,gS=YE;r9({target:"Object",stat:!0,arity:2,forced:Object.assign!==gS},{assign:gS});var kr={};/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(kr,"__esModule",{value:!0});var n9=jn.exports,a9=gi.exports,i9=mi.exports,s9=ta.exports,o9=Un.exports,u9=Nn.exports,l9=Ln.exports,c9=Xr.exports;function _i(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Zs=_i(n9),Sa=_i(a9),Tp=_i(i9),f9=_i(s9),d9=_i(o9),p9=_i(u9),v9=_i(l9),mS=_i(c9),xa=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function h9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=y9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function y9(e,t){if(!!e){if(typeof e=="string")return bS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return bS(e,t)}}function bS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var JE=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return xa(function(a){var i=!1,s=[],u=h9(r),o;try{for(u.s();!(o=u.n()).done;){var l=o.value;if(typeof l=="string"){i=i||Zs.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){u.e(c)}finally{u.f()}return[i,s]})};function g9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=m9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function m9(e,t){if(!!e){if(typeof e=="string")return wS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return wS(e,t)}}function wS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var b9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return xa(function(a){var i=!1,s=[],u=g9(r),o;try{for(u.s();!(o=u.n()).done;){var l=o.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){u.e(c)}finally{u.f()}return[i,s]})};function w9(e){var t=_9();return function(){var n=mS.default(e),a;if(t){var i=mS.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return v9.default(this,a)}}function _9(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function ju(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=S9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function S9(e,t){if(!!e){if(typeof e=="string")return _S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _S(e,t)}}function _S(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Hf=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=ju(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=Sa.default(a.value,2),s=i[0],u=i[1],o=Gf(t[s],u),l=Sa.default(o,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(C){n.e(C)}finally{n.f()}},QE=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(Zs.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),Zs.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=Zs.default(t)),n},$9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=hg(r);return function(i){return function(s){p9.default(o,s);var u=w9(o);function o(){d9.default(this,o);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Hf(a,c),u.call.apply(u,[this].concat(c))}return f9.default(o)}(i)}},T9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=hg(r);return function(i,s,u){if(typeof u.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var o=u.value;u.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Hf(a,c),o.apply(this,c)}}},k9=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=hg(r);return function(i,s,u){if(typeof u.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var o=u.value;u.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{Hf(a,c)}catch(w){return Promise.reject(w)}return o.apply(this,c)}}},hg=function(t){var r=[],n=ju(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Wf(i))}}catch(s){n.e(s)}finally{n.f()}return r},Wf=function(t){var r=[],n=Array.isArray(t)?t:[t],a=ju(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(JE(s));continue}r.push(s)}}catch(u){a.e(u)}finally{a.f()}return r},Gf=function(t,r){var n=[],a,i=!1,s=ju(t),u;try{for(s.s();!(u=s.n()).done;){var o=u.value,l=ju(o.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=Sa.default(w,3),$=b[0],C=b[1],I=b[2];i=i||$,!a&&I&&(a=I),C&&(n=typeof C=="string"?[].concat(Tp.default(n),[C]):[].concat(Tp.default(n),Tp.default(C)))}}catch(se){l.e(se)}finally{l.f()}}}catch(se){s.e(se)}finally{s.f()}if(i)return[!0];var j=a||QE(r),D=n.length-1,ve=D>0?"".concat(n.slice(0,D).join(", ")," or ").concat(n[D]):n.join(", ");return[!1,j,ve,D>1?";":","]};function E9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=I9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function I9(e,t){if(!!e){if(typeof e=="string")return SS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return SS(e,t)}}function SS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var C9=function(t,r){return xa(function(n){if(!Array.isArray(n)||n.length<1)return[!1,"a non-empty array of ".concat(t)];var a=E9(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=Sa.default(i.value,2),u=s[0],o=s[1],l=Gf(Wf(r),o),c=Sa.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid non-empty array of ".concat(t," (index ").concat(u," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(u," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})},R9=xa(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),A9=xa(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),O9=xa(function(e){return[Zs.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]}),P9=function(t,r){return xa(function(n){if(Zs.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=Sa.default(i[a],2),u=s[0],o=s[1],l=Gf(Wf(o),n[u]),c=Sa.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(u,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(u,'" is ').concat(w,")")]}return[!0]})};function M9(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=x9(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function x9(e,t){if(!!e){if(typeof e=="string")return $S(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return $S(e,t)}}function $S(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var N9=function(t,r){return xa(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=M9(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=Sa.default(i.value,2),u=s[0],o=s[1],l=Gf(Wf(r),o),c=Sa.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(u," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(u," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};kr.array=N9;kr.custom=xa;kr.literal=b9;kr.nonEmptyArray=C9;kr.nonEmptyString=R9;kr.nonNegativeInteger=A9;kr.objectSchema=P9;kr.pureObject=O9;kr.runtimeTypeValidation=Hf;kr.stringifyReceivedType=QE;kr.type=JE;kr.validateConstructorTypes=$9;kr.validateTypes=T9;kr.validateTypesAsync=k9;/*
@license
The MIT License (MIT)

Copyright (c) 2016 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=So.exports,r=Un.exports,n=ta.exports,a=Nn.exports,i=Ln.exports,s=Xr.exports,u=ul,o=jn.exports,l=xf,c=hi.exports,h=yi.exports,w=Ma,b=gi.exports,$=mi.exports,C=cs.exports,I=Lf,j=kr;function D(J){return J&&typeof J=="object"&&"default"in J?J:{default:J}}function ve(J){if(J&&J.__esModule)return J;var ee=Object.create(null);return J&&Object.keys(J).forEach(function(q){if(q!=="default"){var z=Object.getOwnPropertyDescriptor(J,q);Object.defineProperty(ee,q,z.get?z:{enumerable:!0,get:function(){return J[q]}})}}),ee.default=J,Object.freeze(ee)}var se=D(t),Pe=D(r),Me=D(n),le=D(a),x=D(i),re=D(s),de=D(u),X=D(o),xe=D(c),ce=D(h),te=D(b),ue=D($),ie=ve(C),Ie=ve(I);function $e(J,ee,q,z){var Z=arguments.length,ge=Z<3?ee:z===null?z=Object.getOwnPropertyDescriptor(ee,q):z,oe;if((typeof Reflect>"u"?"undefined":X.default(Reflect))==="object"&&typeof Reflect.decorate=="function")ge=Reflect.decorate(J,ee,q,z);else for(var je=J.length-1;je>=0;je--)(oe=J[je])&&(ge=(Z<3?oe(ge):Z>3?oe(ee,q,ge):oe(ee,q))||ge);return Z>3&&ge&&Object.defineProperty(ee,q,ge),ge}function N(J,ee){if((typeof Reflect>"u"?"undefined":X.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(J,ee)}var ct;function ft(){}ft.prototype=Object.create(null);function Te(){Te.init.call(this)}Te.EventEmitter=Te,Te.usingDomains=!1,Te.prototype.domain=void 0,Te.prototype._events=void 0,Te.prototype._maxListeners=void 0,Te.defaultMaxListeners=10,Te.init=function(){this.domain=null,Te.usingDomains&&ct.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new ft,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Te.prototype.setMaxListeners=function(ee){if(typeof ee!="number"||ee<0||isNaN(ee))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=ee,this};function Xe(J){return J._maxListeners===void 0?Te.defaultMaxListeners:J._maxListeners}Te.prototype.getMaxListeners=function(){return Xe(this)};function Je(J,ee,q){if(ee)J.call(q);else for(var z=J.length,Z=R(J,z),ge=0;ge<z;++ge)Z[ge].call(q)}function B(J,ee,q,z){if(ee)J.call(q,z);else for(var Z=J.length,ge=R(J,Z),oe=0;oe<Z;++oe)ge[oe].call(q,z)}function T(J,ee,q,z,Z){if(ee)J.call(q,z,Z);else for(var ge=J.length,oe=R(J,ge),je=0;je<ge;++je)oe[je].call(q,z,Z)}function Se(J,ee,q,z,Z,ge){if(ee)J.call(q,z,Z,ge);else for(var oe=J.length,je=R(J,oe),Ve=0;Ve<oe;++Ve)je[Ve].call(q,z,Z,ge)}function pe(J,ee,q,z){if(ee)J.apply(q,z);else for(var Z=J.length,ge=R(J,Z),oe=0;oe<Z;++oe)ge[oe].apply(q,z)}Te.prototype.emit=function(ee){var q,z,Z,ge,oe,je,Ve,at=ee==="error";if(je=this._events,je)at=at&&je.error==null;else if(!at)return!1;if(Ve=this.domain,at){if(q=arguments[1],Ve)q||(q=new Error('Uncaught, unspecified "error" event')),q.domainEmitter=this,q.domain=Ve,q.domainThrown=!1,Ve.emit("error",q);else{if(q instanceof Error)throw q;var tt=new Error('Uncaught, unspecified "error" event. ('+q+")");throw tt.context=q,tt}return!1}if(z=je[ee],!z)return!1;var We=typeof z=="function";switch(Z=arguments.length,Z){case 1:Je(z,We,this);break;case 2:B(z,We,this,arguments[1]);break;case 3:T(z,We,this,arguments[1],arguments[2]);break;case 4:Se(z,We,this,arguments[1],arguments[2],arguments[3]);break;default:for(ge=new Array(Z-1),oe=1;oe<Z;oe++)ge[oe-1]=arguments[oe];pe(z,We,this,ge)}return!0};function Ke(J,ee,q,z){var Z,ge,oe;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if(ge=J._events,ge?(ge.newListener&&(J.emit("newListener",ee,q.listener?q.listener:q),ge=J._events),oe=ge[ee]):(ge=J._events=new ft,J._eventsCount=0),!oe)oe=ge[ee]=q,++J._eventsCount;else if(typeof oe=="function"?oe=ge[ee]=z?[q,oe]:[oe,q]:z?oe.unshift(q):oe.push(q),!oe.warned&&(Z=Xe(J),Z&&Z>0&&oe.length>Z)){oe.warned=!0;var je=new Error("Possible EventEmitter memory leak detected. "+oe.length+" "+ee+" listeners added. Use emitter.setMaxListeners() to increase limit");je.name="MaxListenersExceededWarning",je.emitter=J,je.type=ee,je.count=oe.length,Qe(je)}return J}function Qe(J){typeof console.warn=="function"?console.warn(J):console.log(J)}Te.prototype.addListener=function(ee,q){return Ke(this,ee,q,!1)},Te.prototype.on=Te.prototype.addListener,Te.prototype.prependListener=function(ee,q){return Ke(this,ee,q,!0)};function we(J,ee,q){var z=!1;function Z(){J.removeListener(ee,Z),z||(z=!0,q.apply(J,arguments))}return Z.listener=q,Z}Te.prototype.once=function(ee,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.on(ee,we(this,ee,q)),this},Te.prototype.prependOnceListener=function(ee,q){if(typeof q!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(ee,we(this,ee,q)),this},Te.prototype.removeListener=function(ee,q){var z,Z,ge,oe,je;if(typeof q!="function")throw new TypeError('"listener" argument must be a function');if(Z=this._events,!Z)return this;if(z=Z[ee],!z)return this;if(z===q||z.listener&&z.listener===q)--this._eventsCount===0?this._events=new ft:(delete Z[ee],Z.removeListener&&this.emit("removeListener",ee,z.listener||q));else if(typeof z!="function"){for(ge=-1,oe=z.length;oe-- >0;)if(z[oe]===q||z[oe].listener&&z[oe].listener===q){je=z[oe].listener,ge=oe;break}if(ge<0)return this;if(z.length===1){if(z[0]=void 0,--this._eventsCount===0)return this._events=new ft,this;delete Z[ee]}else O(z,ge);Z.removeListener&&this.emit("removeListener",ee,je||q)}return this},Te.prototype.off=function(J,ee){return this.removeListener(J,ee)},Te.prototype.removeAllListeners=function(ee){var q,z;if(z=this._events,!z)return this;if(!z.removeListener)return arguments.length===0?(this._events=new ft,this._eventsCount=0):z[ee]&&(--this._eventsCount===0?this._events=new ft:delete z[ee]),this;if(arguments.length===0){for(var Z=Object.keys(z),ge=0,oe;ge<Z.length;++ge)oe=Z[ge],oe!=="removeListener"&&this.removeAllListeners(oe);return this.removeAllListeners("removeListener"),this._events=new ft,this._eventsCount=0,this}if(q=z[ee],typeof q=="function")this.removeListener(ee,q);else if(q)do this.removeListener(ee,q[q.length-1]);while(q[0]);return this},Te.prototype.listeners=function(ee){var q,z,Z=this._events;return Z?(q=Z[ee],q?typeof q=="function"?z=[q.listener||q]:z=V(q):z=[]):z=[],z},Te.listenerCount=function(J,ee){return typeof J.listenerCount=="function"?J.listenerCount(ee):Ge.call(J,ee)},Te.prototype.listenerCount=Ge;function Ge(J){var ee=this._events;if(ee){var q=ee[J];if(typeof q=="function")return 1;if(q)return q.length}return 0}Te.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function O(J,ee){for(var q=ee,z=q+1,Z=J.length;z<Z;q+=1,z+=1)J[q]=J[z];J.pop()}function R(J,ee){for(var q=new Array(ee);ee--;)q[ee]=J[ee];return q}function V(J){for(var ee=new Array(J.length),q=0;q<ee.length;++q)ee[q]=J[q].listener||J[q];return ee}var fe=ie.getLogger("twilio-notificatiions");function W(J,ee){return["".concat(new Date().toISOString()," Twilio.Notifications ").concat(J,":")].concat(Array.from(ee))}var Re=function(){function J(){Pe.default(this,J)}return Me.default(J,[{key:"setLevel",value:function(q){fe.setLevel(q)}},{key:"trace",value:function(){for(var q=arguments.length,z=new Array(q),Z=0;Z<q;Z++)z[Z]=arguments[Z];fe.trace.apply(null,W("T",z))}},{key:"debug",value:function(){for(var q=arguments.length,z=new Array(q),Z=0;Z<q;Z++)z[Z]=arguments[Z];fe.debug.apply(null,W("D",z))}},{key:"info",value:function(){for(var q=arguments.length,z=new Array(q),Z=0;Z<q;Z++)z[Z]=arguments[Z];fe.info.apply(null,W("I",z))}},{key:"warn",value:function(){for(var q=arguments.length,z=new Array(q),Z=0;Z<q;Z++)z[Z]=arguments[Z];fe.warn.apply(null,W("W",z))}},{key:"error",value:function(){for(var q=arguments.length,z=new Array(q),Z=0;Z<q;Z++)z[Z]=arguments[Z];fe.error.apply(null,W("E",z))}}]),J}(),me=new Re;function be(J){var ee=Ce();return function(){var z=re.default(J),Z;if(ee){var ge=re.default(this).constructor;Z=Reflect.construct(z,arguments,ge)}else Z=z.apply(this,arguments);return x.default(this,Z)}}function Ce(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Q=Me.default(function J(){var ee=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",z=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;Pe.default(this,J),this.token=ee,this.notificationId=q,this.messageTypes=z});function Fe(J,ee){return[].concat(ue.default(ue.default(J).filter(function(q){return!ee.has(q)})),ue.default(ue.default(ee).filter(function(q){return!J.has(q)})))}function Ue(J,ee){var q=new Set;return J.notificationId!==ee.notificationId&&q.add("notificationId"),J.token!==ee.token&&q.add("token"),Fe(J.messageTypes,ee.messageTypes).length>0&&q.add("messageType"),[q.size>0,q]}var Ae=function(J){le.default(q,J);var ee=be(q);function q(z){var Z;return Pe.default(this,q),Z=ee.call(this),ce.default(xe.default(Z),"desiredState",new Q),ce.default(xe.default(Z),"currentState",new Q),ce.default(xe.default(Z),"_hasActiveAttempt",!1),Z.channelType=z,Z}return Me.default(q,[{key:"setNotificationId",value:function(Z){this.desiredState.notificationId=Z}},{key:"isActive",value:function(){return this.desiredState.notificationId!==""}},{key:"subscribe",value:function(Z){if(this.desiredState.messageTypes.has(Z)){me.debug("message type '".concat(Z,"' for channel ").concat(this.channelType," is already registered"));return}this.desiredState.messageTypes.add(Z)}},{key:"unsubscribe",value:function(Z){!this.desiredState.messageTypes.has(Z)||this.desiredState.messageTypes.delete(Z)}},{key:"updateToken",value:function(Z){this.desiredState.token=Z}},{key:"commitChanges",value:function(){var z=se.default(de.default.mark(function ge(){var oe,je,Ve,at,tt,We;return de.default.wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:if(!this._hasActiveAttempt){rt.next=3;break}throw me.error("One registration attempt is already in progress"),new Error("One registration attempt is already in progress");case 3:if(oe=Ue(this.desiredState,this.currentState),je=te.default(oe,2),Ve=je[0],at=je[1],Ve){rt.next=6;break}return rt.abrupt("return");case 6:if(this.currentState.notificationId||at.delete("notificationId"),me.trace("Persisting ".concat(this.channelType," registration"),at,this.desiredState),rt.prev=8,this._hasActiveAttempt=!0,tt=new Q,tt.token=this.desiredState.token,tt.notificationId=this.desiredState.notificationId,tt.messageTypes=new Set(this.desiredState.messageTypes),!(tt.messageTypes.size>0)){rt.next=24;break}return rt.next=17,this.updateRegistration(tt,at);case 17:We=rt.sent,this.currentState.token=We.token,this.currentState.notificationId=We.notificationId,this.currentState.messageTypes=new Set(We.messageTypes),this.emit("stateChanged",this.channelType,"registered",this.currentState),rt.next=30;break;case 24:return rt.next=26,this.removeRegistration();case 26:this.currentState.token=tt.token,this.currentState.notificationId=tt.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged",this.channelType,"unregistered",this.currentState);case 30:rt.next=35;break;case 32:throw rt.prev=32,rt.t0=rt.catch(8),rt.t0;case 35:return rt.prev=35,this._hasActiveAttempt=!1,rt.finish(35);case 38:case"end":return rt.stop()}},ge,this,[[8,32,35,38]])}));function Z(){return z.apply(this,arguments)}return Z}()}]),q}(Te);function ae(J){var ee=F();return function(){var z=re.default(J),Z;if(ee){var ge=re.default(this).constructor;Z=Reflect.construct(z,arguments,ge)}else Z=z.apply(this,arguments);return x.default(this,Z)}}function F(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var H={min:2e3,max:12e4,randomness:.2},K=function(J){le.default(q,J);var ee=ae(q);function q(z,Z,ge,oe){var je;return Pe.default(this,q),je=ee.call(this,z),ce.default(xe.default(je),"registrationId",null),je.context=Z,je.twilsock=ge,je.registrarUrl=oe,je}return Me.default(q,[{key:"updateRegistration",value:function(){var z=se.default(de.default.mark(function ge(oe,je){var Ve=this,at,tt,We,fr,rt;return de.default.wrap(function(Nt){for(;;)switch(Nt.prev=Nt.next){case 0:if(!je.has("notificationId")){Nt.next=3;break}return Nt.next=3,this.removeRegistration();case 3:if(!(!oe.notificationId||!oe.notificationId.length)){Nt.next=6;break}throw me.error("No push notification ID for registration"),new Error("No push notification ID for registration");case 6:return me.trace("Registering",this.channelType,oe),at={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(oe.messageTypes),data:{registration_id:oe.notificationId}},tt=this.context.productId,We="".concat(this.registrarUrl,"?productId=").concat(tt),fr={"Content-Type":"application/json"},me.trace("Creating registration for channel ".concat(this.channelType)),Nt.prev=12,Nt.next=15,new w.AsyncRetrier(H).run(function(){return Ve.twilsock.post(We,fr,at,tt)});case 15:rt=Nt.sent,this.registrationId=rt.body.id,me.debug("Registration created: ",rt),Nt.next=24;break;case 20:throw Nt.prev=20,Nt.t0=Nt.catch(12),me.error("Registration failed: ",Nt.t0),Nt.t0;case 24:return Nt.abrupt("return",oe);case 25:case"end":return Nt.stop()}},ge,this,[[12,20]])}));function Z(ge,oe){return z.apply(this,arguments)}return Z}()},{key:"removeRegistration",value:function(){var z=se.default(de.default.mark(function ge(){var oe=this,je,Ve,at;return de.default.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:if(this.registrationId){We.next=2;break}return We.abrupt("return");case 2:return je=this.context.productId,Ve="".concat(this.registrarUrl,"/").concat(this.registrationId,"?productId=").concat(je),at={"Content-Type":"application/json"},me.trace("Removing registration for ".concat(this.channelType)),We.prev=6,We.next=9,new w.AsyncRetrier(Object.assign(H,{maxAttemptsCount:3})).run(function(){return oe.twilsock.delete(Ve,at,{},je)});case 9:this.registrationId=null,this.currentState.notificationId="",me.debug("Registration removed for ".concat(this.channelType)),We.next=18;break;case 14:throw We.prev=14,We.t0=We.catch(6),me.error("Failed to remove registration ",this.channelType,We.t0),We.t0;case 18:case"end":return We.stop()}},ge,this,[[6,14]])}));function Z(){return z.apply(this,arguments)}return Z}()},{key:"sendDeviceRemoveRequest",value:function(){var z=se.default(de.default.mark(function ge(oe){var je=this,Ve,at,tt,We;return de.default.wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:if(oe!==""){rt.next=2;break}throw new Error("Empty registration ID");case 2:return Ve=this.context.productId,at="".concat(this.registrarUrl,"?productId=").concat(Ve),tt={"Content-Type":"application/json"},We={binding_type:this.channelType,address:oe},rt.prev=6,me.trace("Removing old registrations for ".concat(this.channelType)),rt.next=10,new w.AsyncRetrier(Object.assign(H,{maxAttemptsCount:3})).run(function(){return je.twilsock.delete(at,tt,We,Ve)});case 10:this.registrationId=null,this.currentState.notificationId="",me.debug("Registration removed for ".concat(this.channelType)),rt.next=19;break;case 15:throw rt.prev=15,rt.t0=rt.catch(6),me.error("Failed to remove registration ",this.channelType,rt.t0),rt.t0;case 19:case"end":return rt.stop()}},ge,this,[[6,15]])}));function Z(ge){return z.apply(this,arguments)}return Z}()}]),q}(Ae);function ye(J){var ee=Ne();return function(){var z=re.default(J),Z;if(ee){var ge=re.default(this).constructor;Z=Reflect.construct(z,arguments,ge)}else Z=z.apply(this,arguments);return x.default(this,Z)}}function Ne(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var qe=function(J){le.default(q,J);var ee=ye(q);function q(z,Z,ge){var oe;return Pe.default(this,q),oe=ee.call(this,"twilsock"),ce.default(xe.default(oe),"contextId",Ie.v4()),oe.productId=z,oe.platform=Z,oe.twilsock=ge,oe}return Me.default(q,[{key:"updateRegistration",value:function(){var z=se.default(de.default.mark(function ge(oe,je){var Ve,at;return de.default.wrap(function(We){for(;;)switch(We.prev=We.next){case 0:if(je.has("messageType")){We.next=2;break}return We.abrupt("return",oe);case 2:return Ve=Array.from(oe.messageTypes),at={product_id:this.productId,notification_protocol_version:4,endpoint_platform:this.platform,message_types:Ve},We.prev=4,We.next=7,this.twilsock.setNotificationsContext(this.contextId,at);case 7:We.next=13;break;case 9:throw We.prev=9,We.t0=We.catch(4),me.error("Failed to update twilsock notification context: ".concat(We.t0)),We.t0;case 13:return We.abrupt("return",oe);case 14:case"end":return We.stop()}},ge,this,[[4,9]])}));function Z(ge,oe){return z.apply(this,arguments)}return Z}()},{key:"removeRegistration",value:function(){var z=se.default(de.default.mark(function ge(){return de.default.wrap(function(je){for(;;)switch(je.prev=je.next){case 0:return je.prev=0,je.next=3,this.twilsock.removeNotificationsContext(this.contextId);case 3:je.next=9;break;case 5:throw je.prev=5,je.t0=je.catch(0),me.error("Failed to remove twilsock notification context: ".concat(je.t0)),je.t0;case 9:case"end":return je.stop()}},ge,this,[[0,5]])}));function Z(){return z.apply(this,arguments)}return Z}()},{key:"sendDeviceRemoveRequest",value:function(){var z=se.default(de.default.mark(function ge(oe){return de.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:case"end":return Ve.stop()}},ge)}));function Z(ge){return z.apply(this,arguments)}return Z}()}]),q}(Ae);function ze(J){var ee=De();return function(){var z=re.default(J),Z;if(ee){var ge=re.default(this).constructor;Z=Reflect.construct(z,arguments,ge)}else Z=z.apply(this,arguments);return x.default(this,Z)}}function De(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var He,Le=j.literal("apn","fcm","twilsock");e.Notifications=He=function(J){le.default(q,J);var ee=ze(q);function q(z){var Z,ge,oe,je,Ve,at,tt,We=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Pe.default(this,q),tt=ee.call(this),We.logLevel=(Z=We.logLevel)!==null&&Z!==void 0?Z:"error",me.setLevel(We.logLevel);var fr=(ge=We.productId)!==null&&ge!==void 0?ge:"notifications",rt=!We.twilsockClient,Ir=We.twilsockClient=(oe=We.twilsockClient)!==null&&oe!==void 0?oe:new l.TwilsockClient(z,fr,We),Nt=(je=We.notifications)!==null&&je!==void 0?je:{},mn=(Ve=(at=Nt.region)!==null&&at!==void 0?at:We.region)!==null&&Ve!==void 0?Ve:"us1",Zt="https://ers.".concat(mn,".twilio.com/v1/registrations"),Fn=Nt.ersUrl||Zt;tt.connectors=new Map;var Et=He._detectPlatform();return tt.connectors.set("apn",new K("apn",{protocolVersion:4,productId:fr,platform:Et},Ir,Fn)),tt.connectors.set("fcm",new K("fcm",{protocolVersion:3,productId:fr,platform:Et},Ir,Fn)),tt.connectors.set("twilsock",new qe(fr,Et,Ir)),Ir.on("stateChanged",function(dr){return tt.emit("transportState",dr)}),tt._connector("twilsock").on("stateChanged",function(dr,qr,Hr){return tt.emit("stateChanged",dr,qr,Hr)}),tt._connector("apn").on("stateChanged",function(dr,qr,Hr){return tt.emit("stateChanged",dr,qr,Hr)}),tt._connector("fcm").on("stateChanged",function(dr,qr,Hr){return tt.emit("stateChanged",dr,qr,Hr)}),Ir.on("message",function(dr,qr){return tt._routeMessage(dr,qr)}),tt.updateToken(z),rt&&(Ir.connect(),tt.twilsock=Ir),tt}return Me.default(q,[{key:"shutdown",value:function(){var z=se.default(de.default.mark(function ge(){return de.default.wrap(function(je){for(;;)switch(je.prev=je.next){case 0:if(this.connectors.clear(),!this.twilsock){je.next=4;break}return je.next=4,this.twilsock.disconnect();case 4:case"end":return je.stop()}},ge,this)}));function Z(){return z.apply(this,arguments)}return Z}()},{key:"setPushRegistrationId",value:function(Z,ge){me.debug("Set ".concat(Z," push registration id '").concat(ge,"'")),this._connector(Z).setNotificationId(ge)}},{key:"subscribe",value:function(Z,ge){me.debug("Add ".concat(Z," subscriptions for message type ").concat(ge)),this._connector(Z).subscribe(ge)}},{key:"unsubscribe",value:function(Z,ge){me.debug("Remove ".concat(Z," subscriptions for message type ").concat(ge)),this._connector(Z).unsubscribe(ge)}},{key:"updateToken",value:function(Z){this.connectors.forEach(function(ge){return ge.updateToken(Z)})}},{key:"commitChanges",value:function(){var z=se.default(de.default.mark(function ge(){var oe;return de.default.wrap(function(Ve){for(;;)switch(Ve.prev=Ve.next){case 0:return oe=[],this.connectors.forEach(function(at){at.isActive()&&oe.push(at.commitChanges())}),Ve.next=4,Promise.all(oe);case 4:case"end":return Ve.stop()}},ge,this)}));function Z(){return z.apply(this,arguments)}return Z}()},{key:"removeRegistrations",value:function(){var z=se.default(de.default.mark(function ge(oe,je){return de.default.wrap(function(at){for(;;)switch(at.prev=at.next){case 0:return at.next=2,this._connector(oe).sendDeviceRemoveRequest(je);case 2:case"end":return at.stop()}},ge,this)}));function Z(ge,oe){return z.apply(this,arguments)}return Z}()},{key:"handlePushNotification",value:function(Z){return{messageType:Z.twi_message_type,payload:Z.payload}}},{key:"_routeMessage",value:function(Z,ge){me.debug("Notification message arrived: ",Z,ge),this.emit("message",Z,ge)}},{key:"_connector",value:function(Z){var ge=this.connectors.get(Z);if(!ge)throw new Error("Unknown channel type: ".concat(Z));return ge}}],[{key:"_detectPlatform",value:function(){var Z="";return typeof navigator<"u"?(Z="unknown",typeof navigator.product<"u"&&(Z=navigator.product),typeof navigator.userAgent<"u"&&(Z=navigator.userAgent)):Z="web",Z.substring(0,128)}}]),q}(Te),$e([j.validateTypes(Le,j.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",void 0)],e.Notifications.prototype,"setPushRegistrationId",null),$e([j.validateTypes(Le,j.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",void 0)],e.Notifications.prototype,"subscribe",null),$e([j.validateTypes(Le,j.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",void 0)],e.Notifications.prototype,"unsubscribe",null),$e([j.validateTypes(j.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String]),N("design:returntype",void 0)],e.Notifications.prototype,"updateToken",null),$e([j.validateTypesAsync(Le,j.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String,String]),N("design:returntype",Promise)],e.Notifications.prototype,"removeRegistrations",null),e.Notifications=He=$e([j.validateConstructorTypes(j.nonEmptyString,[j.pureObject,"undefined",j.literal(null)]),N("design:paramtypes",[String,Object])],e.Notifications)})(KE);var Br={};/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes Backoff library under the following license

    Copyright (C) 2012 Mathieu Turcotte

    Permission is hereby granted, free of charge, to any person obtaining a copy of
    this software and associated documentation files (the "Software"), to deal in
    the Software without restriction, including without limitation the rights to
    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
    of the Software, and to permit persons to whom the Software is furnished to do
    so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.

This software includes Event-to-Promise library under the following license

    Copyright (c) 2014, Julien Fontanet <julien.fontanet@isonoe.net>.

    Permission to use, copy, modify, and/or distribute this software for any purpose
    with or without fee is hereby granted, provided that the above copyright notice
    and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
    FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
    OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
    TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
    THIS SOFTWARE.

*/Object.defineProperty(Br,"__esModule",{value:!0});var L9=So.exports,j9=Un.exports,U9=ta.exports,F9=hi.exports,D9=Nn.exports,B9=Ln.exports,q9=Xr.exports,H9=yi.exports,W9=ul,G9=jn.exports,_e=Tr,Dc=xf,z9=vg.exports,V9=cs.exports,K9=gi.exports,XE=Ma,ZE=Lf,Y9=Mf.exports,J9=Fc.exports;function Zr(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function yg(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if(r!=="default"){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,Object.freeze(t)}var Oe=Zr(L9),vt=Zr(j9),St=Zr(U9),Kn=Zr(F9),Mr=Zr(D9),Si=Zr(B9),Yt=Zr(q9),$t=Zr(H9),G=Zr(W9),eI=Zr(G9),Q9=Zr(z9),X9=yg(V9),tI=Zr(K9),Z9=yg(ZE),fl=Zr(Y9),Jl=yg(J9);function yt(e,t,r,n){var a=arguments.length,i=a<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if((typeof Reflect>"u"?"undefined":eI.default(Reflect))==="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(s=e[u])&&(i=(a<3?s(i):a>3?s(t,r,i):s(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function Ee(e,t){if((typeof Reflect>"u"?"undefined":eI.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}var eY;function ai(){}ai.prototype=Object.create(null);function kt(){kt.init.call(this)}kt.EventEmitter=kt;kt.usingDomains=!1;kt.prototype.domain=void 0;kt.prototype._events=void 0;kt.prototype._maxListeners=void 0;kt.defaultMaxListeners=10;kt.init=function(){this.domain=null,kt.usingDomains&&eY.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new ai,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};kt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function rI(e){return e._maxListeners===void 0?kt.defaultMaxListeners:e._maxListeners}kt.prototype.getMaxListeners=function(){return rI(this)};function tY(e,t,r){if(t)e.call(r);else for(var n=e.length,a=dl(e,n),i=0;i<n;++i)a[i].call(r)}function rY(e,t,r,n){if(t)e.call(r,n);else for(var a=e.length,i=dl(e,a),s=0;s<a;++s)i[s].call(r,n)}function nY(e,t,r,n,a){if(t)e.call(r,n,a);else for(var i=e.length,s=dl(e,i),u=0;u<i;++u)s[u].call(r,n,a)}function aY(e,t,r,n,a,i){if(t)e.call(r,n,a,i);else for(var s=e.length,u=dl(e,s),o=0;o<s;++o)u[o].call(r,n,a,i)}function iY(e,t,r,n){if(t)e.apply(r,n);else for(var a=e.length,i=dl(e,a),s=0;s<a;++s)i[s].apply(r,n)}kt.prototype.emit=function(t){var r,n,a,i,s,u,o,l=t==="error";if(u=this._events,u)l=l&&u.error==null;else if(!l)return!1;if(o=this.domain,l){if(r=arguments[1],o)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=o,r.domainThrown=!1,o.emit("error",r);else{if(r instanceof Error)throw r;var c=new Error('Uncaught, unspecified "error" event. ('+r+")");throw c.context=r,c}return!1}if(n=u[t],!n)return!1;var h=typeof n=="function";switch(a=arguments.length,a){case 1:tY(n,h,this);break;case 2:rY(n,h,this,arguments[1]);break;case 3:nY(n,h,this,arguments[1],arguments[2]);break;case 4:aY(n,h,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(a-1),s=1;s<a;s++)i[s-1]=arguments[s];iY(n,h,this,i)}return!0};function nI(e,t,r,n){var a,i,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=e._events,i?(i.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),i=e._events),s=i[t]):(i=e._events=new ai,e._eventsCount=0),!s)s=i[t]=r,++e._eventsCount;else if(typeof s=="function"?s=i[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(a=rI(e),a&&a>0&&s.length>a)){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,sY(u)}return e}function sY(e){typeof console.warn=="function"?console.warn(e):console.log(e)}kt.prototype.addListener=function(t,r){return nI(this,t,r,!1)};kt.prototype.on=kt.prototype.addListener;kt.prototype.prependListener=function(t,r){return nI(this,t,r,!0)};function aI(e,t,r){var n=!1;function a(){e.removeListener(t,a),n||(n=!0,r.apply(e,arguments))}return a.listener=r,a}kt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,aI(this,t,r)),this};kt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,aI(this,t,r)),this};kt.prototype.removeListener=function(t,r){var n,a,i,s,u;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=this._events,!a)return this;if(n=a[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new ai:(delete a[t],a.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(i=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){u=n[s].listener,i=s;break}if(i<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new ai,this;delete a[t]}else oY(n,i);a.removeListener&&this.emit("removeListener",t,u||r)}return this};kt.prototype.off=function(e,t){return this.removeListener(e,t)};kt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new ai,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new ai:delete n[t]),this;if(arguments.length===0){for(var a=Object.keys(n),i=0,s;i<a.length;++i)s=a[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new ai,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};kt.prototype.listeners=function(t){var r,n,a=this._events;return a?(r=a[t],r?typeof r=="function"?n=[r.listener||r]:n=uY(r):n=[]):n=[],n};kt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):iI.call(e,t)};kt.prototype.listenerCount=iI;function iI(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}kt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function oY(e,t){for(var r=t,n=r+1,a=e.length;n<a;r+=1,n+=1)e[r]=e[n];e.pop()}function dl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function uY(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}var co=function(){function e(t){vt.default(this,e),this.base=t,this.args=new Array,this.paths=new Array}return St.default(e,[{key:"pathSegment",value:function(r){return this.paths.push(encodeURIComponent(r)),this}},{key:"queryParam",value:function(r,n){return typeof n<"u"&&this.args.push(encodeURIComponent(r)+"="+encodeURIComponent(n)),this}},{key:"build",value:function(){var r=this.base;return this.paths.length&&(r+="/"+this.paths.join("/")),this.args.length&&(r+="?"+this.args.join("&")),r}}]),e}();function sI(e){var t=lY();return function(){var n=Yt.default(e),a;if(t){var i=Yt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Si.default(this,a)}}function lY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Dr=function(e){Mr.default(r,e);var t=sI(r);function r(n){var a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return vt.default(this,r),a=t.call(this),a.name=a.constructor.name,a.message="".concat(n," (status: ").concat(i,", code: ").concat(s,")"),a.status=i,a.code=s,a}return r}(Q9.default(Error)),cY=function(e){Mr.default(r,e);var t=sI(r);function r(n){var a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3?arguments[3]:void 0;return vt.default(this,r),a=t.call(this,n,i,s),a.body=u,a}return r}(Dr);function On(e){return JSON.parse(JSON.stringify(e))}function oI(e){var t=e===void 0||gg(e);if(!t)throw new Dr("Invalid pageSize parameter. Expected a positive integer, was '".concat(e,"'."),400,20007)}function fY(e){return!isNaN(parseInt(e))&&isFinite(e)}function gg(e){return fY(e)&&e>0}var Os=X9.getLogger("twilio-sync");function tu(e,t){return["".concat(new Date().toISOString()," Sync ").concat(e,":")].concat(Array.from(t))}var gt={setLevel:function(t){Os.setLevel(t)},trace:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Os.trace.apply(null,tu("T",r))},debug:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Os.debug.apply(null,tu("D",r))},info:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Os.info.apply(null,tu("I",r))},warn:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Os.warn.apply(null,tu("W",r))},error:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];Os.error.apply(null,tu("E",r))}},dY="/v4/Subscriptions",pY="/v3/Maps",vY="/v3/Lists",hY="/v3/Documents",yY="/v3/Streams",gY="/v3/Insights";function mY(e,t,r){return e&&typeof e[t]<"u"?e[t]:r}var bY=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};vt.default(this,e);var r=t.region||"us1",n="https://cds.".concat(r,".twilio.com"),a=t.cdsUri||n;this.settings={subscriptionsUri:a+dY,documentsUri:a+hY,listsUri:a+vY,mapsUri:a+pY,streamsUri:a+yY,insightsUri:a+gY,sessionStorageEnabled:mY(t.Sync,"enableSessionStorage",!0),productId:t.productId}}return St.default(e,[{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"streamsUri",get:function(){return this.settings.streamsUri}},{key:"insightsUri",get:function(){return this.settings.insightsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}},{key:"productId",get:function(){return this.settings.productId}}]),e}();function ru(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=wY(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function wY(e,t){if(!!e){if(typeof e=="string")return TS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return TS(e,t)}}function TS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var _Y=function(){function e(t){vt.default(this,e),this.localObject=t,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}return St.default(e,[{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"indexName",get:function(){return this.localObject.indexName}},{key:"queryString",get:function(){return this.localObject.queryString}},{key:"isEstablished",get:function(){return this.established}},{key:"update",value:function(r,n){this.localObject._update(r,n)}},{key:"updatePending",value:function(r,n){this.pendingAction=r,this.pendingCorrelationId=n}},{key:"reset",value:function(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}},{key:"markAsFailed",value:function(r){this.rejectedWithError=r.error,this.updatePending(null,null),this.localObject.reportFailure(new Dr("Failed to subscribe on service events: ".concat(r.error.message),r.error.status,r.error.code))}},{key:"complete",value:function(r){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(r)}},{key:"setSubscriptionState",value:function(r){this.localObject._setSubscriptionState(r)}}]),e}(),SY=function(){function e(t){var r=this;vt.default(this,e),$t.default(this,"isConnected",!1),$t.default(this,"maxBatchSize",100),$t.default(this,"subscriptionTtlTimer",null),$t.default(this,"pendingPokeReason",null),this.services=t,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map;var n={randomisationFactor:.2,initialDelay:100,maxDelay:2*60*1e3};this.backoff=XE.Backoff.exponential(Object.assign(n,this.services.config.backoffConfig)),this.backoff.on("ready",function(){var a=r.getSubscriptionUpdateBatch(),i=a.action,s=a.subscriptions;i?r.applyNewSubscriptionUpdateBatch(i,s):(r.backoff.reset(),gt.debug("All subscriptions resolved."))})}return St.default(e,[{key:"getSubscriptionUpdateBatch",value:function(){function r(i,s,u,o){var l=[],c=ru(i),h;try{for(c.s();!(h=c.n()).done;){var w=tI.default(h.value,2),b=w[0],$=w[1],C=s.get(b);if(!C&&u!==$.pendingAction&&!$.rejectedWithError&&(l.push($),o&&l.length>=o))break}}catch(I){c.e(I)}finally{c.f()}return l}var n=r(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(n.length>0)return{action:"establish",subscriptions:n};var a=r(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return a.length>0?{action:"cancel",subscriptions:a}:{action:null,subscriptions:null}}},{key:"persist",value:function(){this.backoff.backoff()}},{key:"applyNewSubscriptionUpdateBatch",value:function(){var t=Oe.default(G.default.mark(function n(a,i){var s=this,u,o,l,c,h,w,b,$,C,I,j,D,ve,se,Pe,Me;return G.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(this.isConnected){x.next=4;break}return gt.debug("Twilsock connection (required for subscription) not ready; waiting\u2026"),this.backoff.reset(),x.abrupt("return");case 4:i=this.processLocalActions(a,i),u=new Date().getTime(),o=ru(i);try{for(o.s();!(l=o.n()).done;)c=l.value,this.recordActionAttemptOn(c,a,u)}catch(re){o.e(re)}finally{o.f()}return h=this.pendingPokeReason,this.pendingPokeReason=null,x.prev=10,x.next=13,this.request(a,u,h,i);case 13:w=x.sent,b=w.body.max_batch_size,!isNaN(parseInt(b))&&isFinite(b)&&b>0&&(this.maxBatchSize=b),this.subscriptionTtlTimer||($=w.body.ttl_in_s,C=!isNaN(parseFloat($))&&isFinite($),I=C&&$>0,I&&(this.subscriptionTtlTimer=setTimeout(function(){return s.onSubscriptionTtlElapsed()},$*1e3))),a==="establish"&&(j=w.body.estimated_delivery_in_ms,D=!isNaN(parseFloat(j))&&isFinite(j),ve=D&&j>0,ve?setTimeout(function(){return s.verifyPokeDelivery(u,j,i)},j):gt.error("Invalid timeout: ".concat(j)),i.filter(function(re){return re.pendingCorrelationId===u}).forEach(function(re){return re.setSubscriptionState("response_in_flight")})),this.backoff.reset(),x.next=26;break;case 21:x.prev=21,x.t0=x.catch(10),se=ru(i);try{for(se.s();!(Pe=se.n()).done;)Me=Pe.value,this.recordActionFailureOn(Me,a)}catch(re){se.e(re)}finally{se.f()}x.t0 instanceof Dc.TransportUnavailableError?(gt.debug("Twilsock connection (required for subscription) not ready (c:".concat(u,"); waiting\u2026")),this.backoff.reset()):(gt.debug("Failed an attempt to ".concat(a," subscriptions (c:").concat(u,"); retrying"),x.t0),this.persist());case 26:case"end":return x.stop()}},n,this,[[10,21]])}));function r(n,a){return t.apply(this,arguments)}return r}()},{key:"verifyPokeDelivery",value:function(r,n,a){var i=this,s=this.latestPokeResponseArrivalTimestampByCorrelationId.get(r),u=s?new Date().getTime()-s:n;if(u>=n)a.filter(function(l){return l.pendingCorrelationId===r}).forEach(function(l){l.updatePending(null,null),l.retryCount++,i.persisted.delete(l.sid)}),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(r);else{var o=n-u;setTimeout(function(){return i.verifyPokeDelivery(r,n,a)},o)}}},{key:"processLocalActions",value:function(r,n){return r==="cancel"?n.filter(function(a){return!a.rejectedWithError}):n}},{key:"recordActionAttemptOn",value:function(r,n,a){if(r.setSubscriptionState("request_in_flight"),n==="establish")this.persisted.set(r.sid,r),r.updatePending(n,a);else{var i=this.persisted.get(r.sid);i&&i.updatePending(n,a)}}},{key:"recordActionFailureOn",value:function(r,n){r.setSubscriptionState("none"),r.updatePending(null,null),n==="establish"&&this.persisted.delete(r.sid)}},{key:"request",value:function(r,n,a,i){var s=i.map(function(l){return{object_sid:l.sid,object_type:l.type,last_event_id:r==="establish"?l.lastEventId:void 0,index_name:r==="establish"?l.indexName:void 0,query_string:r==="establish"?l.queryString:void 0}}),u=i.filter(function(l){return l.retryCount>0}).length;gt.debug("Attempting '".concat(r,"' request (c:").concat(n,"):"),s);var o={event_protocol_version:4,action:r,correlation_id:n,retried_requests:u,ttl_in_s:-1,requests:s};return a==="ttl"&&(o.reason=a),this.services.network.post(this.services.config.subscriptionsUri,o)}},{key:"add",value:function(r,n){gt.debug("Establishing intent to subscribe to ".concat(r));var a=this.subscriptions.get(r);a&&n&&a.lastEventId===n.lastEventId||(this.persisted.delete(r),this.subscriptions.set(r,new _Y(n)),this.persist())}},{key:"remove",value:function(r){gt.debug("Establishing intent to unsubscribe from ".concat(r));var n=this.subscriptions.delete(r);n&&this.persist()}},{key:"acceptMessage",value:function(r,n){gt.trace("Subscriptions received",r);var a=r.event_type,i=typeof r.events<"u"?r.events:[r.event],s=r.correlation_id;s&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(s,new Date().getTime());var u=ru(i),o;try{for(u.s();!(o=u.n()).done;){var l=o.value,c=void 0;switch(r.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(l,s);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(l,s);break;case"subscription_failed":this.applySubscriptionFailedMessage(l,s);break;case(c=a.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:{var h=void 0;switch(c[0]){case"map_":h=l.map_sid;break;case"list_":h=l.list_sid;break;case"document_":h=l.document_sid;break;case"stream_":h=l.stream_sid;break;case"live_query_":h=l.query_id,n=!1,r.strictly_ordered===!0&&(n=!0);break;default:h=void 0}this.applyEventToSubscribedEntity(h,l,a,n);break}default:gt.debug("Dropping unknown message type ".concat(a));break}}}catch(w){u.e(w)}finally{u.f()}}},{key:"applySubscriptionEstablishedMessage",value:function(r,n){var a=r.object_sid,i=this.persisted.get(r.object_sid);i&&i.pendingCorrelationId===n?r.replay_status==="interrupted"?(gt.debug("Event Replay for subscription to ".concat(a," (c:").concat(n,") interrupted; continuing eagerly.")),i.updatePending(null,null),this.persisted.delete(i.sid),this.backoff.reset()):r.replay_status==="completed"&&(gt.debug("Event Replay for subscription to ".concat(a," (c:").concat(n,") completed. Subscription is ready.")),i.complete(r.last_event_id),this.persisted.set(r.object_sid,i),i.setSubscriptionState("established"),this.backoff.reset()):gt.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(r,n){var a=this.persisted.get(r.object_sid);a&&a.pendingCorrelationId===n?(a.updatePending(null,null),a.setSubscriptionState("none"),this.persisted.delete(r.object_sid)):gt.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(r,n){var a=r.object_sid,i=this.subscriptions.get(a),s=this.persisted.get(a);i&&s?s.pendingCorrelationId===n&&(gt.error("Failed to subscribe on ".concat(s.sid),r.error),s.markAsFailed(r),s.setSubscriptionState("none")):!i&&s&&(this.persisted.delete(a),s.setSubscriptionState("none")),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(r,n,a,i){var s=this;if(!!r){i=i||function(){var o=s.persisted.get(r);return o&&o.isEstablished}();var u=this.subscriptions.get(r);u?(n.type=a,u.update(n,i)):gt.debug("Message dropped for SID '".concat(r,"', for which there is no subscription."))}}},{key:"onConnectionStateChanged",value:function(r){this.isConnected=r,r&&this.poke("reconnect")}},{key:"onSubscriptionTtlElapsed",value:function(){this.isConnected&&this.poke("ttl")}},{key:"poke",value:function(r){gt.debug("Triggering event replay for all subscriptions, reason=".concat(r)),this.pendingPokeReason=r,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);var n=[],a=ru(this.persisted.values()),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;s.reset(),s.rejectedWithError&&n.push(s)}}catch(c){a.e(c)}finally{a.f()}this.persisted.clear();for(var u=0,o=n;u<o.length;u++){var l=o[u];this.persisted.set(l.sid,l)}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),e}(),$Y=4e3,TY=6e4,kY=9e4,EY=.2;function kS(e){if(e.body&&e.body.message)return e.body.message;switch(e.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function ES(e){return e.body?e.body.code:0}function nu(e){return e.status===409?new cY(kS(e),e.status,ES(e),e.body):e.status?new Dr(kS(e),e.status,ES(e)):e instanceof Dc.TransportUnavailableError?e:new Dr(e.message,0,0)}var IY=function(){function e(t,r,n){vt.default(this,e),this.clientInfo=t,this.config=r,this.transport=n}return St.default(e,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+Z9.v4().replace(/-/g,"")}}},{key:"backoffConfig",value:function(){return Object.assign({min:$Y,max:TY,maxAttemptsTime:kY,randomness:EY},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(r){var n=this,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new Promise(function(i,s){var u=[502,503,504];a&&u.push(429);var o=new XE.Retrier(n.backoffConfig());o.on("attempt",function(){r().then(function(l){return o.succeeded(l)}).catch(function(l){if(u.includes(l.status)){var c=parseInt(l.headers?l.headers["Retry-After"]:null);o.failed(nu(l),isNaN(c)?null:c*1e3)}else l.message==="Twilsock disconnected"?o.failed(nu(l)):(o.removeAllListeners(),o.cancel(),s(nu(l)))})}),o.on("succeeded",function(l){i(l)}),o.on("cancelled",function(l){return s(nu(l))}),o.on("failed",function(l){return s(nu(l))}),o.start()})}},{key:"get",value:function(r){var n=this,a=this.createHeaders();return gt.debug("GET",r,"ID:",a["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.get(r,a,n.config.productId)},!0)}},{key:"post",value:function(r,n,a){var i=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,u=this.createHeaders();return typeof a<"u"&&a!==null&&(u["If-Match"]=a),gt.debug("POST",r,"ID:",u["Twilio-Request-Id"]),this.executeWithRetry(function(){return i.transport.post(r,u,n,i.config.productId)},s)}},{key:"put",value:function(r,n,a){var i=this,s=this.createHeaders();return typeof a<"u"&&a!==null&&(s["If-Match"]=a),gt.debug("PUT",r,"ID:",s["Twilio-Request-Id"]),this.executeWithRetry(function(){return i.transport.put(r,s,n,i.config.productId)},!1)}},{key:"delete",value:function(r){var n=this,a=this.createHeaders();return gt.debug("DELETE",r,"ID:",a["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.delete(r,a,n.config.productId)},!1)}}]),e}(),CY=function(){function e(t,r){vt.default(this,e),this.config=t,this.storageId=null;try{this.storage=r||sessionStorage}catch{}}return St.default(e,[{key:"storageKey",value:function(r,n){return"".concat(this.storageId,"::").concat(r,"::").concat(n)}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}},{key:"updateStorageId",value:function(r){this.storageId=r}},{key:"store",value:function(r,n,a){return this.isReady?this._store(this.storageKey(r,n),a):null}},{key:"read",value:function(r,n){return this.isReady?this._read(this.storageKey(r,n)):null}},{key:"remove",value:function(r,n,a){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(r,n)),a&&this.storage.removeItem(this.storageKey(r,a))}catch{}}},{key:"update",value:function(r,n,a,i){if(!this.isReady)return null;this._apply(this.storageKey(r,n),i),a&&this._apply(this.storageKey(r,a),i)}},{key:"_store",value:function(r,n){try{this.storage.setItem(r,JSON.stringify(n))}catch{}}},{key:"_read",value:function(r){try{var n=this.storage.getItem(r);if(n)return JSON.parse(n)}catch{}return null}},{key:"_apply",value:function(r,n){var a=this._read(r);if(!a)return!1;this._store(r,Object.assign(a,n))}}]),e}();function RY(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=AY(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function AY(e,t){if(!!e){if(typeof e=="string")return IS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return IS(e,t)}}function IS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var pl=function(){function e(t,r){vt.default(this,e),this.services=t,this.removalHandler=r,this.subscriptionState="none",this._attachedListeners=new Map}return St.default(e,[{key:"_advanceLastEventId",value:function(r,n){}},{key:"reportFailure",value:function(r){r.status===404?this.onRemoved(!1):this.broadcastEventToListeners("failure",r)}},{key:"_subscribe",value:function(){this.services.router._subscribe(this.sid,this)}},{key:"_unsubscribe",value:function(){this.services.router._unsubscribe(this.sid)}},{key:"_setSubscriptionState",value:function(r){this.subscriptionState=r,this.broadcastEventToListeners("_subscriptionStateChanged",r)}},{key:"close",value:function(){this._unsubscribe(),this.removalHandler!=null&&this.removalHandler(this.type,this.sid,this.uniqueName)}},{key:"attach",value:function(r){var n=r.listenerUuid,a=this._attachedListeners.get(n);a||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(n,r))}},{key:"detach",value:function(r){this._attachedListeners.delete(r),this._attachedListeners.size||this.close()}},{key:"broadcastEventToListeners",value:function(r,n){var a=RY(this._attachedListeners.values()),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;s.emit(r,n)}}catch(u){a.e(u)}finally{a.f()}}}]),e}(),uI=function(){function e(t){vt.default(this,e),$t.default(this,"queuedRequests",[]),$t.default(this,"isRequestInFlight",!1),this.inputMergingFunction=t}return St.default(e,[{key:"add",value:function(r,n){var a=this,i=new Promise(function(s,u){return a.queuedRequests.push({input:r,requestFunction:n,resolve:s,reject:u})});return this.wakeupQueue(),i}},{key:"squashAndAdd",value:function(r,n){var a=this.queuedRequests;this.queuedRequests=[];var i;a.length>0?(i=a.map(function(u){return u.input}).reduce(this.inputMergingFunction),i=this.inputMergingFunction(i,r)):i=r;var s=this.add(i,n);return a.forEach(function(u){return s.then(u.resolve,u.reject)}),s}},{key:"isEmpty",value:function(){return this.queuedRequests.length===0&&!this.isRequestInFlight}},{key:"wakeupQueue",value:function(){var r=this;if(!(this.queuedRequests.length===0||this.isRequestInFlight)){var n=this.queuedRequests.shift();this.isRequestInFlight=!0,n.requestFunction(n.input).then(n.resolve,n.reject).then(function(a){r.isRequestInFlight=!1,r.wakeupQueue()})}}}]),e}(),lI=function(){function e(t){vt.default(this,e),$t.default(this,"queueByNamespaceKey",new Map),this.inputReducer=t}return St.default(e,[{key:"add",value:function(){var t=Oe.default(G.default.mark(function n(a,i,s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.invokeQueueMethod(a,function(l){return l.add(i,s)}));case 1:case"end":return o.stop()}},n,this)}));function r(n,a,i){return t.apply(this,arguments)}return r}()},{key:"squashAndAdd",value:function(){var t=Oe.default(G.default.mark(function n(a,i,s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.invokeQueueMethod(a,function(l){return l.squashAndAdd(i,s)}));case 1:case"end":return o.stop()}},n,this)}));function r(n,a,i){return t.apply(this,arguments)}return r}()},{key:"invokeQueueMethod",value:function(){var t=Oe.default(G.default.mark(function n(a,i){var s,u;return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.queueByNamespaceKey.has(a)||this.queueByNamespaceKey.set(a,new uI(this.inputReducer)),s=this.queueByNamespaceKey.get(a),u=i(s),this.queueByNamespaceKey.get(a).isEmpty()&&this.queueByNamespaceKey.delete(a),l.abrupt("return",u);case 5:case"end":return l.stop()}},n,this)}));function r(n,a){return t.apply(this,arguments)}return r}()}]),e}();function OY(e){var t=PY();return function(){var n=Yt.default(e),a;if(t){var i=Yt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Si.default(this,a)}}function PY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vl=function(e){Mr.default(r,e);var t=OY(r);function r(){var n;return vt.default(this,r),n=t.call(this),n.closed=!1,n.uuid=ZE.v4(),n}return St.default(r,[{key:"listenerUuid",get:function(){return this.uuid}},{key:"close",value:function(){this.removeAllListeners(),this.closed=!0}},{key:"ensureNotClosed",value:function(){if(this.closed)throw new Error("Invalid operation on closed object")}}]),r}(kt);function cI(e){var t=MY();return function(){var n=Yt.default(e),a;if(t){var i=Yt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Si.default(this,a)}}function MY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var nh=function(e){Mr.default(r,e);var t=cI(r);function r(n,a,i){var s;vt.default(this,r),s=t.call(this,n,i),$t.default(Kn.default(s),"isDeleted",!1);var u=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return s.updateMergingQueue=new uI(u),s.descriptor=a,s.descriptor.data=s.descriptor.data||{},s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return St.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"document"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"_update",value:function(a){switch(a.date_created=new Date(a.date_created),a.type){case"document_updated":if(a.id<=this.lastEventId){gt.trace("Document update skipped, current:",this.lastEventId,", remote:",a.id);break}var i=this.descriptor.data!==void 0?On(this.descriptor.data):null;this.descriptor.last_event_id=a.id,this.descriptor.revision=a.document_revision,this.descriptor.date_updated=a.date_created,this.descriptor.data=a.document_data,this.broadcastEventToListeners("updated",{data:a.document_data,isLocal:!1,previousData:i}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:a.id,revision:a.document_revision,date_updated:a.date_created,data:a.document_data});break;case"document_removed":this.onRemoved(!1);break}}},{key:"set",value:function(){var n=Oe.default(G.default.mark(function i(s,u){var o=this,l;return G.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return l=u||{},h.abrupt("return",this.updateMergingQueue.squashAndAdd(l,function(w){return o._setUnconditionally(s,w.ttl)}));case 2:case"end":return h.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Oe.default(G.default.mark(function i(s,u){var o=this,l;return G.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return l=u||{},h.abrupt("return",this.updateMergingQueue.add(l,function(w){return o._setWithIfMatch(s,w.ttl)}));case 2:case"end":return h.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Oe.default(G.default.mark(function i(s,u){return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.abrupt("return",this.mutate(function(c){return Object.assign(c,s)},u));case 1:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Oe.default(G.default.mark(function i(s){var u;return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this._postUpdateToServer({ttl:s});case 2:u=l.sent,this.descriptor.date_expires=u.date_expires;case 4:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_setUnconditionally",value:function(){var n=Oe.default(G.default.mark(function i(s,u){var o;return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this._postUpdateToServer({data:s,revision:void 0,ttl:u});case 2:return o=c.sent,this._handleSuccessfulUpdateResult(o),c.abrupt("return",this.descriptor.data);case 5:case"end":return c.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_setWithIfMatch",value:function(){var n=Oe.default(G.default.mark(function i(s,u){var o,l,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(o=s(On(this.descriptor.data)),!o){w.next=22;break}return l=this.revision,w.prev=3,w.next=6,this._postUpdateToServer({data:o,revision:l,ttl:u});case 6:return c=w.sent,this._handleSuccessfulUpdateResult(c),w.abrupt("return",this.descriptor.data);case 11:if(w.prev=11,w.t0=w.catch(3),w.t0.status!==412){w.next=19;break}return w.next=16,this._softSync();case 16:return w.abrupt("return",this._setWithIfMatch(s));case 19:throw w.t0;case 20:w.next=23;break;case 22:return w.abrupt("return",this.descriptor.data);case 23:case"end":return w.stop()}},i,this,[[3,11]])}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_handleSuccessfulUpdateResult",value:function(a){if(!(a.last_event_id<=this.descriptor.last_event_id)){var i=this.descriptor.data!==void 0?On(this.descriptor.data):null;this.descriptor.revision=a.revision,this.descriptor.data=a.data,this.descriptor.last_event_id=a.last_event_id,this.descriptor.date_expires=a.date_expires,this.descriptor.date_updated=new Date(a.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:a.last_event_id,revision:a.revision,date_updated:a.date_updated,data:a.data}),this.broadcastEventToListeners("updated",{data:this.descriptor.data,isLocal:!0,previousData:i})}}},{key:"_postUpdateToServer",value:function(){var n=Oe.default(G.default.mark(function i(s){var u,o,l;return G.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.isDeleted){h.next=17;break}return u={data:s.data},s.ttl!==void 0&&(u.ttl=s.ttl),o=s.revision,h.prev=4,h.next=7,this.services.network.post(this.uri,u,o);case 7:return l=h.sent,h.abrupt("return",{revision:l.body.revision,data:s.data,last_event_id:l.body.last_event_id,date_updated:l.body.date_updated,date_expires:l.body.date_expires});case 11:throw h.prev=11,h.t0=h.catch(4),h.t0.status===404&&this.onRemoved(!1),h.t0;case 15:h.next=18;break;case 17:return h.abrupt("return",Promise.reject(new Dr("The Document has been removed",404,54100)));case 18:case"end":return h.stop()}},i,this,[[4,11]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_softSync",value:function(){var n=Oe.default(G.default.mark(function i(){var s=this;return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.services.network.get(this.uri).then(function(l){var c={type:"document_updated",id:l.body.last_event_id,document_revision:l.body.revision,document_data:l.body.data,date_created:l.body.date_updated};return s._update(c),s}).catch(function(l){l.status===404?s.onRemoved(!1):gt.error("Can't get updates for ".concat(s.sid,":"),l)}));case 1:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"onRemoved",value:function(a){if(!this.isDeleted){var i=this.descriptor.data!==void 0?On(this.descriptor.data):null;this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a,previousData:i})}}},{key:"removeDocument",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.isDeleted){u.next=6;break}return u.next=3,this.services.network.delete(this.uri);case 3:this.onRemoved(!0),u.next=7;break;case 6:return u.abrupt("return",Promise.reject(new Dr("The Document has been removed",404,54100)));case 7:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()}],[{key:"type",get:function(){return"document"}}]),r}(pl),fn=function(e){Mr.default(r,e);var t=cI(r);function r(n){var a;return vt.default(this,r),a=t.call(this),a.syncDocumentImpl=n,a.syncDocumentImpl.attach(Kn.default(a)),a}return St.default(r,[{key:"uri",get:function(){return this.syncDocumentImpl.uri}},{key:"revision",get:function(){return this.syncDocumentImpl.revision}},{key:"lastEventId",get:function(){return this.syncDocumentImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncDocumentImpl.dateExpires}},{key:"type",get:function(){return nh.type}},{key:"sid",get:function(){return this.syncDocumentImpl.sid}},{key:"data",get:function(){return this.syncDocumentImpl.data}},{key:"dateUpdated",get:function(){return this.syncDocumentImpl.dateUpdated}},{key:"uniqueName",get:function(){return this.syncDocumentImpl.uniqueName}},{key:"set",value:function(){var n=Oe.default(G.default.mark(function i(s,u){return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.set(s,u));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Oe.default(G.default.mark(function i(s,u){return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.mutate(s,u));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Oe.default(G.default.mark(function i(s,u){return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncDocumentImpl.update(s,u));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncDocumentImpl.setTtl(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"removeDocument",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncDocumentImpl.removeDocument());case 2:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){fl.default(Yt.default(r.prototype),"close",this).call(this),this.syncDocumentImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return nh.type}}]),r}(vl);$t.default(fn,"removed","removed");$t.default(fn,"updated","updated");yt([_e.validateTypesAsync(_e.pureObject,["undefined",_e.objectSchema("document metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object,Object]),Ee("design:returntype",Promise)],fn.prototype,"set",null);yt([_e.validateTypesAsync("function",["undefined",_e.objectSchema("document metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Function,Object]),Ee("design:returntype",Promise)],fn.prototype,"mutate",null);yt([_e.validateTypesAsync(_e.pureObject,["undefined",_e.objectSchema("document metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object,Object]),Ee("design:returntype",Promise)],fn.prototype,"update",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],fn.prototype,"setTtl",null);var ah=function(){function e(t){vt.default(this,e),this.descriptor=t}return St.default(e,[{key:"uri",get:function(){return this.descriptor.uri}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.lastEventId}},{key:"dateUpdated",get:function(){return this.descriptor.dateUpdated}},{key:"dateExpires",get:function(){return this.descriptor.dateExpires}},{key:"index",get:function(){return this.descriptor.index}},{key:"data",get:function(){return this.descriptor.data}},{key:"update",value:function(r,n,a,i){return this.descriptor.lastEventId=r,this.descriptor.revision=n,this.descriptor.data=a,this.descriptor.dateUpdated=i,this}},{key:"updateDateExpires",value:function(r){this.descriptor.dateExpires=r}}]),e}(),mg=function(){function e(t,r,n,a){vt.default(this,e),this.prevToken=n,this.nextToken=a,this.items=t,this.source=r}return St.default(e,[{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}},{key:"nextPage",value:function(){var t=Oe.default(G.default.mark(function n(){return G.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.hasNextPage){i.next=2;break}throw new Error("No next page");case 2:return i.abrupt("return",this.source(this.nextToken));case 3:case"end":return i.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"prevPage",value:function(){var t=Oe.default(G.default.mark(function n(){return G.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(this.hasPrevPage){i.next=2;break}throw new Error("No previous page");case 2:return i.abrupt("return",this.source(this.prevToken));case 3:case"end":return i.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()}]),e}();function xY(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=NY(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function NY(e,t){if(!!e){if(typeof e=="string")return CS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return CS(e,t)}}function CS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var LY=function(){function e(t,r){vt.default(this,e),this.balanceFactor=0,this.key=t,this.value=r,this.parent=null,this.left=null,this.right=null}return St.default(e,[{key:"isRoot",get:function(){return this.parent===null}},{key:"isLeaf",get:function(){return this.left===null&&this.right===null}},{key:"isLeftChild",get:function(){return this.parent.left===this}},{key:"update",value:function(r){this.value=r}},{key:"replace",value:function(r,n){!r||(this.left===n?this.left=n:this.right===n&&(this.right=n))}}]),e}(),jY=function(){function e(t,r){vt.default(this,e),this.isLessThan=t||function(n,a){return n<a},this.isEqual=r||function(n,a){return n===a},this.root=null,this.count=null}return St.default(e,[{key:"size",get:function(){return this.count}},{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(r,n){var a=this.getNode(r);a?a.update(n):this.insert(r,n)}},{key:"insert",value:function(r,n){var a=new LY(r,n);if(this.count++,!this.root){this.root=a;return}for(var i=this.root;;)if(this.isLessThan(r,i.key))if(i.left)i=i.left;else{i.left=a;break}else if(i.right)i=i.right;else{i.right=a;break}for(a.parent=i,i=a;i.parent;){var s=i.parent,u=s.balanceFactor;if(i.isLeftChild?s.balanceFactor++:s.balanceFactor--,Math.abs(s.balanceFactor)<Math.abs(u))break;if(s.balanceFactor<-1||s.balanceFactor>1){this.rebalance(s);break}i=s}}},{key:"get",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n.value;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"delete",value:function(r){var n=this.getNode(r);if(!n||n.key!==r)return null;var a=n.parent,i=n.left,s=n.right;if(!!i!=!!s){var u=i||s;!a&&!u?this.root=null:a&&!u?this.root=u:(a.replace(n,null),this.rebalance(a))}else{for(var o=n.left;o.right;)o=o.right;if(n.left===o)n.isRoot?(this.root=o,o.parent=null):(n.isLeftChild?n.parent.left=o:n.parent.right=o,o.parent=n.parent),o.right=n.right,o.right.parent=o,o.balanceFactor=n.balanceFactor,n={parent:o,isLeftChild:!0};else{var l=o.parent,c=o.left;l.right=c,c&&(c.parent=l),n.isRoot?(this.root=o,o.parent=null):(n.isLeftChild?n.parent.left=o:n.parent.right=o,o.parent=n.parent),o.right=n.right,o.right.parent=o,o.left=n.left,o.left.parent=o,o.balanceFactor=n.balanceFactor,n={parent:l,isLeftChild:!1}}}for(this.count--;n.parent;){var h=n.parent,w=h.balanceFactor;if(n.isLeftChild?h.balanceFactor-=1:h.balanceFactor+=1,Math.abs(h.balanceFactor)>Math.abs(w))if(h.balanceFactor<-1||h.balanceFactor>1)if(this.rebalance(h),h.parent.balanceFactor===0)n=h.parent;else break;else break;else n=h}return null}},{key:"getNode",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"rebalance",value:function(r){r.balanceFactor<0?r.right.balanceFactor>0?(this.rotateRight(r.right),this.rotateLeft(r)):this.rotateLeft(r):r.balanceFactor>0&&(r.left.balanceFactor<0?(this.rotateLeft(r.left),this.rotateRight(r)):this.rotateRight(r))}},{key:"rotateLeft",value:function(r){var n=r.right;r.right=n.left,n.left!==null&&(n.left.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.left=r,r.parent=n,r.balanceFactor=r.balanceFactor+1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor+1-Math.max(r.balanceFactor,0)}},{key:"rotateRight",value:function(r){var n=r.left;r.left=n.right,n.right!==null&&(n.right.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.right=r,r.parent=n,r.balanceFactor=r.balanceFactor-1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor-1-Math.max(r.balanceFactor,0)}},{key:Symbol.iterator,value:G.default.mark(function t(){var r,n,a;return G.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=xY(this.getIterator()),s.prev=1,r.s();case 3:if((n=r.n()).done){s.next=9;break}return a=n.value,s.next=7,a;case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),r.e(s.t0);case 14:return s.prev=14,r.f(),s.finish(14);case 17:case"end":return s.stop()}},t,this,[[1,11,14,17]])})},{key:"getIterator",value:G.default.mark(function t(){var r,n,a,i=arguments;return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=i.length>0&&i[0]!==void 0?i[0]:null,n=this.root;case 2:if(!n){u.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.left)){u.next=5;break}return u.abrupt("break",8);case 5:this.isLessThan(r,n.key)||r===null?n=n.left:n=n.right,u.next=2;break;case 8:if(n){u.next=10;break}return u.abrupt("return",null);case 10:a=!0;case 11:if(!a){u.next=29;break}return u.next=14,[n.key,n.value];case 14:if(a=!1,!n.right){u.next=21;break}for(n=n.right;n.left;)n=n.left;a=!0,u.next=27;break;case 21:if(!n.parent){u.next=26;break}a=n.parent.left===n,n=n.parent,u.next=27;break;case 26:return u.abrupt("break",37);case 27:u.next=35;break;case 29:if(!n.parent){u.next=34;break}a=n.parent.left===n,n=n.parent,u.next=35;break;case 34:return u.abrupt("break",37);case 35:u.next=11;break;case 37:return u.abrupt("return",null);case 38:case"end":return u.stop()}},t,this)})},{key:"getReverseIterator",value:G.default.mark(function t(){var r,n,a,i=arguments;return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=i.length>0&&i[0]!==void 0?i[0]:null,n=this.root;case 2:if(!n){u.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.right)){u.next=5;break}return u.abrupt("break",8);case 5:!this.isLessThan(r,n.key)||r===null?n=n.right:n=n.left,u.next=2;break;case 8:if(n){u.next=10;break}return u.abrupt("return",null);case 10:a=!0;case 11:if(!a){u.next=29;break}return u.next=14,[n.key,n.value];case 14:if(a=!1,!n.left){u.next=21;break}for(n=n.left;n.right;)n=n.right;a=!0,u.next=27;break;case 21:if(!n.parent){u.next=26;break}a=n.parent.right===n,n=n.parent,u.next=27;break;case 26:return u.abrupt("break",37);case 27:u.next=35;break;case 29:if(!n.parent){u.next=34;break}a=n.parent.right===n,n=n.parent,u.next=35;break;case 34:return u.abrupt("break",37);case 35:u.next=11;break;case 37:return u.abrupt("return",null);case 38:case"end":return u.stop()}},t,this)})}]),e}();function UY(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=FY(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function FY(e,t){if(!!e){if(typeof e=="string")return RS(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return RS(e,t)}}function RS(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var DY=function(){function e(t,r){vt.default(this,e),this.value=t,this.revision=r||0}return St.default(e,[{key:"isValid",get:function(){return!0}}]),e}(),BY=function(){function e(t){vt.default(this,e),this.revision=t}return St.default(e,[{key:"isValid",get:function(){return!1}}]),e}(),bg=function(){function e(){vt.default(this,e),this.items=new jY}return St.default(e,[{key:"store",value:function(r,n,a){var i=this.items.get(r);return i&&i.revision>a?i.isValid?i.value:null:(this.items.set(r,new DY(n,a)),n)}},{key:"delete",value:function(r,n){var a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=this.items.get(r);(!i||i.revision<n||i&&a===!0)&&this.items.set(r,new BY(n))}},{key:"isKnown",value:function(r,n){var a=this.items.get(r);return a&&a.revision>=n}},{key:"get",value:function(r){var n=this.items.get(r);return n&&n.isValid?n.value:null}},{key:"has",value:function(r){var n=this.items.get(r);return n&&n.isValid}},{key:"forEach",value:function(r){if(this.items){var n=UY(this.items),a;try{for(n.s();!(a=n.n()).done;){var i=tI.default(a.value,2),s=i[0],u=i[1];u.isValid&&r(s,u.value)}}catch(o){n.e(o)}finally{n.f()}}}}]),e}();function fI(e){var t=qY();return function(){var n=Yt.default(e),a;if(t){var i=Yt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Si.default(this,a)}}function qY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ih=function(e){Mr.default(r,e);var t=fI(r);function r(n,a,i){var s;vt.default(this,r),s=t.call(this,n,i);var u=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return s.updateMergingQueue=new lI(u),s.cache=new bg,s.descriptor=a,s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return St.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"list"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"_addOrUpdateItemOnServer",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o,l){var c,h;return G.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c={data:u},l!==void 0&&(c.ttl=l),b.next=4,this.services.network.post(s,c,o);case 4:return h=b.sent,h.body.data=u,h.body.date_updated=new Date(h.body.date_updated),b.abrupt("return",h.body);case 8:case"end":return b.stop()}},i,this)}));function a(i,s,u,o){return n.apply(this,arguments)}return a}()},{key:"push",value:function(){var n=Oe.default(G.default.mark(function i(s,u){var o,l,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return o=(u||{}).ttl,w.next=3,this._addOrUpdateItemOnServer(this.links.items,s,void 0,o);case 3:return l=w.sent,c=Number(l.index),this._handleItemMutated(c,l.url,l.last_event_id,l.revision,s,l.date_updated,l.date_expires,!0,!1),w.abrupt("return",this.cache.get(c));case 7:case"end":return w.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"set",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){var l=this,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=o||{},w.abrupt("return",this.updateMergingQueue.squashAndAdd(s,c,function(b){return l._updateItemUnconditionally(s,u,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"_updateItemUnconditionally",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){var l,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.get(s);case 2:return l=w.sent,w.next=5,this._addOrUpdateItemOnServer(l.uri,u,void 0,o);case 5:return c=w.sent,this._handleItemMutated(s,c.url,c.last_event_id,c.revision,c.data,c.date_updated,c.date_expires,!1,!1),w.abrupt("return",this.cache.get(s));case 8:case"end":return w.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"_updateItemWithIfMatch",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){var l,c,h,w;return G.default.wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,this.get(s);case 2:if(l=$.sent,c=u(On(l.data)),!c){$.next=25;break}return h=l.revision,$.prev=6,$.next=9,this._addOrUpdateItemOnServer(l.uri,c,h,o);case 9:return w=$.sent,this._handleItemMutated(s,w.url,w.last_event_id,w.revision,w.data,w.date_updated,w.date_expires,!1,!1),$.abrupt("return",this.cache.get(s));case 14:if($.prev=14,$.t0=$.catch(6),$.t0.status!==412){$.next=22;break}return $.next=19,this._getItemFromServer(s);case 19:return $.abrupt("return",this._updateItemWithIfMatch(s,u,o));case 22:throw $.t0;case 23:$.next=26;break;case 25:return $.abrupt("return",l);case 26:case"end":return $.stop()}},i,this,[[6,14]])}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){var l=this,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=o||{},w.abrupt("return",this.updateMergingQueue.add(s,c,function(b){return l._updateItemWithIfMatch(s,u,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(s,function(h){return Object.assign(h,u)},o));case 1:case"end":return c.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=Oe.default(G.default.mark(function i(s){var u,o,l;return G.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.get(s);case 2:return u=h.sent,o=On(u.data),h.next=6,this.services.network.delete(u.uri);case 6:l=h.sent,this._handleItemRemoved(s,l.body.last_event_id,o,new Date(l.body.date_updated),!1);case 8:case"end":return h.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=Oe.default(G.default.mark(function i(s){var u;return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(u=this.cache.get(s),!u){l.next=5;break}return l.abrupt("return",u);case 5:return l.abrupt("return",this._getItemFromServer(s));case 6:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_getItemFromServer",value:function(){var n=Oe.default(G.default.mark(function i(s){var u;return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.queryItems({index:s});case 2:if(u=l.sent,!(u.items.length<1)){l.next=7;break}throw new Dr("No item with index ".concat(s," found"),404,54151);case 7:return l.abrupt("return",u.items[0]);case 8:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"queryItems",value:function(){var n=Oe.default(G.default.mark(function i(s){var u=this,o,l,c,h;return G.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=s||{},o=new co(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Index",s.index).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),b.next=4,this.services.network.get(o);case 4:return l=b.sent,c=l.body.items.map(function($){$.date_updated=new Date($.date_updated);var C=u.cache.get($.index);return C?u._handleItemMutated($.index,$.url,$.last_event_id,$.revision,$.data,$.date_updated,$.date_expires,!1,!0):u.cache.store(Number($.index),new ah({index:Number($.index),uri:$.url,revision:$.revision,lastEventId:$.last_event_id,dateUpdated:$.date_updated,dateExpires:$.date_expires,data:$.data}),$.last_event_id),u.cache.get($.index)}),h=l.body.meta,b.abrupt("return",new mg(c,function($){return u.queryItems({pageToken:$})},h.previous_token,h.next_token));case 8:case"end":return b.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return s=s||{},oI(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",o.abrupt("return",this.queryItems(s));case 5:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getContext",value:function(){var n=Oe.default(G.default.mark(function i(){var s;return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.context){o.next=5;break}return o.next=3,this.services.network.get(this.links.context);case 3:s=o.sent,this._updateContextIfRequired(s.body.data,s.body.last_event_id);case 5:return o.abrupt("return",this.context);case 6:case"end":return o.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Oe.default(G.default.mark(function i(s){var u,o;return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,u={ttl:s},c.next=4,this.services.network.post(this.uri,u);case 4:o=c.sent,this.descriptor.date_expires=o.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},i,this,[[0,8]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=Oe.default(G.default.mark(function i(s,u){var o,l,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.get(s);case 2:return o=w.sent,l={ttl:u},w.next=6,this.services.network.post(o.uri,l);case 6:c=w.sent,o.updateDateExpires(c.body.date_expires);case 8:case"end":return w.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeList",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"onRemoved",value:function(a){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a})}},{key:"shouldIgnoreEvent",value:function(a,i){return this.cache.isKnown(a,i)}},{key:"_update",value:function(a,i){var s=Number(a.item_index);switch(a.date_created=new Date(a.date_created),a.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(s,a.item_url,a.id,a.item_revision,a.item_data,a.date_created,void 0,a.type==="list_item_added",!0);break;case"list_item_removed":this._handleItemRemoved(s,a.id,a.item_data,a.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(a.context_data,a.id,a.date_created);break;case"list_removed":this.onRemoved(!1);break}i&&this._advanceLastEventId(a.id,a.list_revision)}},{key:"_advanceLastEventId",value:function(a,i){this.lastEventId<a&&(this.descriptor.last_event_id=a,i&&(this.descriptor.revision=i))}},{key:"_updateRootDateUpdated",value:function(a){(!this.descriptor.date_updated||a.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=a,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:a}))}},{key:"_handleItemMutated",value:function(a,i,s,u,o,l,c,h,w){if(this.shouldIgnoreEvent(a,s)){gt.trace("Item ".concat(a," update skipped, current: ").concat(this.lastEventId,", remote: ").concat(s));return}this._updateRootDateUpdated(l);var b=this.cache.get(a);if(!b){var $=new ah({index:a,uri:i,lastEventId:s,revision:u,data:o,dateUpdated:l,dateExpires:c});this.cache.store(a,$,s),this.emitItemMutationEvent($,w,h);return}var C=On(b.data);b.update(s,u,o,l),this.cache.store(a,b,s),c!==void 0&&b.updateDateExpires(c),this.emitItemMutationEvent(b,w,!1,C)}},{key:"emitItemMutationEvent",value:function(a,i,s){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=s?"itemAdded":"itemUpdated",l={item:a,isLocal:!i};s||(l.previousItemData=u),this.broadcastEventToListeners(o,l)}},{key:"_handleItemRemoved",value:function(a,i,s,u,o){this._updateRootDateUpdated(u),this.cache.delete(a,i),this.broadcastEventToListeners("itemRemoved",{index:a,isLocal:!o,previousItemData:s})}},{key:"_handleContextUpdate",value:function(a,i,s){this._updateRootDateUpdated(s),this._updateContextIfRequired(a,i)&&this.broadcastEventToListeners("contextUpdated",{context:a,isLocal:!1})}},{key:"_updateContextIfRequired",value:function(a,i){return!this.contextEventId||i>this.contextEventId?(this.context=a,this.contextEventId=i,!0):(gt.trace("Context update skipped, current:",this.lastEventId,", remote:",i),!1)}}],[{key:"type",get:function(){return"list"}}]),r}(pl),Xt=function(e){Mr.default(r,e);var t=fI(r);function r(n){var a;return vt.default(this,r),a=t.call(this),a.syncListImpl=n,a.syncListImpl.attach(Kn.default(a)),a}return St.default(r,[{key:"uri",get:function(){return this.syncListImpl.uri}},{key:"revision",get:function(){return this.syncListImpl.revision}},{key:"lastEventId",get:function(){return this.syncListImpl.lastEventId}},{key:"links",get:function(){return this.syncListImpl.links}},{key:"dateExpires",get:function(){return this.syncListImpl.dateExpires}},{key:"type",get:function(){return ih.type}},{key:"sid",get:function(){return this.syncListImpl.sid}},{key:"uniqueName",get:function(){return this.syncListImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncListImpl.dateUpdated}},{key:"push",value:function(){var n=Oe.default(G.default.mark(function i(s,u){return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncListImpl.push(s,u));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"set",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.set(s,u,o));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.mutate(s,u,o));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.update(s,u,o));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.remove(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.get(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getContext",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.getContext());case 2:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.getItems(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.setTtl(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=Oe.default(G.default.mark(function i(s,u){return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncListImpl.setItemTtl(s,u));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeList",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.removeList());case 2:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){fl.default(Yt.default(r.prototype),"close",this).call(this),this.syncListImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return ih.type}}]),r}(vl);$t.default(Xt,"itemAdded","itemAdded");$t.default(Xt,"itemUpdated","itemUpdated");$t.default(Xt,"itemRemoved","itemRemoved");$t.default(Xt,"removed","removed");yt([_e.validateTypesAsync(_e.pureObject,["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object,Object]),Ee("design:returntype",Promise)],Xt.prototype,"push",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger,_e.pureObject,["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Number,Object,Object]),Ee("design:returntype",Promise)],Xt.prototype,"set",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger,"function",["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Number,Function,Object]),Ee("design:returntype",Promise)],Xt.prototype,"mutate",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger,_e.pureObject,["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Number,Object,Object]),Ee("design:returntype",Promise)],Xt.prototype,"update",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],Xt.prototype,"remove",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],Xt.prototype,"get",null);yt([_e.validateTypesAsync(["undefined",_e.objectSchema("query options",{from:[_e.nonNegativeInteger,"undefined"],pageSize:[_e.custom(function(e){return[gg(e),"a positive integer"]}),"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],Xt.prototype,"getItems",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],Xt.prototype,"setTtl",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger,_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number,Number]),Ee("design:returntype",Promise)],Xt.prototype,"setItemTtl",null);var lu=function(){function e(t){vt.default(this,e),this.descriptor=t}return St.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"key",get:function(){return this.descriptor.key}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"update",value:function(r,n,a,i){return this.descriptor.last_event_id=r,this.descriptor.revision=n,this.descriptor.data=a,this.descriptor.date_updated=i,this}},{key:"updateDateExpires",value:function(r){this.descriptor.date_expires=r}}]),e}();function dI(e){var t=HY();return function(){var n=Yt.default(e),a;if(t){var i=Yt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Si.default(this,a)}}function HY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var sh=function(e){Mr.default(r,e);var t=dI(r);function r(n,a,i){var s;vt.default(this,r),s=t.call(this,n,i);var u=function(l,c){return typeof c.ttl=="number"?{ttl:c.ttl}:l};return s.updateMergingQueue=new lI(u),s.cache=new bg,s.descriptor=a,s.descriptor.date_updated=new Date(s.descriptor.date_updated),a.items&&a.items.forEach(function(o){o.date_updated=new Date(o.date_updated),s.cache.store(o.key,new lu(o),o.last_event_id)}),s}return St.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"map"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"set",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){var l=this,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=o||{},w.abrupt("return",this.updateMergingQueue.squashAndAdd(s,c,function(b){return l._putItemUnconditionally(s,u,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(s!=null){o.next=2;break}throw new Dr("SyncMapItem key may not be empty",400,54209);case 2:if(!this.cache.has(s)){o.next=6;break}return o.abrupt("return",this.cache.get(s));case 6:return o.abrupt("return",this._getItemFromServer(s));case 7:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_getItemFromServer",value:function(){var n=Oe.default(G.default.mark(function i(s){var u;return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,this.queryItems({key:s});case 2:if(u=l.sent,!(u.items.length<1)){l.next=7;break}throw new Dr("The specified Map Item does not exist",404,54201);case 7:return l.abrupt("return",u.items[0]);case 8:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){var l=this,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return c=o||{},w.abrupt("return",this.updateMergingQueue.add(s,c,function(b){return l._putItemWithIfMatch(s,u,b.ttl)}));case 2:case"end":return w.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(s,function(h){return Object.assign(h,u)},o));case 1:case"end":return c.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"_putItemUnconditionally",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){var l,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this._putItemToServer(s,u,void 0,o);case 2:return l=w.sent,c=l.item,this._handleItemMutated(c.key,c.url,c.last_event_id,c.revision,c.data,c.date_updated,c.date_expires,l.added,!1),w.abrupt("return",this.cache.get(c.key));case 6:case"end":return w.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"_putItemWithIfMatch",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){var l,c,h,w,b;return G.default.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,this.get(s).catch(function(I){if(I.status===404)return new lu({key:s,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw I});case 2:if(l=C.sent,c=u(On(l.data)),!c){C.next=26;break}return h=l.revision,C.prev=6,C.next=9,this._putItemToServer(s,c,h,o);case 9:return w=C.sent,b=w.item,this._handleItemMutated(b.key,b.url,b.last_event_id,b.revision,b.data,b.date_updated,b.date_expires,w.added,!1),C.abrupt("return",this.cache.get(b.key));case 15:if(C.prev=15,C.t0=C.catch(6),C.t0.status!==412){C.next=23;break}return C.next=20,this._getItemFromServer(s);case 20:return C.abrupt("return",this._putItemWithIfMatch(s,u,o));case 23:throw C.t0;case 24:C.next=27;break;case 26:return C.abrupt("return",l);case 27:case"end":return C.stop()}},i,this,[[6,15]])}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"_putItemToServer",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o,l){var c,h,w,b,$;return G.default.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return c=new co(this.links.items).pathSegment(s).build(),h={data:u},l!==void 0&&(h.ttl=l),I.prev=3,I.next=6,this.services.network.put(c,h,o);case 6:return w=I.sent,b=w.body,b.data=u,b.date_updated=new Date(b.date_updated),$=w.status.code===201,I.abrupt("return",{added:$,item:b});case 14:throw I.prev=14,I.t0=I.catch(3),I.t0.status===404&&this.onRemoved(!1),I.t0;case 18:case"end":return I.stop()}},i,this,[[3,14]])}));function a(i,s,u,o){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=Oe.default(G.default.mark(function i(s){var u,o,l;return G.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.get(s);case 2:return u=h.sent,o=On(u.data),h.next=6,this.services.network.delete(u.uri);case 6:l=h.sent,this._handleItemRemoved(s,l.body.last_event_id,o,new Date(l.body.date_updated),!1);case 8:case"end":return h.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"queryItems",value:function(){var n=Oe.default(G.default.mark(function i(s){var u=this,o,l,c,h;return G.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return s=s||{},o=new co(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Key",s.key).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),b.next=4,this.services.network.get(o);case 4:return l=b.sent,c=l.body.items.map(function($){$.date_updated=new Date($.date_updated);var C=u.cache.get($.key);return C?u._handleItemMutated($.key,$.url,$.last_event_id,$.revision,$.data,$.date_updated,$.date_expires,!1,!0):u.cache.store($.key,new lu($),$.last_event_id),u.cache.get($.key)}),h=l.body.meta,b.abrupt("return",new mg(c,function($){return u.queryItems({pageToken:$})},h.previous_token,h.next_token));case 8:case"end":return b.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return s=s||{},oI(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",o.abrupt("return",this.queryItems(s));case 5:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"shouldIgnoreEvent",value:function(a,i){return this.cache.isKnown(a,i)}},{key:"_update",value:function(a,i){switch(a.date_created=new Date(a.date_created),a.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(a.item_key,a.item_url,a.id,a.item_revision,a.item_data,a.date_created,void 0,a.type==="map_item_added",!0);break;case"map_item_removed":this._handleItemRemoved(a.item_key,a.id,a.item_data,a.date_created,!0);break;case"map_removed":this.onRemoved(!1);break}i&&this._advanceLastEventId(a.id,a.map_revision)}},{key:"_advanceLastEventId",value:function(a,i){this.lastEventId<a&&(this.descriptor.last_event_id=a,i&&(this.descriptor.revision=i))}},{key:"_updateRootDateUpdated",value:function(a){(!this.descriptor.date_updated||a.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=a,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:a}))}},{key:"_handleItemMutated",value:function(a,i,s,u,o,l,c,h,w){if(this.shouldIgnoreEvent(a,s)){gt.trace("SyncMapItem ",a," update skipped, current:",this.lastEventId,", remote:",s);return}this._updateRootDateUpdated(l);var b=this.cache.get(a);if(!b){var $=new lu({key:a,url:i,last_event_id:s,revision:u,data:o,date_updated:l,date_expires:c});this.cache.store(a,$,s),this.emitItemMutationEvent($,w,h);return}var C=On(b.data);b.update(s,u,o,l),this.cache.store(a,b,s),c!==void 0&&b.updateDateExpires(c),this.emitItemMutationEvent(b,w,!1,C)}},{key:"emitItemMutationEvent",value:function(a,i,s){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=s?"itemAdded":"itemUpdated",l={item:a,isLocal:!i};s||(l.previousItemData=u),this.broadcastEventToListeners(o,l)}},{key:"_handleItemRemoved",value:function(a,i,s,u,o){this._updateRootDateUpdated(u),this.cache.delete(a,i),this.broadcastEventToListeners("itemRemoved",{key:a,isLocal:!o,previousItemData:s})}},{key:"onRemoved",value:function(a){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a})}},{key:"setTtl",value:function(){var n=Oe.default(G.default.mark(function i(s){var u,o;return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,u={ttl:s},c.next=4,this.services.network.post(this.uri,u);case 4:o=c.sent,this.descriptor.date_expires=o.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},i,this,[[0,8]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=Oe.default(G.default.mark(function i(s,u){var o,l,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.get(s);case 2:return o=w.sent,l={ttl:u},w.next=6,this.services.network.post(o.uri,l);case 6:c=w.sent,o.updateDateExpires(c.body.date_expires);case 8:case"end":return w.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeMap",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()}],[{key:"type",get:function(){return"map"}}]),r}(pl),tr=function(e){Mr.default(r,e);var t=dI(r);function r(n){var a;return vt.default(this,r),a=t.call(this),a.syncMapImpl=n,a.syncMapImpl.attach(Kn.default(a)),a}return St.default(r,[{key:"uri",get:function(){return this.syncMapImpl.uri}},{key:"links",get:function(){return this.syncMapImpl.links}},{key:"revision",get:function(){return this.syncMapImpl.revision}},{key:"lastEventId",get:function(){return this.syncMapImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncMapImpl.dateExpires}},{key:"type",get:function(){return sh.type}},{key:"sid",get:function(){return this.syncMapImpl.sid}},{key:"uniqueName",get:function(){return this.syncMapImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncMapImpl.dateUpdated}},{key:"set",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.set(s,u,o));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"get",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.get(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"mutate",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.mutate(s,u,o));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"update",value:function(){var n=Oe.default(G.default.mark(function i(s,u,o){return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.update(s,u,o));case 2:case"end":return c.stop()}},i,this)}));function a(i,s,u){return n.apply(this,arguments)}return a}()},{key:"remove",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.remove(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.getItems(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.setTtl(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setItemTtl",value:function(){var n=Oe.default(G.default.mark(function i(s,u){return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.ensureNotClosed(),l.abrupt("return",this.syncMapImpl.setItemTtl(s,u));case 2:case"end":return l.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"removeMap",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.next=3,this.syncMapImpl.removeMap();case 3:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){fl.default(Yt.default(r.prototype),"close",this).call(this),this.syncMapImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return sh.type}}]),r}(vl);$t.default(tr,"itemAdded","itemAdded");$t.default(tr,"itemUpdated","itemUpdated");$t.default(tr,"itemRemoved","itemRemoved");$t.default(tr,"removed","removed");yt([_e.validateTypesAsync("string",_e.pureObject,["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[String,Object,Object]),Ee("design:returntype",Promise)],tr.prototype,"set",null);yt([_e.validateTypesAsync("string"),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",Promise)],tr.prototype,"get",null);yt([_e.validateTypesAsync("string","function",["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[String,Function,Object]),Ee("design:returntype",Promise)],tr.prototype,"mutate",null);yt([_e.validateTypesAsync("string",_e.pureObject,["undefined",_e.objectSchema("item metadata",{ttl:[_e.nonNegativeInteger,"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[String,Object,Object]),Ee("design:returntype",Promise)],tr.prototype,"update",null);yt([_e.validateTypesAsync("string"),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",Promise)],tr.prototype,"remove",null);yt([_e.validateTypesAsync(["undefined",_e.objectSchema("query options",{from:["string","undefined"],pageSize:[_e.custom(function(e){return[gg(e),"a positive integer"]}),"undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],tr.prototype,"getItems",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],tr.prototype,"setTtl",null);yt([_e.validateTypesAsync("string",_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[String,Number]),Ee("design:returntype",Promise)],tr.prototype,"setItemTtl",null);function pI(e){var t=WY();return function(){var n=Yt.default(e),a;if(t){var i=Yt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Si.default(this,a)}}function WY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Uu=function(e){Mr.default(r,e);var t=pI(r);function r(n,a,i){var s;return vt.default(this,r),s=t.call(this,n,i),s.descriptor=a,s}return St.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"stream"}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"publishMessage",value:function(){var n=Oe.default(G.default.mark(function i(s){var u,o,l,c;return G.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return u={data:s},w.next=3,this.services.network.post(this.links.messages,u);case 3:return o=w.sent,l=o.body,c=this._handleMessagePublished(l.sid,s,!1),w.abrupt("return",c);case 7:case"end":return w.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Oe.default(G.default.mark(function i(s){var u,o;return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,u={ttl:s},c.next=4,this.services.network.post(this.uri,u);case 4:o=c.sent,this.descriptor.date_expires=o.body.date_expires,c.next=12;break;case 8:throw c.prev=8,c.t0=c.catch(0),c.t0.status===404&&this.onRemoved(!1),c.t0;case 12:case"end":return c.stop()}},i,this,[[0,8]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"removeStream",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"_update",value:function(a){switch(a.type){case"stream_message_published":{this._handleMessagePublished(a.message_sid,a.message_data,!0);break}case"stream_removed":{this.onRemoved(!1);break}}}},{key:"_handleMessagePublished",value:function(a,i,s){var u={sid:a,data:i};return this.broadcastEventToListeners("messagePublished",{message:u,isLocal:!s}),u}},{key:"onRemoved",value:function(a){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:a})}}],[{key:"type",get:function(){return"stream"}}]),r}(pl);yt([_e.validateTypesAsync(_e.pureObject),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],Uu.prototype,"publishMessage",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],Uu.prototype,"setTtl",null);var Gn=function(e){Mr.default(r,e);var t=pI(r);function r(n){var a;return vt.default(this,r),a=t.call(this),a.syncStreamImpl=n,a.syncStreamImpl.attach(Kn.default(a)),a}return St.default(r,[{key:"uri",get:function(){return this.syncStreamImpl.uri}},{key:"links",get:function(){return this.syncStreamImpl.links}},{key:"dateExpires",get:function(){return this.syncStreamImpl.dateExpires}},{key:"type",get:function(){return Uu.type}},{key:"lastEventId",get:function(){return null}},{key:"sid",get:function(){return this.syncStreamImpl.sid}},{key:"uniqueName",get:function(){return this.syncStreamImpl.uniqueName}},{key:"publishMessage",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncStreamImpl.publishMessage(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"setTtl",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncStreamImpl.setTtl(s));case 2:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"removeStream",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.removeStream());case 2:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"close",value:function(){fl.default(Yt.default(r.prototype),"close",this).call(this),this.syncStreamImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Uu.type}}]),r}(vl);$t.default(Gn,"messagePublished","messagePublished");$t.default(Gn,"removed","removed");yt([_e.validateTypesAsync(_e.pureObject),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],Gn.prototype,"publishMessage",null);yt([_e.validateTypesAsync(_e.nonNegativeInteger),Ee("design:type",Function),Ee("design:paramtypes",[Number]),Ee("design:returntype",Promise)],Gn.prototype,"setTtl",null);var GY=function e(t){vt.default(this,e),this.sdk="js",this.sdkVer=t,this.os=Jl.os.family,this.osVer=Jl.os.version,this.pl=Jl.name,this.plVer=Jl.version},zY=function(){function e(){vt.default(this,e),this.names=new Map,this.entities=new Map}return St.default(e,[{key:"store",value:function(r){var n=this.entities.get(r.sid);return n||(this.entities.set(r.sid,r),r.uniqueName&&this.names.set(r.type+"::"+r.uniqueName,r.sid),r)}},{key:"getResolved",value:function(r,n){var a=this.names.get(n+"::"+r);return a?this.entities.get(a):null}},{key:"get",value:function(r,n){return this.entities.get(r)||this.getResolved(r,n)||null}},{key:"remove",value:function(r){var n=this.entities.get(r);n&&(this.entities.delete(r),n.uniqueName&&this.names.delete(n.type+"::"+n.uniqueName))}}]),e}();function wg(e){var t=VY();return function(){var n=Yt.default(e),a;if(t){var i=Yt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Si.default(this,a)}}function VY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var KY=function e(){vt.default(this,e)},oh=function(e){Mr.default(r,e);var t=wg(r);function r(n,a,i,s){var u;return vt.default(this,r),u=t.call(this,a,i),u.descriptor=n,u.cache=new bg,s&&s.forEach(function(o){u.cache.store(o.key,{key:o.key,value:o.data},o.revision)}),u}return St.default(r,[{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return null}},{key:"type",get:function(){return r.type}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"indexName",get:function(){return this.descriptor.indexName}},{key:"queryString",get:function(){return this.descriptor.queryExpression}},{key:"queryUri",get:function(){return this.descriptor.queryUri}},{key:"liveQueryDescriptor",get:function(){return this.descriptor}},{key:"onRemoved",value:function(){}},{key:"getItems",value:function(){var a={};return this.cache.forEach(function(i,s){a[i]=s.value}),a}},{key:"_update",value:function(a,i){switch(a.type){case"live_query_item_updated":this.handleItemMutated(a.item_key,a.item_data,a.item_revision);break;case"live_query_item_removed":this.handleItemRemoved(a.item_key,a.item_revision);break;case"live_query_updated":this.handleBatchUpdate(a.items);break}i&&this._advanceLastEventId(a.last_event_id)}},{key:"handleItemMutated",value:function(a,i,s){if(this.shouldIgnoreEvent(a,s))gt.trace("Item ".concat(a," update skipped, revision: ").concat(s));else{var u={key:a,value:i};this.cache.store(a,u,s),this.broadcastEventToListeners("itemUpdated",u)}}},{key:"handleItemRemoved",value:function(a,i){var s=i===null;this.shouldIgnoreEvent(a,i)?gt.trace("Item ".concat(a," delete skipped, revision: ").concat(i)):(this.cache.delete(a,i,s),this.broadcastEventToListeners("itemRemoved",{key:a}))}},{key:"handleBatchUpdate",value:function(a){var i=this,s={};a!=null&&a.forEach(function(o){s[o.key]={data:o.data,revision:o.revision}}),this.cache.forEach(function(o,l){var c=s[o];c!=null?i.handleItemMutated(o,c.data,c.revision):i.handleItemRemoved(o,null),delete s[o]});for(var u in s)this.handleItemMutated(u,s[u].data,s[u].revision)}},{key:"shouldIgnoreEvent",value:function(a,i){return a!=null&&i!=null&&this.cache.isKnown(a,i)}},{key:"_advanceLastEventId",value:function(a,i){this.lastEventId<a&&(this.descriptor.last_event_id=a)}}],[{key:"type",get:function(){return"live_query"}}]),r}(pl);function vI(e){return uh.apply(this,arguments)}function uh(){return uh=Oe.default(G.default.mark(function e(t){var r,n,a,i,s,u;return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:if(r=t.network,n=t.queryString,a=t.uri,i=t.type,n!=null){l.next=3;break}throw new Dr("Invalid query",400,54507);case 3:return s={query_string:n},i===ha.type&&(s.type=i),l.next=7,r.post(a,s,void 0,!0);case 7:return u=l.sent,l.abrupt("return",u.body);case 9:case"end":return l.stop()}},e)})),uh.apply(this,arguments)}var ha=function(e){Mr.default(r,e);var t=wg(r);function r(n){var a;return vt.default(this,r),a=t.call(this),a.liveQueryImpl=n,a.liveQueryImpl.attach(Kn.default(a)),a}return St.default(r,[{key:"type",get:function(){return oh.type}},{key:"lastEventId",get:function(){return this.liveQueryImpl.lastEventId}},{key:"sid",get:function(){return this.liveQueryImpl.sid}},{key:"close",value:function(){fl.default(Yt.default(r.prototype),"close",this).call(this),this.liveQueryImpl.detach(this.listenerUuid)}},{key:"getItems",value:function(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}}],[{key:"type",get:function(){return oh.type}}]),r}(vl);$t.default(ha,"itemUpdated","itemUpdated");$t.default(ha,"itemRemoved","itemRemoved");var hl=function(e){Mr.default(r,e);var t=wg(r);function r(n){var a;return vt.default(this,r),a=t.call(this),$t.default(Kn.default(a),"queryExpression",null),$t.default(Kn.default(a),"items",{}),Object.assign(Kn.default(a),n),a.updateIndexName(n.indexName),a}return St.default(r,[{key:"type",get:function(){return r.type}},{key:"search",value:function(){var n=Oe.default(G.default.mark(function i(s){var u=this;return G.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return this.items={},l.abrupt("return",vI({network:this.network,uri:this.queryUri,queryString:s}).then(function(c){u.queryExpression=s,c.items&&c.items.forEach(function(h){u.items[h.key]=h.data}),u.emit("searchResult",u.getItems())}).catch(function(c){throw gt.error("Error '".concat(c.message,"' while executing query '").concat(s,"'")),u.queryExpression=null,c}));case 2:case"end":return l.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"subscribe",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.queryExpression!=null){u.next=2;break}return u.abrupt("return",Promise.reject(new Dr("Invalid query",400,54507)));case 2:return u.abrupt("return",this.liveQueryCreator(this.indexName,this.queryExpression));case 3:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"getItems",value:function(){return this.items}},{key:"updateIndexName",value:function(a){this.indexName=a,this.queryUri=this.generateQueryUri(this.indexName)}},{key:"generateQueryUri",value:function(a){return new co(this.insightsUri).pathSegment(a).pathSegment("Items").build()}}],[{key:"type",get:function(){return"instant_query"}}]),r}(kt);$t.default(hl,"searchResult","searchResult");yt([_e.validateTypesAsync("string"),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",Promise)],hl.prototype,"search",null);yt([_e.validateTypes(_e.nonEmptyString),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",void 0)],hl.prototype,"updateIndexName",null);var YY="3.1.0";function JY(e){var t=QY();return function(){var n=Yt.default(e),a;if(t){var i=Yt.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return Si.default(this,a)}}function QY(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function AS(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function OS(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?AS(Object(r),!0).forEach(function(n){$t.default(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):AS(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var XY="data_sync",kp=YY;function Ql(e){if(e){if(typeof e=="string")return{id:e,mode:"open_or_create"};var t=e.mode||(e.id?"open_or_create":"create_new");return OS(OS({},e),{},{mode:t})}else return{mode:"create_new"}}var PS="com.twilio.rtd.cds.document",MS="com.twilio.rtd.cds.list",xS="com.twilio.rtd.cds.map",NS="twilio.sync.event",en=function(e){Mr.default(r,e);var t=JY(r);function r(n){var a,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(vt.default(this,r),a=t.call(this),!n)throw new Error("Sync library needs a valid Twilio token to be passed");i.hasOwnProperty("logLevel")?gt.setLevel(i.logLevel):gt.setLevel("silent");var s=i.productId=i.productId||XY;i.clientMetadata=i.clientMetadata||{},i.clientMetadata.hasOwnProperty("type")||(i.clientMetadata.type="sync"),i.clientMetadata.hasOwnProperty("sdk")||(i.clientMetadata.sdk="JS",i.clientMetadata.sdkv=kp);var u=!i.twilsockClient;if(!i.initRegistrations){var o=new Dc.InitRegistration(s);r.populateInitRegistrations(o),i.initRegistrations=[o]}var l=i.twilsockClient=i.twilsockClient||new Dc.Twilsock(n,s,i);l.on("tokenAboutToExpire",function(b){return a.emit("tokenAboutToExpire",b)}),l.on("tokenExpired",function(){return a.emit("tokenExpired")}),l.on("connectionError",function(b){return a.emit("connectionError",b)}),l.on("stateChanged",function(b){a.emit("connectionStateChanged",b),a.services.subscriptions.onConnectionStateChanged(b==="connected")}),l.on("message",function(b,$){return a._routeMessage(b,$)});var c=new bY(i),h=new IY(new GY(kp),c,l),w=new CY(c);return a.services={config:c,twilsock:l,network:h,storage:w,router:Kn.default(a),subscriptions:null},a.services.subscriptions=new SY(a.services),a.entities=new zY,u&&l.connect(),a}return St.default(r,[{key:"_routeMessage",value:function(a,i){switch(gt.trace("Notification type:",a,"content:",i),a){case PS:case MS:case xS:this.services.subscriptions.acceptMessage(i,!1);break;case NS:this.services.subscriptions.acceptMessage(i,!0);break}}},{key:"_subscribe",value:function(a,i){this.services.subscriptions.add(a,i)}},{key:"_unsubscribe",value:function(a){this.services.subscriptions.remove(a)}},{key:"connectionState",get:function(){return this.services.twilsock.state}},{key:"ensureReady",value:function(){var n=Oe.default(G.default.mark(function i(){var s;return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.services.config.sessionStorageEnabled){o.next=2;break}return o.abrupt("return");case 2:return o.prev=2,o.next=5,this.services.twilsock.storageId();case 5:s=o.sent,this.services.storage.updateStorageId(s.id),o.next=12;break;case 9:o.prev=9,o.t0=o.catch(2),gt.warn("Failed to initialize storage",o.t0);case 12:case"end":return o.stop()}},i,this,[[2,9]])}));function a(){return n.apply(this,arguments)}return a}()},{key:"storeRootInSessionCache",value:function(a,i,s){if(!(!this.services.config.sessionStorageEnabled||!i)){var u=On(s);(a===Xt.type||a===tr.type)&&(u.last_event_id=null,delete u.items),this.services.storage.store(a,i,u)}}},{key:"readRootFromSessionCache",value:function(a,i){return!this.services.config.sessionStorageEnabled||!i?null:this.services.storage.read(a,i)}},{key:"_get",value:function(){var n=Oe.default(G.default.mark(function i(s,u){var o,l,c,h=arguments;return G.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(o=h.length>2&&h[2]!==void 0?h[2]:!1,u){b.next=3;break}throw new Dr("Cannot get entity without id",404);case 3:return l=new co(s).pathSegment(u).queryParam("Include",o?"items":void 0).build(),b.next=6,this.services.network.get(l);case 6:return c=b.sent,b.abrupt("return",c.body);case 8:case"end":return b.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_createDocument",value:function(a,i,s){var u={unique_name:a,data:i||{}};return s!==void 0&&(u.ttl=s),this.services.network.post(this.services.config.documentsUri,u).then(function(o){return o.body.data=u.data,o.body})}},{key:"_getDocument",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.readRootFromSessionCache(fn.type,s)||this._get(this.services.config.documentsUri,s));case 1:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_createList",value:function(a,i,s,u){var o={unique_name:a,purpose:i,context:s};return u!==void 0&&(o.ttl=u),this.services.network.post(this.services.config.listsUri,o).then(function(l){return l.body})}},{key:"_getList",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.readRootFromSessionCache(Xt.type,s)||this._get(this.services.config.listsUri,s));case 1:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_createMap",value:function(a,i){var s={unique_name:a};return i!==void 0&&(s.ttl=i),this.services.network.post(this.services.config.mapsUri,s).then(function(u){return u.body})}},{key:"_getMap",value:function(){var n=Oe.default(G.default.mark(function i(s){var u,o=arguments;return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return u=o.length>1&&o[1]!==void 0?o[1]:!1,c.abrupt("return",this.readRootFromSessionCache(tr.type,s)||this._get(this.services.config.mapsUri,s,u));case 2:case"end":return c.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_getStream",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.readRootFromSessionCache(Gn.type,s)||this._get(this.services.config.streamsUri,s,!1));case 1:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"_createStream",value:function(){var n=Oe.default(G.default.mark(function i(s,u){var o,l;return G.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return o={unique_name:s},u!==void 0&&(o.ttl=u),h.next=4,this.services.network.post(this.services.config.streamsUri,o);case 4:return l=h.sent,h.abrupt("return",l.body);case 6:case"end":return h.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"_getLiveQuery",value:function(a){return this.readRootFromSessionCache(ha.type,a)}},{key:"getCached",value:function(a,i){return a&&this.entities.get(a,i)||null}},{key:"removeFromCacheAndSession",value:function(a,i,s){this.entities.remove(i),this.services.config.sessionStorageEnabled&&this.services.storage.remove(a,i,s)}},{key:"document",value:function(){var n=Oe.default(G.default.mark(function i(s){var u=this,o,l,c,h;return G.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(o=Ql(s),o.mode!=="create_new"){b.next=9;break}return b.next=6,this._createDocument(o.id,o.data,o.ttl);case 6:l=b.sent,b.next=39;break;case 9:if(c=this.getCached(o.id,fn.type),!c){b.next=14;break}return b.abrupt("return",new fn(c));case 14:return b.prev=14,b.next=17,this._getDocument(o.id);case 17:l=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||o.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createDocument(o.id,o.data,o.ttl);case 29:l=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.document(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(fn.type,o.id,l),h=new nh(this.services,l,function($,C,I){return u.removeFromCacheAndSession($,C,I)}),h=this.entities.store(h),b.abrupt("return",new fn(h));case 43:case"end":return b.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"map",value:function(){var n=Oe.default(G.default.mark(function i(s){var u=this,o,l,c,h;return G.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(o=Ql(s),o.mode!=="create_new"){b.next=9;break}return b.next=6,this._createMap(o.id,o.ttl);case 6:l=b.sent,b.next=39;break;case 9:if(c=this.getCached(o.id,tr.type),!c){b.next=14;break}return b.abrupt("return",new tr(c));case 14:return b.prev=14,b.next=17,this._getMap(o.id,o.includeItems);case 17:l=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||o.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createMap(o.id,o.ttl);case 29:l=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.map(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(tr.type,o.id,l),h=new sh(this.services,l,function($,C,I){return u.removeFromCacheAndSession($,C,I)}),h=this.entities.store(h),b.abrupt("return",new tr(h));case 43:case"end":return b.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"list",value:function(){var n=Oe.default(G.default.mark(function i(s){var u=this,o,l,c,h;return G.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.ensureReady();case 2:if(o=Ql(s),o.mode!=="create_new"){b.next=9;break}return b.next=6,this._createList(o.id,o.purpose,o.context,o.ttl);case 6:l=b.sent,b.next=39;break;case 9:if(c=this.getCached(o.id,Xt.type),!c){b.next=14;break}return b.abrupt("return",new Xt(c));case 14:return b.prev=14,b.next=17,this._getList(o.id);case 17:l=b.sent,b.next=39;break;case 20:if(b.prev=20,b.t0=b.catch(14),!(b.t0.status!==404||o.mode==="open_existing")){b.next=26;break}throw b.t0;case 26:return b.prev=26,b.next=29,this._createList(o.id,o.purpose,o.context,o.ttl);case 29:l=b.sent,b.next=39;break;case 32:if(b.prev=32,b.t1=b.catch(26),b.t1.status!==409){b.next=38;break}return b.abrupt("return",this.list(s));case 38:throw b.t1;case 39:return this.storeRootInSessionCache(Xt.type,o.id,l),h=new ih(this.services,l,function($,C,I){return u.removeFromCacheAndSession($,C,I)}),h=this.entities.store(h),b.abrupt("return",new Xt(h));case 43:case"end":return b.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"stream",value:function(){var n=Oe.default(G.default.mark(function i(s){var u=this,o,l,c,h,w;return G.default.wrap(function($){for(;;)switch($.prev=$.next){case 0:return $.next=2,this.ensureReady();case 2:if(o=Ql(s),o.mode!=="create_new"){$.next=9;break}return $.next=6,this._createStream(o.id,o.ttl);case 6:l=$.sent,$.next=39;break;case 9:if(c=this.getCached(o.id,Gn.type),!c){$.next=14;break}return $.abrupt("return",new Gn(c));case 14:return $.prev=14,$.next=17,this._getStream(o.id);case 17:l=$.sent,$.next=39;break;case 20:if($.prev=20,$.t0=$.catch(14),!($.t0.status!==404||o.mode==="open_existing")){$.next=26;break}throw $.t0;case 26:return $.prev=26,$.next=29,this._createStream(o.id,o.ttl);case 29:l=$.sent,$.next=39;break;case 32:if($.prev=32,$.t1=$.catch(26),$.t1.status!==409){$.next=38;break}return $.abrupt("return",this.stream(s));case 38:throw $.t1;case 39:return this.storeRootInSessionCache(Gn.type,o.id,l),h=function(I,j,D){return u.removeFromCacheAndSession(I,j,D)},w=new Uu(this.services,l,h),w=this.entities.store(w),$.abrupt("return",new Gn(w));case 44:case"end":return $.stop()}},i,this,[[14,20],[26,32]])}));function a(i){return n.apply(this,arguments)}return a}()},{key:"shutdown",value:function(){var n=Oe.default(G.default.mark(function i(){return G.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.subscriptions.shutdown();case 2:return u.next=4,this.services.twilsock.disconnect();case 4:case"end":return u.stop()}},i,this)}));function a(){return n.apply(this,arguments)}return a}()},{key:"updateToken",value:function(){var n=Oe.default(G.default.mark(function i(s){return G.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.services.twilsock.updateToken(s).catch(function(l){var c,h=l==null||(c=l.reply)===null||c===void 0?void 0:c.status;throw(h==null?void 0:h.code)===401&&(h==null?void 0:h.status)==="UNAUTHORIZED"?new Dr("Updated token was rejected by server",400,51130):l}));case 1:case"end":return o.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()},{key:"liveQuery",value:function(){var n=Oe.default(G.default.mark(function i(s,u){var o=this,l,c,h,w,b;return G.default.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,this.ensureReady();case 2:return l=new co(this.services.config.insightsUri).pathSegment(s).pathSegment("Items").build(),C.next=5,vI({network:this.services.network,uri:l,queryString:u,type:ha.type});case 5:return c=C.sent,h=this.getCached(c.query_id,ha.type),h||(w=this._getLiveQuery(c.query_id),w||(w={indexName:s,queryExpression:u,sid:c.query_id,queryUri:l,last_event_id:c.last_event_id}),b=function(j,D,ve){return o.removeFromCacheAndSession(j,D,ve)},h=new oh(w,this.services,b,c.items)),this.storeRootInSessionCache(ha.type,c.query_id,h.liveQueryDescriptor),h=this.entities.store(h),C.abrupt("return",new ha(h));case 11:case"end":return C.stop()}},i,this)}));function a(i,s){return n.apply(this,arguments)}return a}()},{key:"instantQuery",value:function(){var n=Oe.default(G.default.mark(function i(s){var u=this,o;return G.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.ensureReady();case 2:return o=function(w,b){return u.liveQuery(w,b)},c.abrupt("return",new hl({indexName:s,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:o}));case 4:case"end":return c.stop()}},i,this)}));function a(i){return n.apply(this,arguments)}return a}()}],[{key:"populateInitRegistrations",value:function(a){a.populateInitRegistrations([NS,PS,MS,xS])}},{key:"version",get:function(){return kp}}]),r}(kt);$t.default(en,"connectionStateChanged","connectionStateChanged");$t.default(en,"connectionError","connectionError");$t.default(en,"tokenAboutToExpire","tokenAboutToExpire");$t.default(en,"tokenExpired","tokenExpired");yt([_e.validateTypesAsync(["undefined","string",_e.objectSchema("open document options",{id:["string","undefined"],mode:[_e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[_e.nonNegativeInteger,"undefined"],data:[_e.pureObject,"undefined",_e.literal(null)]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],en.prototype,"document",null);yt([_e.validateTypesAsync(["undefined","string",_e.objectSchema("open map options",{id:["string","undefined"],mode:[_e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[_e.nonNegativeInteger,"undefined"],data:[_e.pureObject,"undefined",_e.literal(null)],includeItems:["boolean","undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],en.prototype,"map",null);yt([_e.validateTypesAsync(["undefined","string",_e.objectSchema("open list options",{id:["string","undefined"],mode:[_e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[_e.nonNegativeInteger,"undefined"],data:[_e.pureObject,"undefined",_e.literal(null)],purpose:["string","undefined"],context:[_e.pureObject,"undefined"],includeItems:["boolean","undefined"]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],en.prototype,"list",null);yt([_e.validateTypesAsync(["undefined","string",_e.objectSchema("open stream options",{id:["string","undefined"],mode:[_e.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[_e.nonNegativeInteger,"undefined"],data:[_e.pureObject,"undefined",_e.literal(null)]})]),Ee("design:type",Function),Ee("design:paramtypes",[Object]),Ee("design:returntype",Promise)],en.prototype,"stream",null);yt([_e.validateTypesAsync(_e.nonEmptyString),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",Promise)],en.prototype,"updateToken",null);yt([_e.validateTypesAsync(_e.nonEmptyString,"string"),Ee("design:type",Function),Ee("design:paramtypes",[String,String]),Ee("design:returntype",Promise)],en.prototype,"liveQuery",null);yt([_e.validateTypesAsync(_e.nonEmptyString),Ee("design:type",Function),Ee("design:paramtypes",[String]),Ee("design:returntype",Promise)],en.prototype,"instantQuery",null);Br.Client=en;Br.InsightsItem=KY;Br.InstantQuery=hl;Br.LiveQuery=ha;Br.Paginator=mg;Br.SyncClient=en;Br.SyncDocument=fn;Br.SyncList=Xt;Br.SyncListItem=ah;Br.SyncMap=tr;Br.SyncMapItem=lu;Br.SyncStream=Gn;var hI={},ZY=HE,eJ=TypeError,yI=function(e){if(ZY(e))throw eJ("The method doesn't accept regular expressions");return e},tJ=At,rJ=tJ("match"),gI=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[rJ]=!1,"/./"[e](t)}catch{}}return!1},nJ=st,mI=et,aJ=Qn.f,iJ=Ia,LS=or,sJ=yI,oJ=Zn,uJ=gI,jS=mI("".startsWith),lJ=mI("".slice),cJ=Math.min,bI=uJ("startsWith"),fJ=!bI&&!!function(){var e=aJ(String.prototype,"startsWith");return e&&!e.writable}();nJ({target:"String",proto:!0,forced:!fJ&&!bI},{startsWith:function(t){var r=LS(oJ(this));sJ(t);var n=iJ(cJ(arguments.length>1?arguments[1]:void 0,r.length)),a=LS(t);return jS?jS(r,a,n):lJ(r,n,n+a.length)===a}});var dJ=st,pJ=cg.left,vJ=ol,US=as,hJ=nl,yJ=vJ("reduce"),gJ=!hJ&&US>79&&US<83;dJ({target:"Array",proto:!0,forced:!yJ||gJ},{reduce:function(t){var r=arguments.length;return pJ(this,t,r,r>1?arguments[1]:void 0)}});var mJ=nt,bJ=At,wJ=h2,_J=bJ("iterator"),wI=!mJ(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach(function(n,a){t.delete("b"),r+=a+n}),wJ&&!e.toJSON||!t.sort||e.href!=="http://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[_J]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||r!=="a1c3"||new URL("http://x",void 0).host!=="x"}),FS=Kh.exports,SJ=Qt,$J=function(e,t,r){return r.get&&FS(r.get,t,{getter:!0}),r.set&&FS(r.set,t,{setter:!0}),SJ.f(e,t,r)},ps=et,Ep=2147483647,wu=36,_I=1,lh=26,TJ=38,kJ=700,EJ=72,IJ=128,CJ="-",RJ=/[^\0-\u007E]/,SI=/[.\u3002\uFF0E\uFF61]/g,DS="Overflow: input needs wider integers to process",Ip=wu-_I,BS=RangeError,AJ=ps(SI.exec),Hs=Math.floor,Cp=String.fromCharCode,qS=ps("".charCodeAt),$I=ps([].join),Ja=ps([].push),OJ=ps("".replace),PJ=ps("".split),MJ=ps("".toLowerCase),xJ=function(e){for(var t=[],r=0,n=e.length;r<n;){var a=qS(e,r++);if(a>=55296&&a<=56319&&r<n){var i=qS(e,r++);(i&64512)==56320?Ja(t,((a&1023)<<10)+(i&1023)+65536):(Ja(t,a),r--)}else Ja(t,a)}return t},HS=function(e){return e+22+75*(e<26)},NJ=function(e,t,r){var n=0;for(e=r?Hs(e/kJ):e>>1,e+=Hs(e/t);e>Ip*lh>>1;)e=Hs(e/Ip),n+=wu;return Hs(n+(Ip+1)*e/(e+TJ))},LJ=function(e){var t=[];e=xJ(e);var r=e.length,n=IJ,a=0,i=EJ,s,u;for(s=0;s<e.length;s++)u=e[s],u<128&&Ja(t,Cp(u));var o=t.length,l=o;for(o&&Ja(t,CJ);l<r;){var c=Ep;for(s=0;s<e.length;s++)u=e[s],u>=n&&u<c&&(c=u);var h=l+1;if(c-n>Hs((Ep-a)/h))throw BS(DS);for(a+=(c-n)*h,n=c,s=0;s<e.length;s++){if(u=e[s],u<n&&++a>Ep)throw BS(DS);if(u==n){for(var w=a,b=wu;;){var $=b<=i?_I:b>=i+lh?lh:b-i;if(w<$)break;var C=w-$,I=wu-$;Ja(t,Cp(HS($+C%I))),w=Hs(C/I),b+=wu}Ja(t,Cp(HS(w))),i=NJ(a,h,l==o),a=0,l++}}a++,n++}return $I(t,"")},jJ=function(e){var t=[],r=PJ(OJ(MJ(e),SI,"."),"."),n,a;for(n=0;n<r.length;n++)a=r[n],Ja(t,AJ(RJ,a)?"xn--"+LJ(a):a);return $I(t,".")},ch=st,fo=lt,Xl=Ct,Jn=et,UJ=Dt,TI=wI,kI=Sr,FJ=Hy,DJ=Ca,BJ=LT,_g=yn,EI=ls,Rp=Rt,qJ=Gt,HJ=Aa,WJ=Ra,GJ=Vt,II=Wt,Vr=or,zJ=vi,WS=rs,fh=_f,VJ=sl,Ps=dy,KJ=At,YJ=dg,JJ=KJ("iterator"),yl="URLSearchParams",CI=yl+"Iterator",RI=_g.set,Tn=_g.getterFor(yl),QJ=_g.getterFor(CI),XJ=Object.getOwnPropertyDescriptor,Sg=function(e){if(!UJ)return fo[e];var t=XJ(fo,e);return t&&t.value},GS=Sg("fetch"),Bc=Sg("Request"),_u=Sg("Headers"),Ap=Bc&&Bc.prototype,zS=_u&&_u.prototype,ZJ=fo.RegExp,eQ=fo.TypeError,AI=fo.decodeURIComponent,tQ=fo.encodeURIComponent,rQ=Jn("".charAt),VS=Jn([].join),Wi=Jn([].push),dh=Jn("".replace),nQ=Jn([].shift),KS=Jn([].splice),YS=Jn("".split),aQ=Jn("".slice),iQ=/\+/g,JS=Array(4),sQ=function(e){return JS[e-1]||(JS[e-1]=ZJ("((?:%[\\da-f]{2}){"+e+"})","gi"))},oQ=function(e){try{return AI(e)}catch{return e}},QS=function(e){var t=dh(e,iQ," "),r=4;try{return AI(t)}catch{for(;r;)t=dh(t,sQ(r--),oQ);return t}},uQ=/[!'()~]|%20/g,lQ={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},cQ=function(e){return lQ[e]},XS=function(e){return dh(tQ(e),uQ,cQ)},Op=BJ(function(t,r){RI(this,{type:CI,iterator:fh(Tn(t).entries),kind:r})},"Iterator",function(){var t=QJ(this),r=t.kind,n=t.iterator.next(),a=n.value;return n.done||(n.value=r==="keys"?a.key:r==="values"?a.value:[a.key,a.value]),n},!0),OI=function(e){this.entries=[],this.url=null,e!==void 0&&(II(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?rQ(e,0)==="?"?aQ(e,1):e:Vr(e)))};OI.prototype={type:yl,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t=VJ(e),r,n,a,i,s,u,o;if(t)for(r=fh(e,t),n=r.next;!(a=Xl(n,r)).done;){if(i=fh(GJ(a.value)),s=i.next,(u=Xl(s,i)).done||(o=Xl(s,i)).done||!Xl(s,i).done)throw eQ("Expected sequence with length 2");Wi(this.entries,{key:Vr(u.value),value:Vr(o.value)})}else for(var l in e)qJ(e,l)&&Wi(this.entries,{key:l,value:Vr(e[l])})},parseQuery:function(e){if(e)for(var t=YS(e,"&"),r=0,n,a;r<t.length;)n=t[r++],n.length&&(a=YS(n,"="),Wi(this.entries,{key:QS(nQ(a)),value:QS(VS(a,"="))}))},serialize:function(){for(var e=this.entries,t=[],r=0,n;r<e.length;)n=e[r++],Wi(t,XS(n.key)+"="+XS(n.value));return VS(t,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var zf=function(){EI(this,Fu);var t=arguments.length>0?arguments[0]:void 0;RI(this,new OI(t))},Fu=zf.prototype;FJ(Fu,{append:function(t,r){Ps(arguments.length,2);var n=Tn(this);Wi(n.entries,{key:Vr(t),value:Vr(r)}),n.updateURL()},delete:function(e){Ps(arguments.length,1);for(var t=Tn(this),r=t.entries,n=Vr(e),a=0;a<r.length;)r[a].key===n?KS(r,a,1):a++;t.updateURL()},get:function(t){Ps(arguments.length,1);for(var r=Tn(this).entries,n=Vr(t),a=0;a<r.length;a++)if(r[a].key===n)return r[a].value;return null},getAll:function(t){Ps(arguments.length,1);for(var r=Tn(this).entries,n=Vr(t),a=[],i=0;i<r.length;i++)r[i].key===n&&Wi(a,r[i].value);return a},has:function(t){Ps(arguments.length,1);for(var r=Tn(this).entries,n=Vr(t),a=0;a<r.length;)if(r[a++].key===n)return!0;return!1},set:function(t,r){Ps(arguments.length,1);for(var n=Tn(this),a=n.entries,i=!1,s=Vr(t),u=Vr(r),o=0,l;o<a.length;o++)l=a[o],l.key===s&&(i?KS(a,o--,1):(i=!0,l.value=u));i||Wi(a,{key:s,value:u}),n.updateURL()},sort:function(){var t=Tn(this);YJ(t.entries,function(r,n){return r.key>n.key?1:-1}),t.updateURL()},forEach:function(t){for(var r=Tn(this).entries,n=HJ(t,arguments.length>1?arguments[1]:void 0),a=0,i;a<r.length;)i=r[a++],n(i.value,i.key,this)},keys:function(){return new Op(this,"keys")},values:function(){return new Op(this,"values")},entries:function(){return new Op(this,"entries")}},{enumerable:!0});kI(Fu,JJ,Fu.entries,{name:"entries"});kI(Fu,"toString",function(){return Tn(this).serialize()},{enumerable:!0});DJ(zf,yl);ch({global:!0,constructor:!0,forced:!TI},{URLSearchParams:zf});if(!TI&&Rp(_u)){var fQ=Jn(zS.has),dQ=Jn(zS.set),ZS=function(e){if(II(e)){var t=e.body,r;if(WJ(t)===yl)return r=e.headers?new _u(e.headers):new _u,fQ(r,"content-type")||dQ(r,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),zJ(e,{body:WS(0,Vr(t)),headers:WS(0,r)})}return e};if(Rp(GS)&&ch({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return GS(t,arguments.length>1?ZS(arguments[1]):{})}}),Rp(Bc)){var Pp=function(t){return EI(this,Ap),new Bc(t,arguments.length>1?ZS(arguments[1]):{})};Ap.constructor=Pp,Pp.prototype=Ap,ch({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:Pp})}}var pQ={URLSearchParams:zf,getState:Tn},vQ=st,$g=Dt,hQ=wI,Tg=lt,e0=Aa,gn=et,qc=Sr,sn=$J,yQ=ls,ph=Gt,kg=YE,Ms=MT,$n=Xu,gQ=_y.codeAt,mQ=jJ,oa=or,bQ=Ca,wQ=dy,PI=pQ,MI=yn,_Q=MI.set,Hc=MI.getterFor("URL"),SQ=PI.URLSearchParams,$Q=PI.getState,au=Tg.URL,vh=Tg.TypeError,Wc=Tg.parseInt,TQ=Math.floor,t0=Math.pow,cn=gn("".charAt),In=gn(/./.exec),cu=gn([].join),kQ=gn(1 .toString),EQ=gn([].pop),Ds=gn([].push),r0=gn("".replace),IQ=gn([].shift),CQ=gn("".split),Su=gn("".slice),Gc=gn("".toLowerCase),RQ=gn([].unshift),AQ="Invalid authority",Mp="Invalid scheme",Ni="Invalid host",n0="Invalid port",xI=/[a-z]/i,OQ=/[\d+-.a-z]/i,hh=/\d/,PQ=/^0x/i,MQ=/^[0-7]+$/,xQ=/^\d+$/,NI=/^[\da-f]+$/i,NQ=/[\0\t\n\r #%/:<>?@[\\\]^|]/,LQ=/[\0\t\n\r #/:<>?@[\\\]^|]/,jQ=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,UQ=/[\t\n\r]/g,on,FQ=function(e){var t=CQ(e,"."),r,n,a,i,s,u,o;if(t.length&&t[t.length-1]==""&&t.length--,r=t.length,r>4)return e;for(n=[],a=0;a<r;a++){if(i=t[a],i=="")return e;if(s=10,i.length>1&&cn(i,0)=="0"&&(s=In(PQ,i)?16:8,i=Su(i,s==8?1:2)),i==="")u=0;else{if(!In(s==10?xQ:s==8?MQ:NI,i))return e;u=Wc(i,s)}Ds(n,u)}for(a=0;a<r;a++)if(u=n[a],a==r-1){if(u>=t0(256,5-r))return null}else if(u>255)return null;for(o=EQ(n),a=0;a<n.length;a++)o+=n[a]*t0(256,3-a);return o},DQ=function(e){var t=[0,0,0,0,0,0,0,0],r=0,n=null,a=0,i,s,u,o,l,c,h,w=function(){return cn(e,a)};if(w()==":"){if(cn(e,1)!=":")return;a+=2,r++,n=r}for(;w();){if(r==8)return;if(w()==":"){if(n!==null)return;a++,r++,n=r;continue}for(i=s=0;s<4&&In(NI,w());)i=i*16+Wc(w(),16),a++,s++;if(w()=="."){if(s==0||(a-=s,r>6))return;for(u=0;w();){if(o=null,u>0)if(w()=="."&&u<4)a++;else return;if(!In(hh,w()))return;for(;In(hh,w());){if(l=Wc(w(),10),o===null)o=l;else{if(o==0)return;o=o*10+l}if(o>255)return;a++}t[r]=t[r]*256+o,u++,(u==2||u==4)&&r++}if(u!=4)return;break}else if(w()==":"){if(a++,!w())return}else if(w())return;t[r++]=i}if(n!==null)for(c=r-n,r=7;r!=0&&c>0;)h=t[r],t[r--]=t[n+c-1],t[n+--c]=h;else if(r!=8)return;return t},BQ=function(e){for(var t=null,r=1,n=null,a=0,i=0;i<8;i++)e[i]!==0?(a>r&&(t=n,r=a),n=null,a=0):(n===null&&(n=i),++a);return a>r&&(t=n,r=a),t},iu=function(e){var t,r,n,a;if(typeof e=="number"){for(t=[],r=0;r<4;r++)RQ(t,e%256),e=TQ(e/256);return cu(t,".")}else if(typeof e=="object"){for(t="",n=BQ(e),r=0;r<8;r++)a&&e[r]===0||(a&&(a=!1),n===r?(t+=r?":":"::",a=!0):(t+=kQ(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},vc={},LI=kg({},vc,{" ":1,'"':1,"<":1,">":1,"`":1}),jI=kg({},LI,{"#":1,"?":1,"{":1,"}":1}),xp=kg({},jI,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Wa=function(e,t){var r=gQ(e,0);return r>32&&r<127&&!ph(t,e)?e:encodeURIComponent(e)},Zl={ftp:21,file:null,http:80,https:443,ws:80,wss:443},fu=function(e,t){var r;return e.length==2&&In(xI,cn(e,0))&&((r=cn(e,1))==":"||!t&&r=="|")},a0=function(e){var t;return e.length>1&&fu(Su(e,0,2))&&(e.length==2||(t=cn(e,2))==="/"||t==="\\"||t==="?"||t==="#")},qQ=function(e){return e==="."||Gc(e)==="%2e"},HQ=function(e){return e=Gc(e),e===".."||e==="%2e."||e===".%2e"||e==="%2e%2e"},Np={},i0={},Lp={},s0={},o0={},jp={},u0={},l0={},ec={},tc={},Up={},Fp={},Dp={},Bp={},c0={},qp={},xs={},Bn={},f0={},Li={},sa={},Eg=function(e,t,r){var n=oa(e),a,i,s;if(t){if(i=this.parse(n),i)throw vh(i);this.searchParams=null}else{if(r!==void 0&&(a=new Eg(r,!0)),i=this.parse(n,null,a),i)throw vh(i);s=$Q(new SQ),s.bindURL(this),this.searchParams=s}};Eg.prototype={type:"URL",parse:function(e,t,r){var n=this,a=t||Np,i=0,s="",u=!1,o=!1,l=!1,c,h,w,b;for(e=oa(e),t||(n.scheme="",n.username="",n.password="",n.host=null,n.port=null,n.path=[],n.query=null,n.fragment=null,n.cannotBeABaseURL=!1,e=r0(e,jQ,"")),e=r0(e,UQ,""),c=Ms(e);i<=c.length;){switch(h=c[i],a){case Np:if(h&&In(xI,h))s+=Gc(h),a=i0;else{if(t)return Mp;a=Lp;continue}break;case i0:if(h&&(In(OQ,h)||h=="+"||h=="-"||h=="."))s+=Gc(h);else if(h==":"){if(t&&(n.isSpecial()!=ph(Zl,s)||s=="file"&&(n.includesCredentials()||n.port!==null)||n.scheme=="file"&&!n.host))return;if(n.scheme=s,t){n.isSpecial()&&Zl[n.scheme]==n.port&&(n.port=null);return}s="",n.scheme=="file"?a=Bp:n.isSpecial()&&r&&r.scheme==n.scheme?a=s0:n.isSpecial()?a=l0:c[i+1]=="/"?(a=o0,i++):(n.cannotBeABaseURL=!0,Ds(n.path,""),a=f0)}else{if(t)return Mp;s="",a=Lp,i=0;continue}break;case Lp:if(!r||r.cannotBeABaseURL&&h!="#")return Mp;if(r.cannotBeABaseURL&&h=="#"){n.scheme=r.scheme,n.path=$n(r.path),n.query=r.query,n.fragment="",n.cannotBeABaseURL=!0,a=sa;break}a=r.scheme=="file"?Bp:jp;continue;case s0:if(h=="/"&&c[i+1]=="/")a=ec,i++;else{a=jp;continue}break;case o0:if(h=="/"){a=tc;break}else{a=Bn;continue}case jp:if(n.scheme=r.scheme,h==on)n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=$n(r.path),n.query=r.query;else if(h=="/"||h=="\\"&&n.isSpecial())a=u0;else if(h=="?")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=$n(r.path),n.query="",a=Li;else if(h=="#")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=$n(r.path),n.query=r.query,n.fragment="",a=sa;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=$n(r.path),n.path.length--,a=Bn;continue}break;case u0:if(n.isSpecial()&&(h=="/"||h=="\\"))a=ec;else if(h=="/")a=tc;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,a=Bn;continue}break;case l0:if(a=ec,h!="/"||cn(s,i+1)!="/")continue;i++;break;case ec:if(h!="/"&&h!="\\"){a=tc;continue}break;case tc:if(h=="@"){u&&(s="%40"+s),u=!0,w=Ms(s);for(var $=0;$<w.length;$++){var C=w[$];if(C==":"&&!l){l=!0;continue}var I=Wa(C,xp);l?n.password+=I:n.username+=I}s=""}else if(h==on||h=="/"||h=="?"||h=="#"||h=="\\"&&n.isSpecial()){if(u&&s=="")return AQ;i-=Ms(s).length+1,s="",a=Up}else s+=h;break;case Up:case Fp:if(t&&n.scheme=="file"){a=qp;continue}else if(h==":"&&!o){if(s=="")return Ni;if(b=n.parseHost(s),b)return b;if(s="",a=Dp,t==Fp)return}else if(h==on||h=="/"||h=="?"||h=="#"||h=="\\"&&n.isSpecial()){if(n.isSpecial()&&s=="")return Ni;if(t&&s==""&&(n.includesCredentials()||n.port!==null))return;if(b=n.parseHost(s),b)return b;if(s="",a=xs,t)return;continue}else h=="["?o=!0:h=="]"&&(o=!1),s+=h;break;case Dp:if(In(hh,h))s+=h;else if(h==on||h=="/"||h=="?"||h=="#"||h=="\\"&&n.isSpecial()||t){if(s!=""){var j=Wc(s,10);if(j>65535)return n0;n.port=n.isSpecial()&&j===Zl[n.scheme]?null:j,s=""}if(t)return;a=xs;continue}else return n0;break;case Bp:if(n.scheme="file",h=="/"||h=="\\")a=c0;else if(r&&r.scheme=="file")if(h==on)n.host=r.host,n.path=$n(r.path),n.query=r.query;else if(h=="?")n.host=r.host,n.path=$n(r.path),n.query="",a=Li;else if(h=="#")n.host=r.host,n.path=$n(r.path),n.query=r.query,n.fragment="",a=sa;else{a0(cu($n(c,i),""))||(n.host=r.host,n.path=$n(r.path),n.shortenPath()),a=Bn;continue}else{a=Bn;continue}break;case c0:if(h=="/"||h=="\\"){a=qp;break}r&&r.scheme=="file"&&!a0(cu($n(c,i),""))&&(fu(r.path[0],!0)?Ds(n.path,r.path[0]):n.host=r.host),a=Bn;continue;case qp:if(h==on||h=="/"||h=="\\"||h=="?"||h=="#"){if(!t&&fu(s))a=Bn;else if(s==""){if(n.host="",t)return;a=xs}else{if(b=n.parseHost(s),b)return b;if(n.host=="localhost"&&(n.host=""),t)return;s="",a=xs}continue}else s+=h;break;case xs:if(n.isSpecial()){if(a=Bn,h!="/"&&h!="\\")continue}else if(!t&&h=="?")n.query="",a=Li;else if(!t&&h=="#")n.fragment="",a=sa;else if(h!=on&&(a=Bn,h!="/"))continue;break;case Bn:if(h==on||h=="/"||h=="\\"&&n.isSpecial()||!t&&(h=="?"||h=="#")){if(HQ(s)?(n.shortenPath(),h!="/"&&!(h=="\\"&&n.isSpecial())&&Ds(n.path,"")):qQ(s)?h!="/"&&!(h=="\\"&&n.isSpecial())&&Ds(n.path,""):(n.scheme=="file"&&!n.path.length&&fu(s)&&(n.host&&(n.host=""),s=cn(s,0)+":"),Ds(n.path,s)),s="",n.scheme=="file"&&(h==on||h=="?"||h=="#"))for(;n.path.length>1&&n.path[0]==="";)IQ(n.path);h=="?"?(n.query="",a=Li):h=="#"&&(n.fragment="",a=sa)}else s+=Wa(h,jI);break;case f0:h=="?"?(n.query="",a=Li):h=="#"?(n.fragment="",a=sa):h!=on&&(n.path[0]+=Wa(h,vc));break;case Li:!t&&h=="#"?(n.fragment="",a=sa):h!=on&&(h=="'"&&n.isSpecial()?n.query+="%27":h=="#"?n.query+="%23":n.query+=Wa(h,vc));break;case sa:h!=on&&(n.fragment+=Wa(h,LI));break}i++}},parseHost:function(e){var t,r,n;if(cn(e,0)=="["){if(cn(e,e.length-1)!="]"||(t=DQ(Su(e,1,-1)),!t))return Ni;this.host=t}else if(this.isSpecial()){if(e=mQ(e),In(NQ,e)||(t=FQ(e),t===null))return Ni;this.host=t}else{if(In(LQ,e))return Ni;for(t="",r=Ms(e),n=0;n<r.length;n++)t+=Wa(r[n],vc);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return ph(Zl,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;t&&(this.scheme!="file"||t!=1||!fu(e[0],!0))&&e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,a=e.host,i=e.port,s=e.path,u=e.query,o=e.fragment,l=t+":";return a!==null?(l+="//",e.includesCredentials()&&(l+=r+(n?":"+n:"")+"@"),l+=iu(a),i!==null&&(l+=":"+i)):t=="file"&&(l+="//"),l+=e.cannotBeABaseURL?s[0]:s.length?"/"+cu(s,"/"):"",u!==null&&(l+="?"+u),o!==null&&(l+="#"+o),l},setHref:function(e){var t=this.parse(e);if(t)throw vh(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e=="blob")try{return new po(e.path[0]).origin}catch{return"null"}return e=="file"||!this.isSpecial()?"null":e+"://"+iu(this.host)+(t!==null?":"+t:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(oa(e)+":",Np)},getUsername:function(){return this.username},setUsername:function(e){var t=Ms(oa(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=Wa(t[r],xp)}},getPassword:function(){return this.password},setPassword:function(e){var t=Ms(oa(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=Wa(t[r],xp)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?iu(e):iu(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,Up)},getHostname:function(){var e=this.host;return e===null?"":iu(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,Fp)},getPort:function(){var e=this.port;return e===null?"":oa(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(e=oa(e),e==""?this.port=null:this.parse(e,Dp))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+cu(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,xs))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){e=oa(e),e==""?this.query=null:(cn(e,0)=="?"&&(e=Su(e,1)),this.query="",this.parse(e,Li)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){if(e=oa(e),e==""){this.fragment=null;return}cn(e,0)=="#"&&(e=Su(e,1)),this.fragment="",this.parse(e,sa)},update:function(){this.query=this.searchParams.serialize()||null}};var po=function(t){var r=yQ(this,Or),n=wQ(arguments.length,1)>1?arguments[1]:void 0,a=_Q(r,new Eg(t,!1,n));$g||(r.href=a.serialize(),r.origin=a.getOrigin(),r.protocol=a.getProtocol(),r.username=a.getUsername(),r.password=a.getPassword(),r.host=a.getHost(),r.hostname=a.getHostname(),r.port=a.getPort(),r.pathname=a.getPathname(),r.search=a.getSearch(),r.searchParams=a.getSearchParams(),r.hash=a.getHash())},Or=po.prototype,un=function(e,t){return{get:function(){return Hc(this)[e]()},set:t&&function(r){return Hc(this)[t](r)},configurable:!0,enumerable:!0}};$g&&(sn(Or,"href",un("serialize","setHref")),sn(Or,"origin",un("getOrigin")),sn(Or,"protocol",un("getProtocol","setProtocol")),sn(Or,"username",un("getUsername","setUsername")),sn(Or,"password",un("getPassword","setPassword")),sn(Or,"host",un("getHost","setHost")),sn(Or,"hostname",un("getHostname","setHostname")),sn(Or,"port",un("getPort","setPort")),sn(Or,"pathname",un("getPathname","setPathname")),sn(Or,"search",un("getSearch","setSearch")),sn(Or,"searchParams",un("getSearchParams")),sn(Or,"hash",un("getHash","setHash")));qc(Or,"toJSON",function(){return Hc(this).serialize()},{enumerable:!0});qc(Or,"toString",function(){return Hc(this).serialize()},{enumerable:!0});if(au){var d0=au.createObjectURL,p0=au.revokeObjectURL;d0&&qc(po,"createObjectURL",e0(d0,au)),p0&&qc(po,"revokeObjectURL",e0(p0,au))}bQ(po,"URL");vQ({global:!0,constructor:!0,forced:!hQ,sham:!$g},{URL:po});var Er={};/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(Er,"__esModule",{value:!0});var WQ=jn.exports,GQ=gi.exports,zQ=mi.exports,VQ=ta.exports,KQ=Un.exports,YQ=Nn.exports,JQ=Ln.exports,QQ=Xr.exports;function $i(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var eo=$i(WQ),$a=$i(GQ),Hp=$i(zQ),XQ=$i(VQ),ZQ=$i(KQ),eX=$i(YQ),tX=$i(JQ),v0=$i(QQ),Na=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function rX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=nX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function nX(e,t){if(!!e){if(typeof e=="string")return h0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return h0(e,t)}}function h0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var UI=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Na(function(a){var i=!1,s=[],u=rX(r),o;try{for(u.s();!(o=u.n()).done;){var l=o.value;if(typeof l=="string"){i=i||eo.default(a)===l,s.push("of type ".concat(l));continue}i=i||a instanceof l,s.push("an instance of ".concat(l.name))}}catch(c){u.e(c)}finally{u.f()}return[i,s]})};function aX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=iX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function iX(e,t){if(!!e){if(typeof e=="string")return y0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return y0(e,t)}}function y0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var sX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return Na(function(a){var i=!1,s=[],u=aX(r),o;try{for(u.s();!(o=u.n()).done;){var l=o.value;i=i||a===l,s.push(typeof l=="string"?'"'.concat(l,'"'):"".concat(l))}}catch(c){u.e(c)}finally{u.f()}return[i,s]})};function oX(e){var t=uX();return function(){var n=v0.default(e),a;if(t){var i=v0.default(this).constructor;a=Reflect.construct(n,arguments,i)}else a=n.apply(this,arguments);return tX.default(this,a)}}function uX(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Du(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=lX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function lX(e,t){if(!!e){if(typeof e=="string")return g0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return g0(e,t)}}function g0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var Vf=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=Du(r.entries()),a;try{for(n.s();!(a=n.n()).done;){var i=$a.default(a.value,2),s=i[0],u=i[1],o=Yf(t[s],u),l=$a.default(o,4),c=l[0],h=l[1],w=l[2],b=l[3];if(!c){var $=s+1;throw new Error("Argument ".concat($," is expected to be ").concat(w).concat(b," but got ").concat(h))}}}catch(C){n.e(C)}finally{n.f()}},FI=function(t){var r,n,a=["undefined","boolean","number","bigint","string"];if(a.includes(eo.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),eo.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var i;n=t===null?"null":"instance of ".concat(t==null||(i=t.constructor)===null||i===void 0?void 0:i.name)}return n||(n=eo.default(t)),n},cX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Ig(r);return function(i){return function(s){eX.default(o,s);var u=oX(o);function o(){ZQ.default(this,o);for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Vf(a,c),u.call.apply(u,[this].concat(c))}return XQ.default(o)}(i)}},fX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Ig(r);return function(i,s,u){if(typeof u.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var o=u.value;u.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return Vf(a,c),o.apply(this,c)}}},dX=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=Ig(r);return function(i,s,u){if(typeof u.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var o=u.value;u.value=function(){for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];try{Vf(a,c)}catch(w){return Promise.reject(w)}return o.apply(this,c)}}},Ig=function(t){var r=[],n=Du(t),a;try{for(n.s();!(a=n.n()).done;){var i=a.value;r.push(Kf(i))}}catch(s){n.e(s)}finally{n.f()}return r},Kf=function(t){var r=[],n=Array.isArray(t)?t:[t],a=Du(n),i;try{for(a.s();!(i=a.n()).done;){var s=i.value;if(typeof s=="string"||typeof s=="function"){r.push(UI(s));continue}r.push(s)}}catch(u){a.e(u)}finally{a.f()}return r},Yf=function(t,r){var n=[],a,i=!1,s=Du(t),u;try{for(s.s();!(u=s.n()).done;){var o=u.value,l=Du(o.checks),c;try{for(l.s();!(c=l.n()).done;){var h=c.value,w=h(r),b=$a.default(w,3),$=b[0],C=b[1],I=b[2];i=i||$,!a&&I&&(a=I),C&&(n=typeof C=="string"?[].concat(Hp.default(n),[C]):[].concat(Hp.default(n),Hp.default(C)))}}catch(se){l.e(se)}finally{l.f()}}}catch(se){s.e(se)}finally{s.f()}if(i)return[!0];var j=a||FI(r),D=n.length-1,ve=D>0?"".concat(n.slice(0,D).join(", ")," or ").concat(n[D]):n.join(", ");return[!1,j,ve,D>1?";":","]};function pX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=vX(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function vX(e,t){if(!!e){if(typeof e=="string")return m0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return m0(e,t)}}function m0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var hX=function(t,r){return Na(function(n){if(!Array.isArray(n)||n.length<1)return[!1,"a non-empty array of ".concat(t)];var a=pX(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=$a.default(i.value,2),u=s[0],o=s[1],l=Yf(Kf(r),o),c=$a.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid non-empty array of ".concat(t," (index ").concat(u," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(u," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})},yX=Na(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),gX=Na(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),mX=Na(function(e){return[eo.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]}),bX=function(t,r){return Na(function(n){if(eo.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var a=0,i=Object.entries(r);a<i.length;a++){var s=$a.default(i[a],2),u=s[0],o=s[1],l=Yf(Kf(o),n[u]),c=$a.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"valid ".concat(t,' (key "').concat(u,'" should be ').concat(b,")"),"malformed ".concat(t,' (key "').concat(u,'" is ').concat(w,")")]}return[!0]})};function wX(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=_X(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(l){throw l},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var l=r.next();return i=l.done,l},e:function(l){s=!0,u=l},f:function(){try{!i&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function _X(e,t){if(!!e){if(typeof e=="string")return b0(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return b0(e,t)}}function b0(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var SX=function(t,r){return Na(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var a=wX(n.entries()),i;try{for(a.s();!(i=a.n()).done;){var s=$a.default(i.value,2),u=s[0],o=s[1],l=Yf(Kf(r),o),c=$a.default(l,3),h=c[0],w=c[1],b=c[2];if(!h)return[!1,"a valid array of ".concat(t," (index ").concat(u," should be ").concat(b,")"),"malformed array of ".concat(t," (index ").concat(u," is ").concat(w,")")]}}catch($){a.e($)}finally{a.f()}return[!0]})};Er.array=SX;Er.custom=Na;Er.literal=sX;Er.nonEmptyArray=hX;Er.nonEmptyString=yX;Er.nonNegativeInteger=gX;Er.objectSchema=bX;Er.pureObject=mX;Er.runtimeTypeValidation=Vf;Er.stringifyReceivedType=FI;Er.type=UI;Er.validateConstructorTypes=cX;Er.validateTypes=fX;Er.validateTypesAsync=dX;/*
@license
Copyright (c) 2018, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=yi.exports,n=So.exports,a=ul,i=cs.exports,s=Ma,u=Er;function o(ae){return ae&&typeof ae=="object"&&"default"in ae?ae:{default:ae}}function l(ae){if(ae&&ae.__esModule)return ae;var F=Object.create(null);return ae&&Object.keys(ae).forEach(function(H){if(H!=="default"){var K=Object.getOwnPropertyDescriptor(ae,H);Object.defineProperty(F,H,K.get?K:{enumerable:!0,get:function(){return ae[H]}})}}),F.default=ae,Object.freeze(F)}var c=o(r),h=o(n),w=o(a),b=l(i),$={exports:{}},C=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if(C){var I=new Uint8Array(16);$.exports=function(){return C(I),I}}else{var j=new Array(16);$.exports=function(){for(var F=0,H;F<16;F++)(F&3)===0&&(H=Math.random()*4294967296),j[F]=H>>>((F&3)<<3)&255;return j}}for(var D=[],ve=0;ve<256;++ve)D[ve]=(ve+256).toString(16).substr(1);function se(ae,F){var H=F||0,K=D;return[K[ae[H++]],K[ae[H++]],K[ae[H++]],K[ae[H++]],"-",K[ae[H++]],K[ae[H++]],"-",K[ae[H++]],K[ae[H++]],"-",K[ae[H++]],K[ae[H++]],"-",K[ae[H++]],K[ae[H++]],K[ae[H++]],K[ae[H++]],K[ae[H++]],K[ae[H++]]].join("")}var Pe=se,Me=$.exports,le=Pe,x,re,de=0,X=0;function xe(ae,F,H){var K=F&&H||0,ye=F||[];ae=ae||{};var Ne=ae.node||x,qe=ae.clockseq!==void 0?ae.clockseq:re;if(Ne==null||qe==null){var ze=Me();Ne==null&&(Ne=x=[ze[0]|1,ze[1],ze[2],ze[3],ze[4],ze[5]]),qe==null&&(qe=re=(ze[6]<<8|ze[7])&16383)}var De=ae.msecs!==void 0?ae.msecs:new Date().getTime(),He=ae.nsecs!==void 0?ae.nsecs:X+1,Le=De-de+(He-X)/1e4;if(Le<0&&ae.clockseq===void 0&&(qe=qe+1&16383),(Le<0||De>de)&&ae.nsecs===void 0&&(He=0),He>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");de=De,X=He,re=qe,De+=122192928e5;var J=((De&268435455)*1e4+He)%4294967296;ye[K++]=J>>>24&255,ye[K++]=J>>>16&255,ye[K++]=J>>>8&255,ye[K++]=J&255;var ee=De/4294967296*1e4&268435455;ye[K++]=ee>>>8&255,ye[K++]=ee&255,ye[K++]=ee>>>24&15|16,ye[K++]=ee>>>16&255,ye[K++]=qe>>>8|128,ye[K++]=qe&255;for(var q=0;q<6;++q)ye[K+q]=Ne[q];return F||le(ye)}var ce=xe,te=$.exports,ue=Pe;function ie(ae,F,H){var K=F&&H||0;typeof ae=="string"&&(F=ae==="binary"?new Array(16):null,ae=null),ae=ae||{};var ye=ae.random||(ae.rng||te)();if(ye[6]=ye[6]&15|64,ye[8]=ye[8]&63|128,F)for(var Ne=0;Ne<16;++Ne)F[K+Ne]=ye[Ne];return F||ue(ye)}var Ie=ie,$e=ce,N=Ie,ct=N;ct.v1=$e,ct.v4=N;var ft=ct;class Te extends Promise{constructor(F){var H=ft.v4(),K;super((ye,Ne)=>(K=Ne,F(qe=>{Te.cancellationMap.delete(H),ye(qe)},qe=>{Te.cancellationMap.delete(H),Ne(qe)},qe=>{Te.cancellationMap.set(H,qe)}))),this.id=H,this.rejectPromise=K}cancel(){var F=Te.cancellationMap.get(this.id);return F==null||F(),this.rejectPromise&&(this.catch(()=>{}),this.rejectPromise(new Error("Promise was cancelled"))),this}}c.default(Te,"cancellationMap",new Map);function Xe(ae,F,H,K){var ye=arguments.length,Ne=ye<3?F:K===null?K=Object.getOwnPropertyDescriptor(F,H):K,qe;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Ne=Reflect.decorate(ae,F,H,K);else for(var ze=ae.length-1;ze>=0;ze--)(qe=ae[ze])&&(Ne=(ye<3?qe(Ne):ye>3?qe(F,H,Ne):qe(F,H))||Ne);return ye>3&&Ne&&Object.defineProperty(F,H,Ne),Ne}function Je(ae,F){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(ae,F)}function B(ae,F){return["".concat(new Date().toISOString()," MCS Client ").concat(ae,":")].concat(Array.from(F))}class T{constructor(F){c.default(this,"prefix",""),this.prefix=F!=null&&F.length>0?F+" ":""}static scope(F){return new T(F)}setLevel(F){b.setLevel(F)}static setLevel(F){b.setLevel(F)}trace(){for(var F=arguments.length,H=new Array(F),K=0;K<F;K++)H[K]=arguments[K];b.trace.apply(null,B(this.prefix+"T",H))}debug(){for(var F=arguments.length,H=new Array(F),K=0;K<F;K++)H[K]=arguments[K];b.debug.apply(null,B(this.prefix+"D",H))}info(){for(var F=arguments.length,H=new Array(F),K=0;K<F;K++)H[K]=arguments[K];b.info.apply(null,B(this.prefix+"I",H))}warn(){for(var F=arguments.length,H=new Array(F),K=0;K<F;K++)H[K]=arguments[K];b.warn.apply(null,B(this.prefix+"W",H))}error(){for(var F=arguments.length,H=new Array(F),K=0;K<F;K++)H[K]=arguments[K];b.error.apply(null,B(this.prefix+"E",H))}static trace(){for(var F=arguments.length,H=new Array(F),K=0;K<F;K++)H[K]=arguments[K];b.trace.apply(null,B("T",H))}static debug(){for(var F=arguments.length,H=new Array(F),K=0;K<F;K++)H[K]=arguments[K];b.debug.apply(null,B("D",H))}static info(){for(var F=arguments.length,H=new Array(F),K=0;K<F;K++)H[K]=arguments[K];b.info.apply(null,B("I",H))}static warn(){for(var F=arguments.length,H=new Array(F),K=0;K<F;K++)H[K]=arguments[K];b.warn.apply(null,B("W",H))}static error(){for(var F=arguments.length,H=new Array(F),K=0;K<F;K++)H[K]=arguments[K];b.error.apply(null,B("E",H))}}var Se=1e3,pe=4e3,Ke=3,Qe=!0,we=ae=>"https://mcs.".concat(ae!=null?ae:"us1",".twilio.com"),Ge=ae=>ae.startsWith("http"),O=(ae,F)=>"".concat(Ge(ae)?"":we(F)).concat(ae);class R{constructor(F,H,K,ye){var Ne,qe,ze,De,He,Le,J=(Ne=(qe=ye.MCS)!==null&&qe!==void 0?qe:ye)!==null&&Ne!==void 0?Ne:{};this.region=(ze=(De=J.region)!==null&&De!==void 0?De:ye.region)!==null&&ze!==void 0?ze:"us1",this.mediaUrl=O(H,this.region),this.mediaSetUrl=K?O(K):"".concat(this.mediaUrl,"Set"),this.token=F,this.retryWhenThrottledOverride=(He=J.retryWhenThrottledOverride)!==null&&He!==void 0?He:Qe,this.backoffConfigOverride=(Le=J.backoffConfigOverride)!==null&&Le!==void 0?Le:R.backoffConfigDefault}static get backoffConfigDefault(){return{min:Se,max:pe,maxAttemptsCount:Ke}}static get retryWhenThrottledDefault(){return Qe}updateToken(F){this.token=F}}class V{constructor(F,H,K){this.config=F,this.network=H,this._update(K)}get sid(){return this.state.sid}get serviceSid(){return this.state.serviceSid}get dateCreated(){return this.state.dateCreated}get dateUpdated(){return this.state.dateUpdated}get contentType(){return this.state.contentType}get size(){return this.state.size}get fileName(){return this.state.filename}get filename(){return this.state.filename}get category(){return this.state.category}getContentUrl(){var F=this;return new Te(function(){var H=h.default(w.default.mark(function K(ye,Ne,qe){var ze,De;return w.default.wrap(function(Le){for(;;)switch(Le.prev=Le.next){case 0:return ze=F.network.get("".concat(F.config.mediaUrl,"/").concat(F.sid)),qe(()=>ze.cancel()),Le.prev=2,Le.next=5,ze;case 5:De=Le.sent,F._update(De.body),ye(F.state.contentDirectUrl),Le.next=13;break;case 10:Le.prev=10,Le.t0=Le.catch(2),Ne(Le.t0);case 13:case"end":return Le.stop()}},K,null,[[2,10]])}));return function(K,ye,Ne){return H.apply(this,arguments)}}())}_update(F){var H,K,ye,Ne;this.state={sid:F.sid,serviceSid:F.service_sid,channelSid:F.channel_sid,messageSid:F.message_sid,dateCreated:F.date_created?new Date(F.date_created):null,dateUploadUpdated:F.date_upload_updated?new Date(F.date_upload_updated):null,dateUpdated:F.date_updated?new Date(F.date_updated):null,size:F.size,contentType:F.content_type,author:F.author,url:F.url,contentUrl:F.links.content,contentDirectUrl:(H=F.links.content_direct_temporary)!==null&&H!==void 0?H:null,filename:(K=F.filename)!==null&&K!==void 0?K:null,category:(ye=F.category)!==null&&ye!==void 0?ye:"media",isMultipartUpstream:(Ne=F.is_multipart_upstream)!==null&&Ne!==void 0?Ne:!1}}}class fe extends Error{constructor(F,H,K,ye,Ne){super(F),this.code=H,this.body=K,this.status=ye,this.headers=Ne}}var W=t.XMLHttpRequest||{};function Re(ae){return ae?ae.split(`\r
`).map(F=>F.split(": ")).filter(F=>F.length===2&&F[1].length>0).reduce((F,H)=>(F[H[0]]=H[1],F),{}):{}}function me(ae){var F=ae.getResponseHeader("Content-Type");if(!F||F.indexOf("application/json")!==0||ae.responseText.length===0)return ae.responseText;try{return JSON.parse(ae.responseText)}catch{return ae.responseText}}class be{static request(F,H,K,ye){return new Te((Ne,qe,ze)=>{var De=new W,He=!1;ze(()=>{De.abort(),He=!0}),De.open(F,H,!0),De.onreadystatechange=function(){if(!(De.readyState!==4||He)){var ee=Re(De.getAllResponseHeaders()),q=me(De);if(200<=De.status&&De.status<300)Ne({status:De.status,headers:ee,body:q});else{var z,Z=(z=De.statusText)!==null&&z!==void 0?z:"NONE",ge;if(typeof q=="string")if(q&&q.split(`
`,2).length===1)ge=q;else{var oe,je=(oe=q.replace(/<.*?>/g,"").split(/\r\n/g).filter(at=>at.length)[0])===null||oe===void 0?void 0:oe.split(" ");ge=(je==null?void 0:je.length)>2?je==null?void 0:je.slice(1).join(" "):""}else ge=JSON.stringify(q);var Ve="".concat(De.status,": [").concat(Z,"] ").concat(ge);qe(new fe(Ve,De.status,q,Z,ee))}}};for(var Le in K)De.setRequestHeader(Le,K[Le]),Le==="Content-Type"&&K[Le]==="application/json"&&(ye=JSON.stringify(ye));De.send(ye)})}get(F,H){return be.request("GET",F,H)}post(F,H,K){return be.request("POST",F,H,K)}}var Ce=T.scope("Network");class Q{constructor(F,H){this.config=F,this.transport=H}backoffConfig(){return Object.assign(R.backoffConfigDefault,this.config.backoffConfigOverride)}retryWhenThrottled(){var F,H;return(F=(H=this.config.retryWhenThrottledOverride)!==null&&H!==void 0?H:R.retryWhenThrottledDefault)!==null&&F!==void 0?F:!1}executeWithRetry(F,H){var K=this;return new Te(function(){var ye=h.default(w.default.mark(function Ne(qe,ze,De){var He,Le;return w.default.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:He=new s.Retrier(K.backoffConfig()),Le=[502,503,504],H&&Le.push(429),De(()=>{He.cancel(),He.removeAllListeners()}),He.on("attempt",h.default(w.default.mark(function q(){var z,Z;return w.default.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return oe.prev=0,z=F(),De(()=>{z.cancel(),He.cancel(),He.removeAllListeners()}),oe.next=5,z;case 5:Z=oe.sent,He.succeeded(Z),oe.next=12;break;case 9:oe.prev=9,oe.t0=oe.catch(0),Le.indexOf(oe.t0.status)>-1||oe.t0.message==="Twilsock disconnected"?He.failed(oe.t0):(He.removeAllListeners(),He.cancel(),ze(oe.t0));case 12:case"end":return oe.stop()}},q,null,[[0,9]])}))),He.on("succeeded",q=>{qe(q)}),He.on("cancelled",q=>ze(q)),He.on("failed",q=>ze(q)),He.start();case 9:case"end":return ee.stop()}},Ne)}));return function(Ne,qe,ze){return ye.apply(this,arguments)}}())}get(F){var H=this;return new Te(function(){var K=h.default(w.default.mark(function ye(Ne,qe,ze){var De,He,Le;return w.default.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return De={"X-Twilio-Token":H.config.token},He=H.executeWithRetry(()=>H.transport.get(F,De),H.retryWhenThrottled()),Ce.trace("sending GET request to ",F," headers ",De),ze(()=>He.cancel()),ee.prev=4,ee.next=7,He;case 7:Le=ee.sent,Ce.trace("response",Le),Ne(Le),ee.next=16;break;case 12:ee.prev=12,ee.t0=ee.catch(4),Ce.debug("get() error ".concat(ee.t0)),qe(ee.t0);case 16:case"end":return ee.stop()}},ye,null,[[4,12]])}));return function(ye,Ne,qe){return K.apply(this,arguments)}}())}post(F,H,K,ye,Ne){var qe=this,ze={"X-Twilio-Token":this.config.token};(typeof FormData>"u"||!(K instanceof FormData))&&ye&&Object.assign(ze,{"Content-Type":ye});var De=new URL(F);return H&&De.searchParams.append("Category",H),Ne&&De.searchParams.append("Filename",Ne),new Te(function(){var He=h.default(w.default.mark(function Le(J,ee,q){var z,Z;return w.default.wrap(function(oe){for(;;)switch(oe.prev=oe.next){case 0:return z=qe.transport.post(De.href,ze,K),q(()=>z.cancel()),Ce.trace("sending POST request to ".concat(F," with headers ").concat(ze)),oe.prev=3,oe.next=6,z;case 6:Z=oe.sent,oe.next=17;break;case 9:if(oe.prev=9,oe.t0=oe.catch(3),!(t.XMLHttpRequest===void 0&&K instanceof FormData)){oe.next=14;break}return ee(new TypeError("Posting FormData supported only with browser engine's FormData")),oe.abrupt("return");case 14:return Ce.debug("post() error ".concat(oe.t0)),ee(oe.t0),oe.abrupt("return");case 17:Ce.trace("response",Z),J(Z);case 19:case"end":return oe.stop()}},Le,null,[[3,9]])}));return function(Le,J,ee){return He.apply(this,arguments)}}())}}var Fe="0.6.1",Ue,Ae=T.scope("");e.default=(Ue=class{constructor(F,H,K){var ye,Ne,qe=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.options=qe,this.options.logLevel=(ye=this.options.logLevel)!==null&&ye!==void 0?ye:"silent",this.config=new R(F,H,K,this.options),Ae.setLevel(this.options.logLevel),this.options.transport=(Ne=this.options.transport)!==null&&Ne!==void 0?Ne:new be,this.transport=this.options.transport,this.network=new Q(this.config,this.transport)}updateToken(F){Ae.info("updateToken"),this.config.updateToken(F)}get(F){var H=this;return new Te(function(){var K=h.default(w.default.mark(function ye(Ne,qe,ze){var De,He;return w.default.wrap(function(J){for(;;)switch(J.prev=J.next){case 0:return De=H.network.get("".concat(H.config.mediaUrl,"/").concat(F)),ze(()=>De.cancel()),J.prev=2,J.next=5,De;case 5:He=J.sent,Ne(new V(H.config,H.network,He.body)),J.next=12;break;case 9:J.prev=9,J.t0=J.catch(2),qe(J.t0);case 12:case"end":return J.stop()}},ye,null,[[2,9]])}));return function(ye,Ne,qe){return K.apply(this,arguments)}}())}post(F,H,K,ye){var Ne=this;return new Te(function(){var qe=h.default(w.default.mark(function ze(De,He,Le){var J,ee;return w.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return J=Ne.network.post(Ne.config.mediaUrl,K!=null?K:"media",H,F,ye),Le(()=>J.cancel()),z.prev=2,z.next=5,J;case 5:ee=z.sent,De(new V(Ne.config,Ne.network,ee.body)),z.next=12;break;case 9:z.prev=9,z.t0=z.catch(2),He(z.t0);case 12:case"end":return z.stop()}},ze,null,[[2,9]])}));return function(ze,De,He){return qe.apply(this,arguments)}}())}postFormData(F,H){var K=this;return new Te(function(){var ye=h.default(w.default.mark(function Ne(qe,ze,De){var He,Le;return w.default.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return He=K.network.post(K.config.mediaUrl,H!=null?H:"media",F),De(()=>He.cancel()),ee.prev=2,ee.next=5,He;case 5:Le=ee.sent,qe(new V(K.config,K.network,Le.body)),ee.next=12;break;case 9:ee.prev=9,ee.t0=ee.catch(2),ze(ee.t0);case 12:case"end":return ee.stop()}},Ne,null,[[2,9]])}));return function(Ne,qe,ze){return ye.apply(this,arguments)}}())}mediaSetGet(F){var H=this;return new Te(function(){var K=h.default(w.default.mark(function ye(Ne,qe,ze){var De,He,Le,J;return w.default.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return De={command:"get",list:F.map(z=>({media_sid:z}))},He=H.network.post("".concat(H.config.mediaSetUrl),null,De,"application/json"),ze(()=>He.cancel()),q.prev=3,q.next=6,He;case 6:Le=q.sent,J=Le.body.map(z=>{if(z.code!==200){qe("Failed to obtain detailed information about Media items (failed SID ".concat(z.media_record.sid,")"));return}return new V(H.config,H.network,z.media_record)}),Ne(J),q.next=14;break;case 11:q.prev=11,q.t0=q.catch(3),qe(q.t0);case 14:case"end":return q.stop()}},ye,null,[[3,11]])}));return function(ye,Ne,qe){return K.apply(this,arguments)}}())}mediaSetGetContentUrls(F){var H=this;return new Te(function(){var K=h.default(w.default.mark(function ye(Ne,qe,ze){var De,He,Le,J;return w.default.wrap(function(q){for(;;)switch(q.prev=q.next){case 0:return De={command:"get",list:F.map(z=>({media_sid:z}))},He=H.network.post("".concat(H.config.mediaSetUrl),null,De,"application/json"),ze(()=>He.cancel()),q.prev=3,q.next=6,He;case 6:Le=q.sent,J=new Map,Le.body.forEach(z=>{if(z.code!==200){qe("Failed to obtain detailed information about Media items (failed SID ".concat(z.media_record.sid,")"));return}J.set(z.media_record.sid,z.media_record.links.content_direct_temporary)}),Ne(J),q.next=15;break;case 12:q.prev=12,q.t0=q.catch(3),qe(q.t0);case 15:case"end":return q.stop()}},ye,null,[[3,12]])}));return function(ye,Ne,qe){return K.apply(this,arguments)}}())}},c.default(Ue,"version",Fe),Ue),Xe([u.validateTypes(u.nonEmptyString),Je("design:type",Function),Je("design:paramtypes",[String]),Je("design:returntype",void 0)],e.default.prototype,"updateToken",null),Xe([u.validateTypesAsync(u.nonEmptyString),Je("design:type",Function),Je("design:paramtypes",[String]),Je("design:returntype",Te)],e.default.prototype,"get",null),e.default=Xe([u.validateConstructorTypes(u.nonEmptyString,u.nonEmptyString,[u.nonEmptyString,u.literal(null)],[u.pureObject,"undefined"]),Je("design:paramtypes",[String,String,Object,Object])],e.default),e.CancellablePromise=Te,e.Client=e.default,e.McsClient=e.default,e.McsMedia=V,e.Media=V})(hI);var DI=Pt,$X=cr,TX=ea,kX=DI.aTypedArray,EX=DI.exportTypedArrayMethod;EX("at",function(t){var r=kX(this),n=$X(r),a=TX(t),i=a>=0?a:n+a;return i<0||i>=n?void 0:r[i]});var IX=st,CX=lt,RX=eE,AX=mf,Cg="ArrayBuffer",w0=RX[Cg],OX=CX[Cg];IX({global:!0,constructor:!0,forced:OX!==w0},{ArrayBuffer:w0});AX(Cg);var PX=st,BI=et,MX=xn,xX=_r,_0=cr,NX=ig,S0=or,Rg=nt,LX=dg,jX=ol,$0=LE,UX=jE,T0=as,k0=UE,Qa=[],E0=BI(Qa.sort),FX=BI(Qa.push),DX=Rg(function(){Qa.sort(void 0)}),BX=Rg(function(){Qa.sort(null)}),qX=jX("sort"),qI=!Rg(function(){if(T0)return T0<70;if(!($0&&$0>3)){if(UX)return!0;if(k0)return k0<603;var e="",t,r,n,a;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(a=0;a<47;a++)Qa.push({k:r+a,v:n})}for(Qa.sort(function(i,s){return s.v-i.v}),a=0;a<Qa.length;a++)r=Qa[a].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),HX=DX||!BX||!qX||!qI,WX=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:S0(t)>S0(r)?1:-1}};PX({target:"Array",proto:!0,forced:HX},{sort:function(t){t!==void 0&&MX(t);var r=xX(this);if(qI)return t===void 0?E0(r):E0(r,t);var n=[],a=_0(r),i,s;for(s=0;s<a;s++)s in r&&FX(n,r[s]);for(LX(n,WX(t)),i=_0(n),s=0;s<i;)r[s]=n[s++];for(;s<a;)NX(r,s++);return r}});var GX=st,zX=et,VX=yI,KX=Zn,I0=or,YX=gI,JX=zX("".indexOf);GX({target:"String",proto:!0,forced:!YX("includes")},{includes:function(t){return!!~JX(I0(KX(this)),I0(VX(t)),arguments.length>1?arguments[1]:void 0)}});var Jf={};/*
@license
Copyright (c) 2022 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(Jf,"__esModule",{value:!0});var QX=cs.exports;function XX(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var rc=XX(QX),ZX=function(t,r,n){return function(a,i,s){if(typeof s.value!="function"&&(s==null?void 0:s.get)===void 0)throw new Error("The deprecated decorator can only be applied to methods or getters");if(typeof s.value=="function"){var u=s.value;s.value=function(){yh("The method ".concat(t," is deprecated").concat(r?", use "+r+" instead":"").concat(n?", "+n:"."));for(var l=arguments.length,c=new Array(l),h=0;h<l;h++)c[h]=arguments[h];return u.apply(this,c)};return}var o=s.get;s.get=function(){return yh("The getter ".concat(t," is deprecated").concat(r?", use "+r+" instead":"").concat(n?", "+n:".")),o==null?void 0:o.apply(this)}}},yh=function(t){var r=rc.default.getLevel();rc.default.setLevel("warn"),rc.default.warn(t),rc.default.setLevel(r)};Jf.deprecated=ZX;Jf.deprecationWarning=yh;var eZ=st,tZ=Qr.find,rZ=Ey,gh="find",HI=!0;gh in[]&&Array(1)[gh](function(){HI=!1});eZ({target:"Array",proto:!0,forced:HI},{find:function(t){return tZ(this,t,arguments.length>1?arguments[1]:void 0)}});rZ(gh);/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2019, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes q under the following license.

    Copyright 2009–2014 Kristopher Michael Kowal. All rights reserved.
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.

This software includes platform.js under the following license.

    Copyright 2014 Benjamin Tan <https://d10.github.io/>
    Copyright 2011-2015 John-David Dalton <http://allyoucanleet.com/>

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=So.exports,r=hi.exports,n=Nn.exports,a=Ln.exports,i=Xr.exports,s=yi.exports,u=ta.exports,o=Un.exports,l=ul,c=jn.exports,h=cs.exports,w=v4,b=$r,$=Uy,C=Hv.exports,I=gi.exports,j=Ma,D=xf,ve=KE,se=Br,Pe=hI,Me=mi.exports,le=Jf,x=Lf;function re(A){return A&&typeof A=="object"&&"default"in A?A:{default:A}}function de(A){if(A&&A.__esModule)return A;var P=Object.create(null);return A&&Object.keys(A).forEach(function(S){if(S!=="default"){var _=Object.getOwnPropertyDescriptor(A,S);Object.defineProperty(P,S,_.get?_:{enumerable:!0,get:function(){return A[S]}})}}),P.default=A,Object.freeze(P)}var X=re(t),xe=re(r),ce=re(n),te=re(a),ue=re(i),ie=re(s),Ie=re(u),$e=re(o),N=re(l),ct=re(c),ft=de(h),Te=re(C),Xe=re(I),Je=re(Me);function B(A,P,S,_){var v=arguments.length,g=v<3?P:_===null?_=Object.getOwnPropertyDescriptor(P,S):_,d;if((typeof Reflect>"u"?"undefined":ct.default(Reflect))==="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(A,P,S,_);else for(var p=A.length-1;p>=0;p--)(d=A[p])&&(g=(v<3?d(g):v>3?d(P,S,g):d(P,S))||g);return v>3&&g&&Object.defineProperty(P,S,g),g}function T(A,P){if((typeof Reflect>"u"?"undefined":ct.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(A,P)}function Se(A,P){return["".concat(new Date().toISOString()," Conversations ").concat(A,":")].concat(Array.from(P))}var pe=ft.getLogger("twilio-conversations"),Ke=function(){function A(P){$e.default(this,A),ie.default(this,"prefix",""),this.prefix=P!=null&&P.length>0?P+" ":""}return Ie.default(A,[{key:"setLevel",value:function(S){pe.setLevel(S)}},{key:"trace",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];pe.trace.apply(null,Se(this.prefix+"T",_))}},{key:"debug",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];pe.debug.apply(null,Se(this.prefix+"D",_))}},{key:"info",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];pe.info.apply(null,Se(this.prefix+"I",_))}},{key:"warn",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];pe.warn.apply(null,Se(this.prefix+"W",_))}},{key:"error",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];pe.error.apply(null,Se(this.prefix+"E",_))}}],[{key:"scope",value:function(S){return new A(S)}},{key:"setLevel",value:function(S){pe.setLevel(S)}},{key:"trace",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];pe.trace.apply(null,Se("T",_))}},{key:"debug",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];pe.debug.apply(null,Se("D",_))}},{key:"info",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];pe.info.apply(null,Se("I",_))}},{key:"warn",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];pe.warn.apply(null,Se("W",_))}},{key:"error",value:function(){for(var S=arguments.length,_=new Array(S),v=0;v<S;v++)_[v]=arguments[v];pe.error.apply(null,Se("E",_))}}]),A}();function Qe(A,P){var S=Object.keys(A);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(A);P&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(A,v).enumerable})),S.push.apply(S,_)}return S}function we(A){for(var P=1;P<arguments.length;P++){var S=arguments[P]!=null?arguments[P]:{};P%2?Qe(Object(S),!0).forEach(function(_){ie.default(A,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(S)):Qe(Object(S)).forEach(function(_){Object.defineProperty(A,_,Object.getOwnPropertyDescriptor(S,_))})}return A}var Ge=5,O="PT5S",R="PT5S",V=100,fe=1e3,W=4e3,Re=3,me=!0,be=Ie.default(function A(){var P,S,_,v,g,d,p=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},f=arguments.length>1?arguments[1]:void 0,m=arguments.length>2?arguments[2]:void 0;$e.default(this,A),ie.default(this,"typingIndicatorTimeoutDefault",Ge*1e3);var y=p.Chat||p.IPMessaging||p||{};this.productId=y.productId,this.links={myConversations:f.links.my_conversations,conversations:f.links.conversations,users:f.links.users,currentUser:f.links.current_user,typing:f.links.typing,mediaService:f.links.media_service,mediaSetService:f.links.media_set_service,messagesReceipts:f.links.messages_receipts},this.limits={mediaAttachmentsCountLimit:f.options.media_attachments_count_limit,mediaAttachmentSizeLimitInMb:f.options.media_attachment_size_limit_in_mb,mediaAttachmentsTotalSizeLimitInMb:f.options.media_attachments_total_size_limit_in_mb,emailHistoriesAllowedContentTypes:f.options.email_histories_allowed_mime_types,emailBodiesAllowedContentTypes:f.options.email_bodies_allowed_mime_types},this.typingIndicatorTimeoutOverride=y.typingIndicatorTimeoutOverride,this.backoffConfiguration=we({min:fe,max:W,maxAttemptsCount:Re},y.backoffConfigOverride),this.retryWhenThrottled=y.retryWhenThrottledOverride!==void 0?y.retryWhenThrottledOverride:me,this.userInfosToSubscribe=(P=(S=y.userInfosToSubscribeOverride)!==null&&S!==void 0?S:f.options.user_infos_to_subscribe)!==null&&P!==void 0?P:V,this.reachabilityEnabled=f.options.reachability_enabled,this.userIdentity=f.identity,this.userInfo=f.sync_objects.my_user_info,this.myConversations=f.sync_objects.my_conversations;var k=(_=(v=y.httpCacheIntervalOverride)!==null&&v!==void 0?v:f.options.http_cache_interval)!==null&&_!==void 0?_:O;try{this.httpCacheInterval=w.toSeconds(w.parse(k))}catch{m.error("Failed to parse http cache interval ".concat(k,", using default value ").concat(O)),this.httpCacheInterval=w.toSeconds(w.parse(O))}var E=(g=(d=y.consumptionReportIntervalOverride)!==null&&d!==void 0?d:f.options.consumption_report_interval)!==null&&g!==void 0?g:R;try{this.consumptionReportInterval=w.toSeconds(w.parse(E))}catch{m.error("Failed to parse consumption report interval ".concat(E,", using default value ").concat(R)),this.consumptionReportInterval=w.toSeconds(w.parse(R))}});function Ce(A){return JSON.parse(JSON.stringify(A))}function Q(A){return typeof A<"u"&&!isNaN(Number(A))?Number(A):null}function Fe(A){try{return new Date(A)}catch{return null}}function Ue(A,P,S){var _={};if(A)try{_=JSON.parse(A)}catch(v){S.warn(P,v)}return _}var Ae=function(){function A(P){$e.default(this,A),this.base=P.replace(/\/$/,""),this.args=[],this.paths=[]}return Ie.default(A,[{key:"arg",value:function(S,_){return typeof _<"u"&&this.args.push(encodeURIComponent(S)+"="+encodeURIComponent(_)),this}},{key:"path",value:function(S){return this.paths.push(encodeURIComponent(S)),this}},{key:"build",value:function(){var S=this.base;return this.paths.length&&(S+="/"+this.paths.join("/")),this.args.length&&(S+="?"+this.args.join("&")),S}}]),A}(),ae=b.custom(function(A){return[["string","number","boolean","object"].includes(ct.default(A)),"a JSON type"]}),F=b.custom(function(A){return[["undefined","string","number","boolean","object"].includes(ct.default(A)),"an optional JSON type"]});function H(A){var P=K();return function(){var _=ue.default(A),v;if(P){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return te.default(this,v)}}function K(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ye=Ke.scope("User"),Ne=function(A){ce.default(S,A);var P=H(S);function S(_,v,g,d){var p;return $e.default(this,S),p=P.call(this),ie.default(xe.default(p),"promiseToFetch",null),ie.default(xe.default(p),"updated","updated"),ie.default(xe.default(p),"userSubscribed","userSubscribed"),ie.default(xe.default(p),"userUnsubscribed","userUnsubscribed"),p.services=d,p.subscribed="initializing",p.setMaxListeners(0),p.state={identity:_,entityName:v,friendlyName:null,attributes:{},online:null,notifiable:null},p._initializationPromise=new Promise(function(f){p._resolveInitializationPromise=f}),g!==null&&p._resolveInitialization(g,_,v,!1),p}return Ie.default(S,[{key:"identity",get:function(){return this.state.identity},set:function(v){this.state.identity=v}},{key:"entityName",set:function(v){this.state.entityName=v}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"isOnline",get:function(){return this.state.online}},{key:"isNotifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return this.subscribed=="subscribed"}},{key:"_update",value:function(){var _=X.default(N.default.mark(function g(d,p){var f,m;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,this._initializationPromise;case 2:f=[],ye.debug("User for",this.state.identity,"updated:",d,p),k.t0=d,k.next=k.t0==="friendlyName"?7:k.t0==="attributes"?9:k.t0==="reachability"?12:15;break;case 7:return this.state.friendlyName!==p.value&&(f.push("friendlyName"),this.state.friendlyName=p.value),k.abrupt("break",16);case 9:return m=Ue(p.value,"Retrieved malformed attributes from the server for user: ".concat(this.state.identity),ye),Te.default(this.state.attributes,m)||(this.state.attributes=m,f.push("attributes")),k.abrupt("break",16);case 12:return this.state.online!==p.online&&(this.state.online=p.online,f.push("reachabilityOnline")),this.state.notifiable!==p.notifiable&&(this.state.notifiable=p.notifiable,f.push("reachabilityNotifiable")),k.abrupt("break",16);case 15:return k.abrupt("return");case 16:f.length>0&&this.emit("updated",{user:this,updateReasons:f});case 17:case"end":return k.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_updateReachabilityInfo",value:function(){var _=X.default(N.default.mark(function g(d,p){var f=this;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._initializationPromise;case 2:if(this.configuration.reachabilityEnabled){y.next=4;break}return y.abrupt("return",Promise.resolve());case 4:return y.abrupt("return",d.get("reachability").then(p).catch(function(k){ye.warn("Failed to get reachability info for ",f.state.identity,k)}));case 5:case"end":return y.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_fetch",value:function(){var _=X.default(N.default.mark(function g(){var d=this;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._initializationPromise;case 2:if(this.state.entityName){f.next=4;break}return f.abrupt("return",this);case 4:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then(function(m){return d.entity=m,m.on("itemUpdated",function(y){return ye.debug(d.state.entityName+" ("+d.state.identity+") itemUpdated: "+y.item.key),d._update(y.item.key,y.item.data)}),Promise.all([m.get("friendlyName").then(function(y){return d._update(y.key,y.data)}),m.get("attributes").then(function(y){return d._update(y.key,y.data)}),d._updateReachabilityInfo(m,function(y){return d._update(y.key,y.data)})])}).then(function(){return ye.debug("Fetched for",d.identity),d.subscribed="subscribed",d.emit("userSubscribed",d),d}).catch(function(m){throw d.promiseToFetch=null,m}),f.abrupt("return",this.promiseToFetch);case 6:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_ensureFetched",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._initializationPromise;case 2:return p.abrupt("return",this.promiseToFetch||this._fetch());case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateAttributes",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){f.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return f.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(d)});case 6:return f.abrupt("return",this);case 7:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateFriendlyName",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){f.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return f.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:d});case 6:return f.abrupt("return",this);case 7:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"unsubscribe",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._initializationPromise;case 2:if(!this.promiseToFetch){p.next=9;break}return p.next=5,this.promiseToFetch;case 5:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 9:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_resolveInitialization",value:function(v,g,d,p){this.configuration=v,this.identity=g,this.entityName=d,this.links={self:"".concat(this.configuration.links.users,"/").concat(encodeURIComponent(this.identity))},this._resolveInitializationPromise(),p&&this.emit("updated",{user:this,updateReasons:["friendlyName","attributes","reachabilityOnline","reachabilityNotifiable"]})}}]),S}($.ReplayEventEmitter);B([b.validateTypesAsync(ae),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],Ne.prototype,"updateAttributes",null),B([b.validateTypesAsync(["string"]),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],Ne.prototype,"updateFriendlyName",null);function qe(A,P){var S=typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(!S){if(Array.isArray(A)||(S=ze(A))||P&&A&&typeof A.length=="number"){S&&(A=S);var _=0,v=function(){};return{s:v,n:function(){return _>=A.length?{done:!0}:{done:!1,value:A[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(A)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function ze(A,P){if(!!A){if(typeof A=="string")return De(A,P);var S=Object.prototype.toString.call(A).slice(8,-1);if(S==="Object"&&A.constructor&&(S=A.constructor.name),S==="Map"||S==="Set")return Array.from(A);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return De(A,P)}}function De(A,P){(P==null||P>A.length)&&(P=A.length);for(var S=0,_=new Array(P);S<P;S++)_[S]=A[S];return _}var He=function(){function A(P,S){$e.default(this,A),this.configuration=P,this.services=S,this.cache=new Map,this.cacheLifetime=this.configuration.httpCacheInterval*100,this.cleanupCache()}return Ie.default(A,[{key:"isExpired",value:function(S){return!this.cacheLifetime||Date.now()-S>this.cacheLifetime}},{key:"cleanupCache",value:function(){var S=qe(this.cache),_;try{for(S.s();!(_=S.n()).done;){var v=Xe.default(_.value,2),g=v[0],d=v[1];this.isExpired(d.timestamp)&&this.cache.delete(g)}}catch(p){S.e(p)}finally{S.f()}this.cache.size===0&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var S=this;this.timer=this.timer||setInterval(function(){return S.cleanupCache()},this.cacheLifetime*2)}},{key:"executeWithRetry",value:function(S){var _=this,v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise(function(g,d){var p=[502,503,504];v&&p.push(429);var f=new j.Retrier(_.configuration.backoffConfiguration);f.on("attempt",function(){S().then(function(m){return f.succeeded(m)}).catch(function(m){p.indexOf(m.status)>-1||m.message==="Twilsock disconnected"?f.failed(m):(f.removeAllListeners(),f.cancel(),d(m))})}),f.on("succeeded",function(m){g(m)}),f.on("cancelled",function(m){return d(m)}),f.on("failed",function(m){return d(m)}),f.start()})}},{key:"get",value:function(){var P=X.default(N.default.mark(function _(v){var g=this,d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(d=this.cache.get(v),!(d&&!this.isExpired(d.timestamp))){y.next=3;break}return y.abrupt("return",d.response);case 3:return p={},y.next=6,this.executeWithRetry(function(){return g.services.transport.get(v,p,g.configuration.productId)},this.configuration.retryWhenThrottled);case 6:return f=y.sent,this.cache.set(v,{response:f,timestamp:Date.now()}),this.pokeTimer(),y.abrupt("return",f);case 10:case"end":return y.stop()}},_,this)}));function S(_){return P.apply(this,arguments)}return S}()}]),A}(),Le=Ie.default(function A(){$e.default(this,A)});ie.default(Le,"TYPING_INDICATOR","twilio.ipmsg.typing_indicator"),ie.default(Le,"NEW_MESSAGE","twilio.conversations.new_message"),ie.default(Le,"ADDED_TO_CONVERSATION","twilio.conversations.added_to_conversation"),ie.default(Le,"REMOVED_FROM_CONVERSATION","twilio.conversations.removed_from_conversation"),ie.default(Le,"CONSUMPTION_UPDATE","twilio.channel.consumption_update");function J(A){var P=ee();return function(){var _=ue.default(A),v;if(P){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return te.default(this,v)}}function ee(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var q=Ke.scope("Participant"),z=function(A){ce.default(S,A);var P=J(S);function S(_,v,g,d,p){var f,m,y;if($e.default(this,S),y=P.call(this),y.conversation=g,y.links=d,y.services=p,y.state={attributes:Ue(_.attributes,"Retrieved malformed attributes from the server for participant: "+v,q),dateCreated:_.dateCreated?Fe(_.dateCreated):null,dateUpdated:_.dateCreated?Fe(_.dateUpdated):null,sid:v,typingTimeout:null,isTyping:!1,identity:_.identity,roleSid:(f=_.roleSid)!==null&&f!==void 0?f:"",lastReadMessageIndex:Number.isInteger(_.lastConsumedMessageIndex)?_.lastConsumedMessageIndex:null,lastReadTimestamp:_.lastConsumptionTimestamp?Fe(_.lastConsumptionTimestamp):null,type:_.type||"chat",userInfo:_.userInfo,bindings:(m=_.bindings)!==null&&m!==void 0?m:{}},!_.identity&&!_.type)throw new Error("Received invalid Participant object from server: Missing identity or type of Participant.");return y}return Ie.default(S,[{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastReadMessageIndex",get:function(){return this.state.lastReadMessageIndex}},{key:"lastReadTimestamp",get:function(){return this.state.lastReadTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}},{key:"bindings",get:function(){var v;return(v=this.state.bindings)!==null&&v!==void 0?v:{}}},{key:"_startTyping",value:function(v){var g=this;return this.state.typingTimeout&&clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.conversation.emit("typingStarted",this),this.state.typingTimeout=Number(setTimeout(function(){return g._endTyping()},v)),this}},{key:"_endTyping",value:function(){!this.state.typingTimeout||(this.state.isTyping=!1,this.emit("typingEnded",this),this.conversation.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(v){var g=[],d=Ue(v.attributes,"Retrieved malformed attributes from the server for participant: "+this.state.sid,q);v.attributes&&!Te.default(this.state.attributes,d)&&(this.state.attributes=d,g.push("attributes"));var p=Fe(v.dateUpdated);v.dateUpdated&&(p==null?void 0:p.getTime())!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=p,g.push("dateUpdated"));var f=Fe(v.dateCreated);if(v.dateCreated&&(f==null?void 0:f.getTime())!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=f,g.push("dateCreated")),v.roleSid&&this.state.roleSid!==v.roleSid&&(this.state.roleSid=v.roleSid,g.push("roleSid")),(Number.isInteger(v.lastConsumedMessageIndex)||v.lastConsumedMessageIndex===null)&&this.state.lastReadMessageIndex!==v.lastConsumedMessageIndex&&(this.state.lastReadMessageIndex=v.lastConsumedMessageIndex,g.push("lastReadMessageIndex")),v.lastConsumptionTimestamp){var m=new Date(v.lastConsumptionTimestamp);(!this.state.lastReadTimestamp||this.state.lastReadTimestamp.getTime()!==m.getTime())&&(this.state.lastReadTimestamp=m,g.push("lastReadTimestamp"))}return v.bindings&&!Te.default(this.state.bindings,v.bindings)&&(this.state.bindings=v.bindings,g.push("bindings")),g.length>0&&this.emit("updated",{participant:this,updateReasons:g}),this}},{key:"getUser",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.type=="chat"){p.next=2;break}throw new Error("Getting User is not supported for this Participant type: "+this.type);case 2:return p.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"remove",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.abrupt("return",this.conversation.removeParticipant(this));case 1:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateAttributes",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(d)});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter);ie.default(z,"typingStarted","typingStarted"),ie.default(z,"typingEnded","typingEnded"),ie.default(z,"updated","updated"),B([b.validateTypesAsync(ae),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],z.prototype,"updateAttributes",null);function Z(A){var P=ge();return function(){var _=ue.default(A),v;if(P){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return te.default(this,v)}}function ge(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var oe=Ke.scope("Participants"),je=function(A){ce.default(S,A);var P=Z(S);function S(_,v,g,d,p){var f;return $e.default(this,S),f=P.call(this),ie.default(xe.default(f),"rosterEntityPromise",null),f.conversation=_,f.participants=v,f.links=g,f.configuration=d,f.services=p,f}return Ie.default(S,[{key:"unsubscribe",value:function(){var _=X.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!this.rosterEntityPromise){f.next=6;break}return f.next=3,this.rosterEntityPromise;case 3:d=f.sent,d.close(),this.rosterEntityPromise=null;case 6:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"subscribe",value:function(v){var g=this,d=typeof v=="string"?this.services.syncClient.map({id:v,mode:"open_existing"}):Promise.resolve(v);return this.rosterEntityPromise=this.rosterEntityPromise||d.then(function(p){p.on("itemAdded",function(y){oe.debug(g.conversation.sid+" itemAdded: "+y.item.key),g.upsertParticipant(y.item.key,y.item.data).then(function(k){g.emit("participantJoined",k)})}),p.on("itemRemoved",function(y){oe.debug(g.conversation.sid+" itemRemoved: "+y.key);var k=y.key;if(!!g.participants.has(k)){var E=g.participants.get(k);g.participants.delete(k),E&&g.emit("participantLeft",E)}}),p.on("itemUpdated",function(y){oe.debug(g.conversation.sid+" itemUpdated: "+y.item.key),g.upsertParticipant(y.item.key,y.item.data)});var f=[],m=function y(k){return k.items.forEach(function(E){f.push(g.upsertParticipant(E.key,E.data))}),k.hasNextPage?k.nextPage().then(y):null};return p.getItems().then(m).then(function(){return Promise.all(f)}).then(function(){return p})}).catch(function(p){throw g.rosterEntityPromise=null,g.services.syncClient.connectionState!="disconnected"&&oe.error("Failed to get roster object for conversation",g.conversation.sid,p),oe.debug("ERROR: Failed to get roster object for conversation",g.conversation.sid,p),p})}},{key:"upsertParticipantFromResponse",value:function(){var _=X.default(N.default.mark(function g(d){var p,f,m,y,k,E,L,U;return N.default.wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:return f=d.sid,m=d.attributes,y=d.date_created,k=d.date_updated,E=d.identity,L=d.role_sid,U=d.messaging_binding,Ye.next=3,this.upsertParticipant(f,{attributes:m,dateCreated:new Date(y),dateUpdated:new Date(k),identity:E,roleSid:L,lastConsumedMessageIndex:null,lastConsumptionTimestamp:null,type:(p=U==null?void 0:U.type)!==null&&p!==void 0?p:"chat"});case 3:return Ye.abrupt("return",Ye.sent);case 4:case"end":return Ye.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"upsertParticipant",value:function(){var _=X.default(N.default.mark(function g(d,p){var f=this,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:if(m=this.participants.get(d),!m){E.next=3;break}return E.abrupt("return",m._update(p));case 3:return y={self:"".concat(this.links.participants,"/").concat(d)},m=new z(p,d,this.conversation,y,this.services),this.participants.set(d,m),m.on("updated",function(L){return f.emit("participantUpdated",L)}),E.abrupt("return",m);case 8:case"end":return E.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"getParticipants",value:function(){var _=X.default(N.default.mark(function g(){var d=this;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var m=[];return d.participants.forEach(function(y){return m.push(y)}),m}):[]);case 1:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getParticipantBySid",value:function(){var _=X.default(N.default.mark(function g(d){var p=this;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var y=p.participants.get(d);if(!y)throw new Error("Participant with SID "+d+" was not found");return y}):null);case 1:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getParticipantByIdentity",value:function(){var _=X.default(N.default.mark(function g(d){var p=this,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return f=null,y.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){if(p.participants.forEach(function(k){k.identity===d&&(f=k)}),!f)throw new Error("Participant with identity "+d+" was not found");return f}):null);case 2:case"end":return y.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"add",value:function(){var _=X.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:d,attributes:typeof p<"u"?JSON.stringify(p):void 0});case 2:return m.abrupt("return",m.sent);case 3:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"addNonChatParticipant",value:function(){var _=X.default(N.default.mark(function g(d,p){var f,m,y,k,E=arguments;return N.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return y=E.length>2&&E[2]!==void 0?E[2]:{},k=E.length>3&&E[3]!==void 0?E[3]:{},U.next=4,this.services.commandExecutor.mutateResource("post",this.links.participants,{attributes:typeof y<"u"?JSON.stringify(y):void 0,messaging_binding:{address:p,proxy_address:d,name:k==null||(f=k.email)===null||f===void 0?void 0:f.name,level:k==null||(m=k.email)===null||m===void 0?void 0:m.level}});case 4:return U.abrupt("return",U.sent);case 5:case"end":return U.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"remove",value:function(v){return this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(v))}}]),S}($.ReplayEventEmitter),Ve=function(){function A(P,S){$e.default(this,A),ie.default(this,"mcsMedia",null),this.services=S,P instanceof Pe.McsMedia&&(this.mcsMedia=P),this.state={sid:P.sid,category:P.category,filename:P.filename,contentType:P.contentType,size:P.size}}return Ie.default(A,[{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"category",get:function(){return this.state.category}},{key:"getContentTemporaryUrl",value:function(){var S=this;return new Pe.CancellablePromise(function(){var _=X.default(N.default.mark(function v(g,d,p){var f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(m=S._fetchMcsMedia(),y=(f=S.mcsMedia)===null||f===void 0?void 0:f.getContentUrl(),p(function(){m.cancel(),y&&y.cancel()}),L.prev=3,S.mcsMedia){L.next=9;break}return L.next=7,m;case 7:k=L.sent,y=k.getContentUrl();case 9:if(L.t0=g,!y){L.next=16;break}return L.next=13,y;case 13:L.t1=L.sent,L.next=17;break;case 16:L.t1=null;case 17:L.t2=L.t1,(0,L.t0)(L.t2),L.next=24;break;case 21:L.prev=21,L.t3=L.catch(3),d(L.t3);case 24:case"end":return L.stop()}},v,null,[[3,21]])}));return function(v,g,d){return _.apply(this,arguments)}}())}},{key:"_fetchMcsMedia",value:function(){var S=this;return new Pe.CancellablePromise(function(){var _=X.default(N.default.mark(function v(g,d,p){var f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(f=S.services.mcsClient.get(S.state.sid),!S.services.mcsClient){y.next=14;break}return p(function(){return f.cancel()}),y.prev=3,y.next=6,f;case 6:S.mcsMedia=y.sent,g(S.mcsMedia),y.next=13;break;case 10:y.prev=10,y.t0=y.catch(3),d(y.t0);case 13:return y.abrupt("return");case 14:d(new Error("Media Content Service is unavailable"));case 15:case"end":return y.stop()}},v,null,[[3,10]])}));return function(v,g,d){return _.apply(this,arguments)}}())}}]),A}(),at=function(){function A(P){$e.default(this,A),this.state=P}return Ie.default(A,[{key:"total",get:function(){return this.state.total}},{key:"sent",get:function(){return this.state.sent}},{key:"delivered",get:function(){return this.state.delivered}},{key:"read",get:function(){return this.state.read}},{key:"undelivered",get:function(){return this.state.undelivered}},{key:"failed",get:function(){return this.state.failed}},{key:"_update",value:function(S){this.state=S}},{key:"_isEquals",value:function(S){var _=this.total===S.total,v=this.sent===S.sent,g=this.delivered===S.delivered,d=this.read===S.read,p=this.undelivered===S.undelivered,f=this.failed===S.failed;return _&&v&&g&&d&&p&&f}}]),A}(),tt=function(){function A(P,S,_,v){$e.default(this,A),this.state={prevToken:_,nextToken:v,source:S,items:P}}return Ie.default(A,[{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}},{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):Promise.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):Promise.reject(new Error("No previous page"))}}]),A}(),We=Ie.default(function A(P){$e.default(this,A),this.sid=P.sid,this.messageSid=P.message_sid,this.conversationSid=P.conversation_sid,this.channelMessageSid=P.channel_message_sid,this.participantSid=P.participant_sid,this.status=P.status||"queued",this.errorCode=P.error_code||0,this.dateCreated=P.date_created,this.dateUpdated=P.date_updated});function fr(A,P){var S=Object.keys(A);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(A);P&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(A,v).enumerable})),S.push.apply(S,_)}return S}function rt(A){for(var P=1;P<arguments.length;P++){var S=arguments[P]!=null?arguments[P]:{};P%2?fr(Object(S),!0).forEach(function(_){ie.default(A,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(S)):fr(Object(S)).forEach(function(_){Object.defineProperty(A,_,Object.getOwnPropertyDescriptor(S,_))})}return A}function Ir(A){var P=Nt();return function(){var _=ue.default(A),v;if(P){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return te.default(this,v)}}function Nt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mn=Ke.scope("Message"),Zt=function(A){ce.default(S,A);var P=Ir(S);function S(_,v,g,d,p,f){var m,y,k,E,L;return $e.default(this,S),L=P.call(this),L.conversation=g,L.links=d,L.configuration=p,L.services=f,L.state={sid:v.sid,index:_,author:v.author,subject:v.subject,body:(m=v.text)!==null&&m!==void 0?m:null,timestamp:v.timestamp?new Date(v.timestamp):null,dateUpdated:v.dateUpdated?new Date(v.dateUpdated):null,lastUpdatedBy:(y=v.lastUpdatedBy)!==null&&y!==void 0?y:null,attributes:Ue(v.attributes,"Got malformed attributes for the message ".concat(v.sid),mn),type:(k=v.type)!==null&&k!==void 0?k:"text",media:v.type==="media"&&v.media?new Ve(v.media,L.services):null,medias:v.type==="media"&&v.medias?v.medias.map(function(U){return new Ve(U,L.services)}):v.type==="media"&&v.media&&!v.medias?[new Ve(rt(rt({},v.media),{},{category:"media"}),L.services)]:null,participantSid:(E=v.memberSid)!==null&&E!==void 0?E:null,aggregatedDeliveryReceipt:v.delivery?new at(v.delivery):null},L}return Ie.default(S,[{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"subject",get:function(){return this.state.subject}},{key:"body",get:function(){return this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"dateCreated",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"attachedMedia",get:function(){return this.getMediaByCategories(["media"])}},{key:"participantSid",get:function(){return this.state.participantSid}},{key:"aggregatedDeliveryReceipt",get:function(){return this.state.aggregatedDeliveryReceipt}},{key:"getMediaByCategory",value:function(v){return this.getMediaByCategories(v)}},{key:"getMediaByCategories",value:function(v){var g;return((g=this.state.medias)!==null&&g!==void 0?g:[]).filter(function(d){return v.includes(d.category)})}},{key:"getEmailBody",value:function(){var v,g,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(v=(g=this.getMediaByCategories(["body"]))===null||g===void 0?void 0:g.filter(function(p){return p.contentType==d}).shift())!==null&&v!==void 0?v:null}},{key:"getEmailHistory",value:function(){var v,g,d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(v=(g=this.getMediaByCategories(["history"]))===null||g===void 0?void 0:g.filter(function(p){return p.contentType==d}).shift())!==null&&v!==void 0?v:null}},{key:"_update",value:function(v){var g=[];(v.text||typeof v.text=="string")&&v.text!==this.state.body&&(this.state.body=v.text,g.push("body")),v.subject&&v.subject!==this.state.subject&&(this.state.subject=v.subject,g.push("subject")),v.lastUpdatedBy&&v.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=v.lastUpdatedBy,g.push("lastUpdatedBy")),v.author&&v.author!==this.state.author&&(this.state.author=v.author,g.push("author")),v.dateUpdated&&new Date(v.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(v.dateUpdated),g.push("dateUpdated")),v.timestamp&&new Date(v.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(v.timestamp),g.push("dateCreated"));var d=Ue(v.attributes,"Got malformed attributes for the message ".concat(this.sid),mn);Te.default(this.state.attributes,d)||(this.state.attributes=d,g.push("attributes"));var p=v.delivery,f=this.state.aggregatedDeliveryReceipt,m=!!p&&!!p.total&&!!p.delivered&&!!p.failed&&!!p.read&&!!p.sent&&!!p.undelivered;m&&(f?f._isEquals(p)||(f._update(p),g.push("deliveryReceipt")):(this.state.aggregatedDeliveryReceipt=new at(p),g.push("deliveryReceipt"))),g.length>0&&this.emit("updated",{message:this,updateReasons:g})}},{key:"getParticipant",value:function(){var _=X.default(N.default.mark(function g(){var d=this,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(p=null,!this.state.participantSid){y.next=5;break}return y.next=4,this.conversation.getParticipantBySid(this.state.participantSid).catch(function(){return mn.debug('Participant with sid "'.concat(d.participantSid,'" not found for message ').concat(d.sid)),null});case 4:p=y.sent;case 5:if(!(!p&&this.state.author)){y.next=9;break}return y.next=8,this.conversation.getParticipantByIdentity(this.state.author).catch(function(){return mn.debug('Participant with identity "'.concat(d.author,'" not found for message ').concat(d.sid)),null});case 8:p=y.sent;case 9:if(!p){y.next=11;break}return y.abrupt("return",p);case 11:throw f="Participant with ",this.state.participantSid&&(f+="SID '"+this.state.participantSid+"' "),this.state.author&&(this.state.participantSid&&(f+="or "),f+="identity '"+this.state.author+"' "),f==="Participant with "&&(f="Participant "),f+="was not found",new Error(f);case 17:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getDetailedDeliveryReceipts",value:function(){var _=X.default(N.default.mark(function g(){var d,p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._getDetailedDeliveryReceiptsPaginator();case 2:d=m.sent,p=d.items;case 4:if(!d.hasNextPage){m.next=11;break}return m.next=7,d.nextPage();case 7:d=m.sent,p=[].concat(Je.default(p),Je.default(d.items)),m.next=4;break;case 11:return m.abrupt("return",p);case 12:case"end":return m.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"remove",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return p.abrupt("return",this);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateBody",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{body:d});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateAttributes",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:typeof d<"u"?JSON.stringify(d):void 0});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"attachTemporaryUrlsFor",value:function(){var _=X.default(N.default.mark(function g(d){var p=this,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(f=d==null?void 0:d.map(function(k){return k.sid}),!(this.services.mcsClient&&f)){y.next=7;break}return y.next=4,this.services.mcsClient.mediaSetGet(f);case 4:return y.abrupt("return",y.sent.map(function(k){return new Ve(k,p.services)}));case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return y.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getTemporaryContentUrlsForMedia",value:function(v){var g=v.map(function(d){return d.sid});return this.getTemporaryContentUrlsForMediaSids(g)}},{key:"getTemporaryContentUrlsForMediaSids",value:function(v){var g=this;return new Pe.CancellablePromise(function(){var d=X.default(N.default.mark(function p(f,m,y){var k,E;return N.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(k=g.services.mcsClient.mediaSetGetContentUrls(v!=null?v:[]),!(!g.services.mcsClient||!v)){U.next=4;break}return m(new Error("Media Content Service is unavailable")),U.abrupt("return");case 4:return y(function(){k.cancel()}),U.prev=5,U.next=8,k;case 8:E=U.sent,f(E),U.next=15;break;case 12:U.prev=12,U.t0=U.catch(5),m(U.t0);case 15:case"end":return U.stop()}},p,null,[[5,12]])}));return function(p,f,m){return d.apply(this,arguments)}}())}},{key:"getTemporaryContentUrlsForAttachedMedia",value:function(){var v,g=this.attachedMedia,d=(v=g==null?void 0:g.map(function(p){return p.sid}))!==null&&v!==void 0?v:[];return this.getTemporaryContentUrlsForMediaSids(d)}},{key:"_getDetailedDeliveryReceiptsPaginator",value:function(){var _=X.default(N.default.mark(function g(d){var p=this,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return f=this.configuration.links.messagesReceipts.replace("%s",this.conversation.sid).replace("%s",this.sid),m=new Ae(f).arg("PageToken",d==null?void 0:d.pageToken).arg("PageSize",d==null?void 0:d.pageSize).build(),E.next=4,this.services.network.get(m);case 4:return y=E.sent,E.abrupt("return",new tt(y.body.delivery_receipts.map(function(L){return new We(L)}),function(L,U){return p._getDetailedDeliveryReceiptsPaginator({pageToken:L,pageSize:U})},y.body.meta.previous_token,y.body.meta.next_token));case 6:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter);ie.default(Zt,"updated","updated"),B([le.deprecated("getMediaByCategory","getMediaByCategories"),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Array)],Zt.prototype,"getMediaByCategory",null),B([b.validateTypes([b.nonEmptyString,"undefined"]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Ve)],Zt.prototype,"getEmailBody",null),B([b.validateTypes([b.nonEmptyString,"undefined"]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Ve)],Zt.prototype,"getEmailHistory",null),B([b.validateTypesAsync("string"),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],Zt.prototype,"updateBody",null),B([b.validateTypesAsync(ae),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],Zt.prototype,"updateAttributes",null),B([le.deprecated("attachTemporaryUrlsFor","getTemporaryContentUrlsForMedia"),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Promise)],Zt.prototype,"attachTemporaryUrlsFor",null),B([b.validateTypesAsync(b.nonEmptyArray("media",Ve)),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Pe.CancellablePromise)],Zt.prototype,"getTemporaryContentUrlsForMedia",null),B([b.validateTypesAsync(b.nonEmptyArray("strings","string")),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Pe.CancellablePromise)],Zt.prototype,"getTemporaryContentUrlsForMediaSids",null);function Fn(A,P){var S=typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(!S){if(Array.isArray(A)||(S=Et(A))||P&&A&&typeof A.length=="number"){S&&(A=S);var _=0,v=function(){};return{s:v,n:function(){return _>=A.length?{done:!0}:{done:!1,value:A[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(A)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function Et(A,P){if(!!A){if(typeof A=="string")return dr(A,P);var S=Object.prototype.toString.call(A).slice(8,-1);if(S==="Object"&&A.constructor&&(S=A.constructor.name),S==="Map"||S==="Set")return Array.from(A);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return dr(A,P)}}function dr(A,P){(P==null||P>A.length)&&(P=A.length);for(var S=0,_=new Array(P);S<P;S++)_[S]=A[S];return _}function qr(A){var P=Hr();return function(){var _=ue.default(A),v;if(P){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return te.default(this,v)}}function Hr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var pr=Ke.scope("Messages"),vs=function(A){ce.default(S,A);var P=qr(S);function S(_,v,g){var d;return $e.default(this,S),d=P.call(this),d.conversation=_,d.configuration=v,d.services=g,d.messagesByIndex=new Map,d.messagesListPromise=null,d}return Ie.default(S,[{key:"subscribe",value:function(){var _=X.default(N.default.mark(function g(d){var p=this,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!this.messagesListPromise){y.next=2;break}return y.abrupt("return",this.messagesListPromise);case 2:return this.messagesListPromise=typeof d=="string"?this.services.syncClient.list({id:d,mode:"open_existing"}):Promise.resolve(d),y.prev=3,y.next=6,this.messagesListPromise;case 6:return f=y.sent,f.on("itemAdded",function(k){pr.debug("".concat(p.conversation.sid," itemAdded: ").concat(k.item.index));var E={self:"".concat(p.conversation._links.messages,"/").concat(k.item.data.sid),conversation:p.conversation._links.self,messages_receipts:"".concat(p.conversation._links.messages,"/").concat(k.item.data.sid,"/Receipts")},L=new Zt(k.item.index,k.item.data,p.conversation,E,p.configuration,p.services);if(p.messagesByIndex.has(L.index)){pr.debug("Message arrived, but is already known and ignored",p.conversation.sid,L.index);return}p.messagesByIndex.set(L.index,L),L.on("updated",function(U){return p.emit("messageUpdated",U)}),p.emit("messageAdded",L)}),f.on("itemRemoved",function(k){pr.debug("#{this.conversation.sid} itemRemoved: ".concat(k.index));var E=k.index;if(p.messagesByIndex.has(E)){var L=p.messagesByIndex.get(E);if(!L)return;p.messagesByIndex.delete(L.index),L.removeAllListeners("updated"),p.emit("messageRemoved",L)}}),f.on("itemUpdated",function(k){pr.debug("".concat(p.conversation.sid," itemUpdated: ").concat(k.item.index));var E=p.messagesByIndex.get(k.item.index);E&&E._update(k.item.data)}),y.abrupt("return",f);case 13:throw y.prev=13,y.t0=y.catch(3),this.messagesListPromise=null,this.services.syncClient.connectionState!=="disconnected"&&pr.error("Failed to get messages object for conversation",this.conversation.sid,y.t0),pr.debug("ERROR: Failed to get messages object for conversation",this.conversation.sid,y.t0),y.t0;case 19:case"end":return y.stop()}},g,this,[[3,13]])}));function v(g){return _.apply(this,arguments)}return v}()},{key:"unsubscribe",value:function(){var _=X.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this.messagesListPromise){f.next=2;break}return f.abrupt("return");case 2:return f.next=4,this.messagesListPromise;case 4:d=f.sent,d.close(),this.messagesListPromise=null;case 7:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"sendV2",value:function(v){var g=this;return pr.debug("Sending message V2",v.mediaContent,v.attributes,v.emailOptions),new Pe.CancellablePromise(function(){var d=X.default(N.default.mark(function p(f,m,y){var k,E,L,U,ke,Ye,Lt,Ze,hr,ur,Cr,M;return N.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:E=[],L=[],y(function(){L.forEach(function(Be){return Be.cancel()})}),U=Fn(v.mediaContent),ne.prev=4,U.s();case 6:if((ke=U.n()).done){ne.next=25;break}return Ye=Xe.default(ke.value,2),Lt=Ye[0],Ze=Ye[1],ne.prev=8,pr.debug("Adding media to a message as ".concat(Ze instanceof FormData?"FormData":"SendMediaOptions"),Ze),Cr=Ze instanceof FormData?g.services.mcsClient.postFormData(Ze,Lt):g.services.mcsClient.post((hr=Ze.contentType)!==null&&hr!==void 0?hr:"",(ur=Ze.media)!==null&&ur!==void 0?ur:"",Lt,Ze.filename),L.push(Cr),ne.t0=E,ne.next=15,Cr;case 15:ne.t1=ne.sent,ne.t0.push.call(ne.t0,ne.t1),ne.next=23;break;case 19:return ne.prev=19,ne.t2=ne.catch(8),m(ne.t2),ne.abrupt("return");case 23:ne.next=6;break;case 25:ne.next=30;break;case 27:ne.prev=27,ne.t3=ne.catch(4),U.e(ne.t3);case 30:return ne.prev=30,U.f(),ne.finish(30);case 33:return M=g.services.commandExecutor.mutateResource("post",g.conversation._links.messages,{body:v.text,subject:(k=v.emailOptions)===null||k===void 0?void 0:k.subject,media_sids:E.map(function(Be){return Be.sid}),attributes:typeof v.attributes<"u"?JSON.stringify(v.attributes):void 0}),ne.prev=34,ne.t4=f,ne.next=38,M;case 38:ne.t5=ne.sent,(0,ne.t4)(ne.t5),ne.next=45;break;case 42:ne.prev=42,ne.t6=ne.catch(34),m(ne.t6);case 45:case"end":return ne.stop()}},p,null,[[4,27,30,33],[8,19],[34,42]])}));return function(p,f,m){return d.apply(this,arguments)}}())}},{key:"send",value:function(){var _=X.default(N.default.mark(function g(d){var p,f,m=arguments;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return p=m.length>1&&m[1]!==void 0?m[1]:{},f=m.length>2?m[2]:void 0,pr.debug("Sending text message",d,p,f),k.abrupt("return",this.services.commandExecutor.mutateResource("post",this.conversation._links.messages,{body:d!=null?d:"",attributes:typeof p<"u"?JSON.stringify(p):void 0,subject:f==null?void 0:f.subject}));case 4:case"end":return k.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"sendMedia",value:function(){var _=X.default(N.default.mark(function g(d){var p,f,m,y,k,E=arguments;return N.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(m=E.length>1&&E[1]!==void 0?E[1]:{},y=E.length>2?E[2]:void 0,pr.debug("Sending media message",d,m,y),pr.debug("Sending media message as ".concat(d instanceof FormData?"FormData":"SendMediaOptions"),d,m),!(d instanceof FormData)){U.next=10;break}return U.next=7,this.services.mcsClient.postFormData(d);case 7:U.t0=U.sent,U.next=13;break;case 10:return U.next=12,this.services.mcsClient.post((p=d.contentType)!==null&&p!==void 0?p:"",(f=d.media)!==null&&f!==void 0?f:"","media",d.filename);case 12:U.t0=U.sent;case 13:return k=U.t0,U.next=16,this.services.commandExecutor.mutateResource("post",this.conversation._links.messages,{media_sids:[k.sid],attributes:typeof m<"u"?JSON.stringify(m):void 0});case 16:return U.abrupt("return",U.sent);case 17:case"end":return U.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getMessages",value:function(){var _=X.default(N.default.mark(function g(d,p){var f,m=arguments;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return f=m.length>2&&m[2]!==void 0?m[2]:"backwards",k.abrupt("return",this._getMessages(d,p,f));case 2:case"end":return k.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_wrapPaginator",value:function(v,g,d){var p=this,f=v==="desc",m=function(){return g.nextPage().then(function(E){return p._wrapPaginator(v,E,d)})},y=function(){return g.prevPage().then(function(E){return p._wrapPaginator(v,E,d)})};return d(g.items).then(function(k){return{items:k.sort(function(E,L){return E.index-L.index}),hasPrevPage:f?g.hasNextPage:g.hasPrevPage,hasNextPage:f?g.hasPrevPage:g.hasNextPage,prevPage:f?m:y,nextPage:f?y:m}})}},{key:"_upsertMessage",value:function(v,g){var d=this,p=this.messagesByIndex.get(v);if(p)return p;var f={self:"".concat(this.conversation._links.messages,"/").concat(g.sid),conversation:this.conversation._links.self,messages_receipts:"".concat(this.conversation._links.messages,"/").concat(g.sid,"/Receipts")},m=new Zt(v,g,this.conversation,f,this.configuration,this.services);return this.messagesByIndex.set(m.index,m),m.on("updated",function(y){return d.emit("messageUpdated",y)}),m}},{key:"_getMessages",value:function(){var _=X.default(N.default.mark(function g(){var d=this,p,f,m,y,k,E,L=arguments;return N.default.wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:return p=L.length>0&&L[0]!==void 0?L[0]:30,f=L.length>1&&L[1]!==void 0?L[1]:"end",m=L.length>2&&L[2]!==void 0?L[2]:"forward",y=m==="backwards"?"desc":"asc",ke.next=6,this.messagesListPromise;case 6:return k=ke.sent,ke.next=9,k==null?void 0:k.getItems({from:f!=="end"?f:void 0,pageSize:p,order:y,limit:p});case 9:return E=ke.sent,ke.next=12,this._wrapPaginator(y,E,function(Ye){return Promise.all(Ye.map(function(Lt){return d._upsertMessage(Lt.index,Lt.data)}))});case 12:return ke.abrupt("return",ke.sent);case 13:case"end":return ke.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter),xr=function(){function A(P){$e.default(this,A),ie.default(this,"attributes",{}),ie.default(this,"mediaContent",[]),ie.default(this,"emailOptions",{}),this.messagesEntity=P}return Ie.default(A,[{key:"send",value:function(){var S=this;return new Pe.CancellablePromise(function(){var _=X.default(N.default.mark(function v(g,d,p){var f,m;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return f=S.messagesEntity.sendV2(S),p(function(){return f.cancel()}),k.prev=2,k.next=5,f;case 5:m=k.sent,g(Q(m.index)),k.next=12;break;case 9:k.prev=9,k.t0=k.catch(2),d(k.t0);case 12:case"end":return k.stop()}},v,null,[[2,9]])}));return function(v,g,d){return _.apply(this,arguments)}}())}}]),A}(),hs=function(){function A(P,S){$e.default(this,A),this.limits=P,this.message=new xr(S),this.emailBodies=new Map,this.emailHistories=new Map}return Ie.default(A,[{key:"setBody",value:function(S){return this.message.text=S,this}},{key:"setSubject",value:function(S){return this.message.emailOptions.subject=S,this}},{key:"setAttributes",value:function(S){return this.message.attributes=S,this}},{key:"setEmailBody",value:function(S,_){return this.emailBodies.set(S,_),this}},{key:"setEmailHistory",value:function(S,_){return this.emailHistories.set(S,_),this}},{key:"addMedia",value:function(S){if(typeof FormData>"u"&&S instanceof FormData)throw new Error("Could not add FormData content whilst not in a browser");if(!(S instanceof FormData)){var _=S;if(!_.contentType||!_.media)throw new Error("Media content in SendMediaOptions must contain non-empty contentType and media")}return this.message.mediaContent.push(["media",S]),this}},{key:"build",value:function(){var S=this;if(this.emailBodies.forEach(function(_,v){if(!S.limits.emailBodiesAllowedContentTypes.includes(v))throw new Error("Unsupported email body content type ".concat(v))}),this.emailHistories.forEach(function(_,v){if(!S.limits.emailHistoriesAllowedContentTypes.includes(v))throw new Error("Unsupported email history content type ".concat(v))}),this.emailBodies.size>this.limits.emailBodiesAllowedContentTypes.length)throw new Error("Too many email bodies attached to the message (".concat(this.emailBodies.size," > ").concat(this.limits.emailBodiesAllowedContentTypes.length,")"));if(this.emailHistories.size>this.limits.emailHistoriesAllowedContentTypes.length)throw new Error("Too many email histories attached to the message (".concat(this.emailHistories.size," > ").concat(this.limits.emailHistoriesAllowedContentTypes.length,")"));if(this.message.mediaContent.length>this.limits.mediaAttachmentsCountLimit)throw new Error("Too many media attachments in the message (".concat(this.message.mediaContent.length," > ").concat(this.limits.mediaAttachmentsCountLimit,")"));return this.emailBodies.forEach(function(_){S.message.mediaContent.push(["body",_])}),this.emailHistories.forEach(function(_){S.message.mediaContent.push(["history",_])}),this.message}},{key:"buildAndSend",value:function(){return this.build().send()}},{key:"getPayloadContentType",value:function(S){return typeof FormData<"u"&&S instanceof FormData?S.get("Content-Type"):S.contentType}}]),A}();function Io(A,P){var S=typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(!S){if(Array.isArray(A)||(S=Co(A))||P&&A&&typeof A.length=="number"){S&&(A=S);var _=0,v=function(){};return{s:v,n:function(){return _>=A.length?{done:!0}:{done:!1,value:A[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(A)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function Co(A,P){if(!!A){if(typeof A=="string")return ys(A,P);var S=Object.prototype.toString.call(A).slice(8,-1);if(S==="Object"&&A.constructor&&(S=A.constructor.name),S==="Map"||S==="Set")return Array.from(A);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return ys(A,P)}}function ys(A,P){(P==null||P>A.length)&&(P=A.length);for(var S=0,_=new Array(P);S<P;S++)_[S]=A[S];return _}function Ro(A){var P=bn();return function(){var _=ue.default(A),v;if(P){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return te.default(this,v)}}function bn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var wn={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",uniqueName:"uniqueName",state:"state",bindings:"bindings"},wt=function(A){ce.default(S,A);var P=Ro(S);function S(_,v,g,d,p){var f,m,y;$e.default(this,S),y=P.call(this),y.sid=v,y._links=g,y._configuration=d,y._services=p,y._entityName=_.channel,y._internalState={uniqueName:_.uniqueName||null,status:"notParticipating",attributes:(f=_.attributes)!==null&&f!==void 0?f:{},createdBy:_.createdBy,dateCreated:Fe(_.dateCreated),dateUpdated:Fe(_.dateUpdated),friendlyName:_.friendlyName||null,lastReadMessageIndex:Number.isInteger(_.lastConsumedMessageIndex)?_.lastConsumedMessageIndex:null,bindings:(m=_.bindings)!==null&&m!==void 0?m:{}},_.notificationLevel&&(y._internalState.notificationLevel=_.notificationLevel);var k={participants:y._links.participants};return y._participants=new Map,y._participantsEntity=new je(xe.default(y),y._participants,k,y._configuration,y._services),y._participantsEntity.on("participantJoined",function(E){return y.emit("participantJoined",E)}),y._participantsEntity.on("participantLeft",function(E){return y.emit("participantLeft",E)}),y._participantsEntity.on("participantUpdated",function(E){return y.emit("participantUpdated",E)}),y._messagesEntity=new vs(xe.default(y),d,p),y._messagesEntity.on("messageAdded",function(E){return y._onMessageAdded(E)}),y._messagesEntity.on("messageUpdated",function(E){return y.emit("messageUpdated",E)}),y._messagesEntity.on("messageRemoved",function(E){return y.emit("messageRemoved",E)}),y}return Ie.default(S,[{key:"uniqueName",get:function(){return this._internalState.uniqueName}},{key:"status",get:function(){return this._internalState.status}},{key:"friendlyName",get:function(){return this._internalState.friendlyName}},{key:"dateUpdated",get:function(){return this._internalState.dateUpdated}},{key:"dateCreated",get:function(){return this._internalState.dateCreated}},{key:"createdBy",get:function(){var v;return(v=this._internalState.createdBy)!==null&&v!==void 0?v:""}},{key:"attributes",get:function(){return this._internalState.attributes}},{key:"lastReadMessageIndex",get:function(){return this._internalState.lastReadMessageIndex}},{key:"lastMessage",get:function(){var v;return(v=this._internalState.lastMessage)!==null&&v!==void 0?v:void 0}},{key:"notificationLevel",get:function(){var v;return(v=this._internalState.notificationLevel)!==null&&v!==void 0?v:"default"}},{key:"bindings",get:function(){return this._internalState.bindings}},{key:"limits",get:function(){return this._configuration.limits}},{key:"state",get:function(){return this._internalState.state}},{key:"_statusSource",get:function(){return this._dataSource}},{key:"add",value:function(){var _=X.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.abrupt("return",this._participantsEntity.add(d,p!=null?p:{}));case 1:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"addNonChatParticipant",value:function(){var _=X.default(N.default.mark(function g(d,p){var f,m,y=arguments;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return f=y.length>2&&y[2]!==void 0?y[2]:{},m=y.length>3&&y[3]!==void 0?y[3]:{},E.abrupt("return",this._participantsEntity.addNonChatParticipant(d,p,f!=null?f:{},m!=null?m:{}));case 3:case"end":return E.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"advanceLastReadMessageIndex",value:function(){var _=X.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._subscribeStreams();case 2:if(!(d<((p=this.lastReadMessageIndex)!==null&&p!==void 0?p:0))){m.next=6;break}return m.next=5,this._setLastReadMessageIndex(this.lastReadMessageIndex);case 5:return m.abrupt("return",m.sent);case 6:return m.next=8,this._setLastReadMessageIndex(d);case 8:return m.abrupt("return",m.sent);case 9:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"delete",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._services.commandExecutor.mutateResource("delete",this._links.self);case 2:return p.abrupt("return",this);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getAttributes",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._subscribe();case 2:return p.abrupt("return",this.attributes);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getMessages",value:function(){var _=X.default(N.default.mark(function g(d,p,f){return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._subscribeStreams();case 2:return y.abrupt("return",this._messagesEntity.getMessages(d,p,f));case 3:case"end":return y.stop()}},g,this)}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"getParticipants",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._subscribeStreams();case 2:return p.abrupt("return",this._participantsEntity.getParticipants());case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getParticipantsCount",value:function(){var _=X.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return p=new Ae(this._configuration.links.conversations).path(this.sid).build(),y.next=3,this._services.network.get(p);case 3:return f=y.sent,y.abrupt("return",(d=f.body.participants_count)!==null&&d!==void 0?d:0);case 5:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getParticipantBySid",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.abrupt("return",this._participantsEntity.getParticipantBySid(d));case 1:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getParticipantByIdentity",value:function(){var _=X.default(N.default.mark(function g(){var d,p=arguments;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return d=p.length>0&&p[0]!==void 0?p[0]:"",m.abrupt("return",this._participantsEntity.getParticipantByIdentity(d!=null?d:""));case 2:case"end":return m.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getMessagesCount",value:function(){var _=X.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return p=new Ae(this._configuration.links.conversations).path(this.sid).build(),y.next=3,this._services.network.get(p);case 3:return f=y.sent,y.abrupt("return",(d=f.body.messages_count)!==null&&d!==void 0?d:0);case 5:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getUnreadMessagesCount",value:function(){var _=X.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return d=new Ae(this._configuration.links.myConversations).path(this.sid).build(),y.next=3,this._services.network.get(d);case 3:if(p=y.sent,p.body.conversation_sid===this.sid){y.next=6;break}throw new Error("Conversation was not found in the user conversations list");case 6:if(f=p.body.unread_messages_count,typeof f!="number"){y.next=9;break}return y.abrupt("return",f);case 9:return y.abrupt("return",null);case 10:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"join",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._services.commandExecutor.mutateResource("post",this._links.participants,{identity:this._configuration.userIdentity});case 2:return p.abrupt("return",this);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"leave",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this._internalState.status!=="joined"){p.next=3;break}return p.next=3,this._services.commandExecutor.mutateResource("delete","".concat(this._links.participants,"/").concat(this._configuration.userIdentity));case 3:return p.abrupt("return",this);case 4:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"removeParticipant",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._participantsEntity.remove(typeof d=="string"?d:d.sid);case 2:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"sendMessage",value:function(){var _=X.default(N.default.mark(function g(d,p,f){var m,y,k,E;return N.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!(typeof d=="string"||d===null)){U.next=5;break}return U.next=3,this._messagesEntity.send(d,p,f);case 3:return k=U.sent,U.abrupt("return",(y=Q(k.index))!==null&&y!==void 0?y:0);case 5:return U.next=7,this._messagesEntity.sendMedia(d,p,f);case 7:return E=U.sent,U.abrupt("return",(m=Q(E.index))!==null&&m!==void 0?m:0);case 9:case"end":return U.stop()}},g,this)}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"prepareMessage",value:function(){return new hs(this.limits,this._messagesEntity)}},{key:"setAllMessagesRead",value:function(){var _=X.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._subscribeStreams();case 2:return f.next=4,this.getMessages(1);case 4:if(d=f.sent,!(d.items.length>0)){f.next=7;break}return f.abrupt("return",this.advanceLastReadMessageIndex(d.items[0].index));case 7:return f.abrupt("return",0);case 8:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"setAllMessagesUnread",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._subscribeStreams();case 2:return p.next=4,this._setLastReadMessageIndex(null);case 4:return p.abrupt("return",p.sent);case 5:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"setUserNotificationLevel",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._services.commandExecutor.mutateResource("post","".concat(this._configuration.links.myConversations,"/").concat(this.sid),{notification_level:d});case 2:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"typing",value:function(){return this._services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._services.commandExecutor.mutateResource("post",this._links.self,{attributes:d!==void 0?JSON.stringify(d):void 0});case 2:return f.abrupt("return",this);case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateFriendlyName",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this._internalState.friendlyName===d){f.next=3;break}return f.next=3,this._services.commandExecutor.mutateResource("post",this._links.self,{friendly_name:d});case 3:return f.abrupt("return",this);case 4:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateLastReadMessageIndex",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._subscribeStreams();case 2:return f.abrupt("return",this._setLastReadMessageIndex(d));case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"updateUniqueName",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(this._internalState.uniqueName===d){f.next=4;break}return d||(d=""),f.next=4,this._services.commandExecutor.mutateResource("post",this._links.self,{unique_name:d});case 4:return f.abrupt("return",this);case 5:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"_subscribe",value:function(){var _=X.default(N.default.mark(function g(){var d=this;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!this._entityPromise){f.next=2;break}return f.abrupt("return",this._entityPromise);case 2:return this._entityPromise=this._services.syncClient.document({id:this._entityName,mode:"open_existing"}),f.prev=3,f.next=6,this._entityPromise;case 6:return this._entity=f.sent,this._entity.on("updated",function(m){return d._update(m.data)}),this._entity.on("removed",function(){return d.emit("removed",d)}),this._update(this._entity.data),f.abrupt("return",this._entity);case 13:throw f.prev=13,f.t0=f.catch(3),this._entity=null,this._entityPromise=null,this._services.syncClient.connectionState!="disconnected"&&S._logger.error("Failed to get conversation object",f.t0),S._logger.debug("ERROR: Failed to get conversation object",f.t0),f.t0;case 20:case"end":return f.stop()}},g,this,[[3,13]])}));function v(){return _.apply(this,arguments)}return v}()},{key:"_fetchStreams",value:function(){var _=X.default(N.default.mark(function g(){var d,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._subscribe();case 2:return S._logger.trace("_streamsAvailable, this.entity.data=",(d=this._entity)===null||d===void 0?void 0:d.data),f=(p=this._entity)===null||p===void 0?void 0:p.data,y.next=6,this._services.syncClient.list({id:f.messages,mode:"open_existing"});case 6:return this._messagesList=y.sent,y.next=9,this._services.syncClient.map({id:f.roster,mode:"open_existing"});case 9:this._participantsMap=y.sent;case 10:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_subscribeStreams",value:function(){var _=X.default(N.default.mark(function g(){var d,p,f,m,y,k,E;return N.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:return U.prev=0,U.next=3,this._subscribe();case 3:return S._logger.trace("_subscribeStreams, this.entity.data=",(d=this._entity)===null||d===void 0?void 0:d.data),y=(p=this._entity)===null||p===void 0?void 0:p.data,k=y.messages,E=y.roster,U.next=9,Promise.all([this._messagesEntity.subscribe((f=this._messagesList)!==null&&f!==void 0?f:k),this._participantsEntity.subscribe((m=this._participantsMap)!==null&&m!==void 0?m:E)]);case 9:U.next=16;break;case 11:throw U.prev=11,U.t0=U.catch(0),this._services.syncClient.connectionState!=="disconnected"&&S._logger.error("Failed to subscribe on conversation objects",this.sid,U.t0),S._logger.debug("ERROR: Failed to subscribe on conversation objects",this.sid,U.t0),U.t0;case 16:case"end":return U.stop()}},g,this,[[0,11]])}));function v(){return _.apply(this,arguments)}return v}()},{key:"_unsubscribe",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(!this._entity){p.next=5;break}return p.next=3,this._entity.close();case 3:this._entity=null,this._entityPromise=null;case 5:return p.abrupt("return",Promise.all([this._participantsEntity.unsubscribe(),this._messagesEntity.unsubscribe()]));case 6:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_setStatus",value:function(v,g){var d=this;if(this._dataSource=g,this._internalState.status!==v){if(this._internalState.status=v,v==="joined"){this._subscribeStreams().catch(function(p){if(S._logger.debug("ERROR while setting conversation status "+v,p),d._services.syncClient.connectionState!=="disconnected")throw p});return}this._entityPromise&&this._unsubscribe().catch(function(p){if(S._logger.debug("ERROR while setting conversation status "+v,p),d._services.syncClient.connectionState!=="disconnected")throw p})}}},{key:"_update",value:function(v){var g,d,p,f,m;S._logger.trace("_update",v),S.preprocessUpdate(v,this.sid);for(var y=new Set,k=0,E=Object.keys(v);k<E.length;k++){var L=E[k],U=wn[L];if(!!U)switch(U){case wn.status:if(!v.status||v.status==="unknown"||this._internalState.status===v.status)break;this._internalState.status=v.status,y.add(U);break;case wn.attributes:if(Te.default(this._internalState.attributes,v.attributes))break;this._internalState.attributes=v.attributes,y.add(U);break;case wn.lastConsumedMessageIndex:if(v.lastConsumedMessageIndex===void 0||v.lastConsumedMessageIndex===this._internalState.lastReadMessageIndex)break;this._internalState.lastReadMessageIndex=v.lastConsumedMessageIndex,y.add("lastReadMessageIndex");break;case wn.lastMessage:if(this._internalState.lastMessage&&!v.lastMessage){delete this._internalState.lastMessage,y.add(U);break}this._internalState.lastMessage=this._internalState.lastMessage||{},((g=v.lastMessage)===null||g===void 0?void 0:g.index)!==void 0&&v.lastMessage.index!==this._internalState.lastMessage.index&&(this._internalState.lastMessage.index=v.lastMessage.index,y.add(U)),((d=v.lastMessage)===null||d===void 0?void 0:d.timestamp)!==void 0&&((p=this._internalState.lastMessage)===null||p===void 0||(f=p.dateCreated)===null||f===void 0?void 0:f.getTime())!==v.lastMessage.timestamp.getTime()&&(this._internalState.lastMessage.dateCreated=v.lastMessage.timestamp,y.add(U)),Te.default(this._internalState.lastMessage,{})&&delete this._internalState.lastMessage;break;case wn.state:var ke=v.state||void 0;if(ke!==void 0&&(ke.dateUpdated=new Date(ke.dateUpdated)),Te.default(this._internalState.state,ke))break;this._internalState.state=ke,y.add(U);break;case wn.bindings:if(Te.default(this._internalState.bindings,v.bindings))break;this._internalState.bindings=v.bindings,y.add(U);break;default:var Ye=v[L]instanceof Date,Lt=Ye&&((m=this._internalState[U])===null||m===void 0?void 0:m.getTime())===v[L].getTime(),Ze=!Ye&&this[U]===v[L];if(Lt||Ze)break;this._internalState[U]=v[L],y.add(U)}}y.size>0&&this.emit("updated",{conversation:this,updateReasons:Je.default(y)})}},{key:"_onMessageAdded",value:function(v){var g=Io(this._participants.values()),d;try{for(g.s();!(d=g.n()).done;){var p=d.value;if(p.identity===v.author){p._endTyping();break}}}catch(f){g.e(f)}finally{g.f()}this.emit("messageAdded",v)}},{key:"_setLastReadMessageIndex",value:function(){var _=X.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._services.commandExecutor.mutateResource("post","".concat(this._configuration.links.myConversations,"/").concat(this.sid),{last_read_message_index:d});case 2:return p=m.sent,m.abrupt("return",p.unread_messages_count);case 4:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}],[{key:"preprocessUpdate",value:function(v,g){try{typeof v.attributes=="string"?v.attributes=JSON.parse(v.attributes):v.attributes&&JSON.stringify(v.attributes)}catch{S._logger.warn("Retrieved malformed attributes from the server for conversation: "+g),v.attributes={}}try{v.dateCreated&&(v.dateCreated=new Date(v.dateCreated))}catch{S._logger.warn("Retrieved malformed dateCreated from the server for conversation: "+g),delete v.dateCreated}try{v.dateUpdated&&(v.dateUpdated=new Date(v.dateUpdated))}catch{S._logger.warn("Retrieved malformed dateUpdated from the server for conversation: "+g),delete v.dateUpdated}try{v.lastMessage&&v.lastMessage.timestamp&&(v.lastMessage.timestamp=new Date(v.lastMessage.timestamp))}catch{S._logger.warn("Retrieved malformed lastMessage.timestamp from the server for conversation: "+g),delete v.lastMessage.timestamp}}}]),S}($.ReplayEventEmitter);ie.default(wt,"participantJoined","participantJoined"),ie.default(wt,"participantLeft","participantLeft"),ie.default(wt,"participantUpdated","participantUpdated"),ie.default(wt,"messageAdded","messageAdded"),ie.default(wt,"messageRemoved","messageRemoved"),ie.default(wt,"messageUpdated","messageUpdated"),ie.default(wt,"typingEnded","typingEnded"),ie.default(wt,"typingStarted","typingStarted"),ie.default(wt,"updated","updated"),ie.default(wt,"removed","removed"),ie.default(wt,"_logger",Ke.scope("Conversation")),B([b.validateTypesAsync(b.nonEmptyString,F),T("design:type",Function),T("design:paramtypes",[String,Object]),T("design:returntype",Promise)],wt.prototype,"add",null),B([b.validateTypesAsync(b.nonEmptyString,b.nonEmptyString,F),T("design:type",Function),T("design:paramtypes",[String,String,Object,Object]),T("design:returntype",Promise)],wt.prototype,"addNonChatParticipant",null),B([b.validateTypesAsync(b.nonNegativeInteger),T("design:type",Function),T("design:paramtypes",[Number]),T("design:returntype",Promise)],wt.prototype,"advanceLastReadMessageIndex",null),B([b.validateTypesAsync(["undefined",b.nonNegativeInteger],["undefined",b.nonNegativeInteger],["undefined",b.literal("backwards","forward")]),T("design:type",Function),T("design:paramtypes",[Number,Number,String]),T("design:returntype",Promise)],wt.prototype,"getMessages",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],wt.prototype,"getParticipantBySid",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],wt.prototype,"getParticipantByIdentity",null),B([b.validateTypesAsync([b.nonEmptyString,z]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],wt.prototype,"removeParticipant",null),B([b.validateTypesAsync(["string",FormData,b.literal(null),b.objectSchema("media options",{contentType:b.nonEmptyString,media:b.custom(function(A){var P=typeof A=="string"&&A.length>0||A instanceof Uint8Array||A instanceof ArrayBuffer;return typeof Blob=="function"&&(P=P||A instanceof Blob),[P,"a non-empty string, an instance of Buffer or an instance of Blob"]})})],F,["undefined",b.literal(null),b.objectSchema("email attributes",{subject:[b.nonEmptyString,"undefined"]})]),T("design:type",Function),T("design:paramtypes",[Object,Object,Object]),T("design:returntype",Promise)],wt.prototype,"sendMessage",null),B([b.validateTypesAsync(b.literal("default","muted")),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],wt.prototype,"setUserNotificationLevel",null),B([b.validateTypesAsync(ae),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],wt.prototype,"updateAttributes",null),B([b.validateTypesAsync("string"),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],wt.prototype,"updateFriendlyName",null),B([b.validateTypesAsync([b.literal(null),b.nonNegativeInteger]),T("design:type",Function),T("design:paramtypes",[Number]),T("design:returntype",Promise)],wt.prototype,"updateLastReadMessageIndex",null),B([b.validateTypesAsync(["string",b.literal(null)]),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],wt.prototype,"updateUniqueName",null);var Ao=function(){function A(){var P=this;$e.default(this,A),this._promise=new Promise(function(S,_){P._resolve=S,P._reject=_})}return Ie.default(A,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(S){this._resolve(S)}},{key:"set",value:function(S){this.current=S,this._resolve(S)}},{key:"fail",value:function(S){this._reject(S)}}]),A}();function Oo(A,P){var S=typeof Symbol<"u"&&A[Symbol.iterator]||A["@@iterator"];if(!S){if(Array.isArray(A)||(S=Po(A))||P&&A&&typeof A.length=="number"){S&&(A=S);var _=0,v=function(){};return{s:v,n:function(){return _>=A.length?{done:!0}:{done:!1,value:A[_++]}},e:function(m){throw m},f:v}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var g=!0,d=!1,p;return{s:function(){S=S.call(A)},n:function(){var m=S.next();return g=m.done,m},e:function(m){d=!0,p=m},f:function(){try{!g&&S.return!=null&&S.return()}finally{if(d)throw p}}}}function Po(A,P){if(!!A){if(typeof A=="string")return ra(A,P);var S=Object.prototype.toString.call(A).slice(8,-1);if(S==="Object"&&A.constructor&&(S=A.constructor.name),S==="Map"||S==="Set")return Array.from(A);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return ra(A,P)}}function ra(A,P){(P==null||P>A.length)&&(P=A.length);for(var S=0,_=new Array(P);S<P;S++)_[S]=A[S];return _}function gs(A,P){var S=Object.keys(A);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(A);P&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(A,v).enumerable})),S.push.apply(S,_)}return S}function Mo(A){for(var P=1;P<arguments.length;P++){var S=arguments[P]!=null?arguments[P]:{};P%2?gs(Object(S),!0).forEach(function(_){ie.default(A,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(S)):gs(Object(S)).forEach(function(_){Object.defineProperty(A,_,Object.getOwnPropertyDescriptor(S,_))})}return A}function tn(A){var P=xo();return function(){var _=ue.default(A),v;if(P){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return te.default(this,v)}}function xo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vr=Ke.scope("Conversations"),No=function(A){ce.default(S,A);var P=tn(S);function S(_,v){var g;return $e.default(this,S),g=P.call(this),ie.default(xe.default(g),"conversations",new Map),ie.default(xe.default(g),"myConversationsRead",new Ao),ie.default(xe.default(g),"tombstones",new Set),ie.default(xe.default(g),"myConversationsFetched",!1),g.configuration=_,g.services=v,g}return Ie.default(S,[{key:"addConversation",value:function(){var _=X.default(N.default.mark(function g(d){var p,f,m,y,k,E,L,U,ke,Ye;return N.default.wrap(function(Ze){for(;;)switch(Ze.prev=Ze.next){case 0:return y=typeof(d==null?void 0:d.attributes)<"u"?d.attributes:{},Ze.next=3,this.services.commandExecutor.mutateResource("post",this.configuration.links.conversations,{friendly_name:d.friendlyName,unique_name:d.uniqueName,attributes:typeof y<"u"?JSON.stringify(y):void 0});case 3:if(k=Ze.sent,E=(p=k.sid)!==null&&p!==void 0?p:null,L=(f=(m=k.sync_objects)===null||m===void 0?void 0:m.conversation)!==null&&f!==void 0?f:null,U=Mo({self:k.url},k.links),ke=this.conversations.get(E),!ke){Ze.next=12;break}return Ze.next=11,ke._subscribe();case 11:return Ze.abrupt("return",ke);case 12:return Ye=new wt({channel:L,entityName:"",uniqueName:"",attributes:null,createdBy:"",friendlyName:"",lastConsumedMessageIndex:0,dateCreated:null,dateUpdated:null},E,U,this.configuration,this.services),this.conversations.set(Ye.sid,Ye),this._registerForEvents(Ye),Ze.next=17,Ye._subscribe();case 17:return this.emit("conversationAdded",Ye),Ze.abrupt("return",Ye);case 19:case"end":return Ze.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"fetchConversations",value:function(){var _=X.default(N.default.mark(function g(){var d=this,p,f,m,y,k,E,L;return N.default.wrap(function(ke){for(;;)switch(ke.prev=ke.next){case 0:return ke.prev=0,ke.next=3,this._getMap();case 3:return p=ke.sent,p.on("itemAdded",function(Ye){vr.debug("itemAdded: ".concat(Ye.item.key)),d._upsertConversation("sync",Ye.item.key,Ye.item.data)}),p.on("itemRemoved",function(Ye){vr.debug("itemRemoved: ".concat(Ye.key));var Lt=Ye.key;d.myConversationsFetched||d.tombstones.add(Lt);var Ze=d.conversations.get(Lt);!Ze||(Ze.status==="joined"&&(Ze._setStatus("notParticipating","sync"),d.emit("conversationLeft",Ze)),d.conversations.delete(Lt),d.emit("conversationRemoved",Ze),Ze.emit("removed",Ze))}),p.on("itemUpdated",function(Ye){vr.debug("itemUpdated: ".concat(Ye.item.key)),d._upsertConversation("sync",Ye.item.key,Ye.item.data)}),ke.next=9,this._fetchMyConversations();case 9:f=ke.sent,m=[],y=Oo(f);try{for(y.s();!(k=y.n()).done;)E=k.value,m.push(this._upsertConversation("rest",E.channel_sid,E))}catch(Ye){y.e(Ye)}finally{y.f()}return this.myConversationsRead.set(!0),ke.next=16,Promise.all(m);case 16:return this.myConversationsFetched=!0,this.tombstones.clear(),vr.debug("The conversations list has been successfully fetched"),ke.abrupt("return",this);case 22:throw ke.prev=22,ke.t0=ke.catch(0),L="Failed to fetch the conversations list",this.services.syncClient.connectionState!=="disconnected"&&vr.error(L,ke.t0),vr.debug("ERROR: ".concat(L),ke.t0),ke.t0;case 28:case"end":return ke.stop()}},g,this,[[0,22]])}));function v(){return _.apply(this,arguments)}return v}()},{key:"getConversations",value:function(){var _=X.default(N.default.mark(function g(){var d=this,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this._getMap();case 2:return p=y.sent,y.next=5,p.getItems();case 5:return f=y.sent,y.abrupt("return",this._wrapPaginator(f,function(k){return Promise.all(k.map(function(E){return d._upsertConversation("sync",E.key,E.data)}))}));case 7:case"end":return y.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getConversation",value:function(){var _=X.default(N.default.mark(function g(d){var p=this,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,this._getMap();case 2:return f=E.sent,E.next=5,f.getItems({key:d});case 5:return m=E.sent,y=m.items.map(function(L){return p._upsertConversation("sync",L.key,L.data)}),E.abrupt("return",y.length>0?y[0]:null);case 8:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getConversationByUniqueName",value:function(){var _=X.default(N.default.mark(function g(d){var p,f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return p=new Ae(this.configuration.links.myConversations).path(d).build(),L.next=3,this.services.network.get(p);case 3:return f=L.sent,m=f.body,y=m.conversation_sid,k={entityName:null,lastConsumedMessageIndex:m.last_read_message_index,status:(m==null?void 0:m.status)||"unknown",friendlyName:m.friendly_name,dateUpdated:m.date_updated,dateCreated:m.date_created,uniqueName:m.unique_name,createdBy:m.created_by,attributes:m.attributes,channel:m.sync_objects.conversation,notificationLevel:m==null?void 0:m.notification_level,sid:y},L.abrupt("return",y?this._upsertConversation("sync",y,k):null);case 8:case"end":return L.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"peekConversation",value:function(){var _=X.default(N.default.mark(function g(d){var p,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return p=new Ae(this.configuration.links.conversations).path(d).build(),E.next=3,this.services.network.get(p);case 3:return f=E.sent,m=f.body,y={entityName:null,status:(m==null?void 0:m.status)||"unknown",friendlyName:m.friendly_name,dateUpdated:m.date_updated,dateCreated:m.date_created,uniqueName:m.unique_name,createdBy:m.created_by,attributes:m.attributes,channel:"".concat(d,".channel"),sid:d},E.abrupt("return",this._upsertConversation("sync",d,y));case 7:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"_getMap",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this.services.syncClient.map({id:this.configuration.myConversations,mode:"open_existing"});case 2:return p.abrupt("return",p.sent);case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_wrapPaginator",value:function(){var _=X.default(N.default.mark(function g(d,p){var f=this,m;return N.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,p(d.items);case 2:return m=k.sent,k.abrupt("return",{items:m.filter(function(E){return E!==null}),hasNextPage:d.hasNextPage,hasPrevPage:d.hasPrevPage,nextPage:function(){return d.nextPage().then(function(L){return f._wrapPaginator(L,p)})},prevPage:function(){return d.prevPage().then(function(L){return f._wrapPaginator(L,p)})}});case 4:case"end":return k.stop()}},g)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"_updateConversation",value:function(){var _=X.default(N.default.mark(function g(d,p,f){var m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:if(m=p._statusSource!==void 0&&d!==p._statusSource,y=d!=="rest"||p._statusSource==="sync",!(m&&y&&d!=="sync")){L.next=5;break}return vr.trace("upsertConversation: conversation is known from sync and came from REST, ignoring",{sid:p.sid,data:f.status,conversation:p.status}),L.abrupt("return");case 5:if(!(f.status==="joined"&&p.status!=="joined")){L.next=15;break}return p._setStatus("joined",d),k={},typeof f.notificationLevel<"u"&&(k.notificationLevel=f.notificationLevel),typeof f.lastConsumedMessageIndex<"u"&&(k.lastConsumedMessageIndex=f.lastConsumedMessageIndex),Te.default(k,{})||p._update(k),L.next=13,p._subscribe();case 13:return this.emit("conversationJoined",p),L.abrupt("return");case 15:if(!(f.status==="notParticipating"&&p.status==="joined")){L.next=22;break}return p._setStatus("notParticipating",d),p._update(f),L.next=20,p._subscribe();case 20:return this.emit("conversationLeft",p),L.abrupt("return");case 22:if(f.status!=="notParticipating"){L.next=26;break}return L.next=25,p._subscribe();case 25:return L.abrupt("return");case 26:p._update(f);case 27:case"end":return L.stop()}},g,this)}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"_upsertConversation",value:function(){var _=X.default(N.default.mark(function g(d,p,f){var m,y,k,E;return N.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(vr.trace("upsertConversation called for ".concat(p),f),m=this.conversations.get(p),!m){U.next=9;break}return vr.trace("upsertConversation: the conversation ".concat(m.sid," is known;")+"its status is known from the source ".concat(m._statusSource," ")+"and the update came from the source ".concat(d),m),U.next=6,this._updateConversation(d,m,f);case 6:return U.next=8,m._subscribe();case 8:return U.abrupt("return",m);case 9:if(!(d==="rest"&&this.tombstones.has(p))){U.next=12;break}return vr.trace("upsertChannel: the conversation is deleted but reappeared again from REST, ignoring",p),U.abrupt("return",null);case 12:return vr.trace("upsertConversation: creating a local conversation object with sid "+p,f),y="".concat(this.configuration.links.conversations,"/").concat(p),k={self:y,messages:"".concat(y,"/Messages"),participants:"".concat(y,"/Participants")},E=new wt(f,p,k,this.configuration,this.services),this.conversations.set(p,E),U.prev=17,U.next=20,E._subscribe();case 20:if(f.status!=="joined"){U.next=23;break}return U.next=23,E._fetchStreams();case 23:U.next=32;break;case 25:if(U.prev=25,U.t0=U.catch(17),U.t0.name==="SyncError"){U.next=29;break}throw U.t0;case 29:return vr.trace("upsertChannel: the conversation is missing some Sync entity(ies), ignoring",p,U.t0),this.conversations.delete(p),U.abrupt("return",null);case 32:return this._registerForEvents(E),this.emit("conversationAdded",E),f.status==="joined"&&(E._setStatus("joined",d),this.emit("conversationJoined",E)),U.abrupt("return",E);case 36:case"end":return U.stop()}},g,this,[[17,25]])}));function v(g,d,p){return _.apply(this,arguments)}return v}()},{key:"_fetchMyConversations",value:function(){var _=X.default(N.default.mark(function g(){var d,p,f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:d=[],p=null;case 2:return m=new Ae(this.configuration.links.myConversations),p&&m.arg("PageToken",p),L.next=6,this.services.network.get(m.build());case 6:y=L.sent,k=(f=y.body)===null||f===void 0?void 0:f.conversations.map(function(U){return{descriptor:U,channel_sid:U.conversation_sid,status:U.status,channel:U.sync_objects.conversation,messages:U.sync_objects.messages,roster:"".concat(U.conversation_sid,".roster"),lastConsumedMessageIndex:U.last_read_message_index,notificationLevel:U.notification_level}}),p=y.body.meta.next_token,d=[].concat(Je.default(d),Je.default(k));case 10:if(p){L.next=2;break}case 11:return L.abrupt("return",d);case 12:case"end":return L.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_onConversationRemoved",value:function(v){var g=this.conversations.get(v);g&&(this.conversations.delete(v),this.emit("conversationRemoved",g))}},{key:"_registerForEvents",value:function(v){var g=this;v.on("removed",function(){return g._onConversationRemoved(v.sid)}),v.on("updated",function(d){return g.emit("conversationUpdated",d)}),v.on("participantJoined",function(d){return g.emit("participantJoined",d)}),v.on("participantLeft",function(d){return g.emit("participantLeft",d)}),v.on("participantUpdated",function(d){return g.emit("participantUpdated",d)}),v.on("messageAdded",function(d){return g.emit("messageAdded",d)}),v.on("messageUpdated",function(d){return g.emit("messageUpdated",d)}),v.on("messageRemoved",function(d){return g.emit("messageRemoved",d)}),v.on("typingStarted",function(d){return g.emit("typingStarted",d)}),v.on("typingEnded",function(d){return g.emit("typingEnded",d)})}}]),S}($.ReplayEventEmitter);function Lo(A){var P=jo();return function(){var _=ue.default(A),v;if(P){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return te.default(this,v)}}function jo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Uo=function(A){ce.default(S,A);var P=Lo(S);function S(_,v,g){var d;return $e.default(this,S),d=P.call(this),d.configuration=v,d.services=g,d.fifoStack=[],d.myself=_,d.myself.on("updated",function(p){return d.emit("userUpdated",p)}),d.myself.on("userSubscribed",function(){return d.emit("userSubscribed",d.myself)}),d.myself.on("userUnsubscribed",function(){d.emit("userUnsubscribed",d.myself),d.myself._ensureFetched()}),d.subscribedUsers=new Map,d}return Ie.default(S,[{key:"handleUnsubscribeUser",value:function(v){this.subscribedUsers.has(v.identity)&&this.subscribedUsers.delete(v.identity);var g=0,d=this.fifoStack.find(function(p,f){return p==v.identity?(g=f,!0):!1});d&&this.fifoStack.splice(g,1),this.emit("userUnsubscribed",v)}},{key:"handleSubscribeUser",value:function(v){if(!this.subscribedUsers.has(v.identity)){if(this.fifoStack.length>=this.configuration.userInfosToSubscribe){var g,d,p=this.fifoStack.shift();(g=this.subscribedUsers)===null||g===void 0||(d=g.get(p))===null||d===void 0||d.unsubscribe()}this.fifoStack.push(v.identity),this.subscribedUsers.set(v.identity,v),this.emit("userSubscribed",v)}}},{key:"getUser",value:function(){var _=X.default(N.default.mark(function g(d,p){var f,m=this,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:return L.next=2,this.myself._ensureFetched();case 2:if(d!=this.myself.identity){L.next=4;break}return L.abrupt("return",this.myself);case 4:if(y=this.subscribedUsers.get(d),!y){L.next=7;break}return L.abrupt("return",y);case 7:if(!((f=p)!==null&&f!==void 0)){L.next=11;break}L.next=14;break;case 11:return L.next=13,this.getSyncUniqueName(d);case 13:p=L.sent;case 14:return k=new Ne(d,p,this.configuration,this.services),k.on("updated",function(U){return m.emit("userUpdated",U)}),k.on("userSubscribed",function(){return m.handleSubscribeUser(k)}),k.on("userUnsubscribed",function(){return m.handleUnsubscribeUser(k)}),L.next=20,k._ensureFetched();case 20:return L.abrupt("return",k);case 21:case"end":return L.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"getSubscribedUsers",value:function(){var _=X.default(N.default.mark(function g(){var d;return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.myself._ensureFetched();case 2:return d=[this.myself],this.subscribedUsers.forEach(function(m){return d.push(m)}),f.abrupt("return",d);case 5:case"end":return f.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getSyncUniqueName",value:function(){var _=X.default(N.default.mark(function g(d){var p,f,m,y;return N.default.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return m=new Ae(this.configuration.links.users).path(d).build(),E.next=3,this.services.network.get(m);case 3:return y=E.sent,E.abrupt("return",(p=(f=y.body)===null||f===void 0?void 0:f.sync_objects.user_info_map)!==null&&p!==void 0?p:"");case 5:case"end":return E.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()}]),S}($.ReplayEventEmitter),_n=Ke.scope("TypingIndicator"),Fo=function(){function A(P,S,_){$e.default(this,A),this.configuration=S,this.services=_,this.getConversation=P,this.serviceTypingTimeout=null,this.sentUpdates=new Map}return Ie.default(A,[{key:"typingTimeout",get:function(){return this.configuration.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.configuration.typingIndicatorTimeoutDefault}},{key:"initialize",value:function(){var S=this;this.services.notificationClient.on("message",function(){var _=X.default(N.default.mark(function v(g,d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(g!==Le.TYPING_INDICATOR){f.next=3;break}return f.next=3,S._handleRemoteTyping(d);case 3:case"end":return f.stop()}},v)}));return function(v,g){return _.apply(this,arguments)}}())}},{key:"_handleRemoteTyping",value:function(){var P=X.default(N.default.mark(function _(v){var g=this;return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:_n.trace("Got new typing indicator ",v),this.getConversation(v.channel_sid).then(function(f){!f||f._participants.forEach(function(m){if(m.identity===v.identity){var y=g.configuration.typingIndicatorTimeoutOverride?g.configuration.typingIndicatorTimeoutOverride+1e3:v.typing_timeout*1e3;m._startTyping(y)}})}).catch(function(f){throw _n.error(f),f});case 2:case"end":return p.stop()}},_,this)}));function S(_){return P.apply(this,arguments)}return S}()},{key:"send",value:function(S){var _=this.sentUpdates.get(S);return _&&_>Date.now()-this.typingTimeout?Promise.resolve():(this.sentUpdates.set(S,Date.now()),this._send(S))}},{key:"_send",value:function(S){var _=this;_n.trace("Sending typing indicator");var v=this.configuration.links.typing,g={"Content-Type":"application/x-www-form-urlencoded"},d="ChannelSid=".concat(S);return this.services.twilsockClient.post(v,g,d,this.configuration.productId).then(function(p){p.body.hasOwnProperty("typing_timeout")&&(_.serviceTypingTimeout=p.body.typing_timeout*1e3)}).catch(function(p){throw _n.error("Failed to send typing indicator:",p),p})}}]),A}(),Nr=Ie.default(function A(P){$e.default(this,A),this.title=P.title||null,this.body=P.body||null,this.sound=P.sound||null,this.badge=P.badge||null,this.action=P.action||null,this.type=P.type||null,this.data=P.data||{}}),La="2.2.0";function Ti(A,P){var S=Object.keys(A);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(A);P&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(A,v).enumerable})),S.push.apply(S,_)}return S}function Do(A){for(var P=1;P<arguments.length;P++){var S=arguments[P]!=null?arguments[P]:{};P%2?Ti(Object(S),!0).forEach(function(_){ie.default(A,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(S)):Ti(Object(S)).forEach(function(_){Object.defineProperty(A,_,Object.getOwnPropertyDescriptor(S,_))})}return A}var ms=function(P){return P.replace(/(^\/+|\/+$)/g,"")},Bo=function(P){return P.status.code===202},qo=function(){function A(P,S,_){$e.default(this,A),this._serviceUrl=P,this._services=S,this._productId=_}return Ie.default(A,[{key:"_preProcessUrl",value:function(S){var _=ms(S);return/^https?:\/\//.test(S)?_:"".concat(ms(this._serviceUrl),"/").concat(_)}},{key:"_makeRequest",value:function(){var P=X.default(N.default.mark(function _(v,g,d,p){var f,m,y,k;return N.default.wrap(function(L){for(;;)switch(L.prev=L.next){case 0:f=this._preProcessUrl(g),m=Do({"Content-Type":"application/json; charset=utf-8"},p||{}),L.t0=v,L.next=L.t0==="get"?5:L.t0==="post"?11:L.t0==="delete"?15:19;break;case 5:return k=f,d&&(k+="?"+Object.entries(d).map(function(U){return U.map(encodeURIComponent).join("=")}).join("&")),L.next=9,this._services.transport.get(k,m,this._productId);case 9:return y=L.sent,L.abrupt("break",19);case 11:return L.next=13,this._services.transport.post(f,m,JSON.stringify(d),this._productId);case 13:return y=L.sent,L.abrupt("break",19);case 15:return L.next=17,this._services.transport.delete(f,m,{},this._productId);case 17:return y=L.sent,L.abrupt("break",19);case 19:if(!(y.status.code<200||y.status.code>=300)){L.next=21;break}throw new Error("Request responded with a non-success code ".concat(y.status.code));case 21:return L.abrupt("return",y);case 22:case"end":return L.stop()}},_,this)}));function S(_,v,g,d){return P.apply(this,arguments)}return S}()},{key:"fetchResource",value:function(){var P=X.default(N.default.mark(function _(v,g){var d=this,p,f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return p=6,y.prev=1,y.next=4,new j.AsyncRetrier({min:50,max:1600,maxAttemptsCount:p}).run(function(){return d._makeRequest("get",v,g)});case 4:return f=y.sent,y.abrupt("return",f.body);case 8:throw y.prev=8,y.t0=y.catch(1),new Error('Fetch resource from "'.concat(v,'" failed.'));case 11:case"end":return y.stop()}},_,null,[[1,8]])}));function S(_,v){return P.apply(this,arguments)}return S}()},{key:"mutateResource",value:function(){var P=X.default(N.default.mark(function _(v,g,d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._makeRequest(v,g,d,{"X-Twilio-Mutation-Id":x.v4()});case 2:if(p=m.sent,!Bo(p)){m.next=7;break}return m.next=6,this.fetchResource(p.body.resource_url);case 6:return m.abrupt("return",m.sent);case 7:return m.abrupt("return",p.body);case 8:case"end":return m.stop()}},_,this)}));function S(_,v,g){return P.apply(this,arguments)}return S}()}]),A}(),pt;function bs(A,P){var S=Object.keys(A);if(Object.getOwnPropertySymbols){var _=Object.getOwnPropertySymbols(A);P&&(_=_.filter(function(v){return Object.getOwnPropertyDescriptor(A,v).enumerable})),S.push.apply(S,_)}return S}function ja(A){for(var P=1;P<arguments.length;P++){var S=arguments[P]!=null?arguments[P]:{};P%2?bs(Object(S),!0).forEach(function(_){ie.default(A,_,S[_])}):Object.getOwnPropertyDescriptors?Object.defineProperties(A,Object.getOwnPropertyDescriptors(S)):bs(Object(S)).forEach(function(_){Object.defineProperty(A,_,Object.getOwnPropertyDescriptor(S,_))})}return A}function ki(A){var P=na();return function(){var _=ue.default(A),v;if(P){var g=ue.default(this).constructor;v=Reflect.construct(_,arguments,g)}else v=_.apply(this,arguments);return te.default(this,v)}}function na(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dt,ws=Ie.default(function A(){$e.default(this,A)});e.Client=dt=(pt=function(A){ce.default(S,A);var P=ki(S);function S(_){var v,g,d,p,f,m,y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if($e.default(this,S),m=P.call(this),ie.default(xe.default(m),"version",La),ie.default(xe.default(m),"connectionState","unknown"),ie.default(xe.default(m),"parsePushNotification",dt.parsePushNotification),m._fpaToken=_!=null?_:"",m._options=y!=null?y:{},!m._options.disableDeepClone){var k=ja(ja({},m._options),{},{transport:void 0,twilsockClient:void 0});k=Ce(k),k.transport=m._options.transport,k.twilsockClient=m._options.twilsockClient,m._options=k}m._options.logLevel=(v=m._options.logLevel)!==null&&v!==void 0?v:"silent",dt._logger.setLevel(m._options.logLevel);var E=m._options.productId="ip_messaging";if(m._options.clientMetadata=m._options.clientMetadata||{},m._options.clientMetadata.hasOwnProperty("type")||(m._options.clientMetadata.type="conversations"),m._options.clientMetadata.hasOwnProperty("sdk")||(m._options.clientMetadata.sdk="JS",m._options.clientMetadata.sdkv=La),m._options.Sync=m._options.Sync||{},typeof m._options.Sync.enableSessionStorage>"u"&&(m._options.Sync.enableSessionStorage=!0),m._options.region&&(m._options.Sync.region=m._options.region),!_)throw new Error("A valid Twilio token should be provided");m._services=new ws,m._myself=new Ne("","",null,m._services);var L=!m._options.twilsockClient;if(!m._options.initRegistrations){var U=new D.InitRegistration(E);dt.populateInitRegistrations(U),m._options.initRegistrations=[U]}m._services.twilsockClient=m._options.twilsockClient=(g=m._options.twilsockClient)!==null&&g!==void 0?g:new D.TwilsockClient(_,E,m._options),m._services.twilsockClient.on("tokenAboutToExpire",function(){return m.emit("tokenAboutToExpire")}),m._services.twilsockClient.on("tokenExpired",function(){return m.emit("tokenExpired")}),m._services.twilsockClient.on("connectionError",function(ur){return m.emit("connectionError",ur)}),m._services.twilsockClient.on("stateChanged",function(ur){dt._logger.debug("Handling stateChanged for ConversationsClient: new state ".concat(ur)),ur!==m.connectionState&&(m.connectionState=ur,m.emit("connectionStateChanged",m.connectionState))}),m._services.transport=m._options.transport=(d=m._options.transport)!==null&&d!==void 0?d:m._options.twilsockClient,m._services.notificationClient=m._options.notificationsClient=(p=m._options.notificationsClient)!==null&&p!==void 0?p:new ve.Notifications(_,m._options),m._services.syncClient=m._options.syncClient=(f=m._options.syncClient)!==null&&f!==void 0?f:new se.SyncClient(_,m._options);var ke=(y==null?void 0:y.Chat)||(y==null?void 0:y.IPMessaging)||y||{},Ye=ke.region||(y==null?void 0:y.region),Lt=ke.apiUri||ke.typingUri||"https://aim.".concat(Ye||"us1",".twilio.com");m._services.commandExecutor=new qo(Lt,{transport:m._options.transport},E);var Ze=function(Cr){m._rejectEnsureReady(Cr),m.emit("stateChanged","failed"),m.emit("initFailed",{error:Cr})},hr=function(){Ze({terminal:!0,message:"Twilsock has disconnected."})};return m._services.twilsockClient.once("connectionError",Ze),m._services.twilsockClient.once("disconnected",hr),m._services.twilsockClient.once("connected",X.default(N.default.mark(function ur(){var Cr,M;return N.default.wrap(function(ne){for(;;)switch(ne.prev=ne.next){case 0:return dt._logger.debug("ConversationsClient started INITIALIZING"),m._services.twilsockClient.off("connectionError",Ze),m._services.twilsockClient.off("disconnected",hr),ne.prev=3,Cr="conversations.client.startup",m._services.twilsockClient.addPartialTelemetryEvent(new D.TelemetryEventDescription(Cr,"Conversations client startup",new Date),Cr,D.TelemetryPoint.Start),ne.next=8,m._initialize();case 8:m._services.twilsockClient.addPartialTelemetryEvent(new D.TelemetryEventDescription("","",new Date),Cr,D.TelemetryPoint.End),ne.next=17;break;case 11:ne.prev=11,ne.t0=ne.catch(3),M={terminal:!0,message:ne.t0.message},m._rejectEnsureReady(M),m.emit("stateChanged","failed"),m.emit("initFailed",{error:M});case 17:case"end":return ne.stop()}},ur,null,[[3,11]])}))),m._ensureReady=new Promise(function(ur,Cr){m._resolveEnsureReady=ur,m._rejectEnsureReady=Cr}).catch(function(){}),L&&m._services.twilsockClient.connect(),m}return Ie.default(S,[{key:"user",get:function(){return this._myself}},{key:"reachabilityEnabled",get:function(){if(!this._configuration)throw new Error("Reachability information could not yet be accessed as the client has not yet been initialized. Subscribe to the 'stateChanged' event to properly react to the client initialization.");return this._configuration.reachabilityEnabled}},{key:"token",get:function(){return this._fpaToken}},{key:"shutdown",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._ensureReady;case 2:return p.next=4,this._services.twilsockClient.disconnect();case 4:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"updateToken",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:if(dt._logger.info("updateToken"),this._fpaToken!==d){f.next=5;break}return f.abrupt("return",this);case 5:return f.next=7,this._services.twilsockClient.updateToken(d);case 7:return f.next=9,this._services.notificationClient.updateToken(d);case 9:return f.next=11,this._services.mcsClient.updateToken(d);case 11:return this._fpaToken=d,f.abrupt("return",this);case 13:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getConversationBySid",value:function(){var _=X.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return m.next=4,this._conversationsEntity.myConversationsRead.promise;case 4:return m.next=6,this._conversationsEntity.getConversation(d);case 6:if(p=m.sent,p){m.next=12;break}return le.deprecationWarning("The method getConversationBySid is deprecated to retrieve conversations you're not part of. Use peekConversationBySid instead."),m.next=11,this.peekConversationBySid(d);case 11:p=m.sent;case 12:if(p){m.next=14;break}throw new Error("Conversation with SID ".concat(d," was not found."));case 14:return m.abrupt("return",p);case 15:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"peekConversationBySid",value:function(){var _=X.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return m.next=4,this._conversationsEntity.peekConversation(d);case 4:if(p=m.sent,p){m.next=7;break}throw new Error("Conversation with SID ".concat(d," was not found."));case 7:return m.abrupt("return",p);case 8:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getConversationByUniqueName",value:function(){var _=X.default(N.default.mark(function g(d){var p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return m.next=4,this._conversationsEntity.myConversationsRead.promise;case 4:return m.next=6,this._conversationsEntity.getConversationByUniqueName(d);case 6:if(p=m.sent,p){m.next=9;break}throw new Error("Conversation with unique name ".concat(d," was not found."));case 9:return m.abrupt("return",p);case 10:case"end":return m.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getSubscribedConversations",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._ensureReady;case 2:return p.abrupt("return",this._conversationsPromise.then(function(f){return f.getConversations()}));case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"createConversation",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:return d=d||{},f.abrupt("return",this._conversationsPromise.then(function(m){return m.addConversation(d)}));case 4:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"setPushRegistrationId",value:function(){var _=X.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._ensureReady;case 2:return this._subscribeToPushNotifications(d),this._services.notificationClient.setPushRegistrationId(d,p),m.next=6,this._services.notificationClient.commitChanges();case 6:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"unsetPushRegistrationId",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:return this._unsubscribeFromPushNotifications(d),f.next=5,this._services.notificationClient.commitChanges();case 5:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"removePushRegistrations",value:function(){var _=X.default(N.default.mark(function g(d,p){return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._services.notificationClient.removeRegistrations(d,p);case 2:case"end":return m.stop()}},g,this)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"handlePushNotification",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:dt._logger.debug("handlePushNotification, notificationPayload=",d),this.emit("pushNotification",dt.parsePushNotification(d));case 4:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getUser",value:function(){var _=X.default(N.default.mark(function g(d){return N.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this._ensureReady;case 2:return f.abrupt("return",this._services.users.getUser(d));case 3:case"end":return f.stop()}},g,this)}));function v(g){return _.apply(this,arguments)}return v}()},{key:"getSubscribedUsers",value:function(){var _=X.default(N.default.mark(function g(){return N.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return p.next=2,this._ensureReady;case 2:return p.abrupt("return",this._services.users.getSubscribedUsers());case 3:case"end":return p.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"getTemporaryContentUrlsForMediaSids",value:function(v){var g=this;return new Pe.CancellablePromise(function(){var d=X.default(N.default.mark(function p(f,m,y){var k,E;return N.default.wrap(function(U){for(;;)switch(U.prev=U.next){case 0:if(!(!g._services.mcsClient||!v)){U.next=3;break}return m(new Error("Media Content Service is unavailable")),U.abrupt("return");case 3:return k=g._services.mcsClient.mediaSetGetContentUrls(v),y(function(){k.cancel()}),U.prev=5,U.next=8,k;case 8:E=U.sent,f(E),U.next=15;break;case 12:U.prev=12,U.t0=U.catch(5),m(U.t0);case 15:case"end":return U.stop()}},p,null,[[5,12]])}));return function(p,f,m){return d.apply(this,arguments)}}())}},{key:"getTemporaryContentUrlsForMedia",value:function(v){var g=v.map(function(d){return d.sid});return this.getTemporaryContentUrlsForMediaSids(g)}},{key:"_initialize",value:function(){var _=X.default(N.default.mark(function g(){var d=this,p;return N.default.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.next=2,this._services.commandExecutor.fetchResource("Client/v2/Configuration");case 2:return p=m.sent,this._configuration=new be(this._options,p,dt._logger),this._myself._resolveInitialization(this._configuration,this._configuration.userIdentity,this._configuration.userInfo,!0),this._services.typingIndicator=new Fo(this.getConversationBySid.bind(this),this._configuration,this._services),this._services.network=new He(this._configuration,this._services),this._services.users=new Uo(this._myself,this._configuration,this._services),this._services.users.on("userSubscribed",function(y){d.emit("userSubscribed",y)}),this._services.users.on("userUpdated",function(y){return d.emit("userUpdated",y)}),this._services.users.on("userUnsubscribed",function(y){d.emit("userUnsubscribed",y)}),this._conversationsEntity=new No(this._configuration,this._services),this._conversationsEntity.on("conversationAdded",function(y){d.emit("conversationAdded",y)}),this._conversationsEntity.on("conversationRemoved",function(y){d.emit("conversationRemoved",y)}),this._conversationsEntity.on("conversationJoined",function(y){d.emit("conversationJoined",y)}),this._conversationsEntity.on("conversationLeft",function(y){d.emit("conversationLeft",y)}),this._conversationsEntity.on("conversationUpdated",function(y){return d.emit("conversationUpdated",y)}),this._conversationsEntity.on("participantJoined",function(y){d.emit("participantJoined",y)}),this._conversationsEntity.on("participantLeft",function(y){d.emit("participantLeft",y)}),this._conversationsEntity.on("participantUpdated",function(y){return d.emit("participantUpdated",y)}),this._conversationsEntity.on("messageAdded",function(y){return d.emit("messageAdded",y)}),this._conversationsEntity.on("messageUpdated",function(y){return d.emit("messageUpdated",y)}),this._conversationsEntity.on("messageRemoved",function(y){return d.emit("messageRemoved",y)}),this._conversationsEntity.on("typingStarted",function(y){return d.emit("typingStarted",y)}),this._conversationsEntity.on("typingEnded",function(y){return d.emit("typingEnded",y)}),this._conversationsPromise=this._conversationsEntity.fetchConversations().then(function(){return d._conversationsEntity}).catch(function(y){throw y}),m.next=28,this._services.users.myself._ensureFetched();case 28:dt._supportedPushChannels.forEach(function(y){return d._subscribeToPushNotifications(y)}),this._services.typingIndicator.initialize(),this._services.mcsClient=new Pe.McsClient(this._fpaToken,this._configuration.links.mediaService,this._configuration.links.mediaSetService,ja(ja({},this._options),{},{transport:void 0})),this._resolveEnsureReady(),this.emit("stateChanged","initialized"),this.emit("initialized");case 34:case"end":return m.stop()}},g,this)}));function v(){return _.apply(this,arguments)}return v}()},{key:"_subscribeToPushNotifications",value:function(v){var g=this;[Le.NEW_MESSAGE,Le.ADDED_TO_CONVERSATION,Le.REMOVED_FROM_CONVERSATION,Le.TYPING_INDICATOR,Le.CONSUMPTION_UPDATE].forEach(function(d){g._services.notificationClient.subscribe(v,d)})}},{key:"_unsubscribeFromPushNotifications",value:function(v){var g=this;[Le.NEW_MESSAGE,Le.ADDED_TO_CONVERSATION,Le.REMOVED_FROM_CONVERSATION,Le.TYPING_INDICATOR,Le.CONSUMPTION_UPDATE].forEach(function(d){g._services.notificationClient.unsubscribe(v,d)})}}],[{key:"create",value:function(){var _=X.default(N.default.mark(function g(d,p){var f;return N.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(p!=null&&p.twilsockClient)){y.next=2;break}throw new Error("Obsolete usage of ConversationsClient.create() factory method: if you pass twilsock from the outside then you must use ConversationsClient constructor and be prepared to work with uninitialized client.");case 2:return f=new dt(d,p),y.next=5,f._ensureReady;case 5:return y.abrupt("return",f);case 6:case"end":return y.stop()}},g)}));function v(g,d){return _.apply(this,arguments)}return v}()},{key:"parsePushNotification",value:function(v){if(dt._logger.debug("parsePushNotification, notificationPayload=",v),typeof v.aps<"u"){if(!v.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var g=dt._parsePushNotificationChatData(v),d=v.aps,p,f=null;if(typeof d.alert=="string")p=d.alert||null;else{var m,y;p=((m=d.alert)===null||m===void 0?void 0:m.body)||null,f=((y=d.alert)===null||y===void 0?void 0:y.title)||null}return new Nr({title:f,body:p,sound:d.sound||null,badge:d.badge||null,action:d.category||null,type:v.twi_message_type,data:g})}if(typeof v.data<"u"){var k=v.data;if(!k.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var E=dt._parsePushNotificationChatData(v.data);return new Nr({title:k.twi_title||null,body:k.twi_body||null,sound:k.twi_sound||null,badge:null,action:k.twi_action||null,type:k.twi_message_type,data:E})}throw new Error("Provided push notification payload is not Programmable Chat notification")}},{key:"_parsePushNotificationChatData",value:function(v){var g={};for(var d in dt._supportedPushDataFields){var p=v[d];if(!(typeof p>"u"||p===null)){if(d==="message_index"||d==="media_count"){var f=Q(p);f!==null&&(g[dt._supportedPushDataFields[d]]=f);continue}if(d==="media"){if(typeof p=="string")try{g[dt._supportedPushDataFields[d]]=JSON.parse(p)}catch{dt._logger.debug("Media message notification parsing error")}continue}g[dt._supportedPushDataFields[d]]=p}}return g}},{key:"populateInitRegistrations",value:function(v){v.populateInitRegistrations([Le.TYPING_INDICATOR]),se.SyncClient.populateInitRegistrations(v)}}]),S}($.ReplayEventEmitter),ie.default(pt,"conversationAdded","conversationAdded"),ie.default(pt,"conversationJoined","conversationJoined"),ie.default(pt,"conversationLeft","conversationLeft"),ie.default(pt,"conversationRemoved","conversationRemoved"),ie.default(pt,"conversationUpdated","conversationUpdated"),ie.default(pt,"participantJoined","participantJoined"),ie.default(pt,"participantLeft","participantLeft"),ie.default(pt,"participantUpdated","participantUpdated"),ie.default(pt,"messageAdded","messageAdded"),ie.default(pt,"messageRemoved","messageRemoved"),ie.default(pt,"messageUpdated","messageUpdated"),ie.default(pt,"tokenAboutToExpire","tokenAboutToExpire"),ie.default(pt,"tokenExpired","tokenExpired"),ie.default(pt,"typingEnded","typingEnded"),ie.default(pt,"typingStarted","typingStarted"),ie.default(pt,"pushNotification","pushNotification"),ie.default(pt,"userSubscribed","userSubscribed"),ie.default(pt,"userUnsubscribed","userUnsubscribed"),ie.default(pt,"userUpdated","userUpdated"),ie.default(pt,"stateChanged","stateChanged"),ie.default(pt,"initialized","initialized"),ie.default(pt,"initFailed","initFailed"),ie.default(pt,"connectionStateChanged","connectionStateChanged"),ie.default(pt,"connectionError","connectionError"),ie.default(pt,"version",La),ie.default(pt,"_logger",Ke.scope("Client")),ie.default(pt,"_supportedPushChannels",["fcm","apn"]),ie.default(pt,"_supportedPushDataFields",{conversation_sid:"conversationSid",conversation_title:"conversationTitle",message_sid:"messageSid",message_index:"messageIndex",media_count:"mediaCount",media:"media"}),pt),B([le.deprecated("token"),T("design:type",String),T("design:paramtypes",[])],e.Client.prototype,"token",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"updateToken",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"getConversationBySid",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"peekConversationBySid",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"getConversationByUniqueName",null),B([b.validateTypesAsync(["undefined",b.objectSchema("conversation options",{friendlyName:["string","undefined"],isPrivate:["boolean","undefined"],uniqueName:["string","undefined"]})]),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],e.Client.prototype,"createConversation",null),B([b.validateTypesAsync(b.literal("fcm","apn"),"string"),T("design:type",Function),T("design:paramtypes",[String,String]),T("design:returntype",Promise)],e.Client.prototype,"setPushRegistrationId",null),B([b.validateTypesAsync(b.literal("fcm","apn")),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"unsetPushRegistrationId",null),B([b.validateTypesAsync(b.literal("fcm","apn"),b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String,String]),T("design:returntype",Promise)],e.Client.prototype,"removePushRegistrations",null),B([b.validateTypesAsync(b.pureObject),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Promise)],e.Client.prototype,"handlePushNotification",null),B([b.validateTypesAsync(b.nonEmptyString),T("design:type",Function),T("design:paramtypes",[String]),T("design:returntype",Promise)],e.Client.prototype,"getUser",null),B([b.validateTypesAsync(b.nonEmptyArray("strings","string")),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Pe.CancellablePromise)],e.Client.prototype,"getTemporaryContentUrlsForMediaSids",null),B([b.validateTypesAsync(b.nonEmptyArray("media",Ve)),T("design:type",Function),T("design:paramtypes",[Array]),T("design:returntype",Pe.CancellablePromise)],e.Client.prototype,"getTemporaryContentUrlsForMedia",null),B([le.deprecated("Client.create()","new Client()"),b.validateTypesAsync("string",["undefined",b.pureObject]),T("design:type",Function),T("design:paramtypes",[String,Object]),T("design:returntype",Promise)],e.Client,"create",null),B([b.validateTypes(b.pureObject),T("design:type",Function),T("design:paramtypes",[Object]),T("design:returntype",Nr)],e.Client,"parsePushNotification",null),e.Client=dt=B([b.validateConstructorTypes(b.nonEmptyString,[b.pureObject,"undefined"]),T("design:paramtypes",[String,Object])],e.Client),Object.defineProperty(e,"CancellablePromise",{enumerable:!0,get:function(){return Pe.CancellablePromise}}),e.AggregatedDeliveryReceipt=at,e.Conversation=wt,e.DetailedDeliveryReceipt=We,e.Media=Ve,e.Message=Zt,e.MessageBuilder=hs,e.NotificationTypes=Le,e.Participant=z,e.PushNotification=Nr,e.RestPaginator=tt,e.UnsentMessage=xr,e.User=Ne})(Z$);function nZ(e){let t=new Date(e);return`${t.getMonth()+1}/${t.getDate()} @ ${t.getHours()}:${String(t.getMinutes()).padStart(2,"0")}`}function aZ(e){return e.replace("EndUser:","")}const iZ={props:["author","content","dateCreated","cSid","media"],setup(e){const t=e.author,r=e.content,n=e.dateCreated,a=e.cSid,i=e.media,s=bt({id:null,title:null,options:[]}),u=()=>{let I=r.split(/\[\]/);s.value.id=I[1],s.value.title=I[2],console.log("parseArray[3] => ",I[3]);let j=I[3].split(/\#/);console.log("optionsArray.length => ",j.length);for(let D=0;D<j.length;D++){let ve=j[D].split(/\|/),se={label:ve[0],value:ve[1],style:ve[2]};s.value.options.push(se)}},o=rr(()=>(console.log("content => ",r),r!=null&&r.includes("**chatButton**")?(u(),!0):!1)),l=rr(()=>!!(t.startsWith("+")||t.startsWith("whatsapp")||t.startsWith("EndUser:"))),c=rr(()=>!!t.startsWith("EndUser:")),h=rr(()=>t===a),w=rr(()=>r===null&&i!==null),b=bt("/placeholder.png"),$=async I=>{try{let j=`/conversations/conversation-message-media-url?mediaSid=${I}`;const D=await fetch(j,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(D.ok){let ve=await D.json();console.log("getMediaUrl response ==> ",ve),b.value=ve.contentUrl}}catch(j){console.log("getMediaUrl error => ",j)}};xh(()=>{console.log("In Message Component..."),console.log("Media => ",i)}),Nh(async()=>{if(r===null&&i!==null){let I=null,j=mt(i);j[0]!==void 0?I=j[0].sid:j.state!==void 0&&(I=j.state.sid),I!=null&&await $(I)}});function C(I,j,D){alert(`id is ${I} and question is ${j} and answer is ${D}!`)}return{author:t,content:r,media:i,dateCreated:n,isEndUserChat:c,isCustomer:l,isBot:h,isMedia:w,isButtonMessage:o,buttonConfig:s,formatDate:nZ,formatAuthor:aZ,imageUrl:b,answerQuestion:C}}},sZ={key:0},oZ={key:0,class:"text-start mb-2"},uZ={key:0,class:"text-start mb-2"},lZ={class:"fs-4 fw-bold badge bg-light text-dark text-wrap text-start"},cZ=he("i",{class:"bi-phone"},null,-1),fZ={key:0,class:"ms-2"},dZ={key:1},pZ=["src"],vZ=he("br",null,null,-1),hZ={class:"fst-italic"},yZ={key:1,class:"text-start mb-2"},gZ={class:"fs-4 fw-bold badge bg-light text-dark text-wrap text-start"},mZ=he("i",{class:"bi-person-workspace"},null,-1),bZ={key:0,class:"ms-2"},wZ={key:1},_Z=["src"],SZ=he("br",null,null,-1),$Z={class:"fst-italic"},TZ={key:1},kZ={key:0,class:"text-end mb-2"},EZ={class:"fs-4 fw-bold badge bg-secondary text-wrap text-end"},IZ=he("i",{class:"bi-robot"},null,-1),CZ=he("br",null,null,-1),RZ={class:"fst-italic"},AZ={key:1,class:"text-end mb-2"},OZ={class:"fs-4 fw-bold badge bg-success text-wrap text-end"},PZ=he("i",{class:"bi-person-workspace"},null,-1),MZ={key:0,class:"ms-2"},xZ={key:1},NZ=["src"],LZ=he("br",null,null,-1),jZ={class:"fst-italic"},UZ={key:1,class:"mb-5"},FZ={class:"btn-group d-flex",role:"group","aria-label":"..."},DZ=["onClick"];function BZ(e,t,r,n,a,i){return _t(),Ut("div",null,[n.isButtonMessage?gr("",!0):(_t(),Ut("div",sZ,[n.isCustomer?(_t(),Ut("div",oZ,[n.isEndUserChat?gr("",!0):(_t(),Ut("div",uZ,[he("span",lZ,[cZ,n.isMedia?gr("",!0):(_t(),Ut("span",fZ,Ar(n.content),1)),n.isMedia?(_t(),Ut("span",dZ,[he("img",{src:n.imageUrl,style:{"max-height":"300px","max-width":"300px"},class:"ms-2 img-fluid rounded"},null,8,pZ)])):gr("",!0)]),vZ,he("small",null,[he("span",hZ,Ar(n.author)+" - "+Ar(n.formatDate(n.dateCreated)),1)])])),n.isEndUserChat?(_t(),Ut("div",yZ,[he("span",gZ,[mZ,n.isMedia?gr("",!0):(_t(),Ut("span",bZ,Ar(n.content),1)),n.isMedia?(_t(),Ut("span",wZ,[he("img",{src:n.imageUrl,style:{"max-height":"300px","max-width":"300px"},class:"ms-2 img-fluid rounded"},null,8,_Z)])):gr("",!0)]),SZ,he("small",null,[he("span",$Z,Ar(n.formatAuthor(n.author))+" - "+Ar(n.formatDate(n.dateCreated)),1)])])):gr("",!0)])):gr("",!0),n.isCustomer?gr("",!0):(_t(),Ut("div",TZ,[n.isBot?(_t(),Ut("div",kZ,[he("span",EZ,[Jt(Ar(n.content)+" ",1),IZ]),CZ,he("small",null,[he("span",RZ,"Webhook - "+Ar(n.formatDate(n.dateCreated)),1)])])):gr("",!0),n.isBot?gr("",!0):(_t(),Ut("div",AZ,[he("span",OZ,[PZ,n.isMedia?gr("",!0):(_t(),Ut("span",MZ,Ar(n.content),1)),n.isMedia?(_t(),Ut("span",xZ,[he("img",{src:n.imageUrl,style:{"max-height":"300px","max-width":"300px"},class:"ms-2 img-fluid rounded"},null,8,NZ)])):gr("",!0)]),LZ,he("small",null,[he("span",jZ,Ar(n.author)+" - "+Ar(n.formatDate(n.dateCreated)),1)])]))]))])),n.isButtonMessage?(_t(),Ut("div",UZ,[he("h5",null,Ar(n.buttonConfig.title),1),he("div",FZ,[(_t(!0),Ut(jr,null,v$(n.buttonConfig.options,s=>(_t(),Ut("button",{key:s.value,class:zc(["btn",[s.style]]),onClick:u=>n.answerQuestion(n.buttonConfig.id,n.buttonConfig.title,s.value)},Ar(s.label),11,DZ))),128))])])):gr("",!0)])}const qZ=go(iZ,[["render",BZ]]),HZ={class:"container"},WZ={class:"row row-height mt-2"},GZ=he("div",{class:"col-1 pb-5"},"\xA0",-1),zZ={class:"col-10 pb-5"},VZ={class:"pb-5"},KZ={key:0},YZ={class:"alert alert-danger"},JZ=he("i",{class:"bi-plug"},null,-1),QZ=Jt(" Connect"),XZ=[JZ,QZ],ZZ=he("h5",{class:"alert-heading"},"Not Connected",-1),eee=Jt(" Trouble connecting? "),tee=Jt("Refresh Token"),ree=he("p",null,[he("b",null,"Your token has expired!")],-1),nee=he("i",{class:"bi-recycle"},null,-1),aee=Jt(" Refresh Token "),iee=[nee,aee],see={class:"spinner-border text-info mt-5",role:"status"},oee=he("span",{class:"visually-hidden"},"Loading...",-1),uee=[oee],lee={class:"alert alert-danger"},cee=he("h2",{class:"alert-heading mb-3"},"This conversation has ended!",-1),fee=he("h5",{class:"alert-heading mb-5"}," You can return to the home page to start a new Conversation. ",-1),dee=he("i",{class:"bi-house"},null,-1),pee=Jt(" Home "),vee={key:0,class:"alert alert-primary"},hee={class:"input-group"},yee=he("i",{class:"bi-lightning"},null,-1),gee=Jt(" SEND"),mee=[yee,gee],bee={class:"mt-1 text-end"},wee=he("i",{class:"bi-image"},null,-1),_ee=Jt(" Send Image "),See=[wee,_ee],$ee={class:"mt-3"},Tee={class:"text-end"},kee={class:"bg-warning rounded",style:{"min-height":"200px"}},Eee={ref:"messagesDiv",class:"container-fluid pt-3 pb-3"},Iee={class:"float-end"},Cee={__name:"Conversation",setup(e){const t=X$(),r=IO(),n=r.params.sid?r.params.sid:"Not Found",a=bt([]),i=ts({details:{}}),s=bt(!0),u=bt(!1),o=bt(!1),l=bt(!1),c=bt(!1),h=bt("");bt(!1),bt(""),bt(!1),bt(""),bt("");let w=null,b=null;bt(!0),bt(""),bt("");const $=async()=>{try{w=await new Z$.Client(t.endUser.accessToken)}catch(le){console.log("failed to connect to conversation => ",le);return}if(console.log("in connectToConversation and conversationsClient => ",w),w.connectionState==="denied"){C();return}w.on("initialized",async()=>{console.log("conversationsClient => ",w);try{b=await w.getConversationBySid(n)}catch(le){console.log("failed to getConversation => ",le),u.value=!0,l.value=!0,t.logout();return}console.log("twilioConversation => ",b),u.value=!0,b.on("messageAdded",le=>{console.log("message ==> ",le),a.value.unshift(le)})}),w.on("tokenExpired",le=>{console.log("Token Expired!"),u.value=!1,o.value=!0}),w.on("disconnected",le=>{console.log("Conversations disconnected!"),u.value=!1,o.value=!0}),w.on("conversationRemoved",le=>{console.log("Conversations removed!"),l.value=!0,t.logout()})},C=async()=>{console.log("in refreshToken..."),c.value=!0;try{await t.getToken(),await $(),c.value=!1}catch(le){console.log("failed to refresh token => ",le)}},I=async()=>{let le=h.value;h.value="...",await b.sendMessage(le),h.value="",console.log("Sent Message...")},j=bt(!1),D=bt(null),ve=async()=>{const le={contentType:D.value.files[0].type,filename:D.value.files[0].name,media:D.value.files[0]};await b.prepareMessage().addMedia(le).build().send(),j.value=!1,D.value=bt(null)},se=async()=>{try{let le=`/conversations/conversation-details?sid=${n}`;const x=await fetch(le,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(x.ok){let re=await x.json();console.log("in getConversationDetails and r => ",re),i.details=re}}catch(le){console.log("getConversationDetails error => ",le)}},Pe=async()=>{try{let le=`/conversations/conversation-messages?sid=${n}`;const x=await fetch(le,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(x.ok){let re=await x.json();console.log("getConversationMessages response ==> ",re),a.value=re.reverse()}}catch(le){console.log("getConversationMessages error => ",le)}},Me=async()=>{await se(),await Pe()};return xh(async()=>{await Me(),await $()}),(le,x)=>{const re=oi("router-link");return _t(),Ut("div",HZ,[he("div",WZ,[GZ,he("div",zZ,[he("div",VZ,[s.value?(_t(),Ut("div",KZ,[Mt(he("div",YZ,[Mt(he("button",{type:"button",class:"btn btn-sm btn-danger float-end",onClick:x[0]||(x[0]=de=>$())},XZ,512),[[Ft,!o.value]]),ZZ,Mt(he("p",null,"Connecting automatically...",512),[[Ft,!o.value]]),Mt(he("p",null,[eee,Ht(re,{to:"/"},{default:si(()=>[tee]),_:1})],512),[[Ft,!o.value]]),Mt(he("div",null,[ree,Mt(he("button",{class:"btn btn-lg btn-danger",onClick:x[1]||(x[1]=de=>C())},iee,512),[[Ft,!c.value]]),Mt(he("div",see,uee,512),[[Ft,c.value]])],512),[[Ft,o.value]])],512),[[Ft,!u.value]]),Mt(he("div",lee,[cee,fee,Ht(re,{class:"btn btn-primary",to:"/"},{default:si(()=>[dee,pee]),_:1})],512),[[Ft,u.value&&l.value]]),u.value&&!l.value?(_t(),Ut("div",vee,[he("form",{onSubmit:x[5]||(x[5]=fA((...de)=>le.submitForm&&le.submitForm(...de),["prevent"]))},[he("div",hee,[Mt(he("input",{onKeyup:x[2]||(x[2]=pA(de=>I(),["enter"])),type:"text",class:"form-control","onUpdate:modelValue":x[3]||(x[3]=de=>h.value=de),"aria-describedby":"btnGroupAddon"},null,544),[[A$,h.value]]),he("button",{type:"button",class:"btn btn-primary",onClick:x[4]||(x[4]=de=>I())},mee)])],32),Mt(he("div",bee,[he("button",{onClick:x[6]||(x[6]=de=>j.value=!0),class:"btn btn-sm btn-link"},See)],512),[[Ft,!j.value]]),Mt(he("div",$ee,[he("input",{ref_key:"file",ref:D,onChange:x[7]||(x[7]=de=>ve()),class:"form-control form-control-sm",id:"formFileSm",type:"file"},null,544)],512),[[Ft,j.value]]),Mt(he("div",Tee,[he("button",{onClick:x[8]||(x[8]=de=>j.value=!1),class:"btn btn-sm btn-link"}," Cancel ")],512),[[Ft,j.value]])])):gr("",!0)])):gr("",!0),he("div",kee,[he("div",Eee,[(_t(!0),Ut(jr,null,v$(a.value,de=>(_t(),yo(qZ,{key:de.sid,dateCreated:de.dateCreated,author:de.author,content:de.body,cSid:i.details.sid,media:de.media},null,8,["dateCreated","author","content","cSid","media"]))),128))],512)]),he("p",Iee,[he("em",null,Ar(i.details.sid),1)])])])])])}}},Ree={name:"App",components:{Layout:V$,Conversation:Cee}};function Aee(e,t,r,n,a,i){const s=oi("Conversation"),u=oi("Layout");return _t(),yo(u,null,{default:si(()=>[Ht(s)]),_:1})}const Oee=go(Ree,[["render",Aee]]),Pee=kO({history:HA(),routes:[{path:"/",name:"home",component:RM},{name:"conversation",path:"/conversation/:sid",component:Oee}]}),Ag=yA(CO);Ag.use(bA());Ag.use(Pee);Ag.mount("#app");
