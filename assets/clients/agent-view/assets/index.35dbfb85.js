(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function Kh(e,t){const r=Object.create(null),n=e.split(",");for(let i=0;i<n.length;i++)r[n[i]]=!0;return t?i=>!!r[i.toLowerCase()]:i=>!!r[i]}const CE="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",RE=Kh(CE);function ES(e){return!!e||e===""}function Jh(e){if(Ke(e)){const t={};for(let r=0;r<e.length;r++){const n=e[r],i=ur(n)?PE(n):Jh(n);if(i)for(const a in i)t[a]=i[a]}return t}else{if(ur(e))return e;if(Lt(e))return e}}const OE=/;(?![^(]*\))/g,AE=/:(.+)/;function PE(e){const t={};return e.split(OE).forEach(r=>{if(r){const n=r.split(AE);n.length>1&&(t[n[0].trim()]=n[1].trim())}}),t}function hu(e){let t="";if(ur(e))t=e;else if(Ke(e))for(let r=0;r<e.length;r++){const n=hu(e[r]);n&&(t+=n+" ")}else if(Lt(e))for(const r in e)e[r]&&(t+=r+" ");return t.trim()}function ME(e,t){if(e.length!==t.length)return!1;let r=!0;for(let n=0;r&&n<e.length;n++)r=Pu(e[n],t[n]);return r}function Pu(e,t){if(e===t)return!0;let r=iy(e),n=iy(t);if(r||n)return r&&n?e.getTime()===t.getTime():!1;if(r=vu(e),n=vu(t),r||n)return e===t;if(r=Ke(e),n=Ke(t),r||n)return r&&n?ME(e,t):!1;if(r=Lt(e),n=Lt(t),r||n){if(!r||!n)return!1;const i=Object.keys(e).length,a=Object.keys(t).length;if(i!==a)return!1;for(const s in e){const u=e.hasOwnProperty(s),o=t.hasOwnProperty(s);if(u&&!o||!u&&o||!Pu(e[s],t[s]))return!1}}return String(e)===String(t)}function Yh(e,t){return e.findIndex(r=>Pu(r,t))}const Ht=e=>ur(e)?e:e==null?"":Ke(e)||Lt(e)&&(e.toString===RS||!lt(e.toString))?JSON.stringify(e,IS,2):String(e),IS=(e,t)=>t&&t.__v_isRef?IS(e,t.value):js(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((r,[n,i])=>(r[`${n} =>`]=i,r),{})}:io(t)?{[`Set(${t.size})`]:[...t.values()]}:Lt(t)&&!Ke(t)&&!OS(t)?String(t):t,Nt={},Ls=[],En=()=>{},NE=()=>!1,xE=/^on[^a-z]/,Bc=e=>xE.test(e),Qh=e=>e.startsWith("onUpdate:"),gr=Object.assign,Xh=(e,t)=>{const r=e.indexOf(t);r>-1&&e.splice(r,1)},LE=Object.prototype.hasOwnProperty,ht=(e,t)=>LE.call(e,t),Ke=Array.isArray,js=e=>Mu(e)==="[object Map]",io=e=>Mu(e)==="[object Set]",iy=e=>Mu(e)==="[object Date]",lt=e=>typeof e=="function",ur=e=>typeof e=="string",vu=e=>typeof e=="symbol",Lt=e=>e!==null&&typeof e=="object",CS=e=>Lt(e)&&lt(e.then)&&lt(e.catch),RS=Object.prototype.toString,Mu=e=>RS.call(e),jE=e=>Mu(e).slice(8,-1),OS=e=>Mu(e)==="[object Object]",Zh=e=>ur(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Xl=Kh(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),qc=e=>{const t=Object.create(null);return r=>t[r]||(t[r]=e(r))},UE=/-(\w)/g,qn=qc(e=>e.replace(UE,(t,r)=>r?r.toUpperCase():"")),DE=/\B([A-Z])/g,Va=qc(e=>e.replace(DE,"-$1").toLowerCase()),Wc=qc(e=>e.charAt(0).toUpperCase()+e.slice(1)),xf=qc(e=>e?`on${Wc(e)}`:""),gu=(e,t)=>!Object.is(e,t),Zl=(e,t)=>{for(let r=0;r<e.length;r++)e[r](t)},cc=(e,t,r)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:r})},fc=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let ay;const FE=()=>ay||(ay=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Nn;class AS{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&Nn&&(this.parent=Nn,this.index=(Nn.scopes||(Nn.scopes=[])).push(this)-1)}run(t){if(this.active){const r=Nn;try{return Nn=this,t()}finally{Nn=r}}}on(){Nn=this}off(){Nn=this.parent}stop(t){if(this.active){let r,n;for(r=0,n=this.effects.length;r<n;r++)this.effects[r].stop();for(r=0,n=this.cleanups.length;r<n;r++)this.cleanups[r]();if(this.scopes)for(r=0,n=this.scopes.length;r<n;r++)this.scopes[r].stop(!0);if(this.parent&&!t){const i=this.parent.scopes.pop();i&&i!==this&&(this.parent.scopes[this.index]=i,i.index=this.index)}this.active=!1}}}function PS(e){return new AS(e)}function BE(e,t=Nn){t&&t.active&&t.effects.push(e)}const ev=e=>{const t=new Set(e);return t.w=0,t.n=0,t},MS=e=>(e.w&Qi)>0,NS=e=>(e.n&Qi)>0,qE=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Qi},WE=e=>{const{deps:t}=e;if(t.length){let r=0;for(let n=0;n<t.length;n++){const i=t[n];MS(i)&&!NS(i)?i.delete(e):t[r++]=i,i.w&=~Qi,i.n&=~Qi}t.length=r}},kp=new WeakMap;let Yo=0,Qi=1;const Tp=30;let wn;const Ua=Symbol(""),Ep=Symbol("");class tv{constructor(t,r=null,n){this.fn=t,this.scheduler=r,this.active=!0,this.deps=[],this.parent=void 0,BE(this,n)}run(){if(!this.active)return this.fn();let t=wn,r=Hi;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=wn,wn=this,Hi=!0,Qi=1<<++Yo,Yo<=Tp?qE(this):sy(this),this.fn()}finally{Yo<=Tp&&WE(this),Qi=1<<--Yo,wn=this.parent,Hi=r,this.parent=void 0,this.deferStop&&this.stop()}}stop(){wn===this?this.deferStop=!0:this.active&&(sy(this),this.onStop&&this.onStop(),this.active=!1)}}function sy(e){const{deps:t}=e;if(t.length){for(let r=0;r<t.length;r++)t[r].delete(e);t.length=0}}let Hi=!0;const xS=[];function ao(){xS.push(Hi),Hi=!1}function so(){const e=xS.pop();Hi=e===void 0?!0:e}function qr(e,t,r){if(Hi&&wn){let n=kp.get(e);n||kp.set(e,n=new Map);let i=n.get(r);i||n.set(r,i=ev()),LS(i)}}function LS(e,t){let r=!1;Yo<=Tp?NS(e)||(e.n|=Qi,r=!MS(e)):r=!e.has(wn),r&&(e.add(wn),wn.deps.push(e))}function ui(e,t,r,n,i,a){const s=kp.get(e);if(!s)return;let u=[];if(t==="clear")u=[...s.values()];else if(r==="length"&&Ke(e))s.forEach((o,c)=>{(c==="length"||c>=n)&&u.push(o)});else switch(r!==void 0&&u.push(s.get(r)),t){case"add":Ke(e)?Zh(r)&&u.push(s.get("length")):(u.push(s.get(Ua)),js(e)&&u.push(s.get(Ep)));break;case"delete":Ke(e)||(u.push(s.get(Ua)),js(e)&&u.push(s.get(Ep)));break;case"set":js(e)&&u.push(s.get(Ua));break}if(u.length===1)u[0]&&Ip(u[0]);else{const o=[];for(const c of u)c&&o.push(...c);Ip(ev(o))}}function Ip(e,t){const r=Ke(e)?e:[...e];for(const n of r)n.computed&&oy(n);for(const n of r)n.computed||oy(n)}function oy(e,t){(e!==wn||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const HE=Kh("__proto__,__v_isRef,__isVue"),jS=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(vu)),GE=rv(),VE=rv(!1,!0),zE=rv(!0),uy=KE();function KE(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...r){const n=yt(this);for(let a=0,s=this.length;a<s;a++)qr(n,"get",a+"");const i=n[t](...r);return i===-1||i===!1?n[t](...r.map(yt)):i}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...r){ao();const n=yt(this)[t].apply(this,r);return so(),n}}),e}function rv(e=!1,t=!1){return function(n,i,a){if(i==="__v_isReactive")return!e;if(i==="__v_isReadonly")return e;if(i==="__v_isShallow")return t;if(i==="__v_raw"&&a===(e?t?cI:qS:t?BS:FS).get(n))return n;const s=Ke(n);if(!e&&s&&ht(uy,i))return Reflect.get(uy,i,a);const u=Reflect.get(n,i,a);return(vu(i)?jS.has(i):HE(i))||(e||qr(n,"get",i),t)?u:Yt(u)?s&&Zh(i)?u:u.value:Lt(u)?e?WS(u):za(u):u}}const JE=US(),YE=US(!0);function US(e=!1){return function(r,n,i,a){let s=r[n];if(Gs(s)&&Yt(s)&&!Yt(i))return!1;if(!e&&(!dc(i)&&!Gs(i)&&(s=yt(s),i=yt(i)),!Ke(r)&&Yt(s)&&!Yt(i)))return s.value=i,!0;const u=Ke(r)&&Zh(n)?Number(n)<r.length:ht(r,n),o=Reflect.set(r,n,i,a);return r===yt(a)&&(u?gu(i,s)&&ui(r,"set",n,i):ui(r,"add",n,i)),o}}function QE(e,t){const r=ht(e,t);e[t];const n=Reflect.deleteProperty(e,t);return n&&r&&ui(e,"delete",t,void 0),n}function XE(e,t){const r=Reflect.has(e,t);return(!vu(t)||!jS.has(t))&&qr(e,"has",t),r}function ZE(e){return qr(e,"iterate",Ke(e)?"length":Ua),Reflect.ownKeys(e)}const DS={get:GE,set:JE,deleteProperty:QE,has:XE,ownKeys:ZE},eI={get:zE,set(e,t){return!0},deleteProperty(e,t){return!0}},tI=gr({},DS,{get:VE,set:YE}),nv=e=>e,Hc=e=>Reflect.getPrototypeOf(e);function vl(e,t,r=!1,n=!1){e=e.__v_raw;const i=yt(e),a=yt(t);r||(t!==a&&qr(i,"get",t),qr(i,"get",a));const{has:s}=Hc(i),u=n?nv:r?sv:yu;if(s.call(i,t))return u(e.get(t));if(s.call(i,a))return u(e.get(a));e!==i&&e.get(t)}function gl(e,t=!1){const r=this.__v_raw,n=yt(r),i=yt(e);return t||(e!==i&&qr(n,"has",e),qr(n,"has",i)),e===i?r.has(e):r.has(e)||r.has(i)}function yl(e,t=!1){return e=e.__v_raw,!t&&qr(yt(e),"iterate",Ua),Reflect.get(e,"size",e)}function ly(e){e=yt(e);const t=yt(this);return Hc(t).has.call(t,e)||(t.add(e),ui(t,"add",e,e)),this}function cy(e,t){t=yt(t);const r=yt(this),{has:n,get:i}=Hc(r);let a=n.call(r,e);a||(e=yt(e),a=n.call(r,e));const s=i.call(r,e);return r.set(e,t),a?gu(t,s)&&ui(r,"set",e,t):ui(r,"add",e,t),this}function fy(e){const t=yt(this),{has:r,get:n}=Hc(t);let i=r.call(t,e);i||(e=yt(e),i=r.call(t,e)),n&&n.call(t,e);const a=t.delete(e);return i&&ui(t,"delete",e,void 0),a}function dy(){const e=yt(this),t=e.size!==0,r=e.clear();return t&&ui(e,"clear",void 0,void 0),r}function ml(e,t){return function(n,i){const a=this,s=a.__v_raw,u=yt(s),o=t?nv:e?sv:yu;return!e&&qr(u,"iterate",Ua),s.forEach((c,d)=>n.call(i,o(c),o(d),a))}}function bl(e,t,r){return function(...n){const i=this.__v_raw,a=yt(i),s=js(a),u=e==="entries"||e===Symbol.iterator&&s,o=e==="keys"&&s,c=i[e](...n),d=r?nv:t?sv:yu;return!t&&qr(a,"iterate",o?Ep:Ua),{next(){const{value:y,done:_}=c.next();return _?{value:y,done:_}:{value:u?[d(y[0]),d(y[1])]:d(y),done:_}},[Symbol.iterator](){return this}}}}function Ri(e){return function(...t){return e==="delete"?!1:this}}function rI(){const e={get(a){return vl(this,a)},get size(){return yl(this)},has:gl,add:ly,set:cy,delete:fy,clear:dy,forEach:ml(!1,!1)},t={get(a){return vl(this,a,!1,!0)},get size(){return yl(this)},has:gl,add:ly,set:cy,delete:fy,clear:dy,forEach:ml(!1,!0)},r={get(a){return vl(this,a,!0)},get size(){return yl(this,!0)},has(a){return gl.call(this,a,!0)},add:Ri("add"),set:Ri("set"),delete:Ri("delete"),clear:Ri("clear"),forEach:ml(!0,!1)},n={get(a){return vl(this,a,!0,!0)},get size(){return yl(this,!0)},has(a){return gl.call(this,a,!0)},add:Ri("add"),set:Ri("set"),delete:Ri("delete"),clear:Ri("clear"),forEach:ml(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{e[a]=bl(a,!1,!1),r[a]=bl(a,!0,!1),t[a]=bl(a,!1,!0),n[a]=bl(a,!0,!0)}),[e,r,t,n]}const[nI,iI,aI,sI]=rI();function iv(e,t){const r=t?e?sI:aI:e?iI:nI;return(n,i,a)=>i==="__v_isReactive"?!e:i==="__v_isReadonly"?e:i==="__v_raw"?n:Reflect.get(ht(r,i)&&i in n?r:n,i,a)}const oI={get:iv(!1,!1)},uI={get:iv(!1,!0)},lI={get:iv(!0,!1)},FS=new WeakMap,BS=new WeakMap,qS=new WeakMap,cI=new WeakMap;function fI(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function dI(e){return e.__v_skip||!Object.isExtensible(e)?0:fI(jE(e))}function za(e){return Gs(e)?e:av(e,!1,DS,oI,FS)}function pI(e){return av(e,!1,tI,uI,BS)}function WS(e){return av(e,!0,eI,lI,qS)}function av(e,t,r,n,i){if(!Lt(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const a=i.get(e);if(a)return a;const s=dI(e);if(s===0)return e;const u=new Proxy(e,s===2?n:r);return i.set(e,u),u}function Gi(e){return Gs(e)?Gi(e.__v_raw):!!(e&&e.__v_isReactive)}function Gs(e){return!!(e&&e.__v_isReadonly)}function dc(e){return!!(e&&e.__v_isShallow)}function HS(e){return Gi(e)||Gs(e)}function yt(e){const t=e&&e.__v_raw;return t?yt(t):e}function Vs(e){return cc(e,"__v_skip",!0),e}const yu=e=>Lt(e)?za(e):e,sv=e=>Lt(e)?WS(e):e;function GS(e){Hi&&wn&&(e=yt(e),LS(e.dep||(e.dep=ev())))}function VS(e,t){e=yt(e),e.dep&&Ip(e.dep)}function Yt(e){return!!(e&&e.__v_isRef===!0)}function nt(e){return zS(e,!1)}function hI(e){return zS(e,!0)}function zS(e,t){return Yt(e)?e:new vI(e,t)}class vI{constructor(t,r){this.__v_isShallow=r,this.dep=void 0,this.__v_isRef=!0,this._rawValue=r?t:yt(t),this._value=r?t:yu(t)}get value(){return GS(this),this._value}set value(t){const r=this.__v_isShallow||dc(t)||Gs(t);t=r?t:yt(t),gu(t,this._rawValue)&&(this._rawValue=t,this._value=r?t:yu(t),VS(this))}}function Ot(e){return Yt(e)?e.value:e}const gI={get:(e,t,r)=>Ot(Reflect.get(e,t,r)),set:(e,t,r,n)=>{const i=e[t];return Yt(i)&&!Yt(r)?(i.value=r,!0):Reflect.set(e,t,r,n)}};function KS(e){return Gi(e)?e:new Proxy(e,gI)}function yI(e){const t=Ke(e)?new Array(e.length):{};for(const r in e)t[r]=bI(e,r);return t}class mI{constructor(t,r,n){this._object=t,this._key=r,this._defaultValue=n,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function bI(e,t,r){const n=e[t];return Yt(n)?n:new mI(e,t,r)}var JS;class wI{constructor(t,r,n,i){this._setter=r,this.dep=void 0,this.__v_isRef=!0,this[JS]=!1,this._dirty=!0,this.effect=new tv(t,()=>{this._dirty||(this._dirty=!0,VS(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!i,this.__v_isReadonly=n}get value(){const t=yt(this);return GS(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}JS="__v_isReadonly";function _I(e,t,r=!1){let n,i;const a=lt(e);return a?(n=e,i=En):(n=e.get,i=e.set),new wI(n,i,a||!i,r)}function Vi(e,t,r,n){let i;try{i=n?e(...n):e()}catch(a){Gc(a,t,r)}return i}function un(e,t,r,n){if(lt(e)){const a=Vi(e,t,r,n);return a&&CS(a)&&a.catch(s=>{Gc(s,t,r)}),a}const i=[];for(let a=0;a<e.length;a++)i.push(un(e[a],t,r,n));return i}function Gc(e,t,r,n=!0){const i=t?t.vnode:null;if(t){let a=t.parent;const s=t.proxy,u=r;for(;a;){const c=a.ec;if(c){for(let d=0;d<c.length;d++)if(c[d](e,s,u)===!1)return}a=a.parent}const o=t.appContext.config.errorHandler;if(o){Vi(o,null,10,[e,s,u]);return}}SI(e,r,i,n)}function SI(e,t,r,n=!0){console.error(e)}let mu=!1,Cp=!1;const hr=[];let Un=0;const Us=[];let ti=null,Oa=0;const YS=Promise.resolve();let ov=null;function uv(e){const t=ov||YS;return e?t.then(this?e.bind(this):e):t}function $I(e){let t=Un+1,r=hr.length;for(;t<r;){const n=t+r>>>1;bu(hr[n])<e?t=n+1:r=n}return t}function lv(e){(!hr.length||!hr.includes(e,mu&&e.allowRecurse?Un+1:Un))&&(e.id==null?hr.push(e):hr.splice($I(e.id),0,e),QS())}function QS(){!mu&&!Cp&&(Cp=!0,ov=YS.then(ZS))}function kI(e){const t=hr.indexOf(e);t>Un&&hr.splice(t,1)}function TI(e){Ke(e)?Us.push(...e):(!ti||!ti.includes(e,e.allowRecurse?Oa+1:Oa))&&Us.push(e),QS()}function py(e,t=mu?Un+1:0){for(;t<hr.length;t++){const r=hr[t];r&&r.pre&&(hr.splice(t,1),t--,r())}}function XS(e){if(Us.length){const t=[...new Set(Us)];if(Us.length=0,ti){ti.push(...t);return}for(ti=t,ti.sort((r,n)=>bu(r)-bu(n)),Oa=0;Oa<ti.length;Oa++)ti[Oa]();ti=null,Oa=0}}const bu=e=>e.id==null?1/0:e.id,EI=(e,t)=>{const r=bu(e)-bu(t);if(r===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return r};function ZS(e){Cp=!1,mu=!0,hr.sort(EI);const t=En;try{for(Un=0;Un<hr.length;Un++){const r=hr[Un];r&&r.active!==!1&&Vi(r,null,14)}}finally{Un=0,hr.length=0,XS(),mu=!1,ov=null,(hr.length||Us.length)&&ZS()}}function II(e,t,...r){if(e.isUnmounted)return;const n=e.vnode.props||Nt;let i=r;const a=t.startsWith("update:"),s=a&&t.slice(7);if(s&&s in n){const d=`${s==="modelValue"?"model":s}Modifiers`,{number:y,trim:_}=n[d]||Nt;_&&(i=r.map(w=>w.trim())),y&&(i=r.map(fc))}let u,o=n[u=xf(t)]||n[u=xf(qn(t))];!o&&a&&(o=n[u=xf(Va(t))]),o&&un(o,e,6,i);const c=n[u+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[u])return;e.emitted[u]=!0,un(c,e,6,i)}}function e$(e,t,r=!1){const n=t.emitsCache,i=n.get(e);if(i!==void 0)return i;const a=e.emits;let s={},u=!1;if(!lt(e)){const o=c=>{const d=e$(c,t,!0);d&&(u=!0,gr(s,d))};!r&&t.mixins.length&&t.mixins.forEach(o),e.extends&&o(e.extends),e.mixins&&e.mixins.forEach(o)}return!a&&!u?(Lt(e)&&n.set(e,null),null):(Ke(a)?a.forEach(o=>s[o]=null):gr(s,a),Lt(e)&&n.set(e,s),s)}function Vc(e,t){return!e||!Bc(t)?!1:(t=t.slice(2).replace(/Once$/,""),ht(e,t[0].toLowerCase()+t.slice(1))||ht(e,Va(t))||ht(e,t))}let vr=null,t$=null;function pc(e){const t=vr;return vr=e,t$=e&&e.type.__scopeId||null,t}function ar(e,t=vr,r){if(!t||e._n)return e;const n=(...i)=>{n._d&&ky(-1);const a=pc(t),s=e(...i);return pc(a),n._d&&ky(1),s};return n._n=!0,n._c=!0,n._d=!0,n}function Lf(e){const{type:t,vnode:r,proxy:n,withProxy:i,props:a,propsOptions:[s],slots:u,attrs:o,emit:c,render:d,renderCache:y,data:_,setupState:w,ctx:k,inheritAttrs:N}=e;let M,L;const B=pc(e);try{if(r.shapeFlag&4){const ue=i||n;M=Ln(d.call(ue,ue,y,a,w,_,k)),L=o}else{const ue=t;M=Ln(ue.length>1?ue(a,{attrs:o,slots:u,emit:c}):ue(a,null)),L=t.props?o:CI(o)}}catch(ue){iu.length=0,Gc(ue,e,1),M=bt(ln)}let ve=M;if(L&&N!==!1){const ue=Object.keys(L),{shapeFlag:Me}=ve;ue.length&&Me&7&&(s&&ue.some(Qh)&&(L=RI(L,s)),ve=Xi(ve,L))}return r.dirs&&(ve=Xi(ve),ve.dirs=ve.dirs?ve.dirs.concat(r.dirs):r.dirs),r.transition&&(ve.transition=r.transition),M=ve,pc(B),M}const CI=e=>{let t;for(const r in e)(r==="class"||r==="style"||Bc(r))&&((t||(t={}))[r]=e[r]);return t},RI=(e,t)=>{const r={};for(const n in e)(!Qh(n)||!(n.slice(9)in t))&&(r[n]=e[n]);return r};function OI(e,t,r){const{props:n,children:i,component:a}=e,{props:s,children:u,patchFlag:o}=t,c=a.emitsOptions;if(t.dirs||t.transition)return!0;if(r&&o>=0){if(o&1024)return!0;if(o&16)return n?hy(n,s,c):!!s;if(o&8){const d=t.dynamicProps;for(let y=0;y<d.length;y++){const _=d[y];if(s[_]!==n[_]&&!Vc(c,_))return!0}}}else return(i||u)&&(!u||!u.$stable)?!0:n===s?!1:n?s?hy(n,s,c):!0:!!s;return!1}function hy(e,t,r){const n=Object.keys(t);if(n.length!==Object.keys(e).length)return!0;for(let i=0;i<n.length;i++){const a=n[i];if(t[a]!==e[a]&&!Vc(r,a))return!0}return!1}function AI({vnode:e,parent:t},r){for(;t&&t.subTree===e;)(e=t.vnode).el=r,t=t.parent}const PI=e=>e.__isSuspense;function MI(e,t){t&&t.pendingBranch?Ke(e)?t.effects.push(...e):t.effects.push(e):TI(e)}function ec(e,t){if(sr){let r=sr.provides;const n=sr.parent&&sr.parent.provides;n===r&&(r=sr.provides=Object.create(n)),r[e]=t}}function In(e,t,r=!1){const n=sr||vr;if(n){const i=n.parent==null?n.vnode.appContext&&n.vnode.appContext.provides:n.parent.provides;if(i&&e in i)return i[e];if(arguments.length>1)return r&&lt(t)?t.call(n.proxy):t}}const vy={};function ru(e,t,r){return r$(e,t,r)}function r$(e,t,{immediate:r,deep:n,flush:i,onTrack:a,onTrigger:s}=Nt){const u=sr;let o,c=!1,d=!1;if(Yt(e)?(o=()=>e.value,c=dc(e)):Gi(e)?(o=()=>e,n=!0):Ke(e)?(d=!0,c=e.some(L=>Gi(L)||dc(L)),o=()=>e.map(L=>{if(Yt(L))return L.value;if(Gi(L))return La(L);if(lt(L))return Vi(L,u,2)})):lt(e)?t?o=()=>Vi(e,u,2):o=()=>{if(!(u&&u.isUnmounted))return y&&y(),un(e,u,3,[_])}:o=En,t&&n){const L=o;o=()=>La(L())}let y,_=L=>{y=M.onStop=()=>{Vi(L,u,4)}};if(_u)return _=En,t?r&&un(t,u,3,[o(),d?[]:void 0,_]):o(),En;let w=d?[]:vy;const k=()=>{if(!!M.active)if(t){const L=M.run();(n||c||(d?L.some((B,ve)=>gu(B,w[ve])):gu(L,w)))&&(y&&y(),un(t,u,3,[L,w===vy?void 0:w,_]),w=L)}else M.run()};k.allowRecurse=!!t;let N;i==="sync"?N=k:i==="post"?N=()=>Ar(k,u&&u.suspense):(k.pre=!0,u&&(k.id=u.uid),N=()=>lv(k));const M=new tv(o,N);return t?r?k():w=M.run():i==="post"?Ar(M.run.bind(M),u&&u.suspense):M.run(),()=>{M.stop(),u&&u.scope&&Xh(u.scope.effects,M)}}function NI(e,t,r){const n=this.proxy,i=ur(e)?e.includes(".")?n$(n,e):()=>n[e]:e.bind(n,n);let a;lt(t)?a=t:(a=t.handler,r=t);const s=sr;zs(this);const u=r$(i,a.bind(n),r);return s?zs(s):Da(),u}function n$(e,t){const r=t.split(".");return()=>{let n=e;for(let i=0;i<r.length&&n;i++)n=n[r[i]];return n}}function La(e,t){if(!Lt(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Yt(e))La(e.value,t);else if(Ke(e))for(let r=0;r<e.length;r++)La(e[r],t);else if(io(e)||js(e))e.forEach(r=>{La(r,t)});else if(OS(e))for(const r in e)La(e[r],t);return e}function xI(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return oo(()=>{e.isMounted=!0}),u$(()=>{e.isUnmounting=!0}),e}const Zr=[Function,Array],LI={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:Zr,onEnter:Zr,onAfterEnter:Zr,onEnterCancelled:Zr,onBeforeLeave:Zr,onLeave:Zr,onAfterLeave:Zr,onLeaveCancelled:Zr,onBeforeAppear:Zr,onAppear:Zr,onAfterAppear:Zr,onAppearCancelled:Zr},setup(e,{slots:t}){const r=gv(),n=xI();let i;return()=>{const a=t.default&&a$(t.default(),!0);if(!a||!a.length)return;let s=a[0];if(a.length>1){for(const N of a)if(N.type!==ln){s=N;break}}const u=yt(e),{mode:o}=u;if(n.isLeaving)return jf(s);const c=gy(s);if(!c)return jf(s);const d=Rp(c,u,n,r);Op(c,d);const y=r.subTree,_=y&&gy(y);let w=!1;const{getTransitionKey:k}=c.type;if(k){const N=k();i===void 0?i=N:N!==i&&(i=N,w=!0)}if(_&&_.type!==ln&&(!Aa(c,_)||w)){const N=Rp(_,u,n,r);if(Op(_,N),o==="out-in")return n.isLeaving=!0,N.afterLeave=()=>{n.isLeaving=!1,r.update()},jf(s);o==="in-out"&&c.type!==ln&&(N.delayLeave=(M,L,B)=>{const ve=i$(n,_);ve[String(_.key)]=_,M._leaveCb=()=>{L(),M._leaveCb=void 0,delete d.delayedLeave},d.delayedLeave=B})}return s}}},jI=LI;function i$(e,t){const{leavingVNodes:r}=e;let n=r.get(t.type);return n||(n=Object.create(null),r.set(t.type,n)),n}function Rp(e,t,r,n){const{appear:i,mode:a,persisted:s=!1,onBeforeEnter:u,onEnter:o,onAfterEnter:c,onEnterCancelled:d,onBeforeLeave:y,onLeave:_,onAfterLeave:w,onLeaveCancelled:k,onBeforeAppear:N,onAppear:M,onAfterAppear:L,onAppearCancelled:B}=t,ve=String(e.key),ue=i$(r,e),Me=(x,le)=>{x&&un(x,n,9,le)},Re=(x,le)=>{const F=le[1];Me(x,le),Ke(x)?x.every(Se=>Se.length<=1)&&F():x.length<=1&&F()},Ae={mode:a,persisted:s,beforeEnter(x){let le=u;if(!r.isMounted)if(i)le=N||u;else return;x._leaveCb&&x._leaveCb(!0);const F=ue[ve];F&&Aa(e,F)&&F.el._leaveCb&&F.el._leaveCb(),Me(le,[x])},enter(x){let le=o,F=c,Se=d;if(!r.isMounted)if(i)le=M||o,F=L||c,Se=B||d;else return;let Ee=!1;const oe=x._enterCb=te=>{Ee||(Ee=!0,te?Me(Se,[x]):Me(F,[x]),Ae.delayedLeave&&Ae.delayedLeave(),x._enterCb=void 0)};le?Re(le,[x,oe]):oe()},leave(x,le){const F=String(e.key);if(x._enterCb&&x._enterCb(!0),r.isUnmounting)return le();Me(y,[x]);let Se=!1;const Ee=x._leaveCb=oe=>{Se||(Se=!0,le(),oe?Me(k,[x]):Me(w,[x]),x._leaveCb=void 0,ue[F]===e&&delete ue[F])};ue[F]=e,_?Re(_,[x,Ee]):Ee()},clone(x){return Rp(x,t,r,n)}};return Ae}function jf(e){if(zc(e))return e=Xi(e),e.children=null,e}function gy(e){return zc(e)?e.children?e.children[0]:void 0:e}function Op(e,t){e.shapeFlag&6&&e.component?Op(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function a$(e,t=!1,r){let n=[],i=0;for(let a=0;a<e.length;a++){let s=e[a];const u=r==null?s.key:String(r)+String(s.key!=null?s.key:a);s.type===Kt?(s.patchFlag&128&&i++,n=n.concat(a$(s.children,t,u))):(t||s.type!==ln)&&n.push(u!=null?Xi(s,{key:u}):s)}if(i>1)for(let a=0;a<n.length;a++)n[a].patchFlag=-2;return n}function s$(e){return lt(e)?{setup:e,name:e.name}:e}const nu=e=>!!e.type.__asyncLoader,zc=e=>e.type.__isKeepAlive;function UI(e,t){o$(e,"a",t)}function DI(e,t){o$(e,"da",t)}function o$(e,t,r=sr){const n=e.__wdc||(e.__wdc=()=>{let i=r;for(;i;){if(i.isDeactivated)return;i=i.parent}return e()});if(Kc(t,n,r),r){let i=r.parent;for(;i&&i.parent;)zc(i.parent.vnode)&&FI(n,t,r,i),i=i.parent}}function FI(e,t,r,n){const i=Kc(t,e,n,!0);fv(()=>{Xh(n[t],i)},r)}function Kc(e,t,r=sr,n=!1){if(r){const i=r[e]||(r[e]=[]),a=t.__weh||(t.__weh=(...s)=>{if(r.isUnmounted)return;ao(),zs(r);const u=un(t,r,e,s);return Da(),so(),u});return n?i.unshift(a):i.push(a),a}}const pi=e=>(t,r=sr)=>(!_u||e==="sp")&&Kc(e,t,r),cv=pi("bm"),oo=pi("m"),BI=pi("bu"),qI=pi("u"),u$=pi("bum"),fv=pi("um"),WI=pi("sp"),HI=pi("rtg"),GI=pi("rtc");function VI(e,t=sr){Kc("ec",e,t)}function ze(e,t){const r=vr;if(r===null)return e;const n=Yc(r)||r.proxy,i=e.dirs||(e.dirs=[]);for(let a=0;a<t.length;a++){let[s,u,o,c=Nt]=t[a];lt(s)&&(s={mounted:s,updated:s}),s.deep&&La(u),i.push({dir:s,instance:n,value:u,oldValue:void 0,arg:o,modifiers:c})}return e}function wa(e,t,r,n){const i=e.dirs,a=t&&t.dirs;for(let s=0;s<i.length;s++){const u=i[s];a&&(u.oldValue=a[s].value);let o=u.dir[n];o&&(ao(),un(o,r,8,[e.el,u,e,t]),so())}}const l$="components";function Tr(e,t){return KI(l$,e,!0,t)||e}const zI=Symbol();function KI(e,t,r=!0,n=!1){const i=vr||sr;if(i){const a=i.type;if(e===l$){const u=kC(a,!1);if(u&&(u===t||u===qn(t)||u===Wc(qn(t))))return a}const s=yy(i[e]||a[e],t)||yy(i.appContext[e],t);return!s&&n?a:s}}function yy(e,t){return e&&(e[t]||e[qn(t)]||e[Wc(qn(t))])}function xn(e,t,r,n){let i;const a=r&&r[n];if(Ke(e)||ur(e)){i=new Array(e.length);for(let s=0,u=e.length;s<u;s++)i[s]=t(e[s],s,void 0,a&&a[s])}else if(typeof e=="number"){i=new Array(e);for(let s=0;s<e;s++)i[s]=t(s+1,s,void 0,a&&a[s])}else if(Lt(e))if(e[Symbol.iterator])i=Array.from(e,(s,u)=>t(s,u,void 0,a&&a[u]));else{const s=Object.keys(e);i=new Array(s.length);for(let u=0,o=s.length;u<o;u++){const c=s[u];i[u]=t(e[c],c,u,a&&a[u])}}else i=[];return r&&(r[n]=i),i}function JI(e,t,r={},n,i){if(vr.isCE||vr.parent&&nu(vr.parent)&&vr.parent.isCE)return bt("slot",t==="default"?null:{name:t},n&&n());let a=e[t];a&&a._c&&(a._d=!1),Ge();const s=a&&c$(a(r)),u=Cn(Kt,{key:r.key||s&&s.key||`_${t}`},s||(n?n():[]),s&&e._===1?64:-2);return!i&&u.scopeId&&(u.slotScopeIds=[u.scopeId+"-s"]),a&&a._c&&(a._d=!0),u}function c$(e){return e.some(t=>gc(t)?!(t.type===ln||t.type===Kt&&!c$(t.children)):!0)?e:null}const Ap=e=>e?_$(e)?Yc(e)||e.proxy:Ap(e.parent):null,hc=gr(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Ap(e.parent),$root:e=>Ap(e.root),$emit:e=>e.emit,$options:e=>dv(e),$forceUpdate:e=>e.f||(e.f=()=>lv(e.update)),$nextTick:e=>e.n||(e.n=uv.bind(e.proxy)),$watch:e=>NI.bind(e)}),YI={get({_:e},t){const{ctx:r,setupState:n,data:i,props:a,accessCache:s,type:u,appContext:o}=e;let c;if(t[0]!=="$"){const w=s[t];if(w!==void 0)switch(w){case 1:return n[t];case 2:return i[t];case 4:return r[t];case 3:return a[t]}else{if(n!==Nt&&ht(n,t))return s[t]=1,n[t];if(i!==Nt&&ht(i,t))return s[t]=2,i[t];if((c=e.propsOptions[0])&&ht(c,t))return s[t]=3,a[t];if(r!==Nt&&ht(r,t))return s[t]=4,r[t];Pp&&(s[t]=0)}}const d=hc[t];let y,_;if(d)return t==="$attrs"&&qr(e,"get",t),d(e);if((y=u.__cssModules)&&(y=y[t]))return y;if(r!==Nt&&ht(r,t))return s[t]=4,r[t];if(_=o.config.globalProperties,ht(_,t))return _[t]},set({_:e},t,r){const{data:n,setupState:i,ctx:a}=e;return i!==Nt&&ht(i,t)?(i[t]=r,!0):n!==Nt&&ht(n,t)?(n[t]=r,!0):ht(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(a[t]=r,!0)},has({_:{data:e,setupState:t,accessCache:r,ctx:n,appContext:i,propsOptions:a}},s){let u;return!!r[s]||e!==Nt&&ht(e,s)||t!==Nt&&ht(t,s)||(u=a[0])&&ht(u,s)||ht(n,s)||ht(hc,s)||ht(i.config.globalProperties,s)},defineProperty(e,t,r){return r.get!=null?e._.accessCache[t]=0:ht(r,"value")&&this.set(e,t,r.value,null),Reflect.defineProperty(e,t,r)}};let Pp=!0;function QI(e){const t=dv(e),r=e.proxy,n=e.ctx;Pp=!1,t.beforeCreate&&my(t.beforeCreate,e,"bc");const{data:i,computed:a,methods:s,watch:u,provide:o,inject:c,created:d,beforeMount:y,mounted:_,beforeUpdate:w,updated:k,activated:N,deactivated:M,beforeDestroy:L,beforeUnmount:B,destroyed:ve,unmounted:ue,render:Me,renderTracked:Re,renderTriggered:Ae,errorCaptured:x,serverPrefetch:le,expose:F,inheritAttrs:Se,components:Ee,directives:oe,filters:te}=t;if(c&&XI(c,n,null,e.appContext.config.unwrapInjectedRef),s)for(const be in s){const A=s[be];lt(A)&&(n[be]=A.bind(r))}if(i){const be=i.call(r,r);Lt(be)&&(e.data=za(be))}if(Pp=!0,a)for(const be in a){const A=a[be],Le=lt(A)?A.bind(r,r):lt(A.get)?A.get.bind(r,r):En,at=!lt(A)&&lt(A.set)?A.set.bind(r):En,We=Jt({get:Le,set:at});Object.defineProperty(n,be,{enumerable:!0,configurable:!0,get:()=>We.value,set:fe=>We.value=fe})}if(u)for(const be in u)f$(u[be],n,r,be);if(o){const be=lt(o)?o.call(r):o;Reflect.ownKeys(be).forEach(A=>{ec(A,be[A])})}d&&my(d,e,"c");function ne(be,A){Ke(A)?A.forEach(Le=>be(Le.bind(r))):A&&be(A.bind(r))}if(ne(cv,y),ne(oo,_),ne(BI,w),ne(qI,k),ne(UI,N),ne(DI,M),ne(VI,x),ne(GI,Re),ne(HI,Ae),ne(u$,B),ne(fv,ue),ne(WI,le),Ke(F))if(F.length){const be=e.exposed||(e.exposed={});F.forEach(A=>{Object.defineProperty(be,A,{get:()=>r[A],set:Le=>r[A]=Le})})}else e.exposed||(e.exposed={});Me&&e.render===En&&(e.render=Me),Se!=null&&(e.inheritAttrs=Se),Ee&&(e.components=Ee),oe&&(e.directives=oe)}function XI(e,t,r=En,n=!1){Ke(e)&&(e=Mp(e));for(const i in e){const a=e[i];let s;Lt(a)?"default"in a?s=In(a.from||i,a.default,!0):s=In(a.from||i):s=In(a),Yt(s)&&n?Object.defineProperty(t,i,{enumerable:!0,configurable:!0,get:()=>s.value,set:u=>s.value=u}):t[i]=s}}function my(e,t,r){un(Ke(e)?e.map(n=>n.bind(t.proxy)):e.bind(t.proxy),t,r)}function f$(e,t,r,n){const i=n.includes(".")?n$(r,n):()=>r[n];if(ur(e)){const a=t[e];lt(a)&&ru(i,a)}else if(lt(e))ru(i,e.bind(r));else if(Lt(e))if(Ke(e))e.forEach(a=>f$(a,t,r,n));else{const a=lt(e.handler)?e.handler.bind(r):t[e.handler];lt(a)&&ru(i,a,e)}}function dv(e){const t=e.type,{mixins:r,extends:n}=t,{mixins:i,optionsCache:a,config:{optionMergeStrategies:s}}=e.appContext,u=a.get(t);let o;return u?o=u:!i.length&&!r&&!n?o=t:(o={},i.length&&i.forEach(c=>vc(o,c,s,!0)),vc(o,t,s)),Lt(t)&&a.set(t,o),o}function vc(e,t,r,n=!1){const{mixins:i,extends:a}=t;a&&vc(e,a,r,!0),i&&i.forEach(s=>vc(e,s,r,!0));for(const s in t)if(!(n&&s==="expose")){const u=ZI[s]||r&&r[s];e[s]=u?u(e[s],t[s]):t[s]}return e}const ZI={data:by,props:Ra,emits:Ra,methods:Ra,computed:Ra,beforeCreate:$r,created:$r,beforeMount:$r,mounted:$r,beforeUpdate:$r,updated:$r,beforeDestroy:$r,beforeUnmount:$r,destroyed:$r,unmounted:$r,activated:$r,deactivated:$r,errorCaptured:$r,serverPrefetch:$r,components:Ra,directives:Ra,watch:tC,provide:by,inject:eC};function by(e,t){return t?e?function(){return gr(lt(e)?e.call(this,this):e,lt(t)?t.call(this,this):t)}:t:e}function eC(e,t){return Ra(Mp(e),Mp(t))}function Mp(e){if(Ke(e)){const t={};for(let r=0;r<e.length;r++)t[e[r]]=e[r];return t}return e}function $r(e,t){return e?[...new Set([].concat(e,t))]:t}function Ra(e,t){return e?gr(gr(Object.create(null),e),t):t}function tC(e,t){if(!e)return t;if(!t)return e;const r=gr(Object.create(null),e);for(const n in t)r[n]=$r(e[n],t[n]);return r}function rC(e,t,r,n=!1){const i={},a={};cc(a,Jc,1),e.propsDefaults=Object.create(null),d$(e,t,i,a);for(const s in e.propsOptions[0])s in i||(i[s]=void 0);r?e.props=n?i:pI(i):e.type.props?e.props=i:e.props=a,e.attrs=a}function nC(e,t,r,n){const{props:i,attrs:a,vnode:{patchFlag:s}}=e,u=yt(i),[o]=e.propsOptions;let c=!1;if((n||s>0)&&!(s&16)){if(s&8){const d=e.vnode.dynamicProps;for(let y=0;y<d.length;y++){let _=d[y];if(Vc(e.emitsOptions,_))continue;const w=t[_];if(o)if(ht(a,_))w!==a[_]&&(a[_]=w,c=!0);else{const k=qn(_);i[k]=Np(o,u,k,w,e,!1)}else w!==a[_]&&(a[_]=w,c=!0)}}}else{d$(e,t,i,a)&&(c=!0);let d;for(const y in u)(!t||!ht(t,y)&&((d=Va(y))===y||!ht(t,d)))&&(o?r&&(r[y]!==void 0||r[d]!==void 0)&&(i[y]=Np(o,u,y,void 0,e,!0)):delete i[y]);if(a!==u)for(const y in a)(!t||!ht(t,y)&&!0)&&(delete a[y],c=!0)}c&&ui(e,"set","$attrs")}function d$(e,t,r,n){const[i,a]=e.propsOptions;let s=!1,u;if(t)for(let o in t){if(Xl(o))continue;const c=t[o];let d;i&&ht(i,d=qn(o))?!a||!a.includes(d)?r[d]=c:(u||(u={}))[d]=c:Vc(e.emitsOptions,o)||(!(o in n)||c!==n[o])&&(n[o]=c,s=!0)}if(a){const o=yt(r),c=u||Nt;for(let d=0;d<a.length;d++){const y=a[d];r[y]=Np(i,o,y,c[y],e,!ht(c,y))}}return s}function Np(e,t,r,n,i,a){const s=e[r];if(s!=null){const u=ht(s,"default");if(u&&n===void 0){const o=s.default;if(s.type!==Function&&lt(o)){const{propsDefaults:c}=i;r in c?n=c[r]:(zs(i),n=c[r]=o.call(null,t),Da())}else n=o}s[0]&&(a&&!u?n=!1:s[1]&&(n===""||n===Va(r))&&(n=!0))}return n}function p$(e,t,r=!1){const n=t.propsCache,i=n.get(e);if(i)return i;const a=e.props,s={},u=[];let o=!1;if(!lt(e)){const d=y=>{o=!0;const[_,w]=p$(y,t,!0);gr(s,_),w&&u.push(...w)};!r&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!a&&!o)return Lt(e)&&n.set(e,Ls),Ls;if(Ke(a))for(let d=0;d<a.length;d++){const y=qn(a[d]);wy(y)&&(s[y]=Nt)}else if(a)for(const d in a){const y=qn(d);if(wy(y)){const _=a[d],w=s[y]=Ke(_)||lt(_)?{type:_}:_;if(w){const k=$y(Boolean,w.type),N=$y(String,w.type);w[0]=k>-1,w[1]=N<0||k<N,(k>-1||ht(w,"default"))&&u.push(y)}}}const c=[s,u];return Lt(e)&&n.set(e,c),c}function wy(e){return e[0]!=="$"}function _y(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function Sy(e,t){return _y(e)===_y(t)}function $y(e,t){return Ke(t)?t.findIndex(r=>Sy(r,e)):lt(t)&&Sy(t,e)?0:-1}const h$=e=>e[0]==="_"||e==="$stable",pv=e=>Ke(e)?e.map(Ln):[Ln(e)],iC=(e,t,r)=>{if(t._n)return t;const n=ar((...i)=>pv(t(...i)),r);return n._c=!1,n},v$=(e,t,r)=>{const n=e._ctx;for(const i in e){if(h$(i))continue;const a=e[i];if(lt(a))t[i]=iC(i,a,n);else if(a!=null){const s=pv(a);t[i]=()=>s}}},g$=(e,t)=>{const r=pv(t);e.slots.default=()=>r},aC=(e,t)=>{if(e.vnode.shapeFlag&32){const r=t._;r?(e.slots=yt(t),cc(t,"_",r)):v$(t,e.slots={})}else e.slots={},t&&g$(e,t);cc(e.slots,Jc,1)},sC=(e,t,r)=>{const{vnode:n,slots:i}=e;let a=!0,s=Nt;if(n.shapeFlag&32){const u=t._;u?r&&u===1?a=!1:(gr(i,t),!r&&u===1&&delete i._):(a=!t.$stable,v$(t,i)),s=t}else t&&(g$(e,t),s={default:1});if(a)for(const u in i)!h$(u)&&!(u in s)&&delete i[u]};function y$(){return{app:null,config:{isNativeTag:NE,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let oC=0;function uC(e,t){return function(n,i=null){lt(n)||(n=Object.assign({},n)),i!=null&&!Lt(i)&&(i=null);const a=y$(),s=new Set;let u=!1;const o=a.app={_uid:oC++,_component:n,_props:i,_container:null,_context:a,_instance:null,version:EC,get config(){return a.config},set config(c){},use(c,...d){return s.has(c)||(c&&lt(c.install)?(s.add(c),c.install(o,...d)):lt(c)&&(s.add(c),c(o,...d))),o},mixin(c){return a.mixins.includes(c)||a.mixins.push(c),o},component(c,d){return d?(a.components[c]=d,o):a.components[c]},directive(c,d){return d?(a.directives[c]=d,o):a.directives[c]},mount(c,d,y){if(!u){const _=bt(n,i);return _.appContext=a,d&&t?t(_,c):e(_,c,y),u=!0,o._container=c,c.__vue_app__=o,Yc(_.component)||_.component.proxy}},unmount(){u&&(e(null,o._container),delete o._container.__vue_app__)},provide(c,d){return a.provides[c]=d,o}};return o}}function xp(e,t,r,n,i=!1){if(Ke(e)){e.forEach((_,w)=>xp(_,t&&(Ke(t)?t[w]:t),r,n,i));return}if(nu(n)&&!i)return;const a=n.shapeFlag&4?Yc(n.component)||n.component.proxy:n.el,s=i?null:a,{i:u,r:o}=e,c=t&&t.r,d=u.refs===Nt?u.refs={}:u.refs,y=u.setupState;if(c!=null&&c!==o&&(ur(c)?(d[c]=null,ht(y,c)&&(y[c]=null)):Yt(c)&&(c.value=null)),lt(o))Vi(o,u,12,[s,d]);else{const _=ur(o),w=Yt(o);if(_||w){const k=()=>{if(e.f){const N=_?d[o]:o.value;i?Ke(N)&&Xh(N,a):Ke(N)?N.includes(a)||N.push(a):_?(d[o]=[a],ht(y,o)&&(y[o]=d[o])):(o.value=[a],e.k&&(d[e.k]=o.value))}else _?(d[o]=s,ht(y,o)&&(y[o]=s)):w&&(o.value=s,e.k&&(d[e.k]=s))};s?(k.id=-1,Ar(k,r)):k()}}}const Ar=MI;function lC(e){return cC(e)}function cC(e,t){const r=FE();r.__VUE__=!0;const{insert:n,remove:i,patchProp:a,createElement:s,createText:u,createComment:o,setText:c,setElementText:d,parentNode:y,nextSibling:_,setScopeId:w=En,cloneNode:k,insertStaticContent:N}=e,M=(E,T,G,ee=null,q=null,ke=null,J=!1,W=null,pe=!!T.dynamicChildren)=>{if(E===T)return;E&&!Aa(E,T)&&(ee=re(E),V(E,q,ke,!0),E=null),T.patchFlag===-2&&(pe=!1,T.dynamicChildren=null);const{type:R,ref:Te,shapeFlag:Ne}=T;switch(R){case hv:L(E,T,G,ee);break;case ln:B(E,T,G,ee);break;case Uf:E==null&&ve(T,G,ee,J);break;case Kt:oe(E,T,G,ee,q,ke,J,W,pe);break;default:Ne&1?Re(E,T,G,ee,q,ke,J,W,pe):Ne&6?te(E,T,G,ee,q,ke,J,W,pe):(Ne&64||Ne&128)&&R.process(E,T,G,ee,q,ke,J,W,pe,xe)}Te!=null&&q&&xp(Te,E&&E.ref,ke,T||E,!T)},L=(E,T,G,ee)=>{if(E==null)n(T.el=u(T.children),G,ee);else{const q=T.el=E.el;T.children!==E.children&&c(q,T.children)}},B=(E,T,G,ee)=>{E==null?n(T.el=o(T.children||""),G,ee):T.el=E.el},ve=(E,T,G,ee)=>{[E.el,E.anchor]=N(E.children,T,G,ee,E.el,E.anchor)},ue=({el:E,anchor:T},G,ee)=>{let q;for(;E&&E!==T;)q=_(E),n(E,G,ee),E=q;n(T,G,ee)},Me=({el:E,anchor:T})=>{let G;for(;E&&E!==T;)G=_(E),i(E),E=G;i(T)},Re=(E,T,G,ee,q,ke,J,W,pe)=>{J=J||T.type==="svg",E==null?Ae(T,G,ee,q,ke,J,W,pe):F(E,T,q,ke,J,W,pe)},Ae=(E,T,G,ee,q,ke,J,W)=>{let pe,R;const{type:Te,props:Ne,shapeFlag:Oe,transition:je,patchFlag:De,dirs:Ue}=E;if(E.el&&k!==void 0&&De===-1)pe=E.el=k(E.el);else{if(pe=E.el=s(E.type,ke,Ne&&Ne.is,Ne),Oe&8?d(pe,E.children):Oe&16&&le(E.children,pe,null,ee,q,ke&&Te!=="foreignObject",J,W),Ue&&wa(E,null,ee,"created"),Ne){for(const Xe in Ne)Xe!=="value"&&!Xl(Xe)&&a(pe,Xe,null,Ne[Xe],ke,E.children,ee,q,Z);"value"in Ne&&a(pe,"value",null,Ne.value),(R=Ne.onVnodeBeforeMount)&&Pn(R,ee,E)}x(pe,E,E.scopeId,J,ee)}Ue&&wa(E,null,ee,"beforeMount");const Ve=(!q||q&&!q.pendingBranch)&&je&&!je.persisted;Ve&&je.beforeEnter(pe),n(pe,T,G),((R=Ne&&Ne.onVnodeMounted)||Ve||Ue)&&Ar(()=>{R&&Pn(R,ee,E),Ve&&je.enter(pe),Ue&&wa(E,null,ee,"mounted")},q)},x=(E,T,G,ee,q)=>{if(G&&w(E,G),ee)for(let ke=0;ke<ee.length;ke++)w(E,ee[ke]);if(q){let ke=q.subTree;if(T===ke){const J=q.vnode;x(E,J,J.scopeId,J.slotScopeIds,q.parent)}}},le=(E,T,G,ee,q,ke,J,W,pe=0)=>{for(let R=pe;R<E.length;R++){const Te=E[R]=W?Li(E[R]):Ln(E[R]);M(null,Te,T,G,ee,q,ke,J,W)}},F=(E,T,G,ee,q,ke,J)=>{const W=T.el=E.el;let{patchFlag:pe,dynamicChildren:R,dirs:Te}=T;pe|=E.patchFlag&16;const Ne=E.props||Nt,Oe=T.props||Nt;let je;G&&_a(G,!1),(je=Oe.onVnodeBeforeUpdate)&&Pn(je,G,T,E),Te&&wa(T,E,G,"beforeUpdate"),G&&_a(G,!0);const De=q&&T.type!=="foreignObject";if(R?Se(E.dynamicChildren,R,W,G,ee,De,ke):J||Le(E,T,W,null,G,ee,De,ke,!1),pe>0){if(pe&16)Ee(W,T,Ne,Oe,G,ee,q);else if(pe&2&&Ne.class!==Oe.class&&a(W,"class",null,Oe.class,q),pe&4&&a(W,"style",Ne.style,Oe.style,q),pe&8){const Ue=T.dynamicProps;for(let Ve=0;Ve<Ue.length;Ve++){const Xe=Ue[Ve],er=Ne[Xe],wr=Oe[Xe];(wr!==er||Xe==="value")&&a(W,Xe,er,wr,q,E.children,G,ee,Z)}}pe&1&&E.children!==T.children&&d(W,T.children)}else!J&&R==null&&Ee(W,T,Ne,Oe,G,ee,q);((je=Oe.onVnodeUpdated)||Te)&&Ar(()=>{je&&Pn(je,G,T,E),Te&&wa(T,E,G,"updated")},ee)},Se=(E,T,G,ee,q,ke,J)=>{for(let W=0;W<T.length;W++){const pe=E[W],R=T[W],Te=pe.el&&(pe.type===Kt||!Aa(pe,R)||pe.shapeFlag&70)?y(pe.el):G;M(pe,R,Te,null,ee,q,ke,J,!0)}},Ee=(E,T,G,ee,q,ke,J)=>{if(G!==ee){for(const W in ee){if(Xl(W))continue;const pe=ee[W],R=G[W];pe!==R&&W!=="value"&&a(E,W,R,pe,J,T.children,q,ke,Z)}if(G!==Nt)for(const W in G)!Xl(W)&&!(W in ee)&&a(E,W,G[W],null,J,T.children,q,ke,Z);"value"in ee&&a(E,"value",G.value,ee.value)}},oe=(E,T,G,ee,q,ke,J,W,pe)=>{const R=T.el=E?E.el:u(""),Te=T.anchor=E?E.anchor:u("");let{patchFlag:Ne,dynamicChildren:Oe,slotScopeIds:je}=T;je&&(W=W?W.concat(je):je),E==null?(n(R,G,ee),n(Te,G,ee),le(T.children,G,Te,q,ke,J,W,pe)):Ne>0&&Ne&64&&Oe&&E.dynamicChildren?(Se(E.dynamicChildren,Oe,G,q,ke,J,W),(T.key!=null||q&&T===q.subTree)&&m$(E,T,!0)):Le(E,T,G,Te,q,ke,J,W,pe)},te=(E,T,G,ee,q,ke,J,W,pe)=>{T.slotScopeIds=W,E==null?T.shapeFlag&512?q.ctx.activate(T,G,ee,J,pe):ae(T,G,ee,q,ke,J,pe):ne(E,T,pe)},ae=(E,T,G,ee,q,ke,J)=>{const W=E.component=bC(E,ee,q);if(zc(E)&&(W.ctx.renderer=xe),wC(W),W.asyncDep){if(q&&q.registerDep(W,be),!E.el){const pe=W.subTree=bt(ln);B(null,pe,T,G)}return}be(W,E,T,G,q,ke,J)},ne=(E,T,G)=>{const ee=T.component=E.component;if(OI(E,T,G))if(ee.asyncDep&&!ee.asyncResolved){A(ee,T,G);return}else ee.next=T,kI(ee.update),ee.update();else T.el=E.el,ee.vnode=T},be=(E,T,G,ee,q,ke,J)=>{const W=()=>{if(E.isMounted){let{next:Te,bu:Ne,u:Oe,parent:je,vnode:De}=E,Ue=Te,Ve;_a(E,!1),Te?(Te.el=De.el,A(E,Te,J)):Te=De,Ne&&Zl(Ne),(Ve=Te.props&&Te.props.onVnodeBeforeUpdate)&&Pn(Ve,je,Te,De),_a(E,!0);const Xe=Lf(E),er=E.subTree;E.subTree=Xe,M(er,Xe,y(er.el),re(er),E,q,ke),Te.el=Xe.el,Ue===null&&AI(E,Xe.el),Oe&&Ar(Oe,q),(Ve=Te.props&&Te.props.onVnodeUpdated)&&Ar(()=>Pn(Ve,je,Te,De),q)}else{let Te;const{el:Ne,props:Oe}=T,{bm:je,m:De,parent:Ue}=E,Ve=nu(T);if(_a(E,!1),je&&Zl(je),!Ve&&(Te=Oe&&Oe.onVnodeBeforeMount)&&Pn(Te,Ue,T),_a(E,!0),Ne&&$e){const Xe=()=>{E.subTree=Lf(E),$e(Ne,E.subTree,E,q,null)};Ve?T.type.__asyncLoader().then(()=>!E.isUnmounted&&Xe()):Xe()}else{const Xe=E.subTree=Lf(E);M(null,Xe,G,ee,E,q,ke),T.el=Xe.el}if(De&&Ar(De,q),!Ve&&(Te=Oe&&Oe.onVnodeMounted)){const Xe=T;Ar(()=>Pn(Te,Ue,Xe),q)}(T.shapeFlag&256||Ue&&nu(Ue.vnode)&&Ue.vnode.shapeFlag&256)&&E.a&&Ar(E.a,q),E.isMounted=!0,T=G=ee=null}},pe=E.effect=new tv(W,()=>lv(R),E.scope),R=E.update=()=>pe.run();R.id=E.uid,_a(E,!0),R()},A=(E,T,G)=>{T.component=E;const ee=E.vnode.props;E.vnode=T,E.next=null,nC(E,T.props,ee,G),sC(E,T.children,G),ao(),py(),so()},Le=(E,T,G,ee,q,ke,J,W,pe=!1)=>{const R=E&&E.children,Te=E?E.shapeFlag:0,Ne=T.children,{patchFlag:Oe,shapeFlag:je}=T;if(Oe>0){if(Oe&128){We(R,Ne,G,ee,q,ke,J,W,pe);return}else if(Oe&256){at(R,Ne,G,ee,q,ke,J,W,pe);return}}je&8?(Te&16&&Z(R,q,ke),Ne!==R&&d(G,Ne)):Te&16?je&16?We(R,Ne,G,ee,q,ke,J,W,pe):Z(R,q,ke,!0):(Te&8&&d(G,""),je&16&&le(Ne,G,ee,q,ke,J,W,pe))},at=(E,T,G,ee,q,ke,J,W,pe)=>{E=E||Ls,T=T||Ls;const R=E.length,Te=T.length,Ne=Math.min(R,Te);let Oe;for(Oe=0;Oe<Ne;Oe++){const je=T[Oe]=pe?Li(T[Oe]):Ln(T[Oe]);M(E[Oe],je,G,null,q,ke,J,W,pe)}R>Te?Z(E,q,ke,!0,!1,Ne):le(T,G,ee,q,ke,J,W,pe,Ne)},We=(E,T,G,ee,q,ke,J,W,pe)=>{let R=0;const Te=T.length;let Ne=E.length-1,Oe=Te-1;for(;R<=Ne&&R<=Oe;){const je=E[R],De=T[R]=pe?Li(T[R]):Ln(T[R]);if(Aa(je,De))M(je,De,G,null,q,ke,J,W,pe);else break;R++}for(;R<=Ne&&R<=Oe;){const je=E[Ne],De=T[Oe]=pe?Li(T[Oe]):Ln(T[Oe]);if(Aa(je,De))M(je,De,G,null,q,ke,J,W,pe);else break;Ne--,Oe--}if(R>Ne){if(R<=Oe){const je=Oe+1,De=je<Te?T[je].el:ee;for(;R<=Oe;)M(null,T[R]=pe?Li(T[R]):Ln(T[R]),G,De,q,ke,J,W,pe),R++}}else if(R>Oe)for(;R<=Ne;)V(E[R],q,ke,!0),R++;else{const je=R,De=R,Ue=new Map;for(R=De;R<=Oe;R++){const jt=T[R]=pe?Li(T[R]):Ln(T[R]);jt.key!=null&&Ue.set(jt.key,R)}let Ve,Xe=0;const er=Oe-De+1;let wr=!1,pn=0;const Cr=new Array(er);for(R=0;R<er;R++)Cr[R]=0;for(R=je;R<=Ne;R++){const jt=E[R];if(Xe>=er){V(jt,q,ke,!0);continue}let se;if(jt.key!=null)se=Ue.get(jt.key);else for(Ve=De;Ve<=Oe;Ve++)if(Cr[Ve-De]===0&&Aa(jt,T[Ve])){se=Ve;break}se===void 0?V(jt,q,ke,!0):(Cr[se-De]=R+1,se>=pn?pn=se:wr=!0,M(jt,T[se],G,null,q,ke,J,W,pe),Xe++)}const mt=wr?fC(Cr):Ls;for(Ve=mt.length-1,R=er-1;R>=0;R--){const jt=De+R,se=T[jt],de=jt+1<Te?T[jt+1].el:ee;Cr[R]===0?M(null,se,G,de,q,ke,J,W,pe):wr&&(Ve<0||R!==mt[Ve]?fe(se,G,de,2):Ve--)}}},fe=(E,T,G,ee,q=null)=>{const{el:ke,type:J,transition:W,children:pe,shapeFlag:R}=E;if(R&6){fe(E.component.subTree,T,G,ee);return}if(R&128){E.suspense.move(T,G,ee);return}if(R&64){J.move(E,T,G,xe);return}if(J===Kt){n(ke,T,G);for(let Ne=0;Ne<pe.length;Ne++)fe(pe[Ne],T,G,ee);n(E.anchor,T,G);return}if(J===Uf){ue(E,T,G);return}if(ee!==2&&R&1&&W)if(ee===0)W.beforeEnter(ke),n(ke,T,G),Ar(()=>W.enter(ke),q);else{const{leave:Ne,delayLeave:Oe,afterLeave:je}=W,De=()=>n(ke,T,G),Ue=()=>{Ne(ke,()=>{De(),je&&je()})};Oe?Oe(ke,De,Ue):Ue()}else n(ke,T,G)},V=(E,T,G,ee=!1,q=!1)=>{const{type:ke,props:J,ref:W,children:pe,dynamicChildren:R,shapeFlag:Te,patchFlag:Ne,dirs:Oe}=E;if(W!=null&&xp(W,null,G,E,!0),Te&256){T.ctx.deactivate(E);return}const je=Te&1&&Oe,De=!nu(E);let Ue;if(De&&(Ue=J&&J.onVnodeBeforeUnmount)&&Pn(Ue,T,E),Te&6)I(E.component,G,ee);else{if(Te&128){E.suspense.unmount(G,ee);return}je&&wa(E,null,T,"beforeUnmount"),Te&64?E.type.remove(E,T,G,q,xe,ee):R&&(ke!==Kt||Ne>0&&Ne&64)?Z(R,T,G,!1,!0):(ke===Kt&&Ne&384||!q&&Te&16)&&Z(pe,T,G),ee&&Q(E)}(De&&(Ue=J&&J.onVnodeUnmounted)||je)&&Ar(()=>{Ue&&Pn(Ue,T,E),je&&wa(E,null,T,"unmounted")},G)},Q=E=>{const{type:T,el:G,anchor:ee,transition:q}=E;if(T===Kt){$(G,ee);return}if(T===Uf){Me(E);return}const ke=()=>{i(G),q&&!q.persisted&&q.afterLeave&&q.afterLeave()};if(E.shapeFlag&1&&q&&!q.persisted){const{leave:J,delayLeave:W}=q,pe=()=>J(G,ke);W?W(E.el,ke,pe):pe()}else ke()},$=(E,T)=>{let G;for(;E!==T;)G=_(E),i(E),E=G;i(T)},I=(E,T,G)=>{const{bum:ee,scope:q,update:ke,subTree:J,um:W}=E;ee&&Zl(ee),q.stop(),ke&&(ke.active=!1,V(J,E,T,G)),W&&Ar(W,T),Ar(()=>{E.isUnmounted=!0},T),T&&T.pendingBranch&&!T.isUnmounted&&E.asyncDep&&!E.asyncResolved&&E.suspenseId===T.pendingId&&(T.deps--,T.deps===0&&T.resolve())},Z=(E,T,G,ee=!1,q=!1,ke=0)=>{for(let J=ke;J<E.length;J++)V(E[J],T,G,ee,q)},re=E=>E.shapeFlag&6?re(E.component.subTree):E.shapeFlag&128?E.suspense.next():_(E.anchor||E.el),Ie=(E,T,G)=>{E==null?T._vnode&&V(T._vnode,null,null,!0):M(T._vnode||null,E,T,null,null,null,G),py(),XS(),T._vnode=E},xe={p:M,um:V,m:fe,r:Q,mt:ae,mc:le,pc:Le,pbc:Se,n:re,o:e};let ce,$e;return t&&([ce,$e]=t(xe)),{render:Ie,hydrate:ce,createApp:uC(Ie,ce)}}function _a({effect:e,update:t},r){e.allowRecurse=t.allowRecurse=r}function m$(e,t,r=!1){const n=e.children,i=t.children;if(Ke(n)&&Ke(i))for(let a=0;a<n.length;a++){const s=n[a];let u=i[a];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=i[a]=Li(i[a]),u.el=s.el),r||m$(s,u))}}function fC(e){const t=e.slice(),r=[0];let n,i,a,s,u;const o=e.length;for(n=0;n<o;n++){const c=e[n];if(c!==0){if(i=r[r.length-1],e[i]<c){t[n]=i,r.push(n);continue}for(a=0,s=r.length-1;a<s;)u=a+s>>1,e[r[u]]<c?a=u+1:s=u;c<e[r[a]]&&(a>0&&(t[n]=r[a-1]),r[a]=n)}}for(a=r.length,s=r[a-1];a-- >0;)r[a]=s,s=t[s];return r}const dC=e=>e.__isTeleport,Kt=Symbol(void 0),hv=Symbol(void 0),ln=Symbol(void 0),Uf=Symbol(void 0),iu=[];let Sn=null;function Ge(e=!1){iu.push(Sn=e?null:[])}function pC(){iu.pop(),Sn=iu[iu.length-1]||null}let wu=1;function ky(e){wu+=e}function b$(e){return e.dynamicChildren=wu>0?Sn||Ls:null,pC(),wu>0&&Sn&&Sn.push(e),e}function it(e,t,r,n,i,a){return b$(U(e,t,r,n,i,a,!0))}function Cn(e,t,r,n,i){return b$(bt(e,t,r,n,i,!0))}function gc(e){return e?e.__v_isVNode===!0:!1}function Aa(e,t){return e.type===t.type&&e.key===t.key}const Jc="__vInternal",w$=({key:e})=>e!=null?e:null,tc=({ref:e,ref_key:t,ref_for:r})=>e!=null?ur(e)||Yt(e)||lt(e)?{i:vr,r:e,k:t,f:!!r}:e:null;function U(e,t=null,r=null,n=0,i=null,a=e===Kt?0:1,s=!1,u=!1){const o={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&w$(t),ref:t&&tc(t),scopeId:t$,slotScopeIds:null,children:r,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:n,dynamicProps:i,dynamicChildren:null,appContext:null};return u?(vv(o,r),a&128&&e.normalize(o)):r&&(o.shapeFlag|=ur(r)?8:16),wu>0&&!s&&Sn&&(o.patchFlag>0||a&6)&&o.patchFlag!==32&&Sn.push(o),o}const bt=hC;function hC(e,t=null,r=null,n=0,i=null,a=!1){if((!e||e===zI)&&(e=ln),gc(e)){const u=Xi(e,t,!0);return r&&vv(u,r),wu>0&&!a&&Sn&&(u.shapeFlag&6?Sn[Sn.indexOf(e)]=u:Sn.push(u)),u.patchFlag|=-2,u}if(TC(e)&&(e=e.__vccOpts),t){t=vC(t);let{class:u,style:o}=t;u&&!ur(u)&&(t.class=hu(u)),Lt(o)&&(HS(o)&&!Ke(o)&&(o=gr({},o)),t.style=Jh(o))}const s=ur(e)?1:PI(e)?128:dC(e)?64:Lt(e)?4:lt(e)?2:0;return U(e,t,r,n,i,s,a,!0)}function vC(e){return e?HS(e)||Jc in e?gr({},e):e:null}function Xi(e,t,r=!1){const{props:n,ref:i,patchFlag:a,children:s}=e,u=t?gC(n||{},t):n;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:u,key:u&&w$(u),ref:t&&t.ref?r&&i?Ke(i)?i.concat(tc(t)):[i,tc(t)]:tc(t):i,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:s,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Kt?a===-1?16:a|16:a,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Xi(e.ssContent),ssFallback:e.ssFallback&&Xi(e.ssFallback),el:e.el,anchor:e.anchor}}function tt(e=" ",t=0){return bt(hv,null,e,t)}function cr(e="",t=!1){return t?(Ge(),Cn(ln,null,e)):bt(ln,null,e)}function Ln(e){return e==null||typeof e=="boolean"?bt(ln):Ke(e)?bt(Kt,null,e.slice()):typeof e=="object"?Li(e):bt(hv,null,String(e))}function Li(e){return e.el===null||e.memo?e:Xi(e)}function vv(e,t){let r=0;const{shapeFlag:n}=e;if(t==null)t=null;else if(Ke(t))r=16;else if(typeof t=="object")if(n&65){const i=t.default;i&&(i._c&&(i._d=!1),vv(e,i()),i._c&&(i._d=!0));return}else{r=32;const i=t._;!i&&!(Jc in t)?t._ctx=vr:i===3&&vr&&(vr.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else lt(t)?(t={default:t,_ctx:vr},r=32):(t=String(t),n&64?(r=16,t=[tt(t)]):r=8);e.children=t,e.shapeFlag|=r}function gC(...e){const t={};for(let r=0;r<e.length;r++){const n=e[r];for(const i in n)if(i==="class")t.class!==n.class&&(t.class=hu([t.class,n.class]));else if(i==="style")t.style=Jh([t.style,n.style]);else if(Bc(i)){const a=t[i],s=n[i];s&&a!==s&&!(Ke(a)&&a.includes(s))&&(t[i]=a?[].concat(a,s):s)}else i!==""&&(t[i]=n[i])}return t}function Pn(e,t,r,n=null){un(e,t,7,[r,n])}const yC=y$();let mC=0;function bC(e,t,r){const n=e.type,i=(t?t.appContext:e.appContext)||yC,a={uid:mC++,vnode:e,type:n,parent:t,appContext:i,root:null,next:null,subTree:null,effect:null,update:null,scope:new AS(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(i.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:p$(n,i),emitsOptions:e$(n,i),emit:null,emitted:null,propsDefaults:Nt,inheritAttrs:n.inheritAttrs,ctx:Nt,data:Nt,props:Nt,attrs:Nt,slots:Nt,refs:Nt,setupState:Nt,setupContext:null,suspense:r,suspenseId:r?r.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=t?t.root:a,a.emit=II.bind(null,a),e.ce&&e.ce(a),a}let sr=null;const gv=()=>sr||vr,zs=e=>{sr=e,e.scope.on()},Da=()=>{sr&&sr.scope.off(),sr=null};function _$(e){return e.vnode.shapeFlag&4}let _u=!1;function wC(e,t=!1){_u=t;const{props:r,children:n}=e.vnode,i=_$(e);rC(e,r,i,t),aC(e,n);const a=i?_C(e,t):void 0;return _u=!1,a}function _C(e,t){const r=e.type;e.accessCache=Object.create(null),e.proxy=Vs(new Proxy(e.ctx,YI));const{setup:n}=r;if(n){const i=e.setupContext=n.length>1?$C(e):null;zs(e),ao();const a=Vi(n,e,0,[e.props,i]);if(so(),Da(),CS(a)){if(a.then(Da,Da),t)return a.then(s=>{Ty(e,s,t)}).catch(s=>{Gc(s,e,0)});e.asyncDep=a}else Ty(e,a,t)}else S$(e,t)}function Ty(e,t,r){lt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Lt(t)&&(e.setupState=KS(t)),S$(e,r)}let Ey;function S$(e,t,r){const n=e.type;if(!e.render){if(!t&&Ey&&!n.render){const i=n.template||dv(e).template;if(i){const{isCustomElement:a,compilerOptions:s}=e.appContext.config,{delimiters:u,compilerOptions:o}=n,c=gr(gr({isCustomElement:a,delimiters:u},s),o);n.render=Ey(i,c)}}e.render=n.render||En}zs(e),ao(),QI(e),so(),Da()}function SC(e){return new Proxy(e.attrs,{get(t,r){return qr(e,"get","$attrs"),t[r]}})}function $C(e){const t=n=>{e.exposed=n||{}};let r;return{get attrs(){return r||(r=SC(e))},slots:e.slots,emit:e.emit,expose:t}}function Yc(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(KS(Vs(e.exposed)),{get(t,r){if(r in t)return t[r];if(r in hc)return hc[r](e)}}))}function kC(e,t=!0){return lt(e)?e.displayName||e.name:e.name||t&&e.__name}function TC(e){return lt(e)&&"__vccOpts"in e}const Jt=(e,t)=>_I(e,t,_u);function $$(e,t,r){const n=arguments.length;return n===2?Lt(t)&&!Ke(t)?gc(t)?bt(e,null,[t]):bt(e,t):bt(e,null,t):(n>3?r=Array.prototype.slice.call(arguments,2):n===3&&gc(r)&&(r=[r]),bt(e,t,r))}const EC="3.2.39",IC="http://www.w3.org/2000/svg",Pa=typeof document<"u"?document:null,Iy=Pa&&Pa.createElement("template"),CC={insert:(e,t,r)=>{t.insertBefore(e,r||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,r,n)=>{const i=t?Pa.createElementNS(IC,e):Pa.createElement(e,r?{is:r}:void 0);return e==="select"&&n&&n.multiple!=null&&i.setAttribute("multiple",n.multiple),i},createText:e=>Pa.createTextNode(e),createComment:e=>Pa.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Pa.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,r,n,i,a){const s=r?r.previousSibling:t.lastChild;if(i&&(i===a||i.nextSibling))for(;t.insertBefore(i.cloneNode(!0),r),!(i===a||!(i=i.nextSibling)););else{Iy.innerHTML=n?`<svg>${e}</svg>`:e;const u=Iy.content;if(n){const o=u.firstChild;for(;o.firstChild;)u.appendChild(o.firstChild);u.removeChild(o)}t.insertBefore(u,r)}return[s?s.nextSibling:t.firstChild,r?r.previousSibling:t.lastChild]}};function RC(e,t,r){const n=e._vtc;n&&(t=(t?[t,...n]:[...n]).join(" ")),t==null?e.removeAttribute("class"):r?e.setAttribute("class",t):e.className=t}function OC(e,t,r){const n=e.style,i=ur(r);if(r&&!i){for(const a in r)Lp(n,a,r[a]);if(t&&!ur(t))for(const a in t)r[a]==null&&Lp(n,a,"")}else{const a=n.display;i?t!==r&&(n.cssText=r):t&&e.removeAttribute("style"),"_vod"in e&&(n.display=a)}}const Cy=/\s*!important$/;function Lp(e,t,r){if(Ke(r))r.forEach(n=>Lp(e,t,n));else if(r==null&&(r=""),t.startsWith("--"))e.setProperty(t,r);else{const n=AC(e,t);Cy.test(r)?e.setProperty(Va(n),r.replace(Cy,""),"important"):e[n]=r}}const Ry=["Webkit","Moz","ms"],Df={};function AC(e,t){const r=Df[t];if(r)return r;let n=qn(t);if(n!=="filter"&&n in e)return Df[t]=n;n=Wc(n);for(let i=0;i<Ry.length;i++){const a=Ry[i]+n;if(a in e)return Df[t]=a}return t}const Oy="http://www.w3.org/1999/xlink";function PC(e,t,r,n,i){if(n&&t.startsWith("xlink:"))r==null?e.removeAttributeNS(Oy,t.slice(6,t.length)):e.setAttributeNS(Oy,t,r);else{const a=RE(t);r==null||a&&!ES(r)?e.removeAttribute(t):e.setAttribute(t,a?"":r)}}function MC(e,t,r,n,i,a,s){if(t==="innerHTML"||t==="textContent"){n&&s(n,i,a),e[t]=r==null?"":r;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=r;const o=r==null?"":r;(e.value!==o||e.tagName==="OPTION")&&(e.value=o),r==null&&e.removeAttribute(t);return}let u=!1;if(r===""||r==null){const o=typeof e[t];o==="boolean"?r=ES(r):r==null&&o==="string"?(r="",u=!0):o==="number"&&(r=0,u=!0)}try{e[t]=r}catch{}u&&e.removeAttribute(t)}const[k$,NC]=(()=>{let e=Date.now,t=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const r=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(r&&Number(r[1])<=53)}return[e,t]})();let jp=0;const xC=Promise.resolve(),LC=()=>{jp=0},jC=()=>jp||(xC.then(LC),jp=k$());function Di(e,t,r,n){e.addEventListener(t,r,n)}function UC(e,t,r,n){e.removeEventListener(t,r,n)}function DC(e,t,r,n,i=null){const a=e._vei||(e._vei={}),s=a[t];if(n&&s)s.value=n;else{const[u,o]=FC(t);if(n){const c=a[t]=BC(n,i);Di(e,u,c,o)}else s&&(UC(e,u,s,o),a[t]=void 0)}}const Ay=/(?:Once|Passive|Capture)$/;function FC(e){let t;if(Ay.test(e)){t={};let n;for(;n=e.match(Ay);)e=e.slice(0,e.length-n[0].length),t[n[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Va(e.slice(2)),t]}function BC(e,t){const r=n=>{const i=n.timeStamp||k$();(NC||i>=r.attached-1)&&un(qC(n,r.value),t,5,[n])};return r.value=e,r.attached=jC(),r}function qC(e,t){if(Ke(t)){const r=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{r.call(e),e._stopped=!0},t.map(n=>i=>!i._stopped&&n&&n(i))}else return t}const Py=/^on[a-z]/,WC=(e,t,r,n,i=!1,a,s,u,o)=>{t==="class"?RC(e,n,i):t==="style"?OC(e,r,n):Bc(t)?Qh(t)||DC(e,t,r,n,s):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):HC(e,t,n,i))?MC(e,t,n,a,s,u,o):(t==="true-value"?e._trueValue=n:t==="false-value"&&(e._falseValue=n),PC(e,t,n,i))};function HC(e,t,r,n){return n?!!(t==="innerHTML"||t==="textContent"||t in e&&Py.test(t)&&lt(r)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||Py.test(t)&&ur(r)?!1:t in e}const GC={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String};jI.props;const Ks=e=>{const t=e.props["onUpdate:modelValue"]||!1;return Ke(t)?r=>Zl(t,r):t};function VC(e){e.target.composing=!0}function My(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const Ma={created(e,{modifiers:{lazy:t,trim:r,number:n}},i){e._assign=Ks(i);const a=n||i.props&&i.props.type==="number";Di(e,t?"change":"input",s=>{if(s.target.composing)return;let u=e.value;r&&(u=u.trim()),a&&(u=fc(u)),e._assign(u)}),r&&Di(e,"change",()=>{e.value=e.value.trim()}),t||(Di(e,"compositionstart",VC),Di(e,"compositionend",My),Di(e,"change",My))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:r,trim:n,number:i}},a){if(e._assign=Ks(a),e.composing||document.activeElement===e&&e.type!=="range"&&(r||n&&e.value.trim()===t||(i||e.type==="number")&&fc(e.value)===t))return;const s=t==null?"":t;e.value!==s&&(e.value=s)}},zC={deep:!0,created(e,t,r){e._assign=Ks(r),Di(e,"change",()=>{const n=e._modelValue,i=Su(e),a=e.checked,s=e._assign;if(Ke(n)){const u=Yh(n,i),o=u!==-1;if(a&&!o)s(n.concat(i));else if(!a&&o){const c=[...n];c.splice(u,1),s(c)}}else if(io(n)){const u=new Set(n);a?u.add(i):u.delete(i),s(u)}else s(T$(e,a))})},mounted:Ny,beforeUpdate(e,t,r){e._assign=Ks(r),Ny(e,t,r)}};function Ny(e,{value:t,oldValue:r},n){e._modelValue=t,Ke(t)?e.checked=Yh(t,n.props.value)>-1:io(t)?e.checked=t.has(n.props.value):t!==r&&(e.checked=Pu(t,T$(e,!0)))}const Up={deep:!0,created(e,{value:t,modifiers:{number:r}},n){const i=io(t);Di(e,"change",()=>{const a=Array.prototype.filter.call(e.options,s=>s.selected).map(s=>r?fc(Su(s)):Su(s));e._assign(e.multiple?i?new Set(a):a:a[0])}),e._assign=Ks(n)},mounted(e,{value:t}){xy(e,t)},beforeUpdate(e,t,r){e._assign=Ks(r)},updated(e,{value:t}){xy(e,t)}};function xy(e,t){const r=e.multiple;if(!(r&&!Ke(t)&&!io(t))){for(let n=0,i=e.options.length;n<i;n++){const a=e.options[n],s=Su(a);if(r)Ke(t)?a.selected=Yh(t,s)>-1:a.selected=t.has(s);else if(Pu(Su(a),t)){e.selectedIndex!==n&&(e.selectedIndex=n);return}}!r&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function Su(e){return"_value"in e?e._value:e.value}function T$(e,t){const r=t?"_trueValue":"_falseValue";return r in e?e[r]:t}const KC=["ctrl","shift","alt","meta"],JC={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>KC.some(r=>e[`${r}Key`]&&!t.includes(r))},YC=(e,t)=>(r,...n)=>{for(let i=0;i<t.length;i++){const a=JC[t[i]];if(a&&a(r,t))return}return e(r,...n)},QC={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},XC=(e,t)=>r=>{if(!("key"in r))return;const n=Va(r.key);if(t.some(i=>i===n||QC[i]===n))return e(r)},ct={beforeMount(e,{value:t},{transition:r}){e._vod=e.style.display==="none"?"":e.style.display,r&&t?r.beforeEnter(e):Mo(e,t)},mounted(e,{value:t},{transition:r}){r&&t&&r.enter(e)},updated(e,{value:t,oldValue:r},{transition:n}){!t!=!r&&(n?t?(n.beforeEnter(e),Mo(e,!0),n.enter(e)):n.leave(e,()=>{Mo(e,!1)}):Mo(e,t))},beforeUnmount(e,{value:t}){Mo(e,t)}};function Mo(e,t){e.style.display=t?e._vod:"none"}const ZC=gr({patchProp:WC},CC);let Ly;function eR(){return Ly||(Ly=lC(ZC))}const tR=(...e)=>{const t=eR().createApp(...e),{mount:r}=t;return t.mount=n=>{const i=rR(n);if(!i)return;const a=t._component;!lt(a)&&!a.render&&!a.template&&(a.template=i.innerHTML),i.innerHTML="";const s=r(i,!1,i instanceof SVGElement);return i instanceof Element&&(i.removeAttribute("v-cloak"),i.setAttribute("data-v-app","")),s},t};function rR(e){return ur(e)?document.querySelector(e):e}var nR=!1;/*!
  * pinia v2.0.22
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let E$;const Qc=e=>E$=e,I$=Symbol();function Dp(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var au;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(au||(au={}));function iR(){const e=PS(!0),t=e.run(()=>nt({}));let r=[],n=[];const i=Vs({install(a){Qc(i),i._a=a,a.provide(I$,i),a.config.globalProperties.$pinia=i,n.forEach(s=>r.push(s)),n=[]},use(a){return!this._a&&!nR?n.push(a):r.push(a),this},_p:r,_a:null,_e:e,_s:new Map,state:t});return i}const C$=()=>{};function jy(e,t,r,n=C$){e.push(t);const i=()=>{const a=e.indexOf(t);a>-1&&(e.splice(a,1),n())};return!r&&gv()&&fv(i),i}function ds(e,...t){e.slice().forEach(r=>{r(...t)})}function Fp(e,t){e instanceof Map&&t instanceof Map&&t.forEach((r,n)=>e.set(n,r)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const r in t){if(!t.hasOwnProperty(r))continue;const n=t[r],i=e[r];Dp(i)&&Dp(n)&&e.hasOwnProperty(r)&&!Yt(n)&&!Gi(n)?e[r]=Fp(i,n):e[r]=n}return e}const aR=Symbol();function sR(e){return!Dp(e)||!e.hasOwnProperty(aR)}const{assign:ri}=Object;function oR(e){return!!(Yt(e)&&e.effect)}function uR(e,t,r,n){const{state:i,actions:a,getters:s}=t,u=r.state.value[e];let o;function c(){u||(r.state.value[e]=i?i():{});const d=yI(r.state.value[e]);return ri(d,a,Object.keys(s||{}).reduce((y,_)=>(y[_]=Vs(Jt(()=>{Qc(r);const w=r._s.get(e);return s[_].call(w,w)})),y),{}))}return o=R$(e,c,t,r,n,!0),o.$reset=function(){const y=i?i():{};this.$patch(_=>{ri(_,y)})},o}function R$(e,t,r={},n,i,a){let s;const u=ri({actions:{}},r),o={deep:!0};let c,d,y=Vs([]),_=Vs([]),w;const k=n.state.value[e];!a&&!k&&(n.state.value[e]={}),nt({});let N;function M(Ae){let x;c=d=!1,typeof Ae=="function"?(Ae(n.state.value[e]),x={type:au.patchFunction,storeId:e,events:w}):(Fp(n.state.value[e],Ae),x={type:au.patchObject,payload:Ae,storeId:e,events:w});const le=N=Symbol();uv().then(()=>{N===le&&(c=!0)}),d=!0,ds(y,x,n.state.value[e])}const L=C$;function B(){s.stop(),y=[],_=[],n._s.delete(e)}function ve(Ae,x){return function(){Qc(n);const le=Array.from(arguments),F=[],Se=[];function Ee(ae){F.push(ae)}function oe(ae){Se.push(ae)}ds(_,{args:le,name:Ae,store:Me,after:Ee,onError:oe});let te;try{te=x.apply(this&&this.$id===e?this:Me,le)}catch(ae){throw ds(Se,ae),ae}return te instanceof Promise?te.then(ae=>(ds(F,ae),ae)).catch(ae=>(ds(Se,ae),Promise.reject(ae))):(ds(F,te),te)}}const ue={_p:n,$id:e,$onAction:jy.bind(null,_),$patch:M,$reset:L,$subscribe(Ae,x={}){const le=jy(y,Ae,x.detached,()=>F()),F=s.run(()=>ru(()=>n.state.value[e],Se=>{(x.flush==="sync"?d:c)&&Ae({storeId:e,type:au.direct,events:w},Se)},ri({},o,x)));return le},$dispose:B},Me=za(ri({},ue));n._s.set(e,Me);const Re=n._e.run(()=>(s=PS(),s.run(()=>t())));for(const Ae in Re){const x=Re[Ae];if(Yt(x)&&!oR(x)||Gi(x))a||(k&&sR(x)&&(Yt(x)?x.value=k[Ae]:Fp(x,k[Ae])),n.state.value[e][Ae]=x);else if(typeof x=="function"){const le=ve(Ae,x);Re[Ae]=le,u.actions[Ae]=x}}return ri(Me,Re),ri(yt(Me),Re),Object.defineProperty(Me,"$state",{get:()=>n.state.value[e],set:Ae=>{M(x=>{ri(x,Ae)})}}),n._p.forEach(Ae=>{ri(Me,s.run(()=>Ae({store:Me,app:n._a,pinia:n,options:u})))}),k&&a&&r.hydrate&&r.hydrate(Me.$state,k),c=!0,d=!0,Me}function yv(e,t,r){let n,i;const a=typeof t=="function";typeof e=="string"?(n=e,i=a?r:t):(i=e,n=e.id);function s(u,o){const c=gv();return u=u||c&&In(I$),u&&Qc(u),u=E$,u._s.has(n)||(a?R$(n,t,i,u):uR(n,i,u)),u._s.get(n)}return s.$id=n,s}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Cs=typeof window<"u";function lR(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const It=Object.assign;function Ff(e,t){const r={};for(const n in t){const i=t[n];r[n]=Rn(i)?i.map(e):e(i)}return r}const su=()=>{},Rn=Array.isArray,cR=/\/$/,fR=e=>e.replace(cR,"");function Bf(e,t,r="/"){let n,i={},a="",s="";const u=t.indexOf("#");let o=t.indexOf("?");return u<o&&u>=0&&(o=-1),o>-1&&(n=t.slice(0,o),a=t.slice(o+1,u>-1?u:t.length),i=e(a)),u>-1&&(n=n||t.slice(0,u),s=t.slice(u,t.length)),n=vR(n!=null?n:t,r),{fullPath:n+(a&&"?")+a+s,path:n,query:i,hash:s}}function dR(e,t){const r=t.query?e(t.query):"";return t.path+(r&&"?")+r+(t.hash||"")}function Uy(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function pR(e,t,r){const n=t.matched.length-1,i=r.matched.length-1;return n>-1&&n===i&&Js(t.matched[n],r.matched[i])&&O$(t.params,r.params)&&e(t.query)===e(r.query)&&t.hash===r.hash}function Js(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function O$(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(!hR(e[r],t[r]))return!1;return!0}function hR(e,t){return Rn(e)?Dy(e,t):Rn(t)?Dy(t,e):e===t}function Dy(e,t){return Rn(t)?e.length===t.length&&e.every((r,n)=>r===t[n]):e.length===1&&e[0]===t}function vR(e,t){if(e.startsWith("/"))return e;if(!e)return t;const r=t.split("/"),n=e.split("/");let i=r.length-1,a,s;for(a=0;a<n.length;a++)if(s=n[a],s!==".")if(s==="..")i>1&&i--;else break;return r.slice(0,i).join("/")+"/"+n.slice(a-(a===n.length?1:0)).join("/")}var $u;(function(e){e.pop="pop",e.push="push"})($u||($u={}));var ou;(function(e){e.back="back",e.forward="forward",e.unknown=""})(ou||(ou={}));function gR(e){if(!e)if(Cs){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),fR(e)}const yR=/^[^#]+#/;function mR(e,t){return e.replace(yR,"#")+t}function bR(e,t){const r=document.documentElement.getBoundingClientRect(),n=e.getBoundingClientRect();return{behavior:t.behavior,left:n.left-r.left-(t.left||0),top:n.top-r.top-(t.top||0)}}const Xc=()=>({left:window.pageXOffset,top:window.pageYOffset});function wR(e){let t;if("el"in e){const r=e.el,n=typeof r=="string"&&r.startsWith("#"),i=typeof r=="string"?n?document.getElementById(r.slice(1)):document.querySelector(r):r;if(!i)return;t=bR(i,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Fy(e,t){return(history.state?history.state.position-t:-1)+e}const Bp=new Map;function _R(e,t){Bp.set(e,t)}function SR(e){const t=Bp.get(e);return Bp.delete(e),t}let $R=()=>location.protocol+"//"+location.host;function A$(e,t){const{pathname:r,search:n,hash:i}=t,a=e.indexOf("#");if(a>-1){let u=i.includes(e.slice(a))?e.slice(a).length:1,o=i.slice(u);return o[0]!=="/"&&(o="/"+o),Uy(o,"")}return Uy(r,e)+n+i}function kR(e,t,r,n){let i=[],a=[],s=null;const u=({state:_})=>{const w=A$(e,location),k=r.value,N=t.value;let M=0;if(_){if(r.value=w,t.value=_,s&&s===k){s=null;return}M=N?_.position-N.position:0}else n(w);i.forEach(L=>{L(r.value,k,{delta:M,type:$u.pop,direction:M?M>0?ou.forward:ou.back:ou.unknown})})};function o(){s=r.value}function c(_){i.push(_);const w=()=>{const k=i.indexOf(_);k>-1&&i.splice(k,1)};return a.push(w),w}function d(){const{history:_}=window;!_.state||_.replaceState(It({},_.state,{scroll:Xc()}),"")}function y(){for(const _ of a)_();a=[],window.removeEventListener("popstate",u),window.removeEventListener("beforeunload",d)}return window.addEventListener("popstate",u),window.addEventListener("beforeunload",d),{pauseListeners:o,listen:c,destroy:y}}function By(e,t,r,n=!1,i=!1){return{back:e,current:t,forward:r,replaced:n,position:window.history.length,scroll:i?Xc():null}}function TR(e){const{history:t,location:r}=window,n={value:A$(e,r)},i={value:t.state};i.value||a(n.value,{back:null,current:n.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function a(o,c,d){const y=e.indexOf("#"),_=y>-1?(r.host&&document.querySelector("base")?e:e.slice(y))+o:$R()+e+o;try{t[d?"replaceState":"pushState"](c,"",_),i.value=c}catch(w){console.error(w),r[d?"replace":"assign"](_)}}function s(o,c){const d=It({},t.state,By(i.value.back,o,i.value.forward,!0),c,{position:i.value.position});a(o,d,!0),n.value=o}function u(o,c){const d=It({},i.value,t.state,{forward:o,scroll:Xc()});a(d.current,d,!0);const y=It({},By(n.value,o,null),{position:d.position+1},c);a(o,y,!1),n.value=o}return{location:n,state:i,push:u,replace:s}}function ER(e){e=gR(e);const t=TR(e),r=kR(e,t.state,t.location,t.replace);function n(a,s=!0){s||r.pauseListeners(),history.go(a)}const i=It({location:"",base:e,go:n,createHref:mR.bind(null,e)},t,r);return Object.defineProperty(i,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(i,"state",{enumerable:!0,get:()=>t.state.value}),i}function IR(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),ER(e)}function CR(e){return typeof e=="string"||e&&typeof e=="object"}function P$(e){return typeof e=="string"||typeof e=="symbol"}const Oi={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},M$=Symbol("");var qy;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(qy||(qy={}));function Ys(e,t){return It(new Error,{type:e,[M$]:!0},t)}function Xn(e,t){return e instanceof Error&&M$ in e&&(t==null||!!(e.type&t))}const Wy="[^/]+?",RR={sensitive:!1,strict:!1,start:!0,end:!0},OR=/[.+*?^${}()[\]/\\]/g;function AR(e,t){const r=It({},RR,t),n=[];let i=r.start?"^":"";const a=[];for(const c of e){const d=c.length?[]:[90];r.strict&&!c.length&&(i+="/");for(let y=0;y<c.length;y++){const _=c[y];let w=40+(r.sensitive?.25:0);if(_.type===0)y||(i+="/"),i+=_.value.replace(OR,"\\$&"),w+=40;else if(_.type===1){const{value:k,repeatable:N,optional:M,regexp:L}=_;a.push({name:k,repeatable:N,optional:M});const B=L||Wy;if(B!==Wy){w+=10;try{new RegExp(`(${B})`)}catch(ue){throw new Error(`Invalid custom RegExp for param "${k}" (${B}): `+ue.message)}}let ve=N?`((?:${B})(?:/(?:${B}))*)`:`(${B})`;y||(ve=M&&c.length<2?`(?:/${ve})`:"/"+ve),M&&(ve+="?"),i+=ve,w+=20,M&&(w+=-8),N&&(w+=-20),B===".*"&&(w+=-50)}d.push(w)}n.push(d)}if(r.strict&&r.end){const c=n.length-1;n[c][n[c].length-1]+=.7000000000000001}r.strict||(i+="/?"),r.end?i+="$":r.strict&&(i+="(?:/|$)");const s=new RegExp(i,r.sensitive?"":"i");function u(c){const d=c.match(s),y={};if(!d)return null;for(let _=1;_<d.length;_++){const w=d[_]||"",k=a[_-1];y[k.name]=w&&k.repeatable?w.split("/"):w}return y}function o(c){let d="",y=!1;for(const _ of e){(!y||!d.endsWith("/"))&&(d+="/"),y=!1;for(const w of _)if(w.type===0)d+=w.value;else if(w.type===1){const{value:k,repeatable:N,optional:M}=w,L=k in c?c[k]:"";if(Rn(L)&&!N)throw new Error(`Provided param "${k}" is an array but it is not repeatable (* or + modifiers)`);const B=Rn(L)?L.join("/"):L;if(!B)if(M)_.length<2&&(d.endsWith("/")?d=d.slice(0,-1):y=!0);else throw new Error(`Missing required param "${k}"`);d+=B}}return d||"/"}return{re:s,score:n,keys:a,parse:u,stringify:o}}function PR(e,t){let r=0;for(;r<e.length&&r<t.length;){const n=t[r]-e[r];if(n)return n;r++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function MR(e,t){let r=0;const n=e.score,i=t.score;for(;r<n.length&&r<i.length;){const a=PR(n[r],i[r]);if(a)return a;r++}if(Math.abs(i.length-n.length)===1){if(Hy(n))return 1;if(Hy(i))return-1}return i.length-n.length}function Hy(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const NR={type:0,value:""},xR=/[a-zA-Z0-9_]/;function LR(e){if(!e)return[[]];if(e==="/")return[[NR]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(w){throw new Error(`ERR (${r})/"${c}": ${w}`)}let r=0,n=r;const i=[];let a;function s(){a&&i.push(a),a=[]}let u=0,o,c="",d="";function y(){!c||(r===0?a.push({type:0,value:c}):r===1||r===2||r===3?(a.length>1&&(o==="*"||o==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),a.push({type:1,value:c,regexp:d,repeatable:o==="*"||o==="+",optional:o==="*"||o==="?"})):t("Invalid state to consume buffer"),c="")}function _(){c+=o}for(;u<e.length;){if(o=e[u++],o==="\\"&&r!==2){n=r,r=4;continue}switch(r){case 0:o==="/"?(c&&y(),s()):o===":"?(y(),r=1):_();break;case 4:_(),r=n;break;case 1:o==="("?r=2:xR.test(o)?_():(y(),r=0,o!=="*"&&o!=="?"&&o!=="+"&&u--);break;case 2:o===")"?d[d.length-1]=="\\"?d=d.slice(0,-1)+o:r=3:d+=o;break;case 3:y(),r=0,o!=="*"&&o!=="?"&&o!=="+"&&u--,d="";break;default:t("Unknown state");break}}return r===2&&t(`Unfinished custom RegExp for param "${c}"`),y(),s(),i}function jR(e,t,r){const n=AR(LR(e.path),r),i=It(n,{record:e,parent:t,children:[],alias:[]});return t&&!i.record.aliasOf==!t.record.aliasOf&&t.children.push(i),i}function UR(e,t){const r=[],n=new Map;t=zy({strict:!1,end:!0,sensitive:!1},t);function i(d){return n.get(d)}function a(d,y,_){const w=!_,k=DR(d);k.aliasOf=_&&_.record;const N=zy(t,d),M=[k];if("alias"in d){const ve=typeof d.alias=="string"?[d.alias]:d.alias;for(const ue of ve)M.push(It({},k,{components:_?_.record.components:k.components,path:ue,aliasOf:_?_.record:k}))}let L,B;for(const ve of M){const{path:ue}=ve;if(y&&ue[0]!=="/"){const Me=y.record.path,Re=Me[Me.length-1]==="/"?"":"/";ve.path=y.record.path+(ue&&Re+ue)}if(L=jR(ve,y,N),_?_.alias.push(L):(B=B||L,B!==L&&B.alias.push(L),w&&d.name&&!Vy(L)&&s(d.name)),k.children){const Me=k.children;for(let Re=0;Re<Me.length;Re++)a(Me[Re],L,_&&_.children[Re])}_=_||L,o(L)}return B?()=>{s(B)}:su}function s(d){if(P$(d)){const y=n.get(d);y&&(n.delete(d),r.splice(r.indexOf(y),1),y.children.forEach(s),y.alias.forEach(s))}else{const y=r.indexOf(d);y>-1&&(r.splice(y,1),d.record.name&&n.delete(d.record.name),d.children.forEach(s),d.alias.forEach(s))}}function u(){return r}function o(d){let y=0;for(;y<r.length&&MR(d,r[y])>=0&&(d.record.path!==r[y].record.path||!N$(d,r[y]));)y++;r.splice(y,0,d),d.record.name&&!Vy(d)&&n.set(d.record.name,d)}function c(d,y){let _,w={},k,N;if("name"in d&&d.name){if(_=n.get(d.name),!_)throw Ys(1,{location:d});N=_.record.name,w=It(Gy(y.params,_.keys.filter(B=>!B.optional).map(B=>B.name)),d.params&&Gy(d.params,_.keys.map(B=>B.name))),k=_.stringify(w)}else if("path"in d)k=d.path,_=r.find(B=>B.re.test(k)),_&&(w=_.parse(k),N=_.record.name);else{if(_=y.name?n.get(y.name):r.find(B=>B.re.test(y.path)),!_)throw Ys(1,{location:d,currentLocation:y});N=_.record.name,w=It({},y.params,d.params),k=_.stringify(w)}const M=[];let L=_;for(;L;)M.unshift(L.record),L=L.parent;return{name:N,path:k,params:w,matched:M,meta:BR(M)}}return e.forEach(d=>a(d)),{addRoute:a,resolve:c,removeRoute:s,getRoutes:u,getRecordMatcher:i}}function Gy(e,t){const r={};for(const n of t)n in e&&(r[n]=e[n]);return r}function DR(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:FR(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function FR(e){const t={},r=e.props||!1;if("component"in e)t.default=r;else for(const n in e.components)t[n]=typeof r=="boolean"?r:r[n];return t}function Vy(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function BR(e){return e.reduce((t,r)=>It(t,r.meta),{})}function zy(e,t){const r={};for(const n in e)r[n]=n in t?t[n]:e[n];return r}function N$(e,t){return t.children.some(r=>r===e||N$(e,r))}const x$=/#/g,qR=/&/g,WR=/\//g,HR=/=/g,GR=/\?/g,L$=/\+/g,VR=/%5B/g,zR=/%5D/g,j$=/%5E/g,KR=/%60/g,U$=/%7B/g,JR=/%7C/g,D$=/%7D/g,YR=/%20/g;function mv(e){return encodeURI(""+e).replace(JR,"|").replace(VR,"[").replace(zR,"]")}function QR(e){return mv(e).replace(U$,"{").replace(D$,"}").replace(j$,"^")}function qp(e){return mv(e).replace(L$,"%2B").replace(YR,"+").replace(x$,"%23").replace(qR,"%26").replace(KR,"`").replace(U$,"{").replace(D$,"}").replace(j$,"^")}function XR(e){return qp(e).replace(HR,"%3D")}function ZR(e){return mv(e).replace(x$,"%23").replace(GR,"%3F")}function eO(e){return e==null?"":ZR(e).replace(WR,"%2F")}function yc(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function tO(e){const t={};if(e===""||e==="?")return t;const n=(e[0]==="?"?e.slice(1):e).split("&");for(let i=0;i<n.length;++i){const a=n[i].replace(L$," "),s=a.indexOf("="),u=yc(s<0?a:a.slice(0,s)),o=s<0?null:yc(a.slice(s+1));if(u in t){let c=t[u];Rn(c)||(c=t[u]=[c]),c.push(o)}else t[u]=o}return t}function Ky(e){let t="";for(let r in e){const n=e[r];if(r=XR(r),n==null){n!==void 0&&(t+=(t.length?"&":"")+r);continue}(Rn(n)?n.map(a=>a&&qp(a)):[n&&qp(n)]).forEach(a=>{a!==void 0&&(t+=(t.length?"&":"")+r,a!=null&&(t+="="+a))})}return t}function rO(e){const t={};for(const r in e){const n=e[r];n!==void 0&&(t[r]=Rn(n)?n.map(i=>i==null?null:""+i):n==null?n:""+n)}return t}const nO=Symbol(""),Jy=Symbol(""),Zc=Symbol(""),bv=Symbol(""),Wp=Symbol("");function No(){let e=[];function t(n){return e.push(n),()=>{const i=e.indexOf(n);i>-1&&e.splice(i,1)}}function r(){e=[]}return{add:t,list:()=>e,reset:r}}function ji(e,t,r,n,i){const a=n&&(n.enterCallbacks[i]=n.enterCallbacks[i]||[]);return()=>new Promise((s,u)=>{const o=y=>{y===!1?u(Ys(4,{from:r,to:t})):y instanceof Error?u(y):CR(y)?u(Ys(2,{from:t,to:y})):(a&&n.enterCallbacks[i]===a&&typeof y=="function"&&a.push(y),s())},c=e.call(n&&n.instances[i],t,r,o);let d=Promise.resolve(c);e.length<3&&(d=d.then(o)),d.catch(y=>u(y))})}function qf(e,t,r,n){const i=[];for(const a of e)for(const s in a.components){let u=a.components[s];if(!(t!=="beforeRouteEnter"&&!a.instances[s]))if(iO(u)){const c=(u.__vccOpts||u)[t];c&&i.push(ji(c,r,n,a,s))}else{let o=u();i.push(()=>o.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${s}" at "${a.path}"`));const d=lR(c)?c.default:c;a.components[s]=d;const _=(d.__vccOpts||d)[t];return _&&ji(_,r,n,a,s)()}))}}return i}function iO(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Yy(e){const t=In(Zc),r=In(bv),n=Jt(()=>t.resolve(Ot(e.to))),i=Jt(()=>{const{matched:o}=n.value,{length:c}=o,d=o[c-1],y=r.matched;if(!d||!y.length)return-1;const _=y.findIndex(Js.bind(null,d));if(_>-1)return _;const w=Qy(o[c-2]);return c>1&&Qy(d)===w&&y[y.length-1].path!==w?y.findIndex(Js.bind(null,o[c-2])):_}),a=Jt(()=>i.value>-1&&oO(r.params,n.value.params)),s=Jt(()=>i.value>-1&&i.value===r.matched.length-1&&O$(r.params,n.value.params));function u(o={}){return sO(o)?t[Ot(e.replace)?"replace":"push"](Ot(e.to)).catch(su):Promise.resolve()}return{route:n,href:Jt(()=>n.value.href),isActive:a,isExactActive:s,navigate:u}}const aO=s$({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Yy,setup(e,{slots:t}){const r=za(Yy(e)),{options:n}=In(Zc),i=Jt(()=>({[Xy(e.activeClass,n.linkActiveClass,"router-link-active")]:r.isActive,[Xy(e.exactActiveClass,n.linkExactActiveClass,"router-link-exact-active")]:r.isExactActive}));return()=>{const a=t.default&&t.default(r);return e.custom?a:$$("a",{"aria-current":r.isExactActive?e.ariaCurrentValue:null,href:r.href,onClick:r.navigate,class:i.value},a)}}}),Ds=aO;function sO(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function oO(e,t){for(const r in t){const n=t[r],i=e[r];if(typeof n=="string"){if(n!==i)return!1}else if(!Rn(i)||i.length!==n.length||n.some((a,s)=>a!==i[s]))return!1}return!0}function Qy(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Xy=(e,t,r)=>e!=null?e:t!=null?t:r,uO=s$({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:r}){const n=In(Wp),i=Jt(()=>e.route||n.value),a=In(Jy,0),s=Jt(()=>{let c=Ot(a);const{matched:d}=i.value;let y;for(;(y=d[c])&&!y.components;)c++;return c}),u=Jt(()=>i.value.matched[s.value]);ec(Jy,Jt(()=>s.value+1)),ec(nO,u),ec(Wp,i);const o=nt();return ru(()=>[o.value,u.value,e.name],([c,d,y],[_,w,k])=>{d&&(d.instances[y]=c,w&&w!==d&&c&&c===_&&(d.leaveGuards.size||(d.leaveGuards=w.leaveGuards),d.updateGuards.size||(d.updateGuards=w.updateGuards))),c&&d&&(!w||!Js(d,w)||!_)&&(d.enterCallbacks[y]||[]).forEach(N=>N(c))},{flush:"post"}),()=>{const c=i.value,d=e.name,y=u.value,_=y&&y.components[d];if(!_)return Zy(r.default,{Component:_,route:c});const w=y.props[d],k=w?w===!0?c.params:typeof w=="function"?w(c):w:null,M=$$(_,It({},k,t,{onVnodeUnmounted:L=>{L.component.isUnmounted&&(y.instances[d]=null)},ref:o}));return Zy(r.default,{Component:M,route:c})||M}}});function Zy(e,t){if(!e)return null;const r=e(t);return r.length===1?r[0]:r}const F$=uO;function lO(e){const t=UR(e.routes,e),r=e.parseQuery||tO,n=e.stringifyQuery||Ky,i=e.history,a=No(),s=No(),u=No(),o=hI(Oi);let c=Oi;Cs&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const d=Ff.bind(null,$=>""+$),y=Ff.bind(null,eO),_=Ff.bind(null,yc);function w($,I){let Z,re;return P$($)?(Z=t.getRecordMatcher($),re=I):re=$,t.addRoute(re,Z)}function k($){const I=t.getRecordMatcher($);I&&t.removeRoute(I)}function N(){return t.getRoutes().map($=>$.record)}function M($){return!!t.getRecordMatcher($)}function L($,I){if(I=It({},I||o.value),typeof $=="string"){const $e=Bf(r,$,I.path),E=t.resolve({path:$e.path},I),T=i.createHref($e.fullPath);return It($e,E,{params:_(E.params),hash:yc($e.hash),redirectedFrom:void 0,href:T})}let Z;if("path"in $)Z=It({},$,{path:Bf(r,$.path,I.path).path});else{const $e=It({},$.params);for(const E in $e)$e[E]==null&&delete $e[E];Z=It({},$,{params:y($.params)}),I.params=y(I.params)}const re=t.resolve(Z,I),Ie=$.hash||"";re.params=d(_(re.params));const xe=dR(n,It({},$,{hash:QR(Ie),path:re.path})),ce=i.createHref(xe);return It({fullPath:xe,hash:Ie,query:n===Ky?rO($.query):$.query||{}},re,{redirectedFrom:void 0,href:ce})}function B($){return typeof $=="string"?Bf(r,$,o.value.path):It({},$)}function ve($,I){if(c!==$)return Ys(8,{from:I,to:$})}function ue($){return Ae($)}function Me($){return ue(It(B($),{replace:!0}))}function Re($){const I=$.matched[$.matched.length-1];if(I&&I.redirect){const{redirect:Z}=I;let re=typeof Z=="function"?Z($):Z;return typeof re=="string"&&(re=re.includes("?")||re.includes("#")?re=B(re):{path:re},re.params={}),It({query:$.query,hash:$.hash,params:"path"in re?{}:$.params},re)}}function Ae($,I){const Z=c=L($),re=o.value,Ie=$.state,xe=$.force,ce=$.replace===!0,$e=Re(Z);if($e)return Ae(It(B($e),{state:typeof $e=="object"?It({},Ie,$e.state):Ie,force:xe,replace:ce}),I||Z);const E=Z;E.redirectedFrom=I;let T;return!xe&&pR(n,re,Z)&&(T=Ys(16,{to:E,from:re}),at(re,re,!0,!1)),(T?Promise.resolve(T):le(E,re)).catch(G=>Xn(G)?Xn(G,2)?G:Le(G):be(G,E,re)).then(G=>{if(G){if(Xn(G,2))return Ae(It({replace:ce},B(G.to),{state:typeof G.to=="object"?It({},Ie,G.to.state):Ie,force:xe}),I||E)}else G=Se(E,re,!0,ce,Ie);return F(E,re,G),G})}function x($,I){const Z=ve($,I);return Z?Promise.reject(Z):Promise.resolve()}function le($,I){let Z;const[re,Ie,xe]=cO($,I);Z=qf(re.reverse(),"beforeRouteLeave",$,I);for(const $e of re)$e.leaveGuards.forEach(E=>{Z.push(ji(E,$,I))});const ce=x.bind(null,$,I);return Z.push(ce),ps(Z).then(()=>{Z=[];for(const $e of a.list())Z.push(ji($e,$,I));return Z.push(ce),ps(Z)}).then(()=>{Z=qf(Ie,"beforeRouteUpdate",$,I);for(const $e of Ie)$e.updateGuards.forEach(E=>{Z.push(ji(E,$,I))});return Z.push(ce),ps(Z)}).then(()=>{Z=[];for(const $e of $.matched)if($e.beforeEnter&&!I.matched.includes($e))if(Rn($e.beforeEnter))for(const E of $e.beforeEnter)Z.push(ji(E,$,I));else Z.push(ji($e.beforeEnter,$,I));return Z.push(ce),ps(Z)}).then(()=>($.matched.forEach($e=>$e.enterCallbacks={}),Z=qf(xe,"beforeRouteEnter",$,I),Z.push(ce),ps(Z))).then(()=>{Z=[];for(const $e of s.list())Z.push(ji($e,$,I));return Z.push(ce),ps(Z)}).catch($e=>Xn($e,8)?$e:Promise.reject($e))}function F($,I,Z){for(const re of u.list())re($,I,Z)}function Se($,I,Z,re,Ie){const xe=ve($,I);if(xe)return xe;const ce=I===Oi,$e=Cs?history.state:{};Z&&(re||ce?i.replace($.fullPath,It({scroll:ce&&$e&&$e.scroll},Ie)):i.push($.fullPath,Ie)),o.value=$,at($,I,Z,ce),Le()}let Ee;function oe(){Ee||(Ee=i.listen(($,I,Z)=>{if(!Q.listening)return;const re=L($),Ie=Re(re);if(Ie){Ae(It(Ie,{replace:!0}),re).catch(su);return}c=re;const xe=o.value;Cs&&_R(Fy(xe.fullPath,Z.delta),Xc()),le(re,xe).catch(ce=>Xn(ce,12)?ce:Xn(ce,2)?(Ae(ce.to,re).then($e=>{Xn($e,20)&&!Z.delta&&Z.type===$u.pop&&i.go(-1,!1)}).catch(su),Promise.reject()):(Z.delta&&i.go(-Z.delta,!1),be(ce,re,xe))).then(ce=>{ce=ce||Se(re,xe,!1),ce&&(Z.delta&&!Xn(ce,8)?i.go(-Z.delta,!1):Z.type===$u.pop&&Xn(ce,20)&&i.go(-1,!1)),F(re,xe,ce)}).catch(su)}))}let te=No(),ae=No(),ne;function be($,I,Z){Le($);const re=ae.list();return re.length?re.forEach(Ie=>Ie($,I,Z)):console.error($),Promise.reject($)}function A(){return ne&&o.value!==Oi?Promise.resolve():new Promise(($,I)=>{te.add([$,I])})}function Le($){return ne||(ne=!$,oe(),te.list().forEach(([I,Z])=>$?Z($):I()),te.reset()),$}function at($,I,Z,re){const{scrollBehavior:Ie}=e;if(!Cs||!Ie)return Promise.resolve();const xe=!Z&&SR(Fy($.fullPath,0))||(re||!Z)&&history.state&&history.state.scroll||null;return uv().then(()=>Ie($,I,xe)).then(ce=>ce&&wR(ce)).catch(ce=>be(ce,$,I))}const We=$=>i.go($);let fe;const V=new Set,Q={currentRoute:o,listening:!0,addRoute:w,removeRoute:k,hasRoute:M,getRoutes:N,resolve:L,options:e,push:ue,replace:Me,go:We,back:()=>We(-1),forward:()=>We(1),beforeEach:a.add,beforeResolve:s.add,afterEach:u.add,onError:ae.add,isReady:A,install($){const I=this;$.component("RouterLink",Ds),$.component("RouterView",F$),$.config.globalProperties.$router=I,Object.defineProperty($.config.globalProperties,"$route",{enumerable:!0,get:()=>Ot(o)}),Cs&&!fe&&o.value===Oi&&(fe=!0,ue(i.location).catch(Ie=>{}));const Z={};for(const Ie in Oi)Z[Ie]=Jt(()=>o.value[Ie]);$.provide(Zc,I),$.provide(bv,za(Z)),$.provide(Wp,o);const re=$.unmount;V.add($),$.unmount=function(){V.delete($),V.size<1&&(c=Oi,Ee&&Ee(),Ee=null,o.value=Oi,fe=!1,ne=!1),re()}}};return Q}function ps(e){return e.reduce((t,r)=>t.then(()=>r()),Promise.resolve())}function cO(e,t){const r=[],n=[],i=[],a=Math.max(t.matched.length,e.matched.length);for(let s=0;s<a;s++){const u=t.matched[s];u&&(e.matched.find(c=>Js(c,u))?n.push(u):r.push(u));const o=e.matched[s];o&&(t.matched.find(c=>Js(c,o))||i.push(o))}return[r,n,i]}function B$(){return In(Zc)}function q$(){return In(bv)}const fO={__name:"App",setup(e){return(t,r)=>(Ge(),Cn(Ot(F$)))}},uo=yv("list",{state:()=>({lists:[]}),getters:{},actions:{async getAllSyncLists(){try{const t=await fetch("/twilio-table-sync/list-all",{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(t.ok){let r=await t.json();this.lists=r}}catch(e){console.log("getAllSyncLists error => ",e)}}}}),Nu=yv("agent",{state:()=>({agent:{identity:null,accessToken:""},agents:[]}),getters:{},actions:{async getToken(){try{let e=`/auth/token?identity=${this.agent.identity}`;const t=await fetch(e,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(t.ok){let r=await t.json();console.log(typeof r.accessToken),this.agent.accessToken=r.accessToken,console.log("token value set...")}}catch(e){console.log("getToken error => ",e)}},async getAgents(){const t=uo().lists.find(r=>r.uniqueName==="AgentList");try{let r=`/twilio-table-sync/list-item-get-array?targetList=${t.sid}`;const n=await fetch(r,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(n.ok){let i=await n.json();console.log("in getAgents and r => ",i),this.agents=i.map(a=>a.data.Identity).sort((a,s)=>a.localeCompare(s,void 0,{sensitivity:"base"}))}}catch(r){console.log("getAgents error => ",r)}}}}),hi=(e,t)=>{const r=e.__vccOpts||e;for(const[n,i]of t)r[n]=i;return r},dO={name:"Header",setup(){return{agentStore:Nu()}}},pO={class:"container-fluid"},hO={class:"d-flex flex-wrap justify-content-center py-3 mb-2 border-bottom"},vO=U("img",{class:"me-4",width:"107",height:"32",src:"https://www.twilio.com/docs/static/dist/img/559bc7cf.svg"},null,-1),gO=U("span",{class:"fs-4",style:{color:"#f22f46"}},"Conversations (Agent)",-1),yO={class:"nav nav-pills"},mO={class:"nav-item"},bO=U("i",{class:"bi-house"},null,-1),wO=tt(" Home"),_O={key:0,class:"nav-item"},SO=U("i",{class:"bi-chat-left-dots-fill"},null,-1),$O=tt(" Conversations"),kO={key:1,class:"nav-item"},TO=U("i",{class:"bi-person"},null,-1),EO={key:2,class:"nav-item"},IO=U("i",{class:"bi-box-arrow-in-right"},null,-1),CO=tt(" Login");function RO(e,t,r,n,i,a){const s=Tr("router-link");return Ge(),it("div",pO,[U("header",hO,[bt(s,{class:"d-flex align-items-center mb-3 mb-md-0 me-md-auto text-dark text-decoration-none",to:"/"},{default:ar(()=>[vO,gO]),_:1}),U("ul",yO,[U("li",mO,[bt(s,{class:"nav-link",to:"/"},{default:ar(()=>[bO,wO]),_:1})]),n.agentStore.agent.identity!=null?(Ge(),it("li",_O,[bt(s,{class:"nav-link",to:"/conversations"},{default:ar(()=>[SO,$O]),_:1})])):cr("",!0),n.agentStore.agent.identity!=null?(Ge(),it("li",kO,[bt(s,{class:"nav-link",to:"/agent"},{default:ar(()=>[TO,tt(" "+Ht(n.agentStore.agent.identity),1)]),_:1})])):cr("",!0),n.agentStore.agent.identity===null?(Ge(),it("li",EO,[bt(s,{class:"btn btn-warning btn-sm",to:"/login"},{default:ar(()=>[IO,CO]),_:1})])):cr("",!0)])])])}const OO=hi(dO,[["render",RO]]),AO={name:"Footer"},PO={class:"footer mt-auto py-3 bg-light pb-5"},MO=U("div",{class:"container text-center pb-5"},[U("img",{class:"",width:"107",height:"32",src:"https://www.twilio.com/docs/static/dist/img/559bc7cf.svg"})],-1),NO=[MO];function xO(e,t,r,n,i,a){return Ge(),it("footer",PO,NO)}const LO=hi(AO,[["render",xO]]),jO={name:"Layout",components:{Header:OO,Footer:LO}};function UO(e,t,r,n,i,a){const s=Tr("Header"),u=Tr("Footer");return Ge(),it("div",null,[bt(s),JI(e.$slots,"default"),bt(u)])}const xu=hi(jO,[["render",UO]]),DO={class:"container-fluid"},FO={class:"row"},BO={class:"col pt-5"},qO=U("h2",null,"Twilio Conversations",-1),WO=U("p",{class:"mt-5 fs-3"},[U("b",null,"A single API for seamless conversational messaging"),U("br"),tt(" Integrate once and extend across customers\u2019 preferred channels to support scalable, multiparty conversations. ")],-1),HO=U("p",{class:"lead fs-3 mb-5"}," This demo gives demonstrates an agent or administrator view into an multi channel communication tool powered by Twilio Conversations. ",-1),GO={class:"text-center mt-5"},VO=U("i",{class:"bi-chat-left-dots-fill"},null,-1),zO=tt(" Conversations "),KO=U("i",{class:"bi-box-arrow-in-right"},null,-1),JO=tt(" Login "),YO=U("div",{class:"col"},[U("div",{class:"text-center pt-5 pb-5"},[U("img",{class:"img-fluid",style:{"max-width":"600px"},src:"https://twilio-cms-prod.s3.amazonaws.com/images/diagram-conversat.width-1200.format-webp.webpquality-75.webp"})])],-1),QO={__name:"Home",setup(e){const t=uo(),r=Nu();return cv(async()=>{t.lists.length===0&&(await t.getAllSyncLists(),console.log("lists => ",t.lists))}),(n,i)=>(Ge(),it("div",DO,[U("div",FO,[U("div",BO,[qO,WO,HO,U("div",GO,[Ot(r).agent.identity!=null?(Ge(),Cn(Ot(Ds),{key:0,class:"btn btn-lg btn-primary",to:"/conversations"},{default:ar(()=>[VO,zO]),_:1})):cr("",!0),Ot(r).agent.identity===null?(Ge(),Cn(Ot(Ds),{key:1,class:"btn btn-lg btn-warning",to:"/login"},{default:ar(()=>[KO,JO]),_:1})):cr("",!0)])]),YO])]))}},XO={name:"App",components:{Layout:xu,Home:QO}};function ZO(e,t,r,n,i,a){const s=Tr("Home"),u=Tr("Layout");return Ge(),Cn(u,null,{default:ar(()=>[bt(s)]),_:1})}const eA=hi(XO,[["render",ZO]]),W$=yv("webhooks",{state:()=>({webhooks:[]}),getters:{},actions:{async getWebhooks(){const t=uo().lists.find(r=>r.uniqueName==="WebhookList");try{let r=`/twilio-table-sync/list-item-get-array?targetList=${t.sid}`;const n=await fetch(r,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(n.ok){let i=await n.json();console.log("in webhookStore getWebhooks and r => ",i),this.webhooks=i}}catch(r){console.log("in webhookStore getWebhooks error => ",r)}}}}),tA={class:"container-fluid pt-5 pb-5"},rA={class:"alert alert-success text-center fw-bold mb-5"},nA=U("i",{class:"bi-house"},null,-1),iA=tt(" Home "),aA=U("i",{class:"bi-chat-left-dots-fill"},null,-1),sA=tt(" Conversations "),oA=U("i",{class:"bi-person"},null,-1),uA=tt(" Agent "),lA={class:"d-flex justify-content-center mt-3 mb-5"},cA=U("ul",{class:"nav nav-pills mb-3",id:"myTab",role:"tablist"},[U("li",{class:"nav-item",role:"presentation"},[U("button",{class:"nav-link active",id:"login-tab","data-bs-toggle":"tab","data-bs-target":"#login",type:"button",role:"tab","aria-controls":"login","aria-selected":"false"},"Existing Agent Login")]),U("li",{class:"nav-item",role:"presentation"},[U("button",{class:"nav-link",id:"create-tab","data-bs-toggle":"tab","data-bs-target":"#create",type:"button",role:"tab","aria-controls":"create","aria-selected":"true"},"Create Agent")])],-1),fA={class:"tab-content"},dA={class:"tab-pane",id:"create",role:"tabpanel","aria-labelledby":"create-tab"},pA={class:"card p-5",style:{width:"36rem"}},hA={class:"mb-3"},vA=U("label",{for:"exampleFormControlInput1",class:"form-label"},"Agent",-1),gA={class:"d-grid"},yA=U("i",{class:"bi-person-plus"},null,-1),mA=tt(" Create Agent "),bA=[yA,mA],wA={class:"tab-pane active",id:"login",role:"tabpanel","aria-labelledby":"login-tab"},_A={class:"card p-5",style:{width:"36rem"}},SA={class:"mb-3"},$A=U("label",{for:"exampleFormControlInput1",class:"form-label"},"Agent",-1),kA=["value"],TA={class:"d-grid"},EA=U("i",{class:"bi-box-arrow-in-right"},null,-1),IA=tt(" Login "),CA=[EA,IA],RA={__name:"Login",setup(e){const t=uo(),r=W$(),n=Nu(),i=B$(),a=t.lists.find(y=>y.uniqueName==="AgentList"),s=nt(""),u=nt(""),o=async()=>{console.log("in createAccount...");let y={Identity:s.value},_=`/twilio-table-sync/list-item-create?targetList=${a.sid}`;const w=await fetch(_,{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:y})});if(w.ok)await w.json(),n.agent.identity=s.value,await n.getToken(),d();else return!1},c=async()=>{n.agent.identity=u.value,await n.getToken(),d()};function d(){i.replace({name:"conversations"})}return oo(async()=>{await n.getAgents(),await r.getWebhooks()}),(y,_)=>(Ge(),it("div",tA,[ze(U("div",rA,[tt(" You are logged in as "+Ht(Ot(n).agent.identity)+" ",1),bt(Ot(Ds),{class:"btn btn-sm btn-primary",to:"/"},{default:ar(()=>[nA,iA]),_:1}),bt(Ot(Ds),{class:"btn btn-sm btn-primary ms-2",to:"/conversations"},{default:ar(()=>[aA,sA]),_:1}),bt(Ot(Ds),{class:"btn btn-sm btn-primary ms-2",to:"/agent"},{default:ar(()=>[oA,uA]),_:1})],512),[[ct,Ot(n).agent.identity!==null]]),ze(U("div",null,[U("div",lA,[U("div",null,[cA,U("div",fA,[U("div",dA,[U("div",pA,[U("div",hA,[vA,ze(U("input",{type:"text","onUpdate:modelValue":_[0]||(_[0]=w=>s.value=w),class:"form-control",id:"exampleFormControlInput1",placeholder:""},null,512),[[Ma,s.value]])]),U("div",gA,[U("button",{onClick:_[1]||(_[1]=w=>o()),class:"btn btn-primary btn-lg"},bA)])])]),U("div",wA,[U("div",_A,[U("div",SA,[$A,ze(U("select",{class:"form-select","onUpdate:modelValue":_[2]||(_[2]=w=>u.value=w)},[(Ge(!0),it(Kt,null,xn(Ot(n).agents,w=>(Ge(),it("option",{key:w,value:w},Ht(w),9,kA))),128))],512),[[Up,u.value]])]),U("div",TA,[U("button",{onClick:_[3]||(_[3]=w=>c()),class:"btn btn-success btn-lg"},CA)])])])])])])],512),[[ct,Ot(n).agent.identity===null]])]))}},OA={name:"App",components:{Layout:xu,Login:RA}};function AA(e,t,r,n,i,a){const s=Tr("Login"),u=Tr("Layout");return Ge(),Cn(u,null,{default:ar(()=>[bt(s)]),_:1})}const PA=hi(OA,[["render",AA]]),MA={class:"container-fluid"},NA={class:"card text-dark bg-light mt-5 mb-5"},xA=U("div",{class:"card-header fs-4"},[U("i",{class:"bi-person-workspace me-2"}),U("b",null,"Agent")],-1),LA={class:"card-body"},jA={class:"card-title fs-2 mb-5"},UA=U("p",{class:"card-text fs-5 mb-5"}," In order order to enter a conversation, you need a valid access token. ",-1),DA={class:"card-text fs-5 mb-5"},FA=U("i",{class:"bi-recycle"},null,-1),BA=tt(" Refresh Token "),qA=[FA,BA],WA={class:"spinner-border",role:"status"},HA=U("span",{class:"visually-hidden"},"Loading...",-1),GA=[HA],VA={disabled:"",class:"btn btn-success"},zA=U("i",{class:"bi-check"},null,-1),KA=tt(" Token Refreshed "),JA=[zA,KA],YA=U("i",{class:"bi-eye"},null,-1),QA=tt(" View Token "),XA=[YA,QA],ZA={class:"text-break mb-5 p-2 bg-warning"},eP=U("i",{class:"bi-box-arrow-left"},null,-1),tP=tt(" Logout "),rP=[eP,tP],nP={__name:"Agent",setup(e){const t=Nu(),r=Jt(()=>t.agent.accessToken!=""),n=nt(!1),i=nt(!1),a=nt(!1),s=async()=>{i.value=!0,await t.getToken(),i.value=!1,a.value=!0};function u(){t.$reset(),n.value=!1,i.value=!1,a.value=!1}return(o,c)=>(Ge(),it("div",MA,[U("div",NA,[xA,U("div",LA,[U("h5",jA,[U("b",null,Ht(Ot(t).agent.identity),1)]),UA,U("p",DA,[ze(U("button",{onClick:c[0]||(c[0]=d=>s()),class:"btn btn-primary"},[ze(U("span",null,qA,512),[[ct,!i.value]]),ze(U("div",WA,GA,512),[[ct,i.value]])],512),[[ct,Ot(r)&&!a.value]]),ze(U("button",VA,JA,512),[[ct,a.value]]),ze(U("button",{onClick:c[1]||(c[1]=d=>n.value=!n.value),class:"btn btn-warning ms-2"},XA,512),[[ct,Ot(r)]])]),ze(U("p",ZA,[U("i",null,Ht(Ot(t).agent.accessToken),1)],512),[[ct,n.value]]),U("p",null,[ze(U("button",{onClick:c[2]||(c[2]=d=>u()),class:"btn btn-danger float-end"},rP,512),[[ct,Ot(r)]])])])])]))}},iP={name:"App",components:{Layout:xu,Agent:nP}};function aP(e,t,r,n,i,a){const s=Tr("Agent"),u=Tr("Layout");return Ge(),Cn(u,null,{default:ar(()=>[bt(s)]),_:1})}const sP=hi(iP,[["render",aP]]);function H$(e){let t=new Date(e);return`${t.getMonth()+1}/${t.getDate()} @ ${t.getHours()}:${String(t.getMinutes()).padStart(2,"0")}`}const oP={class:"container-fluid pt-4"},uP=U("i",{class:"bi bi-arrow-clockwise"},null,-1),lP=tt(" Refresh "),cP=[uP,lP],fP=U("h3",null,"Conversations",-1),dP={class:"table table-striped mt-4 mb-5 fs-4"},pP=U("thead",null,[U("tr",null,[U("th",{class:"text-center"},"Friendly Name"),U("th",{class:"text-center"},"Chat ID"),U("th",{class:"text-center"},"Date Created"),U("th",{class:"text-center"},"\xA0")])],-1),hP={class:"text-center"},vP={class:"text-center"},gP={class:"text-center"},yP={class:"text-center"},mP=["onClick"],bP=U("i",{class:"bi-play-fill"},null,-1),wP=tt(" Enter "),_P=[bP,wP],SP=["onClick"],$P=U("i",{class:"bi-trash"},null,-1),kP=[$P],TP={class:"row pb-5"},EP={class:"col-6"},IP=U("i",{class:"bi-plus-circle-fill me-1"},null,-1),CP=tt(" Create New Conversation "),RP=[IP,CP],OP=U("label",{for:"",class:"form-label fs-4"},[U("b",null,"Enter Friendly Name for New Conversation")],-1),AP={class:"input-group"},PP=U("i",{class:"bi-plus-circle-fill me-2"},null,-1),MP=tt(" Create "),NP=[PP,MP],xP={__name:"Conversations",setup(e){q$();const t=nt([]),r=async()=>{try{const o=await fetch("/conversations/return-conversations",{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(o.ok){let c=await o.json();console.log("in getConversations and r => ",c),t.value=c}}catch(u){console.log("getConversations error => ",u)}},n=nt(""),i=nt(!1),a=async()=>{try{(await fetch("/conversations/conversation-create",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationName:n.value}})})).ok?(console.log("Success! Created a new conversation..."),n.value="",i.value=!1,r()):console.log("Error! Unable to create new conversation...")}catch(u){console.log("createNewConversation error => ",u)}},s=async u=>{try{(await fetch("/conversations/conversation-delete",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:u}})})).ok&&(console.log("Success! Conversation deleted..."),r())}catch(o){console.log("deleteConversations error => ",o)}};return oo(()=>{r()}),(u,o)=>{const c=Tr("router-link");return Ge(),it("div",oP,[U("button",{onClick:o[0]||(o[0]=d=>r()),class:"float-end btn btn-lg btn-secondary"},cP),fP,U("table",dP,[pP,U("tbody",null,[(Ge(!0),it(Kt,null,xn(t.value,d=>(Ge(),it("tr",{key:d.sid},[U("td",hP,Ht(d.friendlyName),1),U("td",vP,Ht(d.sid),1),U("td",gP,Ht(Ot(H$)(d.dateCreated)),1),U("td",yP,[bt(c,{to:{name:"conversation",params:{sid:d.sid}},custom:""},{default:ar(({navigate:y})=>[U("button",{class:"btn btn-primary",onClick:y},_P,8,mP)]),_:2},1032,["to"]),U("button",{class:"btn btn-danger ms-2",onClick:y=>s(d.sid)},kP,8,SP)])]))),128))])]),U("div",TP,[U("div",EP,[ze(U("button",{type:"button",class:"btn btn-info",onClick:o[1]||(o[1]=d=>i.value=!0)},RP,512),[[ct,!i.value]]),ze(U("div",null,[OP,U("div",AP,[ze(U("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=d=>n.value=d),class:"form-control"},null,512),[[Ma,n.value]]),U("button",{type:"button",class:"btn btn-sm btn-success",onClick:o[3]||(o[3]=d=>a())},NP)])],512),[[ct,i.value]])])])])}}},LP={name:"App",components:{Layout:xu,Conversations:xP}};function jP(e,t,r,n,i,a){const s=Tr("Conversations"),u=Tr("Layout");return Ge(),Cn(u,null,{default:ar(()=>[bt(s)]),_:1})}const UP=hi(LP,[["render",jP]]);function G$(e){return e?e.replace("EndUser:",""):""}function hs(e,t,r){let n={displayName:r,sms:!1,chat:!1,whatsapp:!1,enduser:!1,agent:!1,bot:!1};switch(e){case"sms":n.sms=!0;break;case"chat":n.chat=!0;break;case"whatsapp":n.whatsapp=!0;break}switch(t){case"enduser":n.enduser=!0;break;case"agent":n.agent=!0;break;case"bot":n.bot=!0;break}return JSON.stringify(n)}var $n=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function DP(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}var V$={},wl=function(e){return e&&e.Math==Math&&e},dt=wl(typeof globalThis=="object"&&globalThis)||wl(typeof window=="object"&&window)||wl(typeof self=="object"&&self)||wl(typeof $n=="object"&&$n)||function(){return this}()||Function("return this")(),Hn={},et=function(e){try{return!!e()}catch{return!0}},FP=et,Bt=!FP(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!=7}),BP=et,Lu=!BP(function(){var e=function(){}.bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),qP=Lu,_l=Function.prototype.call,Pt=qP?_l.bind(_l):function(){return _l.apply(_l,arguments)},ju={},z$={}.propertyIsEnumerable,K$=Object.getOwnPropertyDescriptor,WP=K$&&!z$.call({1:2},1);ju.f=WP?function(t){var r=K$(this,t);return!!r&&r.enumerable}:z$;var Ka=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}},J$=Lu,Y$=Function.prototype,HP=Y$.bind,Hp=Y$.call,GP=J$&&HP.bind(Hp,Hp),Qe=J$?function(e){return e&&GP(e)}:function(e){return e&&function(){return Hp.apply(e,arguments)}},Q$=Qe,VP=Q$({}.toString),zP=Q$("".slice),ta=function(e){return zP(VP(e),8,-1)},KP=Qe,JP=et,YP=ta,Wf=Object,QP=KP("".split),Uu=JP(function(){return!Wf("z").propertyIsEnumerable(0)})?function(e){return YP(e)=="String"?QP(e,""):Wf(e)}:Wf,Gn=function(e){return e==null},XP=Gn,ZP=TypeError,Vn=function(e){if(XP(e))throw ZP("Can't call method on "+e);return e},eM=Uu,tM=Vn,Wr=function(e){return eM(tM(e))},Mt=function(e){return typeof e=="function"},em=Mt,Gp=typeof document=="object"&&document.all,rM=typeof Gp>"u"&&Gp!==void 0,Gt=rM?function(e){return typeof e=="object"?e!==null:em(e)||e===Gp}:function(e){return typeof e=="object"?e!==null:em(e)},Hf=dt,nM=Mt,iM=function(e){return nM(e)?e:void 0},cn=function(e,t){return arguments.length<2?iM(Hf[e]):Hf[e]&&Hf[e][t]},aM=Qe,vi=aM({}.isPrototypeOf),sM=cn,Ja=sM("navigator","userAgent")||"",X$=dt,Gf=Ja,tm=X$.process,rm=X$.Deno,nm=tm&&tm.versions||rm&&rm.version,im=nm&&nm.v8,bn,mc;im&&(bn=im.split("."),mc=bn[0]>0&&bn[0]<4?1:+(bn[0]+bn[1]));!mc&&Gf&&(bn=Gf.match(/Edge\/(\d+)/),(!bn||bn[1]>=74)&&(bn=Gf.match(/Chrome\/(\d+)/),bn&&(mc=+bn[1])));var Ya=mc,am=Ya,oM=et,lo=!!Object.getOwnPropertySymbols&&!oM(function(){var e=Symbol();return!String(e)||!(Object(e)instanceof Symbol)||!Symbol.sham&&am&&am<41}),uM=lo,Z$=uM&&!Symbol.sham&&typeof Symbol.iterator=="symbol",lM=cn,cM=Mt,fM=vi,dM=Z$,pM=Object,co=dM?function(e){return typeof e=="symbol"}:function(e){var t=lM("Symbol");return cM(t)&&fM(t.prototype,pM(e))},hM=String,Qa=function(e){try{return hM(e)}catch{return"Object"}},vM=Mt,gM=Qa,yM=TypeError,On=function(e){if(vM(e))return e;throw yM(gM(e)+" is not a function")},mM=On,bM=Gn,Xa=function(e,t){var r=e[t];return bM(r)?void 0:mM(r)},Vf=Pt,zf=Mt,Kf=Gt,wM=TypeError,_M=function(e,t){var r,n;if(t==="string"&&zf(r=e.toString)&&!Kf(n=Vf(r,e))||zf(r=e.valueOf)&&!Kf(n=Vf(r,e))||t!=="string"&&zf(r=e.toString)&&!Kf(n=Vf(r,e)))return n;throw wM("Can't convert object to primitive value")},Za={exports:{}},SM=!1,sm=dt,$M=Object.defineProperty,wv=function(e,t){try{$M(sm,e,{value:t,configurable:!0,writable:!0})}catch{sm[e]=t}return t},kM=dt,TM=wv,om="__core-js_shared__",EM=kM[om]||TM(om,{}),_v=EM,um=_v;(Za.exports=function(e,t){return um[e]||(um[e]=t!==void 0?t:{})})("versions",[]).push({version:"3.25.1",mode:"global",copyright:"\xA9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.25.1/LICENSE",source:"https://github.com/zloirock/core-js"});var IM=Vn,CM=Object,yr=function(e){return CM(IM(e))},RM=Qe,OM=yr,AM=RM({}.hasOwnProperty),Vt=Object.hasOwn||function(t,r){return AM(OM(t),r)},PM=Qe,MM=0,NM=Math.random(),xM=PM(1 .toString),Du=function(e){return"Symbol("+(e===void 0?"":e)+")_"+xM(++MM+NM,36)},LM=dt,jM=Za.exports,lm=Vt,UM=Du,cm=lo,ek=Z$,vs=jM("wks"),Fa=LM.Symbol,fm=Fa&&Fa.for,DM=ek?Fa:Fa&&Fa.withoutSetter||UM,Ct=function(e){if(!lm(vs,e)||!(cm||typeof vs[e]=="string")){var t="Symbol."+e;cm&&lm(Fa,e)?vs[e]=Fa[e]:ek&&fm?vs[e]=fm(t):vs[e]=DM(t)}return vs[e]},FM=Pt,dm=Gt,pm=co,BM=Xa,qM=_M,WM=Ct,HM=TypeError,GM=WM("toPrimitive"),Sv=function(e,t){if(!dm(e)||pm(e))return e;var r=BM(e,GM),n;if(r){if(t===void 0&&(t="default"),n=FM(r,e,t),!dm(n)||pm(n))return n;throw HM("Can't convert object to primitive value")}return t===void 0&&(t="number"),qM(e,t)},VM=Sv,zM=co,Fu=function(e){var t=VM(e,"string");return zM(t)?t:t+""},KM=dt,hm=Gt,Vp=KM.document,JM=hm(Vp)&&hm(Vp.createElement),ef=function(e){return JM?Vp.createElement(e):{}},YM=Bt,QM=et,XM=ef,tk=!YM&&!QM(function(){return Object.defineProperty(XM("div"),"a",{get:function(){return 7}}).a!=7}),ZM=Bt,e2=Pt,t2=ju,r2=Ka,n2=Wr,i2=Fu,a2=Vt,s2=tk,vm=Object.getOwnPropertyDescriptor;Hn.f=ZM?vm:function(t,r){if(t=n2(t),r=i2(r),s2)try{return vm(t,r)}catch{}if(a2(t,r))return r2(!e2(t2.f,t,r),t[r])};var Xt={},o2=Bt,u2=et,rk=o2&&u2(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!=42}),l2=Gt,c2=String,f2=TypeError,Zt=function(e){if(l2(e))return e;throw f2(c2(e)+" is not an object")},d2=Bt,p2=tk,h2=rk,Sl=Zt,gm=Fu,v2=TypeError,Jf=Object.defineProperty,g2=Object.getOwnPropertyDescriptor,Yf="enumerable",Qf="configurable",Xf="writable";Xt.f=d2?h2?function(t,r,n){if(Sl(t),r=gm(r),Sl(n),typeof t=="function"&&r==="prototype"&&"value"in n&&Xf in n&&!n[Xf]){var i=g2(t,r);i&&i[Xf]&&(t[r]=n.value,n={configurable:Qf in n?n[Qf]:i[Qf],enumerable:Yf in n?n[Yf]:i[Yf],writable:!1})}return Jf(t,r,n)}:Jf:function(t,r,n){if(Sl(t),r=gm(r),Sl(n),p2)try{return Jf(t,r,n)}catch{}if("get"in n||"set"in n)throw v2("Accessors not supported");return"value"in n&&(t[r]=n.value),t};var y2=Bt,m2=Xt,b2=Ka,gi=y2?function(e,t,r){return m2.f(e,t,b2(1,r))}:function(e,t,r){return e[t]=r,e},$v={exports:{}},zp=Bt,w2=Vt,nk=Function.prototype,_2=zp&&Object.getOwnPropertyDescriptor,kv=w2(nk,"name"),S2=kv&&function(){}.name==="something",$2=kv&&(!zp||zp&&_2(nk,"name").configurable),Bu={EXISTS:kv,PROPER:S2,CONFIGURABLE:$2},k2=Qe,T2=Mt,Kp=_v,E2=k2(Function.toString);T2(Kp.inspectSource)||(Kp.inspectSource=function(e){return E2(e)});var Tv=Kp.inspectSource,I2=dt,C2=Mt,ym=I2.WeakMap,R2=C2(ym)&&/native code/.test(String(ym)),O2=Za.exports,A2=Du,mm=O2("keys"),tf=function(e){return mm[e]||(mm[e]=A2(e))},qu={},P2=R2,ik=dt,Zf=Qe,M2=Gt,N2=gi,ed=Vt,td=_v,x2=tf,L2=qu,bm="Object already initialized",Jp=ik.TypeError,j2=ik.WeakMap,bc,ku,wc,U2=function(e){return wc(e)?ku(e):bc(e,{})},D2=function(e){return function(t){var r;if(!M2(t)||(r=ku(t)).type!==e)throw Jp("Incompatible receiver, "+e+" required");return r}};if(P2||td.state){var Sa=td.state||(td.state=new j2),F2=Zf(Sa.get),wm=Zf(Sa.has),B2=Zf(Sa.set);bc=function(e,t){if(wm(Sa,e))throw Jp(bm);return t.facade=e,B2(Sa,e,t),t},ku=function(e){return F2(Sa,e)||{}},wc=function(e){return wm(Sa,e)}}else{var gs=x2("state");L2[gs]=!0,bc=function(e,t){if(ed(e,gs))throw Jp(bm);return t.facade=e,N2(e,gs,t),t},ku=function(e){return ed(e,gs)?e[gs]:{}},wc=function(e){return ed(e,gs)}}var fn={set:bc,get:ku,has:wc,enforce:U2,getterFor:D2},q2=et,W2=Mt,$l=Vt,Yp=Bt,H2=Bu.CONFIGURABLE,G2=Tv,ak=fn,V2=ak.enforce,z2=ak.get,rc=Object.defineProperty,K2=Yp&&!q2(function(){return rc(function(){},"length",{value:8}).length!==8}),J2=String(String).split("String"),Y2=$v.exports=function(e,t,r){String(t).slice(0,7)==="Symbol("&&(t="["+String(t).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(t="get "+t),r&&r.setter&&(t="set "+t),(!$l(e,"name")||H2&&e.name!==t)&&(Yp?rc(e,"name",{value:t,configurable:!0}):e.name=t),K2&&r&&$l(r,"arity")&&e.length!==r.arity&&rc(e,"length",{value:r.arity});try{r&&$l(r,"constructor")&&r.constructor?Yp&&rc(e,"prototype",{writable:!1}):e.prototype&&(e.prototype=void 0)}catch{}var n=V2(e);return $l(n,"source")||(n.source=J2.join(typeof t=="string"?t:"")),e};Function.prototype.toString=Y2(function(){return W2(this)&&z2(this).source||G2(this)},"toString");var Q2=Mt,X2=Xt,Z2=$v.exports,eN=wv,mr=function(e,t,r,n){n||(n={});var i=n.enumerable,a=n.name!==void 0?n.name:t;if(Q2(r)&&Z2(r,a,n),n.global)i?e[t]=r:eN(t,r);else{try{n.unsafe?e[t]&&(i=!0):delete e[t]}catch{}i?e[t]=r:X2.f(e,t,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return e},ra={},tN=Math.ceil,rN=Math.floor,nN=Math.trunc||function(t){var r=+t;return(r>0?rN:tN)(r)},iN=nN,yi=function(e){var t=+e;return t!==t||t===0?0:iN(t)},aN=yi,sN=Math.max,oN=Math.min,es=function(e,t){var r=aN(e);return r<0?sN(r+t,0):oN(r,t)},uN=yi,lN=Math.min,mi=function(e){return e>0?lN(uN(e),9007199254740991):0},cN=mi,br=function(e){return cN(e.length)},fN=Wr,dN=es,pN=br,_m=function(e){return function(t,r,n){var i=fN(t),a=pN(i),s=dN(n,a),u;if(e&&r!=r){for(;a>s;)if(u=i[s++],u!=u)return!0}else for(;a>s;s++)if((e||s in i)&&i[s]===r)return e||s||0;return!e&&-1}},rf={includes:_m(!0),indexOf:_m(!1)},hN=Qe,rd=Vt,vN=Wr,gN=rf.indexOf,yN=qu,Sm=hN([].push),sk=function(e,t){var r=vN(e),n=0,i=[],a;for(a in r)!rd(yN,a)&&rd(r,a)&&Sm(i,a);for(;t.length>n;)rd(r,a=t[n++])&&(~gN(i,a)||Sm(i,a));return i},Ev=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],mN=sk,bN=Ev,wN=bN.concat("length","prototype");ra.f=Object.getOwnPropertyNames||function(t){return mN(t,wN)};var Wu={};Wu.f=Object.getOwnPropertySymbols;var _N=cn,SN=Qe,$N=ra,kN=Wu,TN=Zt,EN=SN([].concat),ok=_N("Reflect","ownKeys")||function(t){var r=$N.f(TN(t)),n=kN.f;return n?EN(r,n(t)):r},$m=Vt,IN=ok,CN=Hn,RN=Xt,uk=function(e,t,r){for(var n=IN(t),i=RN.f,a=CN.f,s=0;s<n.length;s++){var u=n[s];!$m(e,u)&&!(r&&$m(r,u))&&i(e,u,a(t,u))}},ON=et,AN=Mt,PN=/#|\.prototype\./,Hu=function(e,t){var r=NN[MN(e)];return r==LN?!0:r==xN?!1:AN(t)?ON(t):!!t},MN=Hu.normalize=function(e){return String(e).replace(PN,".").toLowerCase()},NN=Hu.data={},xN=Hu.NATIVE="N",LN=Hu.POLYFILL="P",nf=Hu,nd=dt,jN=Hn.f,UN=gi,DN=mr,FN=wv,BN=uk,qN=nf,ft=function(e,t){var r=e.target,n=e.global,i=e.stat,a,s,u,o,c,d;if(n?s=nd:i?s=nd[r]||FN(r,{}):s=(nd[r]||{}).prototype,s)for(u in t){if(c=t[u],e.dontCallGetSet?(d=jN(s,u),o=d&&d.value):o=s[u],a=qN(n?u:r+(i?".":"#")+u,e.forced),!a&&o!==void 0){if(typeof c==typeof o)continue;BN(c,o)}(e.sham||o&&o.sham)&&UN(c,"sham",!0),DN(s,u,c,e)}},WN=Lu,lk=Function.prototype,km=lk.apply,Tm=lk.call,na=typeof Reflect=="object"&&Reflect.apply||(WN?Tm.bind(km):function(){return Tm.apply(km,arguments)}),HN=Qe,fo=HN([].slice),ck=Qe,GN=On,VN=Gt,zN=Vt,Em=fo,KN=Lu,fk=Function,JN=ck([].concat),YN=ck([].join),id={},QN=function(e,t,r){if(!zN(id,t)){for(var n=[],i=0;i<t;i++)n[i]="a["+i+"]";id[t]=fk("C,a","return new C("+YN(n,",")+")")}return id[t](e,r)},XN=KN?fk.bind:function(t){var r=GN(this),n=r.prototype,i=Em(arguments,1),a=function(){var u=JN(i,Em(arguments));return this instanceof a?QN(r,u.length,u):r.apply(t,u)};return VN(n)&&(a.prototype=n),a},ZN=Ct,ex=ZN("toStringTag"),dk={};dk[ex]="z";var Iv=String(dk)==="[object z]",tx=Iv,rx=Mt,nc=ta,nx=Ct,ix=nx("toStringTag"),ax=Object,sx=nc(function(){return arguments}())=="Arguments",ox=function(e,t){try{return e[t]}catch{}},bi=tx?nc:function(e){var t,r,n;return e===void 0?"Undefined":e===null?"Null":typeof(r=ox(t=ax(e),ix))=="string"?r:sx?nc(t):(n=nc(t))=="Object"&&rx(t.callee)?"Arguments":n},ux=Qe,lx=et,pk=Mt,cx=bi,fx=cn,dx=Tv,hk=function(){},px=[],vk=fx("Reflect","construct"),Cv=/^\s*(?:class|function)\b/,hx=ux(Cv.exec),vx=!Cv.exec(hk),xo=function(t){if(!pk(t))return!1;try{return vk(hk,px,t),!0}catch{return!1}},gk=function(t){if(!pk(t))return!1;switch(cx(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return vx||!!hx(Cv,dx(t))}catch{return!0}};gk.sham=!0;var af=!vk||lx(function(){var e;return xo(xo.call)||!xo(Object)||!xo(function(){e=!0})||e})?gk:xo,gx=af,yx=Qa,mx=TypeError,Rv=function(e){if(gx(e))return e;throw mx(yx(e)+" is not a constructor")},Ov={},bx=sk,wx=Ev,Gu=Object.keys||function(t){return bx(t,wx)},_x=Bt,Sx=rk,$x=Xt,kx=Zt,Tx=Wr,Ex=Gu;Ov.f=_x&&!Sx?Object.defineProperties:function(t,r){kx(t);for(var n=Tx(r),i=Ex(r),a=i.length,s=0,u;a>s;)$x.f(t,u=i[s++],n[u]);return t};var Ix=cn,yk=Ix("document","documentElement"),Cx=Zt,Rx=Ov,Im=Ev,Ox=qu,Ax=yk,Px=ef,Mx=tf,Cm=">",Rm="<",Qp="prototype",Xp="script",mk=Mx("IE_PROTO"),ad=function(){},bk=function(e){return Rm+Xp+Cm+e+Rm+"/"+Xp+Cm},Om=function(e){e.write(bk("")),e.close();var t=e.parentWindow.Object;return e=null,t},Nx=function(){var e=Px("iframe"),t="java"+Xp+":",r;return e.style.display="none",Ax.appendChild(e),e.src=String(t),r=e.contentWindow.document,r.open(),r.write(bk("document.F=Object")),r.close(),r.F},kl,ic=function(){try{kl=new ActiveXObject("htmlfile")}catch{}ic=typeof document<"u"?document.domain&&kl?Om(kl):Nx():Om(kl);for(var e=Im.length;e--;)delete ic[Qp][Im[e]];return ic()};Ox[mk]=!0;var ia=Object.create||function(t,r){var n;return t!==null?(ad[Qp]=Cx(t),n=new ad,ad[Qp]=null,n[mk]=t):n=ic(),r===void 0?n:Rx.f(n,r)},xx=ft,Lx=cn,sd=na,jx=XN,Am=Rv,Ux=Zt,Pm=Gt,Dx=ia,wk=et,Av=Lx("Reflect","construct"),Fx=Object.prototype,Bx=[].push,_k=wk(function(){function e(){}return!(Av(function(){},[],e)instanceof e)}),Sk=!wk(function(){Av(function(){})}),Mm=_k||Sk;xx({target:"Reflect",stat:!0,forced:Mm,sham:Mm},{construct:function(t,r){Am(t),Ux(r);var n=arguments.length<3?t:Am(arguments[2]);if(Sk&&!_k)return Av(t,r,n);if(t==n){switch(r.length){case 0:return new t;case 1:return new t(r[0]);case 2:return new t(r[0],r[1]);case 3:return new t(r[0],r[1],r[2]);case 4:return new t(r[0],r[1],r[2],r[3])}var i=[null];return sd(Bx,i,r),new(sd(jx,t,i))}var a=n.prototype,s=Dx(Pm(a)?a:Fx),u=sd(t,s,r);return Pm(u)?u:s}});var qx=ft,Wx=yr,$k=Gu,Hx=et,Gx=Hx(function(){$k(1)});qx({target:"Object",stat:!0,forced:Gx},{keys:function(t){return $k(Wx(t))}});var Vx=bi,zx=String,fr=function(e){if(Vx(e)==="Symbol")throw TypeError("Cannot convert a Symbol value to a string");return zx(e)},Pv={},Kx=Fu,Jx=Xt,Yx=Ka,po=function(e,t,r){var n=Kx(t);n in e?Jx.f(e,n,Yx(0,r)):e[n]=r},Nm=es,Qx=br,Xx=po,Zx=Array,eL=Math.max,Vu=function(e,t,r){for(var n=Qx(e),i=Nm(t,n),a=Nm(r===void 0?n:r,n),s=Zx(eL(a-i,0)),u=0;i<a;i++,u++)Xx(s,u,e[i]);return s.length=u,s},tL=ta,rL=Wr,kk=ra.f,nL=Vu,Tk=typeof window=="object"&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],iL=function(e){try{return kk(e)}catch{return nL(Tk)}};Pv.f=function(t){return Tk&&tL(t)=="Window"?iL(t):kk(rL(t))};var Mv={},aL=Ct;Mv.f=aL;var sL=dt,oL=sL,xm=oL,uL=Vt,lL=Mv,cL=Xt.f,Ek=function(e){var t=xm.Symbol||(xm.Symbol={});uL(t,e)||cL(t,e,{value:lL.f(e)})},fL=Pt,dL=cn,pL=Ct,hL=mr,vL=function(){var e=dL("Symbol"),t=e&&e.prototype,r=t&&t.valueOf,n=pL("toPrimitive");t&&!t[n]&&hL(t,n,function(i){return fL(r,this)},{arity:1})},gL=Xt.f,yL=Vt,mL=Ct,Lm=mL("toStringTag"),aa=function(e,t,r){e&&!r&&(e=e.prototype),e&&!yL(e,Lm)&&gL(e,Lm,{configurable:!0,value:t})},jm=Qe,bL=On,wL=Lu,_L=jm(jm.bind),wi=function(e,t){return bL(e),t===void 0?e:wL?_L(e,t):function(){return e.apply(t,arguments)}},SL=ta,zu=Array.isArray||function(t){return SL(t)=="Array"},Um=zu,$L=af,kL=Gt,TL=Ct,EL=TL("species"),Dm=Array,IL=function(e){var t;return Um(e)&&(t=e.constructor,$L(t)&&(t===Dm||Um(t.prototype))?t=void 0:kL(t)&&(t=t[EL],t===null&&(t=void 0))),t===void 0?Dm:t},CL=IL,Nv=function(e,t){return new(CL(e))(t===0?0:t)},RL=wi,OL=Qe,AL=Uu,PL=yr,ML=br,NL=Nv,Fm=OL([].push),Ai=function(e){var t=e==1,r=e==2,n=e==3,i=e==4,a=e==6,s=e==7,u=e==5||a;return function(o,c,d,y){for(var _=PL(o),w=AL(_),k=RL(c,d),N=ML(w),M=0,L=y||NL,B=t?L(o,N):r||s?L(o,0):void 0,ve,ue;N>M;M++)if((u||M in w)&&(ve=w[M],ue=k(ve,M,_),e))if(t)B[M]=ue;else if(ue)switch(e){case 3:return!0;case 5:return ve;case 6:return M;case 2:Fm(B,ve)}else switch(e){case 4:return!1;case 7:Fm(B,ve)}return a?-1:n||i?i:B}},Hr={forEach:Ai(0),map:Ai(1),filter:Ai(2),some:Ai(3),every:Ai(4),find:Ai(5),findIndex:Ai(6),filterReject:Ai(7)},sf=ft,xv=dt,Lv=Pt,xL=Qe,Qs=Bt,Xs=lo,LL=et,or=Vt,jL=vi,Zp=Zt,of=Wr,jv=Fu,UL=fr,eh=Ka,Tu=ia,Ik=Gu,DL=ra,Ck=Pv,FL=Wu,Rk=Hn,Ok=Xt,BL=Ov,Ak=ju,od=mr,Uv=Za.exports,qL=tf,Pk=qu,Bm=Du,WL=Ct,HL=Mv,GL=Ek,VL=vL,zL=aa,Mk=fn,uf=Hr.forEach,Pr=qL("hidden"),lf="Symbol",Eu="prototype",KL=Mk.set,qm=Mk.getterFor(lf),on=Object[Eu],Ba=xv.Symbol,Qo=Ba&&Ba[Eu],JL=xv.TypeError,ud=xv.QObject,Nk=Rk.f,Fi=Ok.f,xk=Ck.f,YL=Ak.f,Lk=xL([].push),li=Uv("symbols"),Ku=Uv("op-symbols"),QL=Uv("wks"),th=!ud||!ud[Eu]||!ud[Eu].findChild,rh=Qs&&LL(function(){return Tu(Fi({},"a",{get:function(){return Fi(this,"a",{value:7}).a}})).a!=7})?function(e,t,r){var n=Nk(on,t);n&&delete on[t],Fi(e,t,r),n&&e!==on&&Fi(on,t,n)}:Fi,ld=function(e,t){var r=li[e]=Tu(Qo);return KL(r,{type:lf,tag:e,description:t}),Qs||(r.description=t),r},cf=function(t,r,n){t===on&&cf(Ku,r,n),Zp(t);var i=jv(r);return Zp(n),or(li,i)?(n.enumerable?(or(t,Pr)&&t[Pr][i]&&(t[Pr][i]=!1),n=Tu(n,{enumerable:eh(0,!1)})):(or(t,Pr)||Fi(t,Pr,eh(1,{})),t[Pr][i]=!0),rh(t,i,n)):Fi(t,i,n)},Dv=function(t,r){Zp(t);var n=of(r),i=Ik(n).concat(Dk(n));return uf(i,function(a){(!Qs||Lv(nh,n,a))&&cf(t,a,n[a])}),t},XL=function(t,r){return r===void 0?Tu(t):Dv(Tu(t),r)},nh=function(t){var r=jv(t),n=Lv(YL,this,r);return this===on&&or(li,r)&&!or(Ku,r)?!1:n||!or(this,r)||!or(li,r)||or(this,Pr)&&this[Pr][r]?n:!0},jk=function(t,r){var n=of(t),i=jv(r);if(!(n===on&&or(li,i)&&!or(Ku,i))){var a=Nk(n,i);return a&&or(li,i)&&!(or(n,Pr)&&n[Pr][i])&&(a.enumerable=!0),a}},Uk=function(t){var r=xk(of(t)),n=[];return uf(r,function(i){!or(li,i)&&!or(Pk,i)&&Lk(n,i)}),n},Dk=function(e){var t=e===on,r=xk(t?Ku:of(e)),n=[];return uf(r,function(i){or(li,i)&&(!t||or(on,i))&&Lk(n,li[i])}),n};Xs||(Ba=function(){if(jL(Qo,this))throw JL("Symbol is not a constructor");var t=!arguments.length||arguments[0]===void 0?void 0:UL(arguments[0]),r=Bm(t),n=function(i){this===on&&Lv(n,Ku,i),or(this,Pr)&&or(this[Pr],r)&&(this[Pr][r]=!1),rh(this,r,eh(1,i))};return Qs&&th&&rh(on,r,{configurable:!0,set:n}),ld(r,t)},Qo=Ba[Eu],od(Qo,"toString",function(){return qm(this).tag}),od(Ba,"withoutSetter",function(e){return ld(Bm(e),e)}),Ak.f=nh,Ok.f=cf,BL.f=Dv,Rk.f=jk,DL.f=Ck.f=Uk,FL.f=Dk,HL.f=function(e){return ld(WL(e),e)},Qs&&(Fi(Qo,"description",{configurable:!0,get:function(){return qm(this).description}}),od(on,"propertyIsEnumerable",nh,{unsafe:!0})));sf({global:!0,constructor:!0,wrap:!0,forced:!Xs,sham:!Xs},{Symbol:Ba});uf(Ik(QL),function(e){GL(e)});sf({target:lf,stat:!0,forced:!Xs},{useSetter:function(){th=!0},useSimple:function(){th=!1}});sf({target:"Object",stat:!0,forced:!Xs,sham:!Qs},{create:XL,defineProperty:cf,defineProperties:Dv,getOwnPropertyDescriptor:jk});sf({target:"Object",stat:!0,forced:!Xs},{getOwnPropertyNames:Uk});VL();zL(Ba,lf);Pk[Pr]=!0;var ZL=lo,Fk=ZL&&!!Symbol.for&&!!Symbol.keyFor,ej=ft,tj=cn,rj=Vt,nj=fr,Bk=Za.exports,ij=Fk,cd=Bk("string-to-symbol-registry"),aj=Bk("symbol-to-string-registry");ej({target:"Symbol",stat:!0,forced:!ij},{for:function(e){var t=nj(e);if(rj(cd,t))return cd[t];var r=tj("Symbol")(t);return cd[t]=r,aj[r]=t,r}});var sj=ft,oj=Vt,uj=co,lj=Qa,cj=Za.exports,fj=Fk,Wm=cj("symbol-to-string-registry");sj({target:"Symbol",stat:!0,forced:!fj},{keyFor:function(t){if(!uj(t))throw TypeError(lj(t)+" is not a symbol");if(oj(Wm,t))return Wm[t]}});var dj=ft,qk=cn,Wk=na,pj=Pt,Ju=Qe,Hk=et,hj=zu,vj=Mt,gj=Gt,Hm=co,Gk=fo,yj=lo,zi=qk("JSON","stringify"),Tl=Ju(/./.exec),Gm=Ju("".charAt),mj=Ju("".charCodeAt),bj=Ju("".replace),wj=Ju(1 .toString),_j=/[\uD800-\uDFFF]/g,Vm=/^[\uD800-\uDBFF]$/,zm=/^[\uDC00-\uDFFF]$/,Km=!yj||Hk(function(){var e=qk("Symbol")();return zi([e])!="[null]"||zi({a:e})!="{}"||zi(Object(e))!="{}"}),Jm=Hk(function(){return zi("\uDF06\uD834")!=='"\\udf06\\ud834"'||zi("\uDEAD")!=='"\\udead"'}),Sj=function(e,t){var r=Gk(arguments),n=t;if(!(!gj(t)&&e===void 0||Hm(e)))return hj(t)||(t=function(i,a){if(vj(n)&&(a=pj(n,this,i,a)),!Hm(a))return a}),r[1]=t,Wk(zi,null,r)},$j=function(e,t,r){var n=Gm(r,t-1),i=Gm(r,t+1);return Tl(Vm,e)&&!Tl(zm,i)||Tl(zm,e)&&!Tl(Vm,n)?"\\u"+wj(mj(e,0),16):e};zi&&dj({target:"JSON",stat:!0,arity:3,forced:Km||Jm},{stringify:function(t,r,n){var i=Gk(arguments),a=Wk(Km?Sj:zi,null,i);return Jm&&typeof a=="string"?bj(a,_j,$j):a}});var kj=ft,Tj=lo,Ej=et,Vk=Wu,Ij=yr,Cj=!Tj||Ej(function(){Vk.f(1)});kj({target:"Object",stat:!0,forced:Cj},{getOwnPropertySymbols:function(t){var r=Vk.f;return r?r(Ij(t)):[]}});var Rj=et,Oj=Ct,Aj=Ya,Pj=Oj("species"),Yu=function(e){return Aj>=51||!Rj(function(){var t=[],r=t.constructor={};return r[Pj]=function(){return{foo:1}},t[e](Boolean).foo!==1})},Mj=ft,Nj=Hr.filter,xj=Yu,Lj=xj("filter");Mj({target:"Array",proto:!0,forced:!Lj},{filter:function(t){return Nj(this,t,arguments.length>1?arguments[1]:void 0)}});var jj=ft,Uj=et,Dj=Wr,zk=Hn.f,Kk=Bt,Fj=Uj(function(){zk(1)}),Bj=!Kk||Fj;jj({target:"Object",stat:!0,forced:Bj,sham:!Kk},{getOwnPropertyDescriptor:function(t,r){return zk(Dj(t),r)}});var qj=ft,Wj=Bt,Hj=ok,Gj=Wr,Vj=Hn,zj=po;qj({target:"Object",stat:!0,sham:!Wj},{getOwnPropertyDescriptors:function(t){for(var r=Gj(t),n=Vj.f,i=Hj(r),a={},s=0,u,o;i.length>s;)o=n(r,u=i[s++]),o!==void 0&&zj(a,u,o);return a}});var ho={exports:{}};(function(e){function t(n,i,a,s,u,o,c){try{var d=n[o](c),y=d.value}catch(_){a(_);return}d.done?i(y):Promise.resolve(y).then(s,u)}function r(n){return function(){var i=this,a=arguments;return new Promise(function(s,u){var o=n.apply(i,a);function c(y){t(o,s,u,c,d,"next",y)}function d(y){t(o,s,u,c,d,"throw",y)}c(void 0)})}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(ho);var ts={exports:{}};(function(e){function t(n,i){for(var a=0;a<i.length;a++){var s=i[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(n,s.key,s)}}function r(n,i,a){return i&&t(n.prototype,i),a&&t(n,a),Object.defineProperty(n,"prototype",{writable:!1}),n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(ts);var sa={exports:{}};(function(e){function t(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(sa);var oa={exports:{}},ff={exports:{}};(function(e){function t(r,n){return e.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(a,s){return a.__proto__=s,a},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ff);(function(e){var t=ff.exports;function r(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(i&&i.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),i&&t(n,i)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(oa);var ua={exports:{}},la={exports:{}};(function(e){function t(r){return e.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(la);(function(e){var t=la.exports.default,r=sa.exports;function n(i,a){if(a&&(t(a)==="object"||typeof a=="function"))return a;if(a!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return r(i)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(ua);var zn={exports:{}};(function(e){function t(r){return e.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(i){return i.__proto__||Object.getPrototypeOf(i)},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(zn);var ca={exports:{}};(function(e){function t(r,n,i){return n in r?Object.defineProperty(r,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[n]=i,r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(ca);var fa={exports:{}};(function(e){function t(r,n){if(!(r instanceof n))throw new TypeError("Cannot call a class as a function")}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(fa);var Kj=Iv,Jj=bi,Yj=Kj?{}.toString:function(){return"[object "+Jj(this)+"]"},Qj=Iv,Xj=mr,Zj=Yj;Qj||Xj(Object.prototype,"toString",Zj,{unsafe:!0});var eU=ta,tU=dt,Qu=eU(tU.process)=="process",rU=Mt,nU=String,iU=TypeError,aU=function(e){if(typeof e=="object"||rU(e))return e;throw iU("Can't set "+nU(e)+" as a prototype")},sU=Qe,oU=Zt,uU=aU,vo=Object.setPrototypeOf||("__proto__"in{}?function(){var e=!1,t={},r;try{r=sU(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set),r(t,[]),e=t instanceof Array}catch{}return function(i,a){return oU(i),uU(a),e?r(i,a):i.__proto__=a,i}}():void 0),lU=cn,cU=Xt,fU=Ct,dU=Bt,Ym=fU("species"),df=function(e){var t=lU(e),r=cU.f;dU&&t&&!t[Ym]&&r(t,Ym,{configurable:!0,get:function(){return this}})},pU=vi,hU=TypeError,rs=function(e,t){if(pU(t,e))return e;throw hU("Incorrect invocation")},Qm=Zt,vU=Rv,gU=Gn,yU=Ct,mU=yU("species"),Fv=function(e,t){var r=Qm(e).constructor,n;return r===void 0||gU(n=Qm(r)[mU])?t:vU(n)},bU=TypeError,Bv=function(e,t){if(e<t)throw bU("Not enough arguments");return e},wU=Ja,Jk=/(?:ipad|iphone|ipod).*applewebkit/i.test(wU),Br=dt,_U=na,SU=wi,Xm=Mt,$U=Vt,kU=et,Zm=yk,TU=fo,eb=ef,EU=Bv,IU=Jk,CU=Qu,ih=Br.setImmediate,ah=Br.clearImmediate,RU=Br.process,fd=Br.Dispatch,OU=Br.Function,tb=Br.MessageChannel,AU=Br.String,dd=0,uu={},rb="onreadystatechange",Iu,$a,pd,hd;try{Iu=Br.location}catch{}var qv=function(e){if($U(uu,e)){var t=uu[e];delete uu[e],t()}},vd=function(e){return function(){qv(e)}},nb=function(e){qv(e.data)},ib=function(e){Br.postMessage(AU(e),Iu.protocol+"//"+Iu.host)};(!ih||!ah)&&(ih=function(t){EU(arguments.length,1);var r=Xm(t)?t:OU(t),n=TU(arguments,1);return uu[++dd]=function(){_U(r,void 0,n)},$a(dd),dd},ah=function(t){delete uu[t]},CU?$a=function(e){RU.nextTick(vd(e))}:fd&&fd.now?$a=function(e){fd.now(vd(e))}:tb&&!IU?(pd=new tb,hd=pd.port2,pd.port1.onmessage=nb,$a=SU(hd.postMessage,hd)):Br.addEventListener&&Xm(Br.postMessage)&&!Br.importScripts&&Iu&&Iu.protocol!=="file:"&&!kU(ib)?($a=ib,Br.addEventListener("message",nb,!1)):rb in eb("script")?$a=function(e){Zm.appendChild(eb("script"))[rb]=function(){Zm.removeChild(this),qv(e)}}:$a=function(e){setTimeout(vd(e),0)});var Yk={set:ih,clear:ah},PU=Ja,MU=dt,NU=/ipad|iphone|ipod/i.test(PU)&&MU.Pebble!==void 0,xU=Ja,LU=/web0s(?!.*chrome)/i.test(xU),Wa=dt,ab=wi,jU=Hn.f,gd=Yk.set,UU=Jk,DU=NU,FU=LU,yd=Qu,sb=Wa.MutationObserver||Wa.WebKitMutationObserver,ob=Wa.document,ub=Wa.process,El=Wa.Promise,lb=jU(Wa,"queueMicrotask"),Qk=lb&&lb.value,Lo,Na,lu,Rs,md,bd,Il,cb;Qk||(Lo=function(){var e,t;for(yd&&(e=ub.domain)&&e.exit();Na;){t=Na.fn,Na=Na.next;try{t()}catch(r){throw Na?Rs():lu=void 0,r}}lu=void 0,e&&e.enter()},!UU&&!yd&&!FU&&sb&&ob?(md=!0,bd=ob.createTextNode(""),new sb(Lo).observe(bd,{characterData:!0}),Rs=function(){bd.data=md=!md}):!DU&&El&&El.resolve?(Il=El.resolve(void 0),Il.constructor=El,cb=ab(Il.then,Il),Rs=function(){cb(Lo)}):yd?Rs=function(){ub.nextTick(Lo)}:(gd=ab(gd,Wa),Rs=function(){gd(Lo)}));var BU=Qk||function(e){var t={fn:e,next:void 0};lu&&(lu.next=t),Na||(Na=t,Rs()),lu=t},qU=dt,WU=function(e,t){var r=qU.console;r&&r.error&&(arguments.length==1?r.error(e):r.error(e,t))},Wv=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},Xk=function(){this.head=null,this.tail=null};Xk.prototype={add:function(e){var t={item:e,next:null};this.head?this.tail.next=t:this.head=t,this.tail=t},get:function(){var e=this.head;if(e)return this.head=e.next,this.tail===e&&(this.tail=null),e.item}};var HU=Xk,GU=dt,pf=GU.Promise,Zk=typeof Deno=="object"&&Deno&&typeof Deno.version=="object",VU=Zk,zU=Qu,KU=!VU&&!zU&&typeof window=="object"&&typeof document=="object",JU=dt,cu=pf,YU=Mt,QU=nf,XU=Tv,ZU=Ct,eD=KU,tD=Zk,wd=Ya;cu&&cu.prototype;var rD=ZU("species"),sh=!1,e0=YU(JU.PromiseRejectionEvent),nD=QU("Promise",function(){var e=XU(cu),t=e!==String(cu);if(!t&&wd===66)return!0;if(!wd||wd<51||!/native code/.test(e)){var r=new cu(function(a){a(1)}),n=function(a){a(function(){},function(){})},i=r.constructor={};if(i[rD]=n,sh=r.then(function(){})instanceof n,!sh)return!0}return!t&&(eD||tD)&&!e0}),Xu={CONSTRUCTOR:nD,REJECTION_EVENT:e0,SUBCLASSING:sh},go={},fb=On,iD=TypeError,aD=function(e){var t,r;this.promise=new e(function(n,i){if(t!==void 0||r!==void 0)throw iD("Bad Promise constructor");t=n,r=i}),this.resolve=fb(t),this.reject=fb(r)};go.f=function(e){return new aD(e)};var sD=ft,_c=Qu,Zi=dt,Zs=Pt,db=mr,pb=vo,oD=aa,uD=df,lD=On,ac=Mt,cD=Gt,fD=rs,dD=Fv,t0=Yk.set,Hv=BU,pD=WU,hD=Wv,vD=HU,r0=fn,Sc=pf,Gv=Xu,n0=go,hf="Promise",i0=Gv.CONSTRUCTOR,gD=Gv.REJECTION_EVENT,yD=Gv.SUBCLASSING,_d=r0.getterFor(hf),mD=r0.set,Os=Sc&&Sc.prototype,xa=Sc,Cl=Os,a0=Zi.TypeError,oh=Zi.document,Vv=Zi.process,uh=n0.f,bD=uh,wD=!!(oh&&oh.createEvent&&Zi.dispatchEvent),s0="unhandledrejection",_D="rejectionhandled",hb=0,o0=1,SD=2,zv=1,u0=2,Rl,vb,$D,gb,l0=function(e){var t;return cD(e)&&ac(t=e.then)?t:!1},c0=function(e,t){var r=t.value,n=t.state==o0,i=n?e.ok:e.fail,a=e.resolve,s=e.reject,u=e.domain,o,c,d;try{i?(n||(t.rejection===u0&&TD(t),t.rejection=zv),i===!0?o=r:(u&&u.enter(),o=i(r),u&&(u.exit(),d=!0)),o===e.promise?s(a0("Promise-chain cycle")):(c=l0(o))?Zs(c,o,a,s):a(o)):s(r)}catch(y){u&&!d&&u.exit(),s(y)}},f0=function(e,t){e.notified||(e.notified=!0,Hv(function(){for(var r=e.reactions,n;n=r.get();)c0(n,e);e.notified=!1,t&&!e.rejection&&kD(e)}))},d0=function(e,t,r){var n,i;wD?(n=oh.createEvent("Event"),n.promise=t,n.reason=r,n.initEvent(e,!1,!0),Zi.dispatchEvent(n)):n={promise:t,reason:r},!gD&&(i=Zi["on"+e])?i(n):e===s0&&pD("Unhandled promise rejection",r)},kD=function(e){Zs(t0,Zi,function(){var t=e.facade,r=e.value,n=yb(e),i;if(n&&(i=hD(function(){_c?Vv.emit("unhandledRejection",r,t):d0(s0,t,r)}),e.rejection=_c||yb(e)?u0:zv,i.error))throw i.value})},yb=function(e){return e.rejection!==zv&&!e.parent},TD=function(e){Zs(t0,Zi,function(){var t=e.facade;_c?Vv.emit("rejectionHandled",t):d0(_D,t,e.value)})},Ms=function(e,t,r){return function(n){e(t,n,r)}},Fs=function(e,t,r){e.done||(e.done=!0,r&&(e=r),e.value=t,e.state=SD,f0(e,!0))},lh=function(e,t,r){if(!e.done){e.done=!0,r&&(e=r);try{if(e.facade===t)throw a0("Promise can't be resolved itself");var n=l0(t);n?Hv(function(){var i={done:!1};try{Zs(n,t,Ms(lh,i,e),Ms(Fs,i,e))}catch(a){Fs(i,a,e)}}):(e.value=t,e.state=o0,f0(e,!1))}catch(i){Fs({done:!1},i,e)}}};if(i0&&(xa=function(t){fD(this,Cl),lD(t),Zs(Rl,this);var r=_d(this);try{t(Ms(lh,r),Ms(Fs,r))}catch(n){Fs(r,n)}},Cl=xa.prototype,Rl=function(t){mD(this,{type:hf,done:!1,notified:!1,parent:!1,reactions:new vD,rejection:!1,state:hb,value:void 0})},Rl.prototype=db(Cl,"then",function(t,r){var n=_d(this),i=uh(dD(this,xa));return n.parent=!0,i.ok=ac(t)?t:!0,i.fail=ac(r)&&r,i.domain=_c?Vv.domain:void 0,n.state==hb?n.reactions.add(i):Hv(function(){c0(i,n)}),i.promise}),vb=function(){var e=new Rl,t=_d(e);this.promise=e,this.resolve=Ms(lh,t),this.reject=Ms(Fs,t)},n0.f=uh=function(e){return e===xa||e===$D?new vb(e):bD(e)},ac(Sc)&&Os!==Object.prototype)){gb=Os.then,yD||db(Os,"then",function(t,r){var n=this;return new xa(function(i,a){Zs(gb,n,i,a)}).then(t,r)},{unsafe:!0});try{delete Os.constructor}catch{}pb&&pb(Os,Cl)}sD({global:!0,constructor:!0,wrap:!0,forced:i0},{Promise:xa});oD(xa,hf,!1);uD(hf);var Zu={},ED=Ct,ID=Zu,CD=ED("iterator"),RD=Array.prototype,Kv=function(e){return e!==void 0&&(ID.Array===e||RD[CD]===e)},OD=bi,mb=Xa,AD=Gn,PD=Zu,MD=Ct,ND=MD("iterator"),el=function(e){if(!AD(e))return mb(e,ND)||mb(e,"@@iterator")||PD[OD(e)]},xD=Pt,LD=On,jD=Zt,UD=Qa,DD=el,FD=TypeError,vf=function(e,t){var r=arguments.length<2?DD(e):t;if(LD(r))return jD(xD(r,e));throw FD(UD(e)+" is not iterable")},BD=Pt,bb=Zt,qD=Xa,p0=function(e,t,r){var n,i;bb(e);try{if(n=qD(e,"return"),!n){if(t==="throw")throw r;return r}n=BD(n,e)}catch(a){i=!0,n=a}if(t==="throw")throw r;if(i)throw n;return bb(n),r},WD=wi,HD=Pt,GD=Zt,VD=Qa,zD=Kv,KD=br,wb=vi,JD=vf,YD=el,_b=p0,QD=TypeError,sc=function(e,t){this.stopped=e,this.result=t},Sb=sc.prototype,gf=function(e,t,r){var n=r&&r.that,i=!!(r&&r.AS_ENTRIES),a=!!(r&&r.IS_RECORD),s=!!(r&&r.IS_ITERATOR),u=!!(r&&r.INTERRUPTED),o=WD(t,n),c,d,y,_,w,k,N,M=function(B){return c&&_b(c,"normal",B),new sc(!0,B)},L=function(B){return i?(GD(B),u?o(B[0],B[1],M):o(B[0],B[1])):u?o(B,M):o(B)};if(a)c=e.iterator;else if(s)c=e;else{if(d=YD(e),!d)throw QD(VD(e)+" is not iterable");if(zD(d)){for(y=0,_=KD(e);_>y;y++)if(w=L(e[y]),w&&wb(Sb,w))return w;return new sc(!1)}c=JD(e,d)}for(k=a?e.next:c.next;!(N=HD(k,c)).done;){try{w=L(N.value)}catch(B){_b(c,"throw",B)}if(typeof w=="object"&&w&&wb(Sb,w))return w}return new sc(!1)},XD=Ct,h0=XD("iterator"),v0=!1;try{var ZD=0,$b={next:function(){return{done:!!ZD++}},return:function(){v0=!0}};$b[h0]=function(){return this},Array.from($b,function(){throw 2})}catch{}var yf=function(e,t){if(!t&&!v0)return!1;var r=!1;try{var n={};n[h0]=function(){return{next:function(){return{done:r=!0}}}},e(n)}catch{}return r},eF=pf,tF=yf,rF=Xu.CONSTRUCTOR,g0=rF||!tF(function(e){eF.all(e).then(void 0,function(){})}),nF=ft,iF=Pt,aF=On,sF=go,oF=Wv,uF=gf,lF=g0;nF({target:"Promise",stat:!0,forced:lF},{all:function(t){var r=this,n=sF.f(r),i=n.resolve,a=n.reject,s=oF(function(){var u=aF(r.resolve),o=[],c=0,d=1;uF(t,function(y){var _=c++,w=!1;d++,iF(u,r,y).then(function(k){w||(w=!0,o[_]=k,--d||i(o))},a)}),--d||i(o)});return s.error&&a(s.value),n.promise}});var cF=ft,fF=Xu.CONSTRUCTOR,ch=pf,dF=cn,pF=Mt,hF=mr,kb=ch&&ch.prototype;cF({target:"Promise",proto:!0,forced:fF,real:!0},{catch:function(e){return this.then(void 0,e)}});if(pF(ch)){var Tb=dF("Promise").prototype.catch;kb.catch!==Tb&&hF(kb,"catch",Tb,{unsafe:!0})}var vF=ft,gF=Pt,yF=On,mF=go,bF=Wv,wF=gf,_F=g0;vF({target:"Promise",stat:!0,forced:_F},{race:function(t){var r=this,n=mF.f(r),i=n.reject,a=bF(function(){var s=yF(r.resolve);wF(t,function(u){gF(s,r,u).then(n.resolve,i)})});return a.error&&i(a.value),n.promise}});var SF=ft,$F=Pt,kF=go,TF=Xu.CONSTRUCTOR;SF({target:"Promise",stat:!0,forced:TF},{reject:function(t){var r=kF.f(this);return $F(r.reject,void 0,t),r.promise}});var EF=Zt,IF=Gt,CF=go,RF=function(e,t){if(EF(e),IF(t)&&t.constructor===e)return t;var r=CF.f(e),n=r.resolve;return n(t),r.promise},OF=ft,AF=cn,PF=Xu.CONSTRUCTOR,MF=RF;AF("Promise");OF({target:"Promise",stat:!0,forced:PF},{resolve:function(t){return MF(this,t)}});var y0={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},NF=ef,Sd=NF("span").classList,Eb=Sd&&Sd.constructor&&Sd.constructor.prototype,m0=Eb===Object.prototype?void 0:Eb,xF=et,tl=function(e,t){var r=[][e];return!!r&&xF(function(){r.call(null,t||function(){return 1},1)})},LF=Hr.forEach,jF=tl,UF=jF("forEach"),DF=UF?[].forEach:function(t){return LF(this,t,arguments.length>1?arguments[1]:void 0)},Ib=dt,Cb=y0,FF=m0,$d=DF,BF=gi,b0=function(e){if(e&&e.forEach!==$d)try{BF(e,"forEach",$d)}catch{e.forEach=$d}};for(var kd in Cb)Cb[kd]&&b0(Ib[kd]&&Ib[kd].prototype);b0(FF);var qF=Mt,WF=Gt,Rb=vo,Jv=function(e,t,r){var n,i;return Rb&&qF(n=t.constructor)&&n!==r&&WF(i=n.prototype)&&i!==r.prototype&&Rb(e,i),e},HF=Qe,GF=HF(1 .valueOf),VF=`	
\v\f\r \xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF`,zF=Qe,KF=Vn,JF=fr,YF=VF,Ob=zF("".replace),$c="["+YF+"]",QF=RegExp("^"+$c+$c+"*"),XF=RegExp($c+$c+"*$"),Td=function(e){return function(t){var r=JF(KF(t));return e&1&&(r=Ob(r,QF,"")),e&2&&(r=Ob(r,XF,"")),r}},ZF={start:Td(1),end:Td(2),trim:Td(3)},e3=Bt,Yv=dt,w0=Qe,t3=nf,r3=mr,Ab=Vt,n3=Jv,i3=vi,a3=co,_0=Sv,s3=et,o3=ra.f,u3=Hn.f,l3=Xt.f,c3=GF,f3=ZF.trim,fh="Number",xi=Yv[fh],Ed=xi.prototype,d3=Yv.TypeError,p3=w0("".slice),Ol=w0("".charCodeAt),h3=function(e){var t=_0(e,"number");return typeof t=="bigint"?t:v3(t)},v3=function(e){var t=_0(e,"number"),r,n,i,a,s,u,o,c;if(a3(t))throw d3("Cannot convert a Symbol value to a number");if(typeof t=="string"&&t.length>2){if(t=f3(t),r=Ol(t,0),r===43||r===45){if(n=Ol(t,2),n===88||n===120)return NaN}else if(r===48){switch(Ol(t,1)){case 66:case 98:i=2,a=49;break;case 79:case 111:i=8,a=55;break;default:return+t}for(s=p3(t,2),u=s.length,o=0;o<u;o++)if(c=Ol(s,o),c<48||c>a)return NaN;return parseInt(s,i)}}return+t};if(t3(fh,!xi(" 0o1")||!xi("0b1")||xi("+0x1"))){for(var ys=function(t){var r=arguments.length<1?0:xi(h3(t)),n=this;return i3(Ed,n)&&s3(function(){c3(n)})?n3(Object(r),n,ys):r},Pb=e3?o3(xi):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),Id=0,Al;Pb.length>Id;Id++)Ab(xi,Al=Pb[Id])&&!Ab(ys,Al)&&l3(ys,Al,u3(xi,Al));ys.prototype=Ed,Ed.constructor=ys,r3(Yv,fh,ys,{constructor:!0})}var S0={exports:{}};(function(e){var t=la.exports.default;function r(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},i=Object.prototype,a=i.hasOwnProperty,s=typeof Symbol=="function"?Symbol:{},u=s.iterator||"@@iterator",o=s.asyncIterator||"@@asyncIterator",c=s.toStringTag||"@@toStringTag";function d(oe,te,ae){return Object.defineProperty(oe,te,{value:ae,enumerable:!0,configurable:!0,writable:!0}),oe[te]}try{d({},"")}catch{d=function(ae,ne,be){return ae[ne]=be}}function y(oe,te,ae,ne){var be=te&&te.prototype instanceof k?te:k,A=Object.create(be.prototype),Le=new F(ne||[]);return A._invoke=function(at,We,fe){var V="suspendedStart";return function(Q,$){if(V==="executing")throw new Error("Generator is already running");if(V==="completed"){if(Q==="throw")throw $;return Ee()}for(fe.method=Q,fe.arg=$;;){var I=fe.delegate;if(I){var Z=Ae(I,fe);if(Z){if(Z===w)continue;return Z}}if(fe.method==="next")fe.sent=fe._sent=fe.arg;else if(fe.method==="throw"){if(V==="suspendedStart")throw V="completed",fe.arg;fe.dispatchException(fe.arg)}else fe.method==="return"&&fe.abrupt("return",fe.arg);V="executing";var re=_(at,We,fe);if(re.type==="normal"){if(V=fe.done?"completed":"suspendedYield",re.arg===w)continue;return{value:re.arg,done:fe.done}}re.type==="throw"&&(V="completed",fe.method="throw",fe.arg=re.arg)}}}(oe,ae,Le),A}function _(oe,te,ae){try{return{type:"normal",arg:oe.call(te,ae)}}catch(ne){return{type:"throw",arg:ne}}}n.wrap=y;var w={};function k(){}function N(){}function M(){}var L={};d(L,u,function(){return this});var B=Object.getPrototypeOf,ve=B&&B(B(Se([])));ve&&ve!==i&&a.call(ve,u)&&(L=ve);var ue=M.prototype=k.prototype=Object.create(L);function Me(oe){["next","throw","return"].forEach(function(te){d(oe,te,function(ae){return this._invoke(te,ae)})})}function Re(oe,te){function ae(be,A,Le,at){var We=_(oe[be],oe,A);if(We.type!=="throw"){var fe=We.arg,V=fe.value;return V&&t(V)=="object"&&a.call(V,"__await")?te.resolve(V.__await).then(function(Q){ae("next",Q,Le,at)},function(Q){ae("throw",Q,Le,at)}):te.resolve(V).then(function(Q){fe.value=Q,Le(fe)},function(Q){return ae("throw",Q,Le,at)})}at(We.arg)}var ne;this._invoke=function(be,A){function Le(){return new te(function(at,We){ae(be,A,at,We)})}return ne=ne?ne.then(Le,Le):Le()}}function Ae(oe,te){var ae=oe.iterator[te.method];if(ae===void 0){if(te.delegate=null,te.method==="throw"){if(oe.iterator.return&&(te.method="return",te.arg=void 0,Ae(oe,te),te.method==="throw"))return w;te.method="throw",te.arg=new TypeError("The iterator does not provide a 'throw' method")}return w}var ne=_(ae,oe.iterator,te.arg);if(ne.type==="throw")return te.method="throw",te.arg=ne.arg,te.delegate=null,w;var be=ne.arg;return be?be.done?(te[oe.resultName]=be.value,te.next=oe.nextLoc,te.method!=="return"&&(te.method="next",te.arg=void 0),te.delegate=null,w):be:(te.method="throw",te.arg=new TypeError("iterator result is not an object"),te.delegate=null,w)}function x(oe){var te={tryLoc:oe[0]};1 in oe&&(te.catchLoc=oe[1]),2 in oe&&(te.finallyLoc=oe[2],te.afterLoc=oe[3]),this.tryEntries.push(te)}function le(oe){var te=oe.completion||{};te.type="normal",delete te.arg,oe.completion=te}function F(oe){this.tryEntries=[{tryLoc:"root"}],oe.forEach(x,this),this.reset(!0)}function Se(oe){if(oe){var te=oe[u];if(te)return te.call(oe);if(typeof oe.next=="function")return oe;if(!isNaN(oe.length)){var ae=-1,ne=function be(){for(;++ae<oe.length;)if(a.call(oe,ae))return be.value=oe[ae],be.done=!1,be;return be.value=void 0,be.done=!0,be};return ne.next=ne}}return{next:Ee}}function Ee(){return{value:void 0,done:!0}}return N.prototype=M,d(ue,"constructor",M),d(M,"constructor",N),N.displayName=d(M,c,"GeneratorFunction"),n.isGeneratorFunction=function(oe){var te=typeof oe=="function"&&oe.constructor;return!!te&&(te===N||(te.displayName||te.name)==="GeneratorFunction")},n.mark=function(oe){return Object.setPrototypeOf?Object.setPrototypeOf(oe,M):(oe.__proto__=M,d(oe,c,"GeneratorFunction")),oe.prototype=Object.create(ue),oe},n.awrap=function(oe){return{__await:oe}},Me(Re.prototype),d(Re.prototype,o,function(){return this}),n.AsyncIterator=Re,n.async=function(oe,te,ae,ne,be){be===void 0&&(be=Promise);var A=new Re(y(oe,te,ae,ne),be);return n.isGeneratorFunction(te)?A:A.next().then(function(Le){return Le.done?Le.value:A.next()})},Me(ue),d(ue,c,"Generator"),d(ue,u,function(){return this}),d(ue,"toString",function(){return"[object Generator]"}),n.keys=function(oe){var te=[];for(var ae in oe)te.push(ae);return te.reverse(),function ne(){for(;te.length;){var be=te.pop();if(be in oe)return ne.value=be,ne.done=!1,ne}return ne.done=!0,ne}},n.values=Se,F.prototype={constructor:F,reset:function(te){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(le),!te)for(var ae in this)ae.charAt(0)==="t"&&a.call(this,ae)&&!isNaN(+ae.slice(1))&&(this[ae]=void 0)},stop:function(){this.done=!0;var te=this.tryEntries[0].completion;if(te.type==="throw")throw te.arg;return this.rval},dispatchException:function(te){if(this.done)throw te;var ae=this;function ne(fe,V){return Le.type="throw",Le.arg=te,ae.next=fe,V&&(ae.method="next",ae.arg=void 0),!!V}for(var be=this.tryEntries.length-1;be>=0;--be){var A=this.tryEntries[be],Le=A.completion;if(A.tryLoc==="root")return ne("end");if(A.tryLoc<=this.prev){var at=a.call(A,"catchLoc"),We=a.call(A,"finallyLoc");if(at&&We){if(this.prev<A.catchLoc)return ne(A.catchLoc,!0);if(this.prev<A.finallyLoc)return ne(A.finallyLoc)}else if(at){if(this.prev<A.catchLoc)return ne(A.catchLoc,!0)}else{if(!We)throw new Error("try statement without catch or finally");if(this.prev<A.finallyLoc)return ne(A.finallyLoc)}}}},abrupt:function(te,ae){for(var ne=this.tryEntries.length-1;ne>=0;--ne){var be=this.tryEntries[ne];if(be.tryLoc<=this.prev&&a.call(be,"finallyLoc")&&this.prev<be.finallyLoc){var A=be;break}}A&&(te==="break"||te==="continue")&&A.tryLoc<=ae&&ae<=A.finallyLoc&&(A=null);var Le=A?A.completion:{};return Le.type=te,Le.arg=ae,A?(this.method="next",this.next=A.finallyLoc,w):this.complete(Le)},complete:function(te,ae){if(te.type==="throw")throw te.arg;return te.type==="break"||te.type==="continue"?this.next=te.arg:te.type==="return"?(this.rval=this.arg=te.arg,this.method="return",this.next="end"):te.type==="normal"&&ae&&(this.next=ae),w},finish:function(te){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var ne=this.tryEntries[ae];if(ne.finallyLoc===te)return this.complete(ne.completion,ne.afterLoc),le(ne),w}},catch:function(te){for(var ae=this.tryEntries.length-1;ae>=0;--ae){var ne=this.tryEntries[ae];if(ne.tryLoc===te){var be=ne.completion;if(be.type==="throw"){var A=be.arg;le(ne)}return A}}throw new Error("illegal catch attempt")},delegateYield:function(te,ae,ne){return this.delegate={iterator:Se(te),resultName:ae,nextLoc:ne},this.method==="next"&&(this.arg=void 0),w}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(S0);var oc=S0.exports(),rl=oc;try{regeneratorRuntime=oc}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=oc:Function("r","regeneratorRuntime = r")(oc)}var g3=TypeError,y3=9007199254740991,$0=function(e){if(e>y3)throw g3("Maximum allowed index exceeded");return e},m3=ft,b3=et,w3=zu,_3=Gt,S3=yr,$3=br,Mb=$0,Nb=po,k3=Nv,T3=Yu,E3=Ct,I3=Ya,k0=E3("isConcatSpreadable"),C3=I3>=51||!b3(function(){var e=[];return e[k0]=!1,e.concat()[0]!==e}),R3=T3("concat"),O3=function(e){if(!_3(e))return!1;var t=e[k0];return t!==void 0?!!t:w3(e)},A3=!C3||!R3;m3({target:"Array",proto:!0,arity:1,forced:A3},{concat:function(t){var r=S3(this),n=k3(r,0),i=0,a,s,u,o,c;for(a=-1,u=arguments.length;a<u;a++)if(c=a===-1?r:arguments[a],O3(c))for(o=$3(c),Mb(i+o),s=0;s<o;s++,i++)s in c&&Nb(n,i,c[s]);else Mb(i+1),Nb(n,i++,c);return n.length=i,n}});var P3=Zt,M3=p0,N3=function(e,t,r,n){try{return n?t(P3(r)[0],r[1]):t(r)}catch(i){M3(e,"throw",i)}},x3=wi,L3=Pt,j3=yr,U3=N3,D3=Kv,F3=af,B3=br,xb=po,q3=vf,W3=el,Lb=Array,T0=function(t){var r=j3(t),n=F3(this),i=arguments.length,a=i>1?arguments[1]:void 0,s=a!==void 0;s&&(a=x3(a,i>2?arguments[2]:void 0));var u=W3(r),o=0,c,d,y,_,w,k;if(u&&!(this===Lb&&D3(u)))for(_=q3(r,u),w=_.next,d=n?new this:[];!(y=L3(w,_)).done;o++)k=s?U3(_,a,[y.value,o],!0):y.value,xb(d,o,k);else for(c=B3(r),d=n?new this(c):Lb(c);c>o;o++)k=s?a(r[o],o):r[o],xb(d,o,k);return d.length=o,d},H3=ft,G3=T0,V3=yf,z3=!V3(function(e){Array.from(e)});H3({target:"Array",stat:!0,forced:z3},{from:G3});var Qv=Qe,K3=yi,J3=fr,Y3=Vn,Q3=Qv("".charAt),jb=Qv("".charCodeAt),X3=Qv("".slice),Ub=function(e){return function(t,r){var n=J3(Y3(t)),i=K3(r),a=n.length,s,u;return i<0||i>=a?e?"":void 0:(s=jb(n,i),s<55296||s>56319||i+1===a||(u=jb(n,i+1))<56320||u>57343?e?Q3(n,i):s:e?X3(n,i,i+2):(s-55296<<10)+(u-56320)+65536)}},Xv={codeAt:Ub(!1),charAt:Ub(!0)},Z3=et,eB=!Z3(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),tB=Vt,rB=Mt,nB=yr,iB=tf,aB=eB,Db=iB("IE_PROTO"),dh=Object,sB=dh.prototype,mf=aB?dh.getPrototypeOf:function(e){var t=nB(e);if(tB(t,Db))return t[Db];var r=t.constructor;return rB(r)&&t instanceof r?r.prototype:t instanceof dh?sB:null},oB=et,uB=Mt,lB=Gt,Fb=mf,cB=mr,fB=Ct,ph=fB("iterator"),E0=!1,Ha,Cd,Rd;[].keys&&(Rd=[].keys(),"next"in Rd?(Cd=Fb(Fb(Rd)),Cd!==Object.prototype&&(Ha=Cd)):E0=!0);var dB=!lB(Ha)||oB(function(){var e={};return Ha[ph].call(e)!==e});dB&&(Ha={});uB(Ha[ph])||cB(Ha,ph,function(){return this});var I0={IteratorPrototype:Ha,BUGGY_SAFARI_ITERATORS:E0},pB=I0.IteratorPrototype,hB=ia,vB=Ka,gB=aa,yB=Zu,mB=function(){return this},C0=function(e,t,r,n){var i=t+" Iterator";return e.prototype=hB(pB,{next:vB(+!n,r)}),gB(e,i,!1),yB[i]=mB,e},bB=ft,wB=Pt,R0=Bu,_B=Mt,SB=C0,Bb=mf,qb=vo,$B=aa,kB=gi,Od=mr,TB=Ct,EB=Zu,O0=I0,IB=R0.PROPER,CB=R0.CONFIGURABLE,Wb=O0.IteratorPrototype,Pl=O0.BUGGY_SAFARI_ITERATORS,jo=TB("iterator"),Hb="keys",Uo="values",Gb="entries",RB=function(){return this},Zv=function(e,t,r,n,i,a,s){SB(r,t,n);var u=function(L){if(L===i&&_)return _;if(!Pl&&L in d)return d[L];switch(L){case Hb:return function(){return new r(this,L)};case Uo:return function(){return new r(this,L)};case Gb:return function(){return new r(this,L)}}return function(){return new r(this)}},o=t+" Iterator",c=!1,d=e.prototype,y=d[jo]||d["@@iterator"]||i&&d[i],_=!Pl&&y||u(i),w=t=="Array"&&d.entries||y,k,N,M;if(w&&(k=Bb(w.call(new e)),k!==Object.prototype&&k.next&&(Bb(k)!==Wb&&(qb?qb(k,Wb):_B(k[jo])||Od(k,jo,RB)),$B(k,o,!0))),IB&&i==Uo&&y&&y.name!==Uo&&(CB?kB(d,"name",Uo):(c=!0,_=function(){return wB(y,this)})),i)if(N={values:u(Uo),keys:a?_:u(Hb),entries:u(Gb)},s)for(M in N)(Pl||c||!(M in d))&&Od(d,M,N[M]);else bB({target:t,proto:!0,forced:Pl||c},N);return d[jo]!==_&&Od(d,jo,_,{name:i}),EB[t]=_,N},eg=function(e,t){return{value:e,done:t}},OB=Xv.charAt,AB=fr,A0=fn,PB=Zv,Vb=eg,P0="String Iterator",MB=A0.set,NB=A0.getterFor(P0);PB(String,"String",function(e){MB(this,{type:P0,string:AB(e),index:0})},function(){var t=NB(this),r=t.string,n=t.index,i;return n>=r.length?Vb(void 0,!0):(i=OB(r,n),t.index+=i.length,Vb(i,!1))});var yo={exports:{}};(function(e){(function(t,r){e.exports?e.exports=r():t.log=r()})($n,function(){var t=function(){},r="undefined",n=typeof window!==r&&typeof window.navigator!==r&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"];function a(N,M){var L=N[M];if(typeof L.bind=="function")return L.bind(N);try{return Function.prototype.bind.call(L,N)}catch{return function(){return Function.prototype.apply.apply(L,[N,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function u(N){return N==="debug"&&(N="log"),typeof console===r?!1:N==="trace"&&n?s:console[N]!==void 0?a(console,N):console.log!==void 0?a(console,"log"):t}function o(N,M){for(var L=0;L<i.length;L++){var B=i[L];this[B]=L<N?t:this.methodFactory(B,N,M)}this.log=this.debug}function c(N,M,L){return function(){typeof console!==r&&(o.call(this,M,L),this[N].apply(this,arguments))}}function d(N,M,L){return u(N)||c.apply(this,arguments)}function y(N,M,L){var B=this,ve;M=M==null?"WARN":M;var ue="loglevel";typeof N=="string"?ue+=":"+N:typeof N=="symbol"&&(ue=void 0);function Me(le){var F=(i[le]||"silent").toUpperCase();if(!(typeof window===r||!ue)){try{window.localStorage[ue]=F;return}catch{}try{window.document.cookie=encodeURIComponent(ue)+"="+F+";"}catch{}}}function Re(){var le;if(!(typeof window===r||!ue)){try{le=window.localStorage[ue]}catch{}if(typeof le===r)try{var F=window.document.cookie,Se=F.indexOf(encodeURIComponent(ue)+"=");Se!==-1&&(le=/^([^;]+)/.exec(F.slice(Se))[1])}catch{}return B.levels[le]===void 0&&(le=void 0),le}}function Ae(){if(!(typeof window===r||!ue)){try{window.localStorage.removeItem(ue);return}catch{}try{window.document.cookie=encodeURIComponent(ue)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}B.name=N,B.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},B.methodFactory=L||d,B.getLevel=function(){return ve},B.setLevel=function(le,F){if(typeof le=="string"&&B.levels[le.toUpperCase()]!==void 0&&(le=B.levels[le.toUpperCase()]),typeof le=="number"&&le>=0&&le<=B.levels.SILENT){if(ve=le,F!==!1&&Me(le),o.call(B,le,N),typeof console===r&&le<B.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+le},B.setDefaultLevel=function(le){M=le,Re()||B.setLevel(le,!1)},B.resetLevel=function(){B.setLevel(M,!1),Ae()},B.enableAll=function(le){B.setLevel(B.levels.TRACE,le)},B.disableAll=function(le){B.setLevel(B.levels.SILENT,le)};var x=Re();x==null&&(x=M),B.setLevel(x,!1)}var _=new y,w={};_.getLogger=function(M){if(typeof M!="symbol"&&typeof M!="string"||M==="")throw new TypeError("You must supply a name when creating a logger.");var L=w[M];return L||(L=w[M]=new y(M,_.getLevel(),_.methodFactory)),L};var k=typeof window!==r?window.log:void 0;return _.noConflict=function(){return typeof window!==r&&window.log===_&&(window.log=k),_},_.getLoggers=function(){return w},_.default=_,_})})(yo);const qa="\\d+(?:[\\.,]\\d+)?",xB=`(${qa}W)`,LB=`(${qa}Y)?(${qa}M)?(${qa}D)?`,jB=`T(${qa}H)?(${qa}M)?(${qa}S)?`,UB=`P(?:${xB}|${LB}(?:${jB})?)`,DB=["weeks","years","months","days","hours","minutes","seconds"],tg=new RegExp(UB),M0=e=>e.match(tg).slice(1).reduce((t,r,n)=>(t[DB[n]]=parseFloat(r)||0,t),{}),rg=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return n.setFullYear(n.getFullYear()+e.years),n.setMonth(n.getMonth()+e.months),n.setDate(n.getDate()+e.days),n.setHours(n.getHours()+e.hours),n.setMinutes(n.getMinutes()+e.minutes),n.setMilliseconds(n.getMilliseconds()+e.seconds*1e3),n.setDate(n.getDate()+e.weeks*7),n},N0=(e,t)=>{const r=t?t.getTime():Date.now(),n=new Date(r);return(rg(e,n).getTime()-n.getTime())/1e3},FB={end:rg,toSeconds:N0,pattern:tg,parse:M0},BB=Object.freeze(Object.defineProperty({__proto__:null,pattern:tg,parse:M0,end:rg,toSeconds:N0,default:FB},Symbol.toStringTag,{value:"Module"})),qB=DP(BB);var WB=ft,HB=Hr.map,GB=Yu,VB=GB("map");WB({target:"Array",proto:!0,forced:!VB},{map:function(t){return HB(this,t,arguments.length>1?arguments[1]:void 0)}});var zB=Ct,KB=ia,JB=Xt.f,hh=zB("unscopables"),vh=Array.prototype;vh[hh]==null&&JB(vh,hh,{configurable:!0,value:KB(null)});var ng=function(e){vh[hh][e]=!0},YB=Wr,ig=ng,zb=Zu,x0=fn,QB=Xt.f,XB=Zv,Ml=eg,ZB=Bt,L0="Array Iterator",e4=x0.set,t4=x0.getterFor(L0),j0=XB(Array,"Array",function(e,t){e4(this,{type:L0,target:YB(e),index:0,kind:t})},function(){var e=t4(this),t=e.target,r=e.kind,n=e.index++;return!t||n>=t.length?(e.target=void 0,Ml(void 0,!0)):r=="keys"?Ml(n,!1):r=="values"?Ml(t[n],!1):Ml([n,t[n]],!1)},"values"),Kb=zb.Arguments=zb.Array;ig("keys");ig("values");ig("entries");if(ZB&&Kb.name!=="values")try{QB(Kb,"name",{value:"values"})}catch{}var Jb=dt,U0=y0,r4=m0,Xo=j0,Ad=gi,D0=Ct,Pd=D0("iterator"),Yb=D0("toStringTag"),Md=Xo.values,F0=function(e,t){if(e){if(e[Pd]!==Md)try{Ad(e,Pd,Md)}catch{e[Pd]=Md}if(e[Yb]||Ad(e,Yb,t),U0[t]){for(var r in Xo)if(e[r]!==Xo[r])try{Ad(e,r,Xo[r])}catch{e[r]=Xo[r]}}}};for(var Nd in U0)F0(Jb[Nd]&&Jb[Nd].prototype,Nd);F0(r4,"DOMTokenList");var n4=Zt,B0=function(){var e=n4(this),t="";return e.hasIndices&&(t+="d"),e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.unicodeSets&&(t+="v"),e.sticky&&(t+="y"),t},ag=et,i4=dt,sg=i4.RegExp,og=ag(function(){var e=sg("a","y");return e.lastIndex=2,e.exec("abcd")!=null}),a4=og||ag(function(){return!sg("a","y").sticky}),s4=og||ag(function(){var e=sg("^r","gy");return e.lastIndex=2,e.exec("str")!=null}),q0={BROKEN_CARET:s4,MISSED_STICKY:a4,UNSUPPORTED_Y:og},o4=et,u4=dt,l4=u4.RegExp,c4=o4(function(){var e=l4(".","s");return!(e.dotAll&&e.exec(`
`)&&e.flags==="s")}),f4=et,d4=dt,p4=d4.RegExp,h4=f4(function(){var e=p4("(?<a>b)","g");return e.exec("b").groups.a!=="b"||"b".replace(e,"$<a>c")!=="bc"}),Ns=Pt,bf=Qe,v4=fr,g4=B0,y4=q0,m4=Za.exports,b4=ia,w4=fn.get,_4=c4,S4=h4,$4=m4("native-string-replace",String.prototype.replace),kc=RegExp.prototype.exec,gh=kc,k4=bf("".charAt),T4=bf("".indexOf),E4=bf("".replace),xd=bf("".slice),yh=function(){var e=/a/,t=/b*/g;return Ns(kc,e,"a"),Ns(kc,t,"a"),e.lastIndex!==0||t.lastIndex!==0}(),W0=y4.BROKEN_CARET,mh=/()??/.exec("")[1]!==void 0,I4=yh||mh||W0||_4||S4;I4&&(gh=function(t){var r=this,n=w4(r),i=v4(t),a=n.raw,s,u,o,c,d,y,_;if(a)return a.lastIndex=r.lastIndex,s=Ns(gh,a,i),r.lastIndex=a.lastIndex,s;var w=n.groups,k=W0&&r.sticky,N=Ns(g4,r),M=r.source,L=0,B=i;if(k&&(N=E4(N,"y",""),T4(N,"g")===-1&&(N+="g"),B=xd(i,r.lastIndex),r.lastIndex>0&&(!r.multiline||r.multiline&&k4(i,r.lastIndex-1)!==`
`)&&(M="(?: "+M+")",B=" "+B,L++),u=new RegExp("^(?:"+M+")",N)),mh&&(u=new RegExp("^"+M+"$(?!\\s)",N)),yh&&(o=r.lastIndex),c=Ns(kc,k?u:r,B),k?c?(c.input=xd(c.input,L),c[0]=xd(c[0],L),c.index=r.lastIndex,r.lastIndex+=c[0].length):r.lastIndex=0:yh&&c&&(r.lastIndex=r.global?c.index+c[0].length:o),mh&&c&&c.length>1&&Ns($4,c[0],u,function(){for(d=1;d<arguments.length-2;d++)arguments[d]===void 0&&(c[d]=void 0)}),c&&w)for(c.groups=y=b4(null),d=0;d<w.length;d++)_=w[d],y[_[0]]=c[_[1]];return c});var wf=gh,C4=ft,Qb=wf;C4({target:"RegExp",proto:!0,forced:/./.exec!==Qb},{exec:Qb});var Xb=Qe,Zb=mr,R4=wf,ew=et,H0=Ct,O4=gi,A4=H0("species"),Ld=RegExp.prototype,_f=function(e,t,r,n){var i=H0(e),a=!ew(function(){var c={};return c[i]=function(){return 7},""[e](c)!=7}),s=a&&!ew(function(){var c=!1,d=/a/;return e==="split"&&(d={},d.constructor={},d.constructor[A4]=function(){return d},d.flags="",d[i]=/./[i]),d.exec=function(){return c=!0,null},d[i](""),!c});if(!a||!s||r){var u=Xb(/./[i]),o=t(i,""[e],function(c,d,y,_,w){var k=Xb(c),N=d.exec;return N===R4||N===Ld.exec?a&&!w?{done:!0,value:u(d,y,_)}:{done:!0,value:k(y,d,_)}:{done:!1}});Zb(String.prototype,e,o[0]),Zb(Ld,i,o[1])}n&&O4(Ld[i],"sham",!0)},P4=Xv.charAt,ug=function(e,t,r){return t+(r?P4(e,t).length:1)},lg=Qe,M4=yr,N4=Math.floor,jd=lg("".charAt),x4=lg("".replace),Ud=lg("".slice),L4=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,j4=/\$([$&'`]|\d{1,2})/g,U4=function(e,t,r,n,i,a){var s=r+e.length,u=n.length,o=j4;return i!==void 0&&(i=M4(i),o=L4),x4(a,o,function(c,d){var y;switch(jd(d,0)){case"$":return"$";case"&":return e;case"`":return Ud(t,0,r);case"'":return Ud(t,s);case"<":y=i[Ud(d,1,-1)];break;default:var _=+d;if(_===0)return c;if(_>u){var w=N4(_/10);return w===0?c:w<=u?n[w-1]===void 0?jd(d,1):n[w-1]+jd(d,1):c}y=n[_-1]}return y===void 0?"":y})},tw=Pt,D4=Zt,F4=Mt,B4=ta,q4=wf,W4=TypeError,Sf=function(e,t){var r=e.exec;if(F4(r)){var n=tw(r,e,t);return n!==null&&D4(n),n}if(B4(e)==="RegExp")return tw(q4,e,t);throw W4("RegExp#exec called on incompatible receiver")},H4=na,rw=Pt,$f=Qe,G4=_f,V4=et,z4=Zt,K4=Mt,J4=Gn,Y4=yi,Q4=mi,ms=fr,X4=Vn,Z4=ug,e6=Xa,t6=U4,r6=Sf,n6=Ct,bh=n6("replace"),i6=Math.max,a6=Math.min,s6=$f([].concat),Dd=$f([].push),nw=$f("".indexOf),iw=$f("".slice),o6=function(e){return e===void 0?e:String(e)},u6=function(){return"a".replace(/./,"$0")==="$0"}(),aw=function(){return/./[bh]?/./[bh]("a","$0")==="":!1}(),l6=!V4(function(){var e=/./;return e.exec=function(){var t=[];return t.groups={a:"7"},t},"".replace(e,"$<a>")!=="7"});G4("replace",function(e,t,r){var n=aw?"$":"$0";return[function(a,s){var u=X4(this),o=J4(a)?void 0:e6(a,bh);return o?rw(o,a,u,s):rw(t,ms(u),a,s)},function(i,a){var s=z4(this),u=ms(i);if(typeof a=="string"&&nw(a,n)===-1&&nw(a,"$<")===-1){var o=r(t,s,u,a);if(o.done)return o.value}var c=K4(a);c||(a=ms(a));var d=s.global;if(d){var y=s.unicode;s.lastIndex=0}for(var _=[];;){var w=r6(s,u);if(w===null||(Dd(_,w),!d))break;var k=ms(w[0]);k===""&&(s.lastIndex=Z4(u,Q4(s.lastIndex),y))}for(var N="",M=0,L=0;L<_.length;L++){w=_[L];for(var B=ms(w[0]),ve=i6(a6(Y4(w.index),u.length),0),ue=[],Me=1;Me<w.length;Me++)Dd(ue,o6(w[Me]));var Re=w.groups;if(c){var Ae=s6([B],ue,ve,u);Re!==void 0&&Dd(Ae,Re);var x=ms(H4(a,void 0,Ae))}else x=t6(B,u,ve,ue,Re,a);ve>=M&&(N+=iw(u,M,ve)+x,M=ve+B.length)}return N+iw(u,M)}]},!l6||!u6||aw);var c6=ft,f6=Qe,d6=Uu,p6=Wr,h6=tl,v6=f6([].join),g6=d6!=Object,y6=h6("join",",");c6({target:"Array",proto:!0,forced:g6||!y6},{join:function(t){return v6(p6(this),t===void 0?",":t)}});var nr={},m6=ft,sw=zu,b6=af,w6=Gt,ow=es,_6=br,S6=Wr,$6=po,k6=Ct,T6=Yu,E6=fo,I6=T6("slice"),C6=k6("species"),Fd=Array,R6=Math.max;m6({target:"Array",proto:!0,forced:!I6},{slice:function(t,r){var n=S6(this),i=_6(n),a=ow(t,i),s=ow(r===void 0?i:r,i),u,o,c;if(sw(n)&&(u=n.constructor,b6(u)&&(u===Fd||sw(u.prototype))?u=void 0:w6(u)&&(u=u[C6],u===null&&(u=void 0)),u===Fd||u===void 0))return E6(n,a,s);for(o=new(u===void 0?Fd:u)(R6(s-a,0)),c=0;a<s;a++,c++)a in n&&$6(o,c,n[a]);return o.length=c,o}});var O6=ft,A6=Bt,P6=dt,Nl=Qe,M6=Vt,N6=Mt,x6=vi,L6=fr,j6=Xt.f,U6=uk,ni=P6.Symbol,ka=ni&&ni.prototype;if(A6&&N6(ni)&&(!("description"in ka)||ni().description!==void 0)){var uw={},xl=function(){var t=arguments.length<1||arguments[0]===void 0?void 0:L6(arguments[0]),r=x6(ka,this)?new ni(t):t===void 0?ni():ni(t);return t===""&&(uw[r]=!0),r};U6(xl,ni),xl.prototype=ka,ka.constructor=xl;var D6=String(ni("test"))=="Symbol(test)",F6=Nl(ka.valueOf),B6=Nl(ka.toString),q6=/^Symbol\((.*)\)[^)]+$/,W6=Nl("".replace),H6=Nl("".slice);j6(ka,"description",{configurable:!0,get:function(){var t=F6(this);if(M6(uw,t))return"";var r=B6(t),n=D6?H6(r,7,-1):W6(r,q6,"$1");return n===""?void 0:n}}),O6({global:!0,constructor:!0,forced:!0},{Symbol:xl})}var G6=Ek;G6("iterator");var V6=Bt,z6=Bu.EXISTS,G0=Qe,K6=Xt.f,V0=Function.prototype,J6=G0(V0.toString),z0=/function\b(?:\s|\/\*[\S\s]*?\*\/|\/\/[^\n\r]*[\n\r]+)*([^\s(/]*)/,Y6=G0(z0.exec),Q6="name";V6&&!z6&&K6(V0,Q6,{configurable:!0,get:function(){try{return Y6(z0,J6(this))[1]}catch{return""}}});var X6=Gt,Z6=Math.floor,K0=Number.isInteger||function(t){return!X6(t)&&isFinite(t)&&Z6(t)===t},e5=ft,t5=K0;e5({target:"Number",stat:!0},{isInteger:t5});var nl={exports:{}},J0={exports:{}};(function(e){function t(r){if(Array.isArray(r))return r}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(J0);var Y0={exports:{}};(function(e){function t(r,n){var i=r==null?null:typeof Symbol<"u"&&r[Symbol.iterator]||r["@@iterator"];if(i!=null){var a=[],s=!0,u=!1,o,c;try{for(i=i.call(r);!(s=(o=i.next()).done)&&(a.push(o.value),!(n&&a.length===n));s=!0);}catch(d){u=!0,c=d}finally{try{!s&&i.return!=null&&i.return()}finally{if(u)throw c}}return a}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Y0);var cg={exports:{}},fg={exports:{}};(function(e){function t(r,n){(n==null||n>r.length)&&(n=r.length);for(var i=0,a=new Array(n);i<n;i++)a[i]=r[i];return a}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(fg);(function(e){var t=fg.exports;function r(n,i){if(!!n){if(typeof n=="string")return t(n,i);var a=Object.prototype.toString.call(n).slice(8,-1);if(a==="Object"&&n.constructor&&(a=n.constructor.name),a==="Map"||a==="Set")return Array.from(n);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return t(n,i)}}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(cg);var Q0={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(Q0);(function(e){var t=J0.exports,r=Y0.exports,n=cg.exports,i=Q0.exports;function a(s,u){return t(s)||r(s,u)||n(s,u)||i()}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(nl);var r5=Bt,X0=Qe,n5=Gu,i5=Wr,a5=ju.f,s5=X0(a5),o5=X0([].push),lw=function(e){return function(t){for(var r=i5(t),n=n5(r),i=n.length,a=0,s=[],u;i>a;)u=n[a++],(!r5||s5(r,u))&&o5(s,e?[u,r[u]]:r[u]);return s}},u5={entries:lw(!0),values:lw(!1)},l5=ft,c5=u5.entries;l5({target:"Object",stat:!0},{entries:function(t){return c5(t)}});var il={exports:{}},Z0={exports:{}};(function(e){var t=fg.exports;function r(n){if(Array.isArray(n))return t(n)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Z0);var e1={exports:{}};(function(e){function t(r){if(typeof Symbol<"u"&&r[Symbol.iterator]!=null||r["@@iterator"]!=null)return Array.from(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(e1);var t1={exports:{}};(function(e){function t(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(t1);(function(e){var t=Z0.exports,r=e1.exports,n=cg.exports,i=t1.exports;function a(s){return t(s)||r(s)||n(s)||i()}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(il);var f5=ft,d5=rf.includes,p5=et,h5=ng,v5=p5(function(){return!Array(1).includes()});f5({target:"Array",proto:!0,forced:v5},{includes:function(t){return d5(this,t,arguments.length>1?arguments[1]:void 0)}});h5("includes");/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.


*/Object.defineProperty(nr,"__esModule",{value:!0});var g5=la.exports,y5=nl.exports,m5=il.exports,b5=fa.exports,w5=oa.exports,_5=ua.exports,S5=zn.exports;function ns(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Bs=ns(g5),Ga=ns(y5),Bd=ns(m5),$5=ns(b5),k5=ns(w5),T5=ns(_5),cw=ns(S5),da=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return{checks:r}};function E5(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=I5(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function I5(e,t){if(!!e){if(typeof e=="string")return fw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return fw(e,t)}}function fw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var r1=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return da(function(i){var a=!1,s=[],u=E5(r),o;try{for(u.s();!(o=u.n()).done;){var c=o.value;if(typeof c=="string"){a=a||Bs.default(i)===c,s.push("of type ".concat(c));continue}a=a||i instanceof c,s.push("an instance of ".concat(c.name))}}catch(d){u.e(d)}finally{u.f()}return[a,s]})};function C5(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=R5(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function R5(e,t){if(!!e){if(typeof e=="string")return dw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return dw(e,t)}}function dw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var O5=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return da(function(i){var a=!1,s=[],u=C5(r),o;try{for(u.s();!(o=u.n()).done;){var c=o.value;a=a||i===c,s.push(typeof c=="string"?'"'.concat(c,'"'):"".concat(c))}}catch(d){u.e(d)}finally{u.f()}return[a,s]})},A5=da(function(e){return[typeof e=="string"&&e.length>0,"a non-empty string"]}),P5=da(function(e){return[typeof e=="number"&&Number.isInteger(e)&&e>=0,"a non-negative integer"]}),M5=da(function(e){return[Bs.default(e)==="object"&&e!==null&&!Array.isArray(e),"a pure object (non-null and non-array)"]});function N5(e){var t=x5();return function(){var n=cw.default(e),i;if(t){var a=cw.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return T5.default(this,i)}}function x5(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function Cu(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=L5(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function L5(e,t){if(!!e){if(typeof e=="string")return pw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return pw(e,t)}}function pw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var kf=function(t,r){if(r.length>t.length)throw new Error("Expected at most ".concat(t.length," argument(s), but got ").concat(r.length));for(;r.length<t.length;)r.push(void 0);var n=Cu(r.entries()),i;try{for(n.s();!(i=n.n()).done;){var a=Ga.default(i.value,2),s=a[0],u=a[1],o=hg(t[s],u),c=Ga.default(o,4),d=c[0],y=c[1],_=c[2],w=c[3];if(!d){var k=s+1;throw new Error("Argument ".concat(k," is expected to be ").concat(_).concat(w," but got ").concat(y))}}}catch(N){n.e(N)}finally{n.f()}},n1=function(t){var r,n,i=["undefined","boolean","number","bigint","string"];if(i.includes(Bs.default(t))&&(n=typeof t=="string"?'"'.concat(t,'"'):"".concat(t)),Bs.default(t)==="object"&&(t==null||(r=t.constructor)===null||r===void 0?void 0:r.name)!=="Object"){var a;n=t===null?"null":"instance of ".concat(t==null||(a=t.constructor)===null||a===void 0?void 0:a.name)}return n||(n=Bs.default(t)),n},j5=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=dg(r);return function(a){return function(s){k5.default(o,s);var u=N5(o);function o(){$5.default(this,o);for(var c=arguments.length,d=new Array(c),y=0;y<c;y++)d[y]=arguments[y];return kf(i,d),u.call.apply(u,[this].concat(d))}return o}(a)}},U5=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=dg(r);return function(a,s,u){if(typeof u.value!="function")throw new Error("The validateTypes decorator can only be applied to methods");var o=u.value;u.value=function(){for(var c=arguments.length,d=new Array(c),y=0;y<c;y++)d[y]=arguments[y];return kf(i,d),o.apply(this,d)}}},D5=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=dg(r);return function(a,s,u){if(typeof u.value!="function")throw new Error("The validateTypesAsync decorator can only be applied to methods");var o=u.value;u.value=function(){for(var c=arguments.length,d=new Array(c),y=0;y<c;y++)d[y]=arguments[y];try{kf(i,d)}catch(_){return Promise.reject(_)}return o.apply(this,d)}}},dg=function(t){var r=[],n=Cu(t),i;try{for(n.s();!(i=n.n()).done;){var a=i.value;r.push(pg(a))}}catch(s){n.e(s)}finally{n.f()}return r},pg=function(t){var r=[],n=Array.isArray(t)?t:[t],i=Cu(n),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;if(typeof s=="string"||typeof s=="function"){r.push(r1(s));continue}r.push(s)}}catch(u){i.e(u)}finally{i.f()}return r},hg=function(t,r){var n=[],i,a=!1,s=Cu(t),u;try{for(s.s();!(u=s.n()).done;){var o=u.value,c=Cu(o.checks),d;try{for(c.s();!(d=c.n()).done;){var y=d.value,_=y(r),w=Ga.default(_,3),k=w[0],N=w[1],M=w[2];a=a||k,!i&&M&&(i=M),N&&(n=typeof N=="string"?[].concat(Bd.default(n),[N]):[].concat(Bd.default(n),Bd.default(N)))}}catch(ue){c.e(ue)}finally{c.f()}}}catch(ue){s.e(ue)}finally{s.f()}if(a)return[!0];var L=i||n1(r),B=n.length-1,ve=B>0?"".concat(n.slice(0,B).join(", ")," or ").concat(n[B]):n.join(", ");return[!1,L,ve,B>1?";":","]},F5=function(t,r){return da(function(n){if(Bs.default(n)!=="object"||n===null||Array.isArray(n))return[!1,"valid ".concat(t," (should be a pure object)")];for(var i=0,a=Object.entries(r);i<a.length;i++){var s=Ga.default(a[i],2),u=s[0],o=s[1],c=hg(pg(o),n[u]),d=Ga.default(c,3),y=d[0],_=d[1],w=d[2];if(!y)return[!1,"valid ".concat(t,' (key "').concat(u,'" should be ').concat(w,")"),"malformed ".concat(t,' (key "').concat(u,'" is ').concat(_,")")]}return[!0]})};function B5(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=q5(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function q5(e,t){if(!!e){if(typeof e=="string")return hw(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return hw(e,t)}}function hw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var W5=function(t,r){return da(function(n){if(!Array.isArray(n))return[!1,"an array of ".concat(t)];var i=B5(n.entries()),a;try{for(i.s();!(a=i.n()).done;){var s=Ga.default(a.value,2),u=s[0],o=s[1],c=hg(pg(r),o),d=Ga.default(c,3),y=d[0],_=d[1],w=d[2];if(!y)return[!1,"a valid array of ".concat(t," (index ").concat(u," should be ").concat(w,")"),"malformed array of ".concat(t," (index ").concat(u," is ").concat(_,")")]}}catch(k){i.e(k)}finally{i.f()}return[!0]})};nr.array=W5;nr.custom=da;nr.literal=O5;nr.nonEmptyString=A5;nr.nonNegativeInteger=P5;nr.objectSchema=F5;nr.pureObject=M5;nr.runtimeTypeValidation=kf;nr.stringifyReceivedType=n1;nr.type=r1;nr.validateConstructorTypes=j5;nr.validateTypes=U5;nr.validateTypesAsync=D5;var vg={},Tf={exports:{}},i1={exports:{}};(function(e){var t=zn.exports;function r(n,i){for(;!Object.prototype.hasOwnProperty.call(n,i)&&(n=t(n),n!==null););return n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(i1);(function(e){var t=i1.exports;function r(){return typeof Reflect<"u"&&Reflect.get?(e.exports=r=Reflect.get.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=r=function(i,a,s){var u=t(i,a);if(!!u){var o=Object.getOwnPropertyDescriptor(u,a);return o.get?o.get.call(arguments.length<3?i:s):o.value}},e.exports.__esModule=!0,e.exports.default=e.exports),r.apply(this,arguments)}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports})(Tf);/*
@license
Copyright (c) 2021 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/Object.defineProperty(vg,"__esModule",{value:!0});var H5=il.exports,G5=fa.exports,V5=ts.exports,z5=sa.exports,K5=Tf.exports,J5=oa.exports,Y5=ua.exports,Q5=zn.exports,X5=ca.exports;function _i(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var Z5=_i(H5),e8=_i(G5),t8=_i(V5),r8=_i(z5),bs=_i(K5),n8=_i(J5),i8=_i(Y5),Ui=_i(Q5),a8=_i(X5),s8;function Ki(){}Ki.prototype=Object.create(null);function At(){At.init.call(this)}At.EventEmitter=At;At.usingDomains=!1;At.prototype.domain=void 0;At.prototype._events=void 0;At.prototype._maxListeners=void 0;At.defaultMaxListeners=10;At.init=function(){this.domain=null,At.usingDomains&&s8.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Ki,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};At.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function a1(e){return e._maxListeners===void 0?At.defaultMaxListeners:e._maxListeners}At.prototype.getMaxListeners=function(){return a1(this)};function o8(e,t,r){if(t)e.call(r);else for(var n=e.length,i=al(e,n),a=0;a<n;++a)i[a].call(r)}function u8(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=al(e,i),s=0;s<i;++s)a[s].call(r,n)}function l8(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,s=al(e,a),u=0;u<a;++u)s[u].call(r,n,i)}function c8(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var s=e.length,u=al(e,s),o=0;o<s;++o)u[o].call(r,n,i,a)}function f8(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=al(e,i),s=0;s<i;++s)a[s].apply(r,n)}At.prototype.emit=function(t){var r,n,i,a,s,u,o,c=t==="error";if(u=this._events,u)c=c&&u.error==null;else if(!c)return!1;if(o=this.domain,c){if(r=arguments[1],o)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=o,r.domainThrown=!1,o.emit("error",r);else{if(r instanceof Error)throw r;var d=new Error('Uncaught, unspecified "error" event. ('+r+")");throw d.context=r,d}return!1}if(n=u[t],!n)return!1;var y=typeof n=="function";switch(i=arguments.length,i){case 1:o8(n,y,this);break;case 2:u8(n,y,this,arguments[1]);break;case 3:l8(n,y,this,arguments[1],arguments[2]);break;case 4:c8(n,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),s=1;s<i;s++)a[s-1]=arguments[s];f8(n,y,this,a)}return!0};function s1(e,t,r,n){var i,a,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]):(a=e._events=new Ki,e._eventsCount=0),!s)s=a[t]=r,++e._eventsCount;else if(typeof s=="function"?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=a1(e),i&&i>0&&s.length>i)){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,d8(u)}return e}function d8(e){typeof console.warn=="function"?console.warn(e):console.log(e)}At.prototype.addListener=function(t,r){return s1(this,t,r,!1)};At.prototype.on=At.prototype.addListener;At.prototype.prependListener=function(t,r){return s1(this,t,r,!0)};function o1(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}At.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,o1(this,t,r)),this};At.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,o1(this,t,r)),this};At.prototype.removeListener=function(t,r){var n,i,a,s,u;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new Ki:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(a=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){u=n[s].listener,a=s;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Ki,this;delete i[t]}else p8(n,a);i.removeListener&&this.emit("removeListener",t,u||r)}return this};At.prototype.off=function(e,t){return this.removeListener(e,t)};At.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Ki,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new Ki:delete n[t]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,s;a<i.length;++a)s=i[a],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new Ki,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};At.prototype.listeners=function(t){var r,n,i=this._events;return i?(r=i[t],r?typeof r=="function"?n=[r.listener||r]:n=h8(r):n=[]):n=[],n};At.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):u1.call(e,t)};At.prototype.listenerCount=u1;function u1(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}At.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function p8(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function al(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function h8(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function v8(e){var t=g8();return function(){var n=Ui.default(e),i;if(t){var a=Ui.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return i8.default(this,i)}}function g8(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var y8=function(e){n8.default(r,e);var t=v8(r);function r(){var n;return e8.default(this,r),n=t.call(this),a8.default(r8.default(n),"eventHistory",new Map),n}return t8.default(r,[{key:"on",value:function(i,a){return bs.default(Ui.default(r.prototype),"on",this).call(this,i,a)}},{key:"once",value:function(i,a){return bs.default(Ui.default(r.prototype),"once",this).call(this,i,a)}},{key:"off",value:function(i,a){return bs.default(Ui.default(r.prototype),"off",this).call(this,i,a)}},{key:"emit",value:function(i){for(var a,s=arguments.length,u=new Array(s>1?s-1:0),o=1;o<s;o++)u[o-1]=arguments[o];return this.eventHistory.set(i,u),(a=bs.default(Ui.default(r.prototype),"emit",this)).call.apply(a,[this,i].concat(u))}},{key:"addListener",value:function(i,a){return bs.default(Ui.default(r.prototype),"addListener",this).call(this,i,a)}},{key:"removeListener",value:function(i,a){return bs.default(Ui.default(r.prototype),"removeListener",this).call(this,i,a)}},{key:"addListenerWithReplay",value:function(i,a){var s=this.eventHistory.get(i);return s!==void 0&&a.apply(void 0,Z5.default(s)),this.addListener(i,a)}},{key:"onWithReplay",value:function(i,a){return this.addListenerWithReplay(i,a)}}]),r}(At);vg.ReplayEventEmitter=y8;var wh={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,a=2,s=9007199254740991,u="[object Arguments]",o="[object Array]",c="[object AsyncFunction]",d="[object Boolean]",y="[object Date]",_="[object Error]",w="[object Function]",k="[object GeneratorFunction]",N="[object Map]",M="[object Number]",L="[object Null]",B="[object Object]",ve="[object Promise]",ue="[object Proxy]",Me="[object RegExp]",Re="[object Set]",Ae="[object String]",x="[object Symbol]",le="[object Undefined]",F="[object WeakMap]",Se="[object ArrayBuffer]",Ee="[object DataView]",oe="[object Float32Array]",te="[object Float64Array]",ae="[object Int8Array]",ne="[object Int16Array]",be="[object Int32Array]",A="[object Uint8Array]",Le="[object Uint8ClampedArray]",at="[object Uint16Array]",We="[object Uint32Array]",fe=/[\\^$.*+?()[\]{}|]/g,V=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,$={};$[oe]=$[te]=$[ae]=$[ne]=$[be]=$[A]=$[Le]=$[at]=$[We]=!0,$[u]=$[o]=$[Se]=$[d]=$[Ee]=$[y]=$[_]=$[w]=$[N]=$[M]=$[B]=$[Me]=$[Re]=$[Ae]=$[F]=!1;var I=typeof $n=="object"&&$n&&$n.Object===Object&&$n,Z=typeof self=="object"&&self&&self.Object===Object&&self,re=I||Z||Function("return this")(),Ie=t&&!t.nodeType&&t,xe=Ie&&!0&&e&&!e.nodeType&&e,ce=xe&&xe.exports===Ie,$e=ce&&I.process,E=function(){try{return $e&&$e.binding&&$e.binding("util")}catch{}}(),T=E&&E.isTypedArray;function G(O,K){for(var he=-1,Be=O==null?0:O.length,Ft=0,ut=[];++he<Be;){var zt=O[he];K(zt,he,O)&&(ut[Ft++]=zt)}return ut}function ee(O,K){for(var he=-1,Be=K.length,Ft=O.length;++he<Be;)O[Ft+he]=K[he];return O}function q(O,K){for(var he=-1,Be=O==null?0:O.length;++he<Be;)if(K(O[he],he,O))return!0;return!1}function ke(O,K){for(var he=-1,Be=Array(O);++he<O;)Be[he]=K(he);return Be}function J(O){return function(K){return O(K)}}function W(O,K){return O.has(K)}function pe(O,K){return O==null?void 0:O[K]}function R(O){var K=-1,he=Array(O.size);return O.forEach(function(Be,Ft){he[++K]=[Ft,Be]}),he}function Te(O,K){return function(he){return O(K(he))}}function Ne(O){var K=-1,he=Array(O.size);return O.forEach(function(Be){he[++K]=Be}),he}var Oe=Array.prototype,je=Function.prototype,De=Object.prototype,Ue=re["__core-js_shared__"],Ve=je.toString,Xe=De.hasOwnProperty,er=function(){var O=/[^.]+$/.exec(Ue&&Ue.keys&&Ue.keys.IE_PROTO||"");return O?"Symbol(src)_1."+O:""}(),wr=De.toString,pn=RegExp("^"+Ve.call(Xe).replace(fe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Cr=ce?re.Buffer:void 0,mt=re.Symbol,jt=re.Uint8Array,se=De.propertyIsEnumerable,de=Oe.splice,Y=mt?mt.toStringTag:void 0,ie=Object.getOwnPropertySymbols,X=Cr?Cr.isBuffer:void 0,ye=Te(Object.keys,Object),we=Rt(re,"DataView"),Pe=Rt(re,"Map"),Ye=Rt(re,"Promise"),st=Rt(re,"Set"),Ze=Rt(re,"WeakMap"),Fe=Rt(Object,"create"),_r=p(we),Je=p(Pe),qt=p(Ye),Ut=p(st),$i=p(Ze),Kn=mt?mt.prototype:void 0,An=Kn?Kn.valueOf:void 0;function Et(O){var K=-1,he=O==null?0:O.length;for(this.clear();++K<he;){var Be=O[K];this.set(Be[0],Be[1])}}function Dt(){this.__data__=Fe?Fe(null):{},this.size=0}function Lr(O){var K=this.has(O)&&delete this.__data__[O];return this.size-=K?1:0,K}function Rr(O){var K=this.__data__;if(Fe){var he=K[O];return he===n?void 0:he}return Xe.call(K,O)?K[O]:void 0}function ha(O){var K=this.__data__;return Fe?K[O]!==void 0:Xe.call(K,O)}function ss(O,K){var he=this.__data__;return this.size+=this.has(O)?0:1,he[O]=Fe&&K===void 0?n:K,this}Et.prototype.clear=Dt,Et.prototype.delete=Lr,Et.prototype.get=Rr,Et.prototype.has=ha,Et.prototype.set=ss;function jr(O){var K=-1,he=O==null?0:O.length;for(this.clear();++K<he;){var Be=O[K];this.set(Be[0],Be[1])}}function os(){this.__data__=[],this.size=0}function wo(O){var K=this.__data__,he=Ti(K,O);if(he<0)return!1;var Be=K.length-1;return he==Be?K.pop():de.call(K,he,1),--this.size,!0}function _o(O){var K=this.__data__,he=Ti(K,O);return he<0?void 0:K[he][1]}function dr(O){return Ti(this.__data__,O)>-1}function hn(O,K){var he=this.__data__,Be=Ti(he,O);return Be<0?(++this.size,he.push([O,K])):he[Be][1]=K,this}jr.prototype.clear=os,jr.prototype.delete=wo,jr.prototype.get=_o,jr.prototype.has=dr,jr.prototype.set=hn;function zr(O){var K=-1,he=O==null?0:O.length;for(this.clear();++K<he;){var Be=O[K];this.set(Be[0],Be[1])}}function _t(){this.size=0,this.__data__={hash:new Et,map:new(Pe||jr),string:new Et}}function So(O){var K=Yn(this,O).delete(O);return this.size-=K?1:0,K}function $o(O){return Yn(this,O).get(O)}function ko(O){return Yn(this,O).has(O)}function us(O,K){var he=Yn(this,O),Be=he.size;return he.set(O,K),this.size+=he.size==Be?0:1,this}zr.prototype.clear=_t,zr.prototype.delete=So,zr.prototype.get=$o,zr.prototype.has=ko,zr.prototype.set=us;function Jn(O){var K=-1,he=O==null?0:O.length;for(this.__data__=new zr;++K<he;)this.add(O[K])}function To(O){return this.__data__.set(O,n),this}function Eo(O){return this.__data__.has(O)}Jn.prototype.add=Jn.prototype.push=To,Jn.prototype.has=Eo;function Kr(O){var K=this.__data__=new jr(O);this.size=K.size}function Sr(){this.__data__=new jr,this.size=0}function Io(O){var K=this.__data__,he=K.delete(O);return this.size=K.size,he}function Co(O){return this.__data__.get(O)}function Ro(O){return this.__data__.has(O)}function Oo(O,K){var he=this.__data__;if(he instanceof jr){var Be=he.__data__;if(!Pe||Be.length<r-1)return Be.push([O,K]),this.size=++he.size,this;he=this.__data__=new zr(Be)}return he.set(O,K),this.size=he.size,this}Kr.prototype.clear=Sr,Kr.prototype.delete=Io,Kr.prototype.get=Co,Kr.prototype.has=Ro,Kr.prototype.set=Oo;function ki(O,K){var he=h(O),Be=!he&&g(O),Ft=!he&&!Be&&S(O),ut=!he&&!Be&&!Ft&&rt(O),zt=he||Be||Ft||ut,ir=zt?ke(O.length,String):[],lr=ir.length;for(var Wt in O)(K||Xe.call(O,Wt))&&!(zt&&(Wt=="length"||Ft&&(Wt=="offset"||Wt=="parent")||ut&&(Wt=="buffer"||Wt=="byteLength"||Wt=="byteOffset")||C(Wt,lr)))&&ir.push(Wt);return ir}function Ti(O,K){for(var he=O.length;he--;)if(f(O[he][0],K))return he;return-1}function Ei(O,K,he){var Be=K(O);return h(O)?Be:ee(Be,he(O))}function vn(O){return O==null?O===void 0?le:L:Y&&Y in Object(O)?Jr(O):l(O)}function va(O){return qe(O)&&vn(O)==u}function ls(O,K,he,Be,Ft){return O===K?!0:O==null||K==null||!qe(O)&&!qe(K)?O!==O&&K!==K:cs(O,K,he,Be,ls,Ft)}function cs(O,K,he,Be,Ft,ut){var zt=h(O),ir=h(K),lr=zt?o:Yr(O),Wt=ir?o:Yr(K);lr=lr==u?B:lr,Wt=Wt==u?B:Wt;var Ur=lr==B,gn=Wt==B,pr=lr==Wt;if(pr&&S(O)){if(!S(K))return!1;zt=!0,Ur=!1}if(pr&&!Ur)return ut||(ut=new Kr),zt||rt(O)?ga(O,K,he,Be,Ft,ut):fs(O,K,lr,he,Be,Ft,ut);if(!(he&i)){var Qr=Ur&&Xe.call(O,"__wrapped__"),Xr=gn&&Xe.call(K,"__wrapped__");if(Qr||Xr){var Ci=Qr?O.value():O,Qn=Xr?K.value():K;return ut||(ut=new Kr),Ft(Ci,Qn,he,Be,ut)}}return pr?(ut||(ut=new Kr),Ii(O,K,he,Be,Ft,ut)):!1}function Ao(O){if(!ge(O)||m(O))return!1;var K=D(O)?pn:V;return K.test(p(O))}function Po(O){return qe(O)&&z(O.length)&&!!$[vn(O)]}function St(O){if(!v(O))return ye(O);var K=[];for(var he in Object(O))Xe.call(O,he)&&he!="constructor"&&K.push(he);return K}function ga(O,K,he,Be,Ft,ut){var zt=he&i,ir=O.length,lr=K.length;if(ir!=lr&&!(zt&&lr>ir))return!1;var Wt=ut.get(O);if(Wt&&ut.get(K))return Wt==K;var Ur=-1,gn=!0,pr=he&a?new Jn:void 0;for(ut.set(O,K),ut.set(K,O);++Ur<ir;){var Qr=O[Ur],Xr=K[Ur];if(Be)var Ci=zt?Be(Xr,Qr,Ur,K,O,ut):Be(Qr,Xr,Ur,O,K,ut);if(Ci!==void 0){if(Ci)continue;gn=!1;break}if(pr){if(!q(K,function(Qn,ba){if(!W(pr,ba)&&(Qr===Qn||Ft(Qr,Qn,he,Be,ut)))return pr.push(ba)})){gn=!1;break}}else if(!(Qr===Xr||Ft(Qr,Xr,he,Be,ut))){gn=!1;break}}return ut.delete(O),ut.delete(K),gn}function fs(O,K,he,Be,Ft,ut,zt){switch(he){case Ee:if(O.byteLength!=K.byteLength||O.byteOffset!=K.byteOffset)return!1;O=O.buffer,K=K.buffer;case Se:return!(O.byteLength!=K.byteLength||!ut(new jt(O),new jt(K)));case d:case y:case M:return f(+O,+K);case _:return O.name==K.name&&O.message==K.message;case Me:case Ae:return O==K+"";case N:var ir=R;case Re:var lr=Be&i;if(ir||(ir=Ne),O.size!=K.size&&!lr)return!1;var Wt=zt.get(O);if(Wt)return Wt==K;Be|=a,zt.set(O,K);var Ur=ga(ir(O),ir(K),Be,Ft,ut,zt);return zt.delete(O),Ur;case x:if(An)return An.call(O)==An.call(K)}return!1}function Ii(O,K,he,Be,Ft,ut){var zt=he&i,ir=ya(O),lr=ir.length,Wt=ya(K),Ur=Wt.length;if(lr!=Ur&&!zt)return!1;for(var gn=lr;gn--;){var pr=ir[gn];if(!(zt?pr in K:Xe.call(K,pr)))return!1}var Qr=ut.get(O);if(Qr&&ut.get(K))return Qr==K;var Xr=!0;ut.set(O,K),ut.set(K,O);for(var Ci=zt;++gn<lr;){pr=ir[gn];var Qn=O[pr],ba=K[pr];if(Be)var ny=zt?Be(ba,Qn,pr,K,O,ut):Be(Qn,ba,pr,O,K,ut);if(!(ny===void 0?Qn===ba||Ft(Qn,ba,he,Be,ut):ny)){Xr=!1;break}Ci||(Ci=pr=="constructor")}if(Xr&&!Ci){var pl=O.constructor,hl=K.constructor;pl!=hl&&"constructor"in O&&"constructor"in K&&!(typeof pl=="function"&&pl instanceof pl&&typeof hl=="function"&&hl instanceof hl)&&(Xr=!1)}return ut.delete(O),ut.delete(K),Xr}function ya(O){return Ei(O,He,ma)}function Yn(O,K){var he=O.__data__;return P(K)?he[typeof K=="string"?"string":"hash"]:he.map}function Rt(O,K){var he=pe(O,K);return Ao(he)?he:void 0}function Jr(O){var K=Xe.call(O,Y),he=O[Y];try{O[Y]=void 0;var Be=!0}catch{}var Ft=wr.call(O);return Be&&(K?O[Y]=he:delete O[Y]),Ft}var ma=ie?function(O){return O==null?[]:(O=Object(O),G(ie(O),function(K){return se.call(O,K)}))}:ot,Yr=vn;(we&&Yr(new we(new ArrayBuffer(1)))!=Ee||Pe&&Yr(new Pe)!=N||Ye&&Yr(Ye.resolve())!=ve||st&&Yr(new st)!=Re||Ze&&Yr(new Ze)!=F)&&(Yr=function(O){var K=vn(O),he=K==B?O.constructor:void 0,Be=he?p(he):"";if(Be)switch(Be){case _r:return Ee;case Je:return N;case qt:return ve;case Ut:return Re;case $i:return F}return K});function C(O,K){return K=K==null?s:K,!!K&&(typeof O=="number"||Q.test(O))&&O>-1&&O%1==0&&O<K}function P(O){var K=typeof O;return K=="string"||K=="number"||K=="symbol"||K=="boolean"?O!=="__proto__":O===null}function m(O){return!!er&&er in O}function v(O){var K=O&&O.constructor,he=typeof K=="function"&&K.prototype||De;return O===he}function l(O){return wr.call(O)}function p(O){if(O!=null){try{return Ve.call(O)}catch{}try{return O+""}catch{}}return""}function f(O,K){return O===K||O!==O&&K!==K}var g=va(function(){return arguments}())?va:function(O){return qe(O)&&Xe.call(O,"callee")&&!se.call(O,"callee")},h=Array.isArray;function b(O){return O!=null&&z(O.length)&&!D(O)}var S=X||Or;function j(O,K){return ls(O,K)}function D(O){if(!ge(O))return!1;var K=vn(O);return K==w||K==k||K==c||K==ue}function z(O){return typeof O=="number"&&O>-1&&O%1==0&&O<=s}function ge(O){var K=typeof O;return O!=null&&(K=="object"||K=="function")}function qe(O){return O!=null&&typeof O=="object"}var rt=T?J(T):Po;function He(O){return b(O)?ki(O):St(O)}function ot(){return[]}function Or(){return!1}e.exports=j})(wh,wh.exports);var gg={exports:{}},m8=et,b8=m8(function(){if(typeof ArrayBuffer=="function"){var e=new ArrayBuffer(8);Object.isExtensible(e)&&Object.defineProperty(e,"a",{value:8})}}),w8=et,_8=Gt,S8=ta,vw=b8,uc=Object.isExtensible,$8=w8(function(){uc(1)}),k8=$8||vw?function(t){return!_8(t)||vw&&S8(t)=="ArrayBuffer"?!1:uc?uc(t):!0}:uc,T8=et,E8=!T8(function(){return Object.isExtensible(Object.preventExtensions({}))}),I8=ft,C8=Qe,R8=qu,O8=Gt,yg=Vt,A8=Xt.f,gw=ra,P8=Pv,mg=k8,M8=Du,N8=E8,l1=!1,ci=M8("meta"),x8=0,bg=function(e){A8(e,ci,{value:{objectID:"O"+x8++,weakData:{}}})},L8=function(e,t){if(!O8(e))return typeof e=="symbol"?e:(typeof e=="string"?"S":"P")+e;if(!yg(e,ci)){if(!mg(e))return"F";if(!t)return"E";bg(e)}return e[ci].objectID},j8=function(e,t){if(!yg(e,ci)){if(!mg(e))return!0;if(!t)return!1;bg(e)}return e[ci].weakData},U8=function(e){return N8&&l1&&mg(e)&&!yg(e,ci)&&bg(e),e},D8=function(){F8.enable=function(){},l1=!0;var e=gw.f,t=C8([].splice),r={};r[ci]=1,e(r).length&&(gw.f=function(n){for(var i=e(n),a=0,s=i.length;a<s;a++)if(i[a]===ci){t(i,a,1);break}return i},I8({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:P8.f}))},F8=gg.exports={enable:D8,fastKey:L8,getWeakData:j8,onFreeze:U8};R8[ci]=!0;var B8=ft,q8=dt,W8=Qe,yw=nf,H8=mr,G8=gg.exports,V8=gf,z8=rs,K8=Mt,J8=Gn,qd=Gt,Wd=et,Y8=yf,Q8=aa,X8=Jv,c1=function(e,t,r){var n=e.indexOf("Map")!==-1,i=e.indexOf("Weak")!==-1,a=n?"set":"add",s=q8[e],u=s&&s.prototype,o=s,c={},d=function(L){var B=W8(u[L]);H8(u,L,L=="add"?function(ue){return B(this,ue===0?0:ue),this}:L=="delete"?function(ve){return i&&!qd(ve)?!1:B(this,ve===0?0:ve)}:L=="get"?function(ue){return i&&!qd(ue)?void 0:B(this,ue===0?0:ue)}:L=="has"?function(ue){return i&&!qd(ue)?!1:B(this,ue===0?0:ue)}:function(ue,Me){return B(this,ue===0?0:ue,Me),this})},y=yw(e,!K8(s)||!(i||u.forEach&&!Wd(function(){new s().entries().next()})));if(y)o=r.getConstructor(t,e,n,a),G8.enable();else if(yw(e,!0)){var _=new o,w=_[a](i?{}:-0,1)!=_,k=Wd(function(){_.has(1)}),N=Y8(function(L){new s(L)}),M=!i&&Wd(function(){for(var L=new s,B=5;B--;)L[a](B,B);return!L.has(-0)});N||(o=t(function(L,B){z8(L,u);var ve=X8(new s,L,o);return J8(B)||V8(B,ve[a],{that:ve,AS_ENTRIES:n}),ve}),o.prototype=u,u.constructor=o),(k||M)&&(d("delete"),d("has"),n&&d("get")),(M||w)&&d(a),i&&u.clear&&delete u.clear}return c[e]=o,B8({global:!0,constructor:!0,forced:o!=s},c),Q8(o,e),i||r.setStrong(o,e,n),o},Z8=mr,wg=function(e,t,r){for(var n in t)Z8(e,n,t[n],r);return e},eq=Xt.f,tq=ia,mw=wg,rq=wi,nq=rs,iq=Gn,aq=gf,sq=Zv,Ll=eg,oq=df,Do=Bt,bw=gg.exports.fastKey,f1=fn,ww=f1.set,Hd=f1.getterFor,d1={getConstructor:function(e,t,r,n){var i=e(function(c,d){nq(c,a),ww(c,{type:t,index:tq(null),first:void 0,last:void 0,size:0}),Do||(c.size=0),iq(d)||aq(d,c[n],{that:c,AS_ENTRIES:r})}),a=i.prototype,s=Hd(t),u=function(c,d,y){var _=s(c),w=o(c,d),k,N;return w?w.value=y:(_.last=w={index:N=bw(d,!0),key:d,value:y,previous:k=_.last,next:void 0,removed:!1},_.first||(_.first=w),k&&(k.next=w),Do?_.size++:c.size++,N!=="F"&&(_.index[N]=w)),c},o=function(c,d){var y=s(c),_=bw(d),w;if(_!=="F")return y.index[_];for(w=y.first;w;w=w.next)if(w.key==d)return w};return mw(a,{clear:function(){for(var d=this,y=s(d),_=y.index,w=y.first;w;)w.removed=!0,w.previous&&(w.previous=w.previous.next=void 0),delete _[w.index],w=w.next;y.first=y.last=void 0,Do?y.size=0:d.size=0},delete:function(c){var d=this,y=s(d),_=o(d,c);if(_){var w=_.next,k=_.previous;delete y.index[_.index],_.removed=!0,k&&(k.next=w),w&&(w.previous=k),y.first==_&&(y.first=w),y.last==_&&(y.last=k),Do?y.size--:d.size--}return!!_},forEach:function(d){for(var y=s(this),_=rq(d,arguments.length>1?arguments[1]:void 0),w;w=w?w.next:y.first;)for(_(w.value,w.key,this);w&&w.removed;)w=w.previous},has:function(d){return!!o(this,d)}}),mw(a,r?{get:function(d){var y=o(this,d);return y&&y.value},set:function(d,y){return u(this,d===0?0:d,y)}}:{add:function(d){return u(this,d=d===0?0:d,d)}}),Do&&eq(a,"size",{get:function(){return s(this).size}}),i},setStrong:function(e,t,r){var n=t+" Iterator",i=Hd(t),a=Hd(n);sq(e,t,function(s,u){ww(this,{type:n,target:s,state:i(s),kind:u,last:void 0})},function(){for(var s=a(this),u=s.kind,o=s.last;o&&o.removed;)o=o.previous;return!s.target||!(s.last=o=o?o.next:s.state.first)?(s.target=void 0,Ll(void 0,!0)):u=="keys"?Ll(o.key,!1):u=="values"?Ll(o.value,!1):Ll([o.key,o.value],!1)},r?"entries":"values",!r,!0),oq(t)}},uq=c1,lq=d1;uq("Map",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},lq);var Si={};/*
@license
Copyright (c) 2016, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/Object.defineProperty(Si,"__esModule",{value:!0});var cq=fa.exports,fq=ts.exports,dq=sa.exports,pq=oa.exports,hq=ua.exports,vq=zn.exports,gq=ca.exports;function is(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}var _g=is(cq),Sg=is(fq),ai=is(dq),$g=is(pq),p1=is(hq),Tc=is(vq),si=is(gq),yq;function Ji(){}Ji.prototype=Object.create(null);function kt(){kt.init.call(this)}kt.EventEmitter=kt;kt.usingDomains=!1;kt.prototype.domain=void 0;kt.prototype._events=void 0;kt.prototype._maxListeners=void 0;kt.defaultMaxListeners=10;kt.init=function(){this.domain=null,kt.usingDomains&&yq.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Ji,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};kt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function h1(e){return e._maxListeners===void 0?kt.defaultMaxListeners:e._maxListeners}kt.prototype.getMaxListeners=function(){return h1(this)};function mq(e,t,r){if(t)e.call(r);else for(var n=e.length,i=sl(e,n),a=0;a<n;++a)i[a].call(r)}function bq(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=sl(e,i),s=0;s<i;++s)a[s].call(r,n)}function wq(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,s=sl(e,a),u=0;u<a;++u)s[u].call(r,n,i)}function _q(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var s=e.length,u=sl(e,s),o=0;o<s;++o)u[o].call(r,n,i,a)}function Sq(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=sl(e,i),s=0;s<i;++s)a[s].apply(r,n)}kt.prototype.emit=function(t){var r,n,i,a,s,u,o,c=t==="error";if(u=this._events,u)c=c&&u.error==null;else if(!c)return!1;if(o=this.domain,c){if(r=arguments[1],o)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=o,r.domainThrown=!1,o.emit("error",r);else{if(r instanceof Error)throw r;var d=new Error('Uncaught, unspecified "error" event. ('+r+")");throw d.context=r,d}return!1}if(n=u[t],!n)return!1;var y=typeof n=="function";switch(i=arguments.length,i){case 1:mq(n,y,this);break;case 2:bq(n,y,this,arguments[1]);break;case 3:wq(n,y,this,arguments[1],arguments[2]);break;case 4:_q(n,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),s=1;s<i;s++)a[s-1]=arguments[s];Sq(n,y,this,a)}return!0};function v1(e,t,r,n){var i,a,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]):(a=e._events=new Ji,e._eventsCount=0),!s)s=a[t]=r,++e._eventsCount;else if(typeof s=="function"?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=h1(e),i&&i>0&&s.length>i)){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,$q(u)}return e}function $q(e){typeof console.warn=="function"?console.warn(e):console.log(e)}kt.prototype.addListener=function(t,r){return v1(this,t,r,!1)};kt.prototype.on=kt.prototype.addListener;kt.prototype.prependListener=function(t,r){return v1(this,t,r,!0)};function g1(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}kt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,g1(this,t,r)),this};kt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,g1(this,t,r)),this};kt.prototype.removeListener=function(t,r){var n,i,a,s,u;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new Ji:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(a=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){u=n[s].listener,a=s;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Ji,this;delete i[t]}else kq(n,a);i.removeListener&&this.emit("removeListener",t,u||r)}return this};kt.prototype.off=function(e,t){return this.removeListener(e,t)};kt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Ji,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new Ji:delete n[t]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,s;a<i.length;++a)s=i[a],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new Ji,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};kt.prototype.listeners=function(t){var r,n,i=this._events;return i?(r=i[t],r?typeof r=="function"?n=[r.listener||r]:n=Tq(r):n=[]):n=[],n};kt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):y1.call(e,t)};kt.prototype.listenerCount=y1;function y1(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}kt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function kq(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function sl(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function Tq(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function m1(e){var t=Eq();return function(){var n=Tc.default(e),i;if(t){var a=Tc.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return p1.default(this,i)}}function Eq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var b1=function(e){$g.default(r,e);var t=m1(r);function r(n){var i;return _g.default(this,r),i=t.call(this),si.default(ai.default(i),"timeout",null),si.default(ai.default(i),"startTimestamp",-1),i.minDelay=n.min,i.maxDelay=n.max,i.initialDelay=n.initial||0,i.maxAttemptsCount=n.maxAttemptsCount||0,i.maxAttemptsTime=n.maxAttemptsTime||0,i.randomness=n.randomness||0,i.inProgress=!1,i.attemptNum=0,i.prevDelay=0,i.currDelay=0,i}return Sg.default(r,[{key:"attempt",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.attemptNum++,this.emit("attempt",this)}},{key:"nextDelay",value:function(i){if(typeof i=="number")return this.prevDelay=0,this.currDelay=i,i;if(this.attemptNum==0)return this.initialDelay;if(this.attemptNum==1)return this.currDelay=this.minDelay,this.currDelay;this.prevDelay=this.currDelay;var a=this.currDelay+this.prevDelay;return this.maxDelay&&a>this.maxDelay&&(this.currDelay=this.maxDelay,a=this.maxDelay),this.currDelay=a,a}},{key:"randomize",value:function(i){var a=i*this.randomness,s=Math.round(Math.random()*a*2-a);return Math.max(0,i+s)}},{key:"scheduleAttempt",value:function(i){var a=this;if(this.maxAttemptsCount&&this.attemptNum>=this.maxAttemptsCount){this.cleanup(),this.emit("failed",new Error("Maximum attempt count limit reached"));return}var s=this.nextDelay(i);if(s=this.randomize(s),this.maxAttemptsTime&&this.startTimestamp+this.maxAttemptsTime<Date.now()+s){this.cleanup(),this.emit("failed",new Error("Maximum attempt time limit reached"));return}this.timeout=setTimeout(function(){return a.attempt()},s)}},{key:"cleanup",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.inProgress=!1,this.attemptNum=0,this.prevDelay=0,this.currDelay=0}},{key:"start",value:function(){if(this.inProgress)throw new Error("Retrier is already in progress");this.inProgress=!0,this.startTimestamp=Date.now(),this.scheduleAttempt(this.initialDelay)}},{key:"cancel",value:function(){this.timeout&&(clearTimeout(this.timeout),this.timeout=null,this.inProgress=!1,this.emit("cancelled"))}},{key:"succeeded",value:function(i){this.emit("succeeded",i)}},{key:"failed",value:function(i,a){if(this.timeout)throw new Error("Retrier attempt is already in progress");this.scheduleAttempt(a)}}]),r}(kt),Iq=function(e){$g.default(r,e);var t=m1(r);function r(n){var i;return _g.default(this,r),i=t.call(this),si.default(ai.default(i),"resolve",function(){}),si.default(ai.default(i),"reject",function(){}),i.retrier=new b1(n),i}return Sg.default(r,[{key:"run",value:function(i){var a=this;return this.retrier.on("attempt",function(){i().then(function(s){return a.retrier.succeeded(s)}).catch(function(s){return a.retrier.failed(s)})}),this.retrier.on("succeeded",function(s){return a.resolve(s)}),this.retrier.on("cancelled",function(){return a.reject(new Error("Cancelled"))}),this.retrier.on("failed",function(s){return a.reject(s)}),new Promise(function(s,u){a.resolve=s,a.reject=u,a.retrier.start()})}},{key:"cancel",value:function(){this.retrier.cancel()}}]),r}(kt);function Cq(e){var t=Rq();return function(){var n=Tc.default(e),i;if(t){var a=Tc.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return p1.default(this,i)}}function Rq(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function jl(e){return e!=null}var Oq=function(e){$g.default(r,e);var t=Cq(r);function r(n){var i;_g.default(this,r),i=t.call(this),si.default(ai.default(i),"backoffDelay",0),si.default(ai.default(i),"nextBackoffDelay",0),si.default(ai.default(i),"backoffNumber",0),si.default(ai.default(i),"timeoutID",null),si.default(ai.default(i),"maxNumberOfRetry",-1),n=n||{};var a=n,s=a.initialDelay,u=a.maxDelay,o=a.randomisationFactor,c=a.factor;if(jl(s)&&s<1)throw new Error("The initial timeout must be equal to or greater than 1.");if(jl(u)&&u<=1)throw new Error("The maximal timeout must be greater than 1.");if(jl(o)&&(o<0||o>1))throw new Error("The randomisation factor must be between 0 and 1.");if(jl(c)&&c<=1)throw new Error("Exponential factor should be greater than 1.");if(i.initialDelay=s||100,i.maxDelay=u||1e4,i.maxDelay<=i.initialDelay)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");return i.randomisationFactor=o||0,i.factor=c||2,i.reset(),i}return Sg.default(r,[{key:"backoff",value:function(i){this.timeoutID==null&&(this.backoffNumber===this.maxNumberOfRetry?(this.emit("fail",i),this.reset()):(this.backoffDelay=this.next(),this.timeoutID=setTimeout(this.onBackoff.bind(this),this.backoffDelay),this.emit("backoff",this.backoffNumber,this.backoffDelay,i)))}},{key:"reset",value:function(){this.backoffDelay=0,this.nextBackoffDelay=this.initialDelay,this.backoffNumber=0,this.timeoutID&&clearTimeout(this.timeoutID),this.timeoutID=null}},{key:"failAfter",value:function(i){if(i<=0)throw new Error("Expected a maximum number of retry greater than 0 but got ".concat(i));this.maxNumberOfRetry=i}},{key:"next",value:function(){this.backoffDelay=Math.min(this.nextBackoffDelay,this.maxDelay),this.nextBackoffDelay=this.backoffDelay*this.factor;var i=1+Math.random()*this.randomisationFactor;return Math.min(this.maxDelay,Math.round(this.backoffDelay*i))}},{key:"onBackoff",value:function(){this.timeoutID=null,this.emit("ready",this.backoffNumber,this.backoffDelay),this.backoffNumber++}}],[{key:"exponential",value:function(i){return new r(i)}}]),r}(kt);Si.AsyncRetrier=Iq;Si.Backoff=Oq;Si.Retrier=b1;var Ef={},Aq=Pt,Pq=Vt,Mq=vi,Nq=B0,_w=RegExp.prototype,xq=function(e){var t=e.flags;return t===void 0&&!("flags"in _w)&&!Pq(e,"flags")&&Mq(_w,e)?Aq(Nq,e):t},Lq=Bu.PROPER,jq=mr,Uq=Zt,Sw=fr,Dq=et,Fq=xq,kg="toString",Bq=RegExp.prototype,w1=Bq[kg],qq=Dq(function(){return w1.call({source:"a",flags:"b"})!="/a/b"}),Wq=Lq&&w1.name!=kg;(qq||Wq)&&jq(RegExp.prototype,kg,function(){var t=Uq(this),r=Sw(t.source),n=Sw(Fq(t));return"/"+r+"/"+n},{unsafe:!0});var Hq=c1,Gq=d1;Hq("Set",function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}},Gq);var _1={exports:{}};(function(e,t){(function(n,i){e.exports=i()})($n,function(){return function(r){var n={};function i(a){if(n[a])return n[a].exports;var s=n[a]={i:a,l:!1,exports:{}};return r[a].call(s.exports,s,s.exports,i),s.l=!0,s.exports}return i.m=r,i.c=n,i.i=function(a){return a},i.d=function(a,s,u){i.o(a,s)||Object.defineProperty(a,s,{configurable:!1,enumerable:!0,get:u})},i.n=function(a){var s=a&&a.__esModule?function(){return a.default}:function(){return a};return i.d(s,"a",s),s},i.o=function(a,s){return Object.prototype.hasOwnProperty.call(a,s)},i.p="",i(i.s=5)}([function(r,n,i){r.exports=function(a,s){var u,o,c;for(u=1;u<arguments.length;u++){o=arguments[u];for(c in o)o.hasOwnProperty(c)&&(a[c]=o[c])}return a}},function(r,n,i){var a=i(0);r.exports={build:function(s,u){var o,c,d,y=u.plugins;for(o=0,c=y.length;o<c;o++)d=y[o],d.methods&&a(s,d.methods),d.properties&&Object.defineProperties(s,d.properties)},hook:function(s,u,o){var c,d,y,_,w=s.config.plugins,k=[s.context];for(o&&(k=k.concat(o)),c=0,d=w.length;c<d;c++)_=w[c],y=w[c][u],y&&y.apply(_,k)}}},function(r,n,i){function a(s){if(s.length===0)return s;var u,o,c=s.split(/[_-]/);if(c.length===1&&c[0][0].toLowerCase()===c[0][0])return s;for(o=c[0].toLowerCase(),u=1;u<c.length;u++)o=o+c[u].charAt(0).toUpperCase()+c[u].substring(1).toLowerCase();return o}a.prepended=function(s,u){return u=a(u),s+u[0].toUpperCase()+u.substring(1)},r.exports=a},function(r,n,i){var a=i(0),s=i(2);function u(o,c){o=o||{},this.options=o,this.defaults=c.defaults,this.states=[],this.transitions=[],this.map={},this.lifecycle=this.configureLifecycle(),this.init=this.configureInitTransition(o.init),this.data=this.configureData(o.data),this.methods=this.configureMethods(o.methods),this.map[this.defaults.wildcard]={},this.configureTransitions(o.transitions||[]),this.plugins=this.configurePlugins(o.plugins,c.plugin)}a(u.prototype,{addState:function(o){this.map[o]||(this.states.push(o),this.addStateLifecycleNames(o),this.map[o]={})},addStateLifecycleNames:function(o){this.lifecycle.onEnter[o]=s.prepended("onEnter",o),this.lifecycle.onLeave[o]=s.prepended("onLeave",o),this.lifecycle.on[o]=s.prepended("on",o)},addTransition:function(o){this.transitions.indexOf(o)<0&&(this.transitions.push(o),this.addTransitionLifecycleNames(o))},addTransitionLifecycleNames:function(o){this.lifecycle.onBefore[o]=s.prepended("onBefore",o),this.lifecycle.onAfter[o]=s.prepended("onAfter",o),this.lifecycle.on[o]=s.prepended("on",o)},mapTransition:function(o){var c=o.name,d=o.from,y=o.to;return this.addState(d),typeof y!="function"&&this.addState(y),this.addTransition(c),this.map[d][c]=o,o},configureLifecycle:function(){return{onBefore:{transition:"onBeforeTransition"},onAfter:{transition:"onAfterTransition"},onEnter:{state:"onEnterState"},onLeave:{state:"onLeaveState"},on:{transition:"onTransition"}}},configureInitTransition:function(o){return typeof o=="string"?this.mapTransition(a({},this.defaults.init,{to:o,active:!0})):typeof o=="object"?this.mapTransition(a({},this.defaults.init,o,{active:!0})):(this.addState(this.defaults.init.from),this.defaults.init)},configureData:function(o){return typeof o=="function"?o:typeof o=="object"?function(){return o}:function(){return{}}},configureMethods:function(o){return o||{}},configurePlugins:function(o,c){o=o||[];var d,y,_;for(d=0,y=o.length;d<y;d++)_=o[d],typeof _=="function"&&(o[d]=_=_()),_.configure&&_.configure(this);return o},configureTransitions:function(o){var c,d,y,_,w,k=this.defaults.wildcard;for(d=0;d<o.length;d++)for(y=o[d],_=Array.isArray(y.from)?y.from:[y.from||k],w=y.to||k,c=0;c<_.length;c++)this.mapTransition({name:y.name,from:_[c],to:w})},transitionFor:function(o,c){var d=this.defaults.wildcard;return this.map[o][c]||this.map[d][c]},transitionsFor:function(o){var c=this.defaults.wildcard;return Object.keys(this.map[o]).concat(Object.keys(this.map[c]))},allStates:function(){return this.states},allTransitions:function(){return this.transitions}}),r.exports=u},function(r,n,i){var a=i(0),s=i(6),u=i(1),o=[null,[]];function c(d,y){this.context=d,this.config=y,this.state=y.init.from,this.observers=[d]}a(c.prototype,{init:function(d){if(a(this.context,this.config.data.apply(this.context,d)),u.hook(this,"init"),this.config.init.active)return this.fire(this.config.init.name,[])},is:function(d){return Array.isArray(d)?d.indexOf(this.state)>=0:this.state===d},isPending:function(){return this.pending},can:function(d){return!this.isPending()&&!!this.seek(d)},cannot:function(d){return!this.can(d)},allStates:function(){return this.config.allStates()},allTransitions:function(){return this.config.allTransitions()},transitions:function(){return this.config.transitionsFor(this.state)},seek:function(d,y){var _=this.config.defaults.wildcard,w=this.config.transitionFor(this.state,d),k=w&&w.to;return typeof k=="function"?k.apply(this.context,y):k===_?this.state:k},fire:function(d,y){return this.transit(d,this.state,this.seek(d,y),y)},transit:function(d,y,_,w){var k=this.config.lifecycle,N=this.config.options.observeUnchangedState||y!==_;return _?this.isPending()?this.context.onPendingTransition(d,y,_):(this.config.addState(_),this.beginTransit(),w.unshift({transition:d,from:y,to:_,fsm:this.context}),this.observeEvents([this.observersForEvent(k.onBefore.transition),this.observersForEvent(k.onBefore[d]),N?this.observersForEvent(k.onLeave.state):o,N?this.observersForEvent(k.onLeave[y]):o,this.observersForEvent(k.on.transition),N?["doTransit",[this]]:o,N?this.observersForEvent(k.onEnter.state):o,N?this.observersForEvent(k.onEnter[_]):o,N?this.observersForEvent(k.on[_]):o,this.observersForEvent(k.onAfter.transition),this.observersForEvent(k.onAfter[d]),this.observersForEvent(k.on[d])],w)):this.context.onInvalidTransition(d,y,_)},beginTransit:function(){this.pending=!0},endTransit:function(d){return this.pending=!1,d},failTransit:function(d){throw this.pending=!1,d},doTransit:function(d){this.state=d.to},observe:function(d){if(d.length===2){var y={};y[d[0]]=d[1],this.observers.push(y)}else this.observers.push(d[0])},observersForEvent:function(d){for(var y=0,_=this.observers.length,w,k=[];y<_;y++)w=this.observers[y],w[d]&&k.push(w);return[d,k,!0]},observeEvents:function(d,y,_,w){if(d.length===0)return this.endTransit(w===void 0?!0:w);var k=d[0][0],N=d[0][1],M=d[0][2];if(y[0].event=k,k&&M&&k!==_&&u.hook(this,"lifecycle",y),N.length===0)return d.shift(),this.observeEvents(d,y,k,w);var L=N.shift(),B=L[k].apply(L,y);return B&&typeof B.then=="function"?B.then(this.observeEvents.bind(this,d,y,k)).catch(this.failTransit.bind(this)):B===!1?this.endTransit(!1):this.observeEvents(d,y,k,B)},onInvalidTransition:function(d,y,_){throw new s("transition is invalid in current state",d,y,_,this.state)},onPendingTransition:function(d,y,_){throw new s("transition is invalid while previous transition is still in progress",d,y,_,this.state)}}),r.exports=c},function(r,n,i){var a=i(0),s=i(2),u=i(1),o=i(3),c=i(4),d={is:function(M){return this._fsm.is(M)},can:function(M){return this._fsm.can(M)},cannot:function(M){return this._fsm.cannot(M)},observe:function(){return this._fsm.observe(arguments)},transitions:function(){return this._fsm.transitions()},allTransitions:function(){return this._fsm.allTransitions()},allStates:function(){return this._fsm.allStates()},onInvalidTransition:function(M,L,B){return this._fsm.onInvalidTransition(M,L,B)},onPendingTransition:function(M,L,B){return this._fsm.onPendingTransition(M,L,B)}},y={state:{configurable:!1,enumerable:!0,get:function(){return this._fsm.state},set:function(M){throw Error("use transitions to change state")}}};function _(M){return k(this||{},M)}function w(){var M,L;typeof arguments[0]=="function"?(M=arguments[0],L=arguments[1]||{}):(M=function(){this._fsm.apply(this,arguments)},L=arguments[0]||{});var B=new o(L,_);return N(M.prototype,B),M.prototype._fsm.config=B,M}function k(M,L){var B=new o(L,_);return N(M,B),M._fsm(),M}function N(M,L){if(typeof M!="object"||Array.isArray(M))throw Error("StateMachine can only be applied to objects");u.build(M,L),Object.defineProperties(M,y),a(M,d),a(M,L.methods),L.allTransitions().forEach(function(B){M[s(B)]=function(){return this._fsm.fire(B,[].slice.call(arguments))}}),M._fsm=function(){this._fsm=new c(this,L),this._fsm.init(arguments)}}_.version="3.0.1",_.factory=w,_.apply=k,_.defaults={wildcard:"*",init:{name:"init",from:"none"}},r.exports=_},function(r,n,i){r.exports=function(a,s,u,o,c){this.message=a,this.transition=s,this.from=u,this.to=o,this.current=c}}])})})(_1);var Ec={exports:{}},$w=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto<"u"&&typeof window.msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto);if($w){var kw=new Uint8Array(16);Ec.exports=function(){return $w(kw),kw}}else{var Tw=new Array(16);Ec.exports=function(){for(var t=0,r;t<16;t++)(t&3)===0&&(r=Math.random()*4294967296),Tw[t]=r>>>((t&3)<<3)&255;return Tw}}var S1=[];for(var Ul=0;Ul<256;++Ul)S1[Ul]=(Ul+256).toString(16).substr(1);function Vq(e,t){var r=t||0,n=S1;return[n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],"-",n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]],n[e[r++]]].join("")}var $1=Vq,zq=Ec.exports,Kq=$1,Ew,Gd,Vd=0,zd=0;function Jq(e,t,r){var n=t&&r||0,i=t||[];e=e||{};var a=e.node||Ew,s=e.clockseq!==void 0?e.clockseq:Gd;if(a==null||s==null){var u=zq();a==null&&(a=Ew=[u[0]|1,u[1],u[2],u[3],u[4],u[5]]),s==null&&(s=Gd=(u[6]<<8|u[7])&16383)}var o=e.msecs!==void 0?e.msecs:new Date().getTime(),c=e.nsecs!==void 0?e.nsecs:zd+1,d=o-Vd+(c-zd)/1e4;if(d<0&&e.clockseq===void 0&&(s=s+1&16383),(d<0||o>Vd)&&e.nsecs===void 0&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Vd=o,zd=c,Gd=s,o+=122192928e5;var y=((o&268435455)*1e4+c)%4294967296;i[n++]=y>>>24&255,i[n++]=y>>>16&255,i[n++]=y>>>8&255,i[n++]=y&255;var _=o/4294967296*1e4&268435455;i[n++]=_>>>8&255,i[n++]=_&255,i[n++]=_>>>24&15|16,i[n++]=_>>>16&255,i[n++]=s>>>8|128,i[n++]=s&255;for(var w=0;w<6;++w)i[n+w]=a[w];return t||Kq(i)}var Yq=Jq,Qq=Ec.exports,Xq=$1;function Zq(e,t,r){var n=t&&r||0;typeof e=="string"&&(t=e==="binary"?new Array(16):null,e=null),e=e||{};var i=e.random||(e.rng||Qq)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t)for(var a=0;a<16;++a)t[n+a]=i[a];return t||Xq(i)}var eW=Zq,tW=Yq,k1=eW,Tg=k1;Tg.v1=tW;Tg.v4=k1;var If=Tg,_h={exports:{}},T1=typeof ArrayBuffer<"u"&&typeof DataView<"u",rW=T1,Eg=Bt,Er=dt,E1=Mt,Cf=Gt,ea=Vt,Ig=bi,nW=Qa,iW=gi,Sh=mr,aW=Xt.f,sW=vi,Rf=mf,mo=vo,oW=Ct,uW=Du,I1=fn,C1=I1.enforce,lW=I1.get,Ic=Er.Int8Array,$h=Ic&&Ic.prototype,Iw=Er.Uint8ClampedArray,Cw=Iw&&Iw.prototype,Fn=Ic&&Rf(Ic),kn=$h&&Rf($h),cW=Object.prototype,Cg=Er.TypeError,Rw=oW("toStringTag"),kh=uW("TYPED_ARRAY_TAG"),Cc="TypedArrayConstructor",fi=rW&&!!mo&&Ig(Er.opera)!=="Opera",R1=!1,Mr,Bi,qs,di={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},Rg={BigInt64Array:8,BigUint64Array:8},fW=function(t){if(!Cf(t))return!1;var r=Ig(t);return r==="DataView"||ea(di,r)||ea(Rg,r)},O1=function(e){var t=Rf(e);if(!!Cf(t)){var r=lW(t);return r&&ea(r,Cc)?r[Cc]:O1(t)}},A1=function(e){if(!Cf(e))return!1;var t=Ig(e);return ea(di,t)||ea(Rg,t)},dW=function(e){if(A1(e))return e;throw Cg("Target is not a typed array")},pW=function(e){if(E1(e)&&(!mo||sW(Fn,e)))return e;throw Cg(nW(e)+" is not a typed array constructor")},hW=function(e,t,r,n){if(!!Eg){if(r)for(var i in di){var a=Er[i];if(a&&ea(a.prototype,e))try{delete a.prototype[e]}catch{try{a.prototype[e]=t}catch{}}}(!kn[e]||r)&&Sh(kn,e,r?t:fi&&$h[e]||t,n)}},vW=function(e,t,r){var n,i;if(!!Eg){if(mo){if(r){for(n in di)if(i=Er[n],i&&ea(i,e))try{delete i[e]}catch{}}if(!Fn[e]||r)try{return Sh(Fn,e,r?t:fi&&Fn[e]||t)}catch{}else return}for(n in di)i=Er[n],i&&(!i[e]||r)&&Sh(i,e,t)}};for(Mr in di)Bi=Er[Mr],qs=Bi&&Bi.prototype,qs?C1(qs)[Cc]=Bi:fi=!1;for(Mr in Rg)Bi=Er[Mr],qs=Bi&&Bi.prototype,qs&&(C1(qs)[Cc]=Bi);if((!fi||!E1(Fn)||Fn===Function.prototype)&&(Fn=function(){throw Cg("Incorrect invocation")},fi))for(Mr in di)Er[Mr]&&mo(Er[Mr],Fn);if((!fi||!kn||kn===cW)&&(kn=Fn.prototype,fi))for(Mr in di)Er[Mr]&&mo(Er[Mr].prototype,kn);fi&&Rf(Cw)!==kn&&mo(Cw,kn);if(Eg&&!ea(kn,Rw)){R1=!0,aW(kn,Rw,{get:function(){return Cf(this)?this[kh]:void 0}});for(Mr in di)Er[Mr]&&iW(Er[Mr],kh,Mr)}var xt={NATIVE_ARRAY_BUFFER_VIEWS:fi,TYPED_ARRAY_TAG:R1&&kh,aTypedArray:dW,aTypedArrayConstructor:pW,exportTypedArrayMethod:hW,exportTypedArrayStaticMethod:vW,getTypedArrayConstructor:O1,isView:fW,isTypedArray:A1,TypedArray:Fn,TypedArrayPrototype:kn},P1=dt,Kd=et,gW=yf,yW=xt.NATIVE_ARRAY_BUFFER_VIEWS,mW=P1.ArrayBuffer,Ta=P1.Int8Array,bW=!yW||!Kd(function(){Ta(1)})||!Kd(function(){new Ta(-1)})||!gW(function(e){new Ta,new Ta(null),new Ta(1.5),new Ta(e)},!0)||Kd(function(){return new Ta(new mW(2),1,void 0).length!==1}),wW=yi,_W=mi,SW=RangeError,M1=function(e){if(e===void 0)return 0;var t=wW(e),r=_W(t);if(t!==r)throw SW("Wrong length or index");return r},$W=Array,kW=Math.abs,ii=Math.pow,TW=Math.floor,EW=Math.log,IW=Math.LN2,CW=function(e,t,r){var n=$W(r),i=r*8-t-1,a=(1<<i)-1,s=a>>1,u=t===23?ii(2,-24)-ii(2,-77):0,o=e<0||e===0&&1/e<0?1:0,c=0,d,y,_;for(e=kW(e),e!=e||e===1/0?(y=e!=e?1:0,d=a):(d=TW(EW(e)/IW),_=ii(2,-d),e*_<1&&(d--,_*=2),d+s>=1?e+=u/_:e+=u*ii(2,1-s),e*_>=2&&(d++,_/=2),d+s>=a?(y=0,d=a):d+s>=1?(y=(e*_-1)*ii(2,t),d=d+s):(y=e*ii(2,s-1)*ii(2,t),d=0));t>=8;)n[c++]=y&255,y/=256,t-=8;for(d=d<<t|y,i+=t;i>0;)n[c++]=d&255,d/=256,i-=8;return n[--c]|=o*128,n},RW=function(e,t){var r=e.length,n=r*8-t-1,i=(1<<n)-1,a=i>>1,s=n-7,u=r-1,o=e[u--],c=o&127,d;for(o>>=7;s>0;)c=c*256+e[u--],s-=8;for(d=c&(1<<-s)-1,c>>=-s,s+=t;s>0;)d=d*256+e[u--],s-=8;if(c===0)c=1-a;else{if(c===i)return d?NaN:o?-1/0:1/0;d=d+ii(2,t),c=c-a}return(o?-1:1)*d*ii(2,c-t)},OW={pack:CW,unpack:RW},AW=yr,Ow=es,PW=br,N1=function(t){for(var r=AW(this),n=PW(r),i=arguments.length,a=Ow(i>1?arguments[1]:void 0,n),s=i>2?arguments[2]:void 0,u=s===void 0?n:Ow(s,n);u>a;)r[a++]=t;return r},Of=dt,Og=Qe,Jd=Bt,MW=T1,x1=Bu,Aw=gi,Pw=wg,Yd=et,Dl=rs,NW=yi,xW=mi,Rc=M1,L1=OW,LW=mf,Mw=vo,jW=ra.f,UW=Xt.f,DW=N1,FW=Vu,j1=aa,U1=fn,BW=x1.PROPER,Nw=x1.CONFIGURABLE,eo=U1.get,xw=U1.set,Oc="ArrayBuffer",D1="DataView",Ws="prototype",qW="Wrong length",F1="Wrong index",nn=Of[Oc],Dr=nn,ws=Dr&&Dr[Ws],jn=Of[D1],Ea=jn&&jn[Ws],Lw=Object.prototype,WW=Of.Array,Ac=Of.RangeError,HW=Og(DW),GW=Og([].reverse),B1=L1.pack,jw=L1.unpack,Uw=function(e){return[e&255]},Dw=function(e){return[e&255,e>>8&255]},Fw=function(e){return[e&255,e>>8&255,e>>16&255,e>>24&255]},Bw=function(e){return e[3]<<24|e[2]<<16|e[1]<<8|e[0]},VW=function(e){return B1(e,23,4)},zW=function(e){return B1(e,52,8)},Fl=function(e,t){UW(e[Ws],t,{get:function(){return eo(this)[t]}})},Pi=function(e,t,r,n){var i=Rc(r),a=eo(e);if(i+t>a.byteLength)throw Ac(F1);var s=eo(a.buffer).bytes,u=i+a.byteOffset,o=FW(s,u,u+t);return n?o:GW(o)},Mi=function(e,t,r,n,i,a){var s=Rc(r),u=eo(e);if(s+t>u.byteLength)throw Ac(F1);for(var o=eo(u.buffer).bytes,c=s+u.byteOffset,d=n(+i),y=0;y<t;y++)o[c+y]=d[a?y:t-y-1]};if(!MW)Dr=function(t){Dl(this,ws);var r=Rc(t);xw(this,{bytes:HW(WW(r),0),byteLength:r}),Jd||(this.byteLength=r)},ws=Dr[Ws],jn=function(t,r,n){Dl(this,Ea),Dl(t,ws);var i=eo(t).byteLength,a=NW(r);if(a<0||a>i)throw Ac("Wrong offset");if(n=n===void 0?i-a:xW(n),a+n>i)throw Ac(qW);xw(this,{buffer:t,byteLength:n,byteOffset:a}),Jd||(this.buffer=t,this.byteLength=n,this.byteOffset=a)},Ea=jn[Ws],Jd&&(Fl(Dr,"byteLength"),Fl(jn,"buffer"),Fl(jn,"byteLength"),Fl(jn,"byteOffset")),Pw(Ea,{getInt8:function(t){return Pi(this,1,t)[0]<<24>>24},getUint8:function(t){return Pi(this,1,t)[0]},getInt16:function(t){var r=Pi(this,2,t,arguments.length>1?arguments[1]:void 0);return(r[1]<<8|r[0])<<16>>16},getUint16:function(t){var r=Pi(this,2,t,arguments.length>1?arguments[1]:void 0);return r[1]<<8|r[0]},getInt32:function(t){return Bw(Pi(this,4,t,arguments.length>1?arguments[1]:void 0))},getUint32:function(t){return Bw(Pi(this,4,t,arguments.length>1?arguments[1]:void 0))>>>0},getFloat32:function(t){return jw(Pi(this,4,t,arguments.length>1?arguments[1]:void 0),23)},getFloat64:function(t){return jw(Pi(this,8,t,arguments.length>1?arguments[1]:void 0),52)},setInt8:function(t,r){Mi(this,1,t,Uw,r)},setUint8:function(t,r){Mi(this,1,t,Uw,r)},setInt16:function(t,r){Mi(this,2,t,Dw,r,arguments.length>2?arguments[2]:void 0)},setUint16:function(t,r){Mi(this,2,t,Dw,r,arguments.length>2?arguments[2]:void 0)},setInt32:function(t,r){Mi(this,4,t,Fw,r,arguments.length>2?arguments[2]:void 0)},setUint32:function(t,r){Mi(this,4,t,Fw,r,arguments.length>2?arguments[2]:void 0)},setFloat32:function(t,r){Mi(this,4,t,VW,r,arguments.length>2?arguments[2]:void 0)},setFloat64:function(t,r){Mi(this,8,t,zW,r,arguments.length>2?arguments[2]:void 0)}});else{var qw=BW&&nn.name!==Oc;if(!Yd(function(){nn(1)})||!Yd(function(){new nn(-1)})||Yd(function(){return new nn,new nn(1.5),new nn(NaN),nn.length!=1||qw&&!Nw})){Dr=function(t){return Dl(this,ws),new nn(Rc(t))},Dr[Ws]=ws;for(var Ww=jW(nn),Hw=0,Qd;Ww.length>Hw;)(Qd=Ww[Hw++])in Dr||Aw(Dr,Qd,nn[Qd]);ws.constructor=Dr}else qw&&Nw&&Aw(nn,"name",Oc);Mw&&LW(Ea)!==Lw&&Mw(Ea,Lw);var Bl=new jn(new Dr(2)),Gw=Og(Ea.setInt8);Bl.setInt8(0,2147483648),Bl.setInt8(1,2147483649),(Bl.getInt8(0)||!Bl.getInt8(1))&&Pw(Ea,{setInt8:function(t,r){Gw(this,t,r<<24>>24)},setUint8:function(t,r){Gw(this,t,r<<24>>24)}},{unsafe:!0})}j1(Dr,Oc);j1(jn,D1);var q1={ArrayBuffer:Dr,DataView:jn},KW=yi,JW=RangeError,YW=function(e){var t=KW(e);if(t<0)throw JW("The argument can't be less than 0");return t},QW=YW,XW=RangeError,W1=function(e,t){var r=QW(e);if(r%t)throw XW("Wrong offset");return r},ZW=bi,eH=Qe,tH=eH("".slice),rH=function(e){return tH(ZW(e),0,3)==="Big"},nH=Sv,iH=TypeError,H1=function(e){var t=nH(e,"number");if(typeof t=="number")throw iH("Can't convert number to bigint");return BigInt(t)},aH=wi,sH=Pt,oH=Rv,uH=yr,lH=br,cH=vf,fH=el,dH=Kv,pH=rH,hH=xt.aTypedArrayConstructor,vH=H1,gH=function(t){var r=oH(this),n=uH(t),i=arguments.length,a=i>1?arguments[1]:void 0,s=a!==void 0,u=fH(n),o,c,d,y,_,w,k,N;if(u&&!dH(u))for(k=cH(n,u),N=k.next,n=[];!(w=sH(N,k)).done;)n.push(w.value);for(s&&i>2&&(a=aH(a,arguments[2])),c=lH(n),d=new(hH(r))(c),y=pH(d),o=0;c>o;o++)_=s?a(n[o],o):n[o],d[o]=y?vH(_):+_;return d},Vw=ft,G1=dt,zw=Pt,yH=Bt,mH=bW,bo=xt,V1=q1,Kw=rs,bH=Ka,Fo=gi,wH=K0,_H=mi,Jw=M1,Xd=W1,z1=Fu,Bo=Vt,SH=bi,Th=Gt,$H=co,kH=ia,TH=vi,ql=vo,EH=ra.f,Yw=gH,IH=Hr.forEach,CH=df,K1=Xt,J1=Hn,Ag=fn,RH=Jv,Eh=Ag.get,OH=Ag.set,AH=Ag.enforce,Pg=K1.f,PH=J1.f,MH=Math.round,Zd=G1.RangeError,Y1=V1.ArrayBuffer,NH=Y1.prototype,xH=V1.DataView,Wl=bo.NATIVE_ARRAY_BUFFER_VIEWS,Qw=bo.TYPED_ARRAY_TAG,Xw=bo.TypedArray,qo=bo.TypedArrayPrototype,LH=bo.aTypedArrayConstructor,Ih=bo.isTypedArray,Hl="BYTES_PER_ELEMENT",ep="Wrong length",Zw=function(e,t){LH(e);for(var r=0,n=t.length,i=new e(n);n>r;)i[r]=t[r++];return i},Gl=function(e,t){Pg(e,t,{get:function(){return Eh(this)[t]}})},e_=function(e){var t;return TH(NH,e)||(t=SH(e))=="ArrayBuffer"||t=="SharedArrayBuffer"},Q1=function(e,t){return Ih(e)&&!$H(t)&&t in e&&wH(+t)&&t>=0},t_=function(t,r){return r=z1(r),Q1(t,r)?bH(2,t[r]):PH(t,r)},r_=function(t,r,n){return r=z1(r),Q1(t,r)&&Th(n)&&Bo(n,"value")&&!Bo(n,"get")&&!Bo(n,"set")&&!n.configurable&&(!Bo(n,"writable")||n.writable)&&(!Bo(n,"enumerable")||n.enumerable)?(t[r]=n.value,t):Pg(t,r,n)};yH?(Wl||(J1.f=t_,K1.f=r_,Gl(qo,"buffer"),Gl(qo,"byteOffset"),Gl(qo,"byteLength"),Gl(qo,"length")),Vw({target:"Object",stat:!0,forced:!Wl},{getOwnPropertyDescriptor:t_,defineProperty:r_}),_h.exports=function(e,t,r){var n=e.match(/\d+$/)[0]/8,i=e+(r?"Clamped":"")+"Array",a="get"+e,s="set"+e,u=G1[i],o=u,c=o&&o.prototype,d={},y=function(N,M){var L=Eh(N);return L.view[a](M*n+L.byteOffset,!0)},_=function(N,M,L){var B=Eh(N);r&&(L=(L=MH(L))<0?0:L>255?255:L&255),B.view[s](M*n+B.byteOffset,L,!0)},w=function(N,M){Pg(N,M,{get:function(){return y(this,M)},set:function(L){return _(this,M,L)},enumerable:!0})};Wl?mH&&(o=t(function(N,M,L,B){return Kw(N,c),RH(function(){return Th(M)?e_(M)?B!==void 0?new u(M,Xd(L,n),B):L!==void 0?new u(M,Xd(L,n)):new u(M):Ih(M)?Zw(o,M):zw(Yw,o,M):new u(Jw(M))}(),N,o)}),ql&&ql(o,Xw),IH(EH(u),function(N){N in o||Fo(o,N,u[N])}),o.prototype=c):(o=t(function(N,M,L,B){Kw(N,c);var ve=0,ue=0,Me,Re,Ae;if(!Th(M))Ae=Jw(M),Re=Ae*n,Me=new Y1(Re);else if(e_(M)){Me=M,ue=Xd(L,n);var x=M.byteLength;if(B===void 0){if(x%n||(Re=x-ue,Re<0))throw Zd(ep)}else if(Re=_H(B)*n,Re+ue>x)throw Zd(ep);Ae=Re/n}else return Ih(M)?Zw(o,M):zw(Yw,o,M);for(OH(N,{buffer:Me,byteOffset:ue,byteLength:Re,length:Ae,view:new xH(Me)});ve<Ae;)w(N,ve++)}),ql&&ql(o,Xw),c=o.prototype=kH(qo)),c.constructor!==o&&Fo(c,"constructor",o),AH(c).TypedArrayConstructor=o,Qw&&Fo(c,Qw,i);var k=o!=u;d[i]=o,Vw({global:!0,constructor:!0,forced:k,sham:!Wl},d),Hl in o||Fo(o,Hl,n),Hl in c||Fo(c,Hl,n),CH(i)}):_h.exports=function(){};var jH=_h.exports;jH("Uint8",function(e){return function(r,n,i){return e(this,r,n,i)}});var n_=Qa,UH=TypeError,Mg=function(e,t){if(!delete e[t])throw UH("Cannot delete property "+n_(t)+" of "+n_(e))},DH=yr,tp=es,FH=br,BH=Mg,qH=Math.min,WH=[].copyWithin||function(t,r){var n=DH(this),i=FH(n),a=tp(t,i),s=tp(r,i),u=arguments.length>2?arguments[2]:void 0,o=qH((u===void 0?i:tp(u,i))-s,i-a),c=1;for(s<a&&a<s+o&&(c=-1,s+=o-1,a+=o-1);o-- >0;)s in n?n[a]=n[s]:BH(n,a),a+=c,s+=c;return n},HH=Qe,X1=xt,GH=WH,VH=HH(GH),zH=X1.aTypedArray,KH=X1.exportTypedArrayMethod;KH("copyWithin",function(t,r){return VH(zH(this),t,r,arguments.length>2?arguments[2]:void 0)});var Z1=xt,JH=Hr.every,YH=Z1.aTypedArray,QH=Z1.exportTypedArrayMethod;QH("every",function(t){return JH(YH(this),t,arguments.length>1?arguments[1]:void 0)});var eT=xt,XH=N1,ZH=H1,eG=bi,tG=Pt,rG=Qe,nG=et,iG=eT.aTypedArray,aG=eT.exportTypedArrayMethod,sG=rG("".slice),oG=nG(function(){var e=0;return new Int8Array(2).fill({valueOf:function(){return e++}}),e!==1});aG("fill",function(t){var r=arguments.length;iG(this);var n=sG(eG(this),0,3)==="Big"?ZH(t):+t;return tG(XH,this,n,r>1?arguments[1]:void 0,r>2?arguments[2]:void 0)},oG);var uG=br,lG=function(e,t){for(var r=0,n=uG(t),i=new e(n);n>r;)i[r]=t[r++];return i},tT=xt,cG=Fv,fG=tT.aTypedArrayConstructor,dG=tT.getTypedArrayConstructor,Af=function(e){return fG(cG(e,dG(e)))},pG=lG,hG=Af,vG=function(e,t){return pG(hG(e),t)},rT=xt,gG=Hr.filter,yG=vG,mG=rT.aTypedArray,bG=rT.exportTypedArrayMethod;bG("filter",function(t){var r=gG(mG(this),t,arguments.length>1?arguments[1]:void 0);return yG(this,r)});var nT=xt,wG=Hr.find,_G=nT.aTypedArray,SG=nT.exportTypedArrayMethod;SG("find",function(t){return wG(_G(this),t,arguments.length>1?arguments[1]:void 0)});var iT=xt,$G=Hr.findIndex,kG=iT.aTypedArray,TG=iT.exportTypedArrayMethod;TG("findIndex",function(t){return $G(kG(this),t,arguments.length>1?arguments[1]:void 0)});var aT=xt,EG=Hr.forEach,IG=aT.aTypedArray,CG=aT.exportTypedArrayMethod;CG("forEach",function(t){EG(IG(this),t,arguments.length>1?arguments[1]:void 0)});var sT=xt,RG=rf.includes,OG=sT.aTypedArray,AG=sT.exportTypedArrayMethod;AG("includes",function(t){return RG(OG(this),t,arguments.length>1?arguments[1]:void 0)});var oT=xt,PG=rf.indexOf,MG=oT.aTypedArray,NG=oT.exportTypedArrayMethod;NG("indexOf",function(t){return PG(MG(this),t,arguments.length>1?arguments[1]:void 0)});var xG=dt,LG=et,Ng=Qe,uT=xt,xg=j0,jG=Ct,Lg=jG("iterator"),i_=xG.Uint8Array,UG=Ng(xg.values),DG=Ng(xg.keys),FG=Ng(xg.entries),jg=uT.aTypedArray,Pf=uT.exportTypedArrayMethod,As=i_&&i_.prototype,Mf=!LG(function(){As[Lg].call([1])}),lT=!!As&&As.values&&As[Lg]===As.values&&As.values.name==="values",cT=function(){return UG(jg(this))};Pf("entries",function(){return FG(jg(this))},Mf);Pf("keys",function(){return DG(jg(this))},Mf);Pf("values",cT,Mf||!lT,{name:"values"});Pf(Lg,cT,Mf||!lT,{name:"values"});var fT=xt,BG=Qe,qG=fT.aTypedArray,WG=fT.exportTypedArrayMethod,HG=BG([].join);WG("join",function(t){return HG(qG(this),t)});var GG=na,VG=Wr,zG=yi,KG=br,JG=tl,YG=Math.min,Ch=[].lastIndexOf,dT=!!Ch&&1/[1].lastIndexOf(1,-0)<0,QG=JG("lastIndexOf"),XG=dT||!QG,ZG=XG?function(t){if(dT)return GG(Ch,this,arguments)||0;var r=VG(this),n=KG(r),i=n-1;for(arguments.length>1&&(i=YG(i,zG(arguments[1]))),i<0&&(i=n+i);i>=0;i--)if(i in r&&r[i]===t)return i||0;return-1}:Ch,pT=xt,eV=na,tV=ZG,rV=pT.aTypedArray,nV=pT.exportTypedArrayMethod;nV("lastIndexOf",function(t){var r=arguments.length;return eV(tV,rV(this),r>1?[t,arguments[1]]:[t])});var hT=xt,iV=Hr.map,aV=Af,sV=hT.aTypedArray,oV=hT.exportTypedArrayMethod;oV("map",function(t){return iV(sV(this),t,arguments.length>1?arguments[1]:void 0,function(r,n){return new(aV(r))(n)})});var uV=On,lV=yr,cV=Uu,fV=br,dV=TypeError,a_=function(e){return function(t,r,n,i){uV(r);var a=lV(t),s=cV(a),u=fV(a),o=e?u-1:0,c=e?-1:1;if(n<2)for(;;){if(o in s){i=s[o],o+=c;break}if(o+=c,e?o<0:u<=o)throw dV("Reduce of empty array with no initial value")}for(;e?o>=0:u>o;o+=c)o in s&&(i=r(i,s[o],o,a));return i}},Ug={left:a_(!1),right:a_(!0)},vT=xt,pV=Ug.left,hV=vT.aTypedArray,vV=vT.exportTypedArrayMethod;vV("reduce",function(t){var r=arguments.length;return pV(hV(this),t,r,r>1?arguments[1]:void 0)});var gT=xt,gV=Ug.right,yV=gT.aTypedArray,mV=gT.exportTypedArrayMethod;mV("reduceRight",function(t){var r=arguments.length;return gV(yV(this),t,r,r>1?arguments[1]:void 0)});var yT=xt,bV=yT.aTypedArray,wV=yT.exportTypedArrayMethod,_V=Math.floor;wV("reverse",function(){for(var t=this,r=bV(t).length,n=_V(r/2),i=0,a;i<n;)a=t[i],t[i++]=t[--r],t[r]=a;return t});var mT=dt,bT=Pt,Dg=xt,SV=br,$V=W1,kV=yr,wT=et,TV=mT.RangeError,Rh=mT.Int8Array,s_=Rh&&Rh.prototype,_T=s_&&s_.set,EV=Dg.aTypedArray,IV=Dg.exportTypedArrayMethod,Oh=!wT(function(){var e=new Uint8ClampedArray(2);return bT(_T,e,{length:1,0:3},1),e[1]!==3}),CV=Oh&&Dg.NATIVE_ARRAY_BUFFER_VIEWS&&wT(function(){var e=new Rh(2);return e.set(1),e.set("2",1),e[0]!==0||e[1]!==2});IV("set",function(t){EV(this);var r=$V(arguments.length>1?arguments[1]:void 0,1),n=kV(t);if(Oh)return bT(_T,this,n,r);var i=this.length,a=SV(n),s=0;if(a+r>i)throw TV("Wrong length");for(;s<a;)this[r+s]=n[s++]},!Oh||CV);var ST=xt,RV=Af,OV=et,AV=fo,PV=ST.aTypedArray,MV=ST.exportTypedArrayMethod,NV=OV(function(){new Int8Array(1).slice()});MV("slice",function(t,r){for(var n=AV(PV(this),t,r),i=RV(this),a=0,s=n.length,u=new i(s);s>a;)u[a]=n[a++];return u},NV);var $T=xt,xV=Hr.some,LV=$T.aTypedArray,jV=$T.exportTypedArrayMethod;jV("some",function(t){return xV(LV(this),t,arguments.length>1?arguments[1]:void 0)});var o_=Vu,UV=Math.floor,Ah=function(e,t){var r=e.length,n=UV(r/2);return r<8?DV(e,t):FV(e,Ah(o_(e,0,n),t),Ah(o_(e,n),t),t)},DV=function(e,t){for(var r=e.length,n=1,i,a;n<r;){for(a=n,i=e[n];a&&t(e[a-1],i)>0;)e[a]=e[--a];a!==n++&&(e[a]=i)}return e},FV=function(e,t,r,n){for(var i=t.length,a=r.length,s=0,u=0;s<i||u<a;)e[s+u]=s<i&&u<a?n(t[s],r[u])<=0?t[s++]:r[u++]:s<i?t[s++]:r[u++];return e},Fg=Ah,BV=Ja,u_=BV.match(/firefox\/(\d+)/i),kT=!!u_&&+u_[1],qV=Ja,TT=/MSIE|Trident/.test(qV),WV=Ja,l_=WV.match(/AppleWebKit\/(\d+)\./),ET=!!l_&&+l_[1],HV=dt,GV=Qe,Ph=et,VV=On,zV=Fg,IT=xt,c_=kT,KV=TT,f_=Ya,d_=ET,JV=IT.aTypedArray,YV=IT.exportTypedArrayMethod,Ru=HV.Uint16Array,Hs=Ru&&GV(Ru.prototype.sort),QV=!!Hs&&!(Ph(function(){Hs(new Ru(2),null)})&&Ph(function(){Hs(new Ru(2),{})})),p_=!!Hs&&!Ph(function(){if(f_)return f_<74;if(c_)return c_<67;if(KV)return!0;if(d_)return d_<602;var e=new Ru(516),t=Array(516),r,n;for(r=0;r<516;r++)n=r%4,e[r]=515-r,t[r]=r-2*n+3;for(Hs(e,function(i,a){return(i/4|0)-(a/4|0)}),r=0;r<516;r++)if(e[r]!==t[r])return!0}),XV=function(e){return function(t,r){return e!==void 0?+e(t,r)||0:r!==r?-1:t!==t?1:t===0&&r===0?1/t>0&&1/r<0?1:-1:t>r}};YV("sort",function(t){return t!==void 0&&VV(t),p_?Hs(this,t):zV(JV(this),XV(t))},!p_||QV);var CT=xt,ZV=mi,h_=es,ez=Af,tz=CT.aTypedArray,rz=CT.exportTypedArrayMethod;rz("subarray",function(t,r){var n=tz(this),i=n.length,a=h_(t,i),s=ez(n);return new s(n.buffer,n.byteOffset+a*n.BYTES_PER_ELEMENT,ZV((r===void 0?i:h_(r,i))-a))});var nz=dt,iz=na,RT=xt,Mh=et,v_=fo,Pc=nz.Int8Array,g_=RT.aTypedArray,az=RT.exportTypedArrayMethod,OT=[].toLocaleString,sz=!!Pc&&Mh(function(){OT.call(new Pc(1))}),oz=Mh(function(){return[1,2].toLocaleString()!=new Pc([1,2]).toLocaleString()})||!Mh(function(){Pc.prototype.toLocaleString.call([1,2])});az("toLocaleString",function(){return iz(OT,sz?v_(g_(this)):g_(this),v_(arguments))},oz);var uz=xt.exportTypedArrayMethod,lz=et,cz=dt,fz=Qe,y_=cz.Uint8Array,dz=y_&&y_.prototype||{},Mc=[].toString,pz=fz([].join);lz(function(){Mc.call({})})&&(Mc=function(){return pz(this)});var hz=dz.toString!=Mc;uz("toString",Mc,hz);var vz=Gt,gz=ta,yz=Ct,mz=yz("match"),AT=function(e){var t;return vz(e)&&((t=e[mz])!==void 0?!!t:gz(e)=="RegExp")},bz=na,Wo=Pt,Bg=Qe,wz=_f,_z=Zt,Sz=Gn,$z=AT,m_=Vn,kz=Fv,Tz=ug,Ez=mi,rp=fr,Iz=Xa,b_=Vu,w_=Sf,Cz=wf,Rz=q0,Oz=et,_s=Rz.UNSUPPORTED_Y,__=4294967295,Az=Math.min,PT=[].push,Pz=Bg(/./.exec),Ss=Bg(PT),Ho=Bg("".slice),Mz=!Oz(function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var r="ab".split(e);return r.length!==2||r[0]!=="a"||r[1]!=="b"});wz("split",function(e,t,r){var n;return"abbc".split(/(b)*/)[1]=="c"||"test".split(/(?:)/,-1).length!=4||"ab".split(/(?:ab)*/).length!=2||".".split(/(.?)(.?)/).length!=4||".".split(/()()/).length>1||"".split(/.?/).length?n=function(i,a){var s=rp(m_(this)),u=a===void 0?__:a>>>0;if(u===0)return[];if(i===void 0)return[s];if(!$z(i))return Wo(t,s,i,u);for(var o=[],c=(i.ignoreCase?"i":"")+(i.multiline?"m":"")+(i.unicode?"u":"")+(i.sticky?"y":""),d=0,y=new RegExp(i.source,c+"g"),_,w,k;(_=Wo(Cz,y,s))&&(w=y.lastIndex,!(w>d&&(Ss(o,Ho(s,d,_.index)),_.length>1&&_.index<s.length&&bz(PT,o,b_(_,1)),k=_[0].length,d=w,o.length>=u)));)y.lastIndex===_.index&&y.lastIndex++;return d===s.length?(k||!Pz(y,""))&&Ss(o,""):Ss(o,Ho(s,d)),o.length>u?b_(o,0,u):o}:"0".split(void 0,0).length?n=function(i,a){return i===void 0&&a===0?[]:Wo(t,this,i,a)}:n=t,[function(a,s){var u=m_(this),o=Sz(a)?void 0:Iz(a,e);return o?Wo(o,a,u,s):Wo(n,rp(u),a,s)},function(i,a){var s=_z(this),u=rp(i),o=r(n,s,u,a,n!==t);if(o.done)return o.value;var c=kz(s,RegExp),d=s.unicode,y=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(_s?"g":"y"),_=new c(_s?"^(?:"+s.source+")":s,y),w=a===void 0?__:a>>>0;if(w===0)return[];if(u.length===0)return w_(_,u)===null?[u]:[];for(var k=0,N=0,M=[];N<u.length;){_.lastIndex=_s?0:N;var L=w_(_,_s?Ho(u,N):u),B;if(L===null||(B=Az(Ez(_.lastIndex+(_s?N:0)),u.length))===k)N=Tz(u,N,d);else{if(Ss(M,Ho(u,k,N)),M.length===w)return M;for(var ve=1;ve<=L.length-1;ve++)if(Ss(M,L[ve]),M.length===w)return M;N=k=B}}return Ss(M,Ho(u,k)),M}]},!Mz,_s);var qg={exports:{}},MT={exports:{}};(function(e){function t(r){return Function.toString.call(r).indexOf("[native code]")!==-1}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(MT);var NT={exports:{}},xT={exports:{}};(function(e){function t(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports})(xT);(function(e){var t=ff.exports,r=xT.exports;function n(i,a,s){return r()?(e.exports=n=Reflect.construct.bind(),e.exports.__esModule=!0,e.exports.default=e.exports):(e.exports=n=function(o,c,d){var y=[null];y.push.apply(y,c);var _=Function.bind.apply(o,y),w=new _;return d&&t(w,d.prototype),w},e.exports.__esModule=!0,e.exports.default=e.exports),n.apply(null,arguments)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports})(NT);(function(e){var t=zn.exports,r=ff.exports,n=MT.exports,i=NT.exports;function a(s){var u=typeof Map=="function"?new Map:void 0;return e.exports=a=function(c){if(c===null||!n(c))return c;if(typeof c!="function")throw new TypeError("Super expression must either be null or a function");if(typeof u<"u"){if(u.has(c))return u.get(c);u.set(c,d)}function d(){return i(c,arguments,t(this).constructor)}return d.prototype=Object.create(c.prototype,{constructor:{value:d,enumerable:!1,writable:!0,configurable:!0}}),r(d,c)},e.exports.__esModule=!0,e.exports.default=e.exports,a(s)}e.exports=a,e.exports.__esModule=!0,e.exports.default=e.exports})(qg);var Nc={exports:{}};/*!
 * Platform.js v1.3.6
 * Copyright 2014-2020 Benjamin Tan
 * Copyright 2011-2013 John-David Dalton
 * Available under MIT license
 */(function(e,t){(function(){var r={function:!0,object:!0},n=r[typeof window]&&window||this,i=t,a=e&&!e.nodeType&&e,s=i&&a&&typeof $n=="object"&&$n;s&&(s.global===s||s.window===s||s.self===s)&&(n=s);var u=Math.pow(2,53)-1,o=/\bOpera/,c=Object.prototype,d=c.hasOwnProperty,y=c.toString;function _(x){return x=String(x),x.charAt(0).toUpperCase()+x.slice(1)}function w(x,le,F){var Se={"10.0":"10","6.4":"10 Technical Preview","6.3":"8.1","6.2":"8","6.1":"Server 2008 R2 / 7","6.0":"Server 2008 / Vista","5.2":"Server 2003 / XP 64-bit","5.1":"XP","5.01":"2000 SP1","5.0":"2000","4.0":"NT","4.90":"ME"};return le&&F&&/^Win/i.test(x)&&!/^Windows Phone /i.test(x)&&(Se=Se[/[\d.]+$/.exec(x)])&&(x="Windows "+Se),x=String(x),le&&F&&(x=x.replace(RegExp(le,"i"),F)),x=N(x.replace(/ ce$/i," CE").replace(/\bhpw/i,"web").replace(/\bMacintosh\b/,"Mac OS").replace(/_PowerPC\b/i," OS").replace(/\b(OS X) [^ \d]+/i,"$1").replace(/\bMac (OS X)\b/,"$1").replace(/\/(\d)/," $1").replace(/_/g,".").replace(/(?: BePC|[ .]*fc[ \d.]+)$/i,"").replace(/\bx86\.64\b/gi,"x86_64").replace(/\b(Windows Phone) OS\b/,"$1").replace(/\b(Chrome OS \w+) [\d.]+\b/,"$1").split(" on ")[0]),x}function k(x,le){var F=-1,Se=x?x.length:0;if(typeof Se=="number"&&Se>-1&&Se<=u)for(;++F<Se;)le(x[F],F,x);else M(x,le)}function N(x){return x=Me(x),/^(?:webOS|i(?:OS|P))/.test(x)?x:_(x)}function M(x,le){for(var F in x)d.call(x,F)&&le(x[F],F,x)}function L(x){return x==null?_(x):y.call(x).slice(8,-1)}function B(x,le){var F=x!=null?typeof x[le]:"number";return!/^(?:boolean|number|string|undefined)$/.test(F)&&(F=="object"?!!x[le]:!0)}function ve(x){return String(x).replace(/([ -])(?!$)/g,"$1?")}function ue(x,le){var F=null;return k(x,function(Se,Ee){F=le(F,Se,Ee,x)}),F}function Me(x){return String(x).replace(/^ +| +$/g,"")}function Re(x){var le=n,F=x&&typeof x=="object"&&L(x)!="String";F&&(le=x,x=null);var Se=le.navigator||{},Ee=Se.userAgent||"";x||(x=Ee);var oe=F?!!Se.likeChrome:/\bChrome\b/.test(x)&&!/internal|\n/i.test(y.toString()),te="Object",ae=F?te:"ScriptBridgingProxyObject",ne=F?te:"Environment",be=F&&le.java?"JavaPackage":L(le.java),A=F?te:"RuntimeObject",Le=/\bJava/.test(be)&&le.java,at=Le&&L(le.environment)==ne,We=Le?"a":"\u03B1",fe=Le?"b":"\u03B2",V=le.document||{},Q=le.operamini||le.opera,$=o.test($=F&&Q?Q["[[Class]]"]:L(Q))?$:Q=null,I,Z=x,re=[],Ie=null,xe=x==Ee,ce=xe&&Q&&typeof Q.version=="function"&&Q.version(),$e,E=ke([{label:"EdgeHTML",pattern:"Edge"},"Trident",{label:"WebKit",pattern:"AppleWebKit"},"iCab","Presto","NetFront","Tasman","KHTML","Gecko"]),T=W(["Adobe AIR","Arora","Avant Browser","Breach","Camino","Electron","Epiphany","Fennec","Flock","Galeon","GreenBrowser","iCab","Iceweasel","K-Meleon","Konqueror","Lunascape","Maxthon",{label:"Microsoft Edge",pattern:"(?:Edge|Edg|EdgA|EdgiOS)"},"Midori","Nook Browser","PaleMoon","PhantomJS","Raven","Rekonq","RockMelt",{label:"Samsung Internet",pattern:"SamsungBrowser"},"SeaMonkey",{label:"Silk",pattern:"(?:Cloud9|Silk-Accelerated)"},"Sleipnir","SlimBrowser",{label:"SRWare Iron",pattern:"Iron"},"Sunrise","Swiftfox","Vivaldi","Waterfox","WebPositive",{label:"Yandex Browser",pattern:"YaBrowser"},{label:"UC Browser",pattern:"UCBrowser"},"Opera Mini",{label:"Opera Mini",pattern:"OPiOS"},"Opera",{label:"Opera",pattern:"OPR"},"Chromium","Chrome",{label:"Chrome",pattern:"(?:HeadlessChrome)"},{label:"Chrome Mobile",pattern:"(?:CriOS|CrMo)"},{label:"Firefox",pattern:"(?:Firefox|Minefield)"},{label:"Firefox for iOS",pattern:"FxiOS"},{label:"IE",pattern:"IEMobile"},{label:"IE",pattern:"MSIE"},"Safari"]),G=R([{label:"BlackBerry",pattern:"BB10"},"BlackBerry",{label:"Galaxy S",pattern:"GT-I9000"},{label:"Galaxy S2",pattern:"GT-I9100"},{label:"Galaxy S3",pattern:"GT-I9300"},{label:"Galaxy S4",pattern:"GT-I9500"},{label:"Galaxy S5",pattern:"SM-G900"},{label:"Galaxy S6",pattern:"SM-G920"},{label:"Galaxy S6 Edge",pattern:"SM-G925"},{label:"Galaxy S7",pattern:"SM-G930"},{label:"Galaxy S7 Edge",pattern:"SM-G935"},"Google TV","Lumia","iPad","iPod","iPhone","Kindle",{label:"Kindle Fire",pattern:"(?:Cloud9|Silk-Accelerated)"},"Nexus","Nook","PlayBook","PlayStation Vita","PlayStation","TouchPad","Transformer",{label:"Wii U",pattern:"WiiU"},"Wii","Xbox One",{label:"Xbox 360",pattern:"Xbox"},"Xoom"]),ee=J({Apple:{iPad:1,iPhone:1,iPod:1},Alcatel:{},Archos:{},Amazon:{Kindle:1,"Kindle Fire":1},Asus:{Transformer:1},"Barnes & Noble":{Nook:1},BlackBerry:{PlayBook:1},Google:{"Google TV":1,Nexus:1},HP:{TouchPad:1},HTC:{},Huawei:{},Lenovo:{},LG:{},Microsoft:{Xbox:1,"Xbox One":1},Motorola:{Xoom:1},Nintendo:{"Wii U":1,Wii:1},Nokia:{Lumia:1},Oppo:{},Samsung:{"Galaxy S":1,"Galaxy S2":1,"Galaxy S3":1,"Galaxy S4":1},Sony:{PlayStation:1,"PlayStation Vita":1},Xiaomi:{Mi:1,Redmi:1}}),q=pe(["Windows Phone","KaiOS","Android","CentOS",{label:"Chrome OS",pattern:"CrOS"},"Debian",{label:"DragonFly BSD",pattern:"DragonFly"},"Fedora","FreeBSD","Gentoo","Haiku","Kubuntu","Linux Mint","OpenBSD","Red Hat","SuSE","Ubuntu","Xubuntu","Cygwin","Symbian OS","hpwOS","webOS ","webOS","Tablet OS","Tizen","Linux","Mac OS X","Macintosh","Mac","Windows 98;","Windows "]);function ke(je){return ue(je,function(De,Ue){return De||RegExp("\\b"+(Ue.pattern||ve(Ue))+"\\b","i").exec(x)&&(Ue.label||Ue)})}function J(je){return ue(je,function(De,Ue,Ve){return De||(Ue[G]||Ue[/^[a-z]+(?: +[a-z]+\b)*/i.exec(G)]||RegExp("\\b"+ve(Ve)+"(?:\\b|\\w*\\d)","i").exec(x))&&Ve})}function W(je){return ue(je,function(De,Ue){return De||RegExp("\\b"+(Ue.pattern||ve(Ue))+"\\b","i").exec(x)&&(Ue.label||Ue)})}function pe(je){return ue(je,function(De,Ue){var Ve=Ue.pattern||ve(Ue);return!De&&(De=RegExp("\\b"+Ve+"(?:/[\\d.]+|[ \\w.]*)","i").exec(x))&&(De=w(De,Ve,Ue.label||Ue)),De})}function R(je){return ue(je,function(De,Ue){var Ve=Ue.pattern||ve(Ue);return!De&&(De=RegExp("\\b"+Ve+" *\\d+[.\\w_]*","i").exec(x)||RegExp("\\b"+Ve+" *\\w+-[\\w]*","i").exec(x)||RegExp("\\b"+Ve+"(?:; *(?:[a-z]+[_-])?[a-z]+\\d+|[^ ();-]*)","i").exec(x))&&((De=String(Ue.label&&!RegExp(Ve,"i").test(Ue.label)?Ue.label:De).split("/"))[1]&&!/[\d.]+/.test(De[0])&&(De[0]+=" "+De[1]),Ue=Ue.label||Ue,De=N(De[0].replace(RegExp(Ve,"i"),Ue).replace(RegExp("; *(?:"+Ue+"[_-])?","i")," ").replace(RegExp("("+Ue+")[-_.]?(\\w)","i"),"$1 $2"))),De})}function Te(je){return ue(je,function(De,Ue){return De||(RegExp(Ue+"(?:-[\\d.]+/|(?: for [\\w-]+)?[ /-])([\\d.]+[^ ();/_-]*)","i").exec(x)||0)[1]||null})}function Ne(){return this.description||""}if(E&&(E=[E]),/\bAndroid\b/.test(q)&&!G&&(I=/\bAndroid[^;]*;(.*?)(?:Build|\) AppleWebKit)\b/i.exec(x))&&(G=Me(I[1]).replace(/^[a-z]{2}-[a-z]{2};\s*/i,"")||null),ee&&!G?G=R([ee]):ee&&G&&(G=G.replace(RegExp("^("+ve(ee)+")[-_.\\s]","i"),ee+" ").replace(RegExp("^("+ve(ee)+")[-_.]?(\\w)","i"),ee+" $2")),(I=/\bGoogle TV\b/.exec(G))&&(G=I[0]),/\bSimulator\b/i.test(x)&&(G=(G?G+" ":"")+"Simulator"),T=="Opera Mini"&&/\bOPiOS\b/.test(x)&&re.push("running in Turbo/Uncompressed mode"),T=="IE"&&/\blike iPhone OS\b/.test(x)?(I=Re(x.replace(/like iPhone OS/,"")),ee=I.manufacturer,G=I.product):/^iP/.test(G)?(T||(T="Safari"),q="iOS"+((I=/ OS ([\d_]+)/i.exec(x))?" "+I[1].replace(/_/g,"."):"")):T=="Konqueror"&&/^Linux\b/i.test(q)?q="Kubuntu":ee&&ee!="Google"&&(/Chrome/.test(T)&&!/\bMobile Safari\b/i.test(x)||/\bVita\b/.test(G))||/\bAndroid\b/.test(q)&&/^Chrome/.test(T)&&/\bVersion\//i.test(x)?(T="Android Browser",q=/\bAndroid\b/.test(q)?q:"Android"):T=="Silk"?(/\bMobi/i.test(x)||(q="Android",re.unshift("desktop mode")),/Accelerated *= *true/i.test(x)&&re.unshift("accelerated")):T=="UC Browser"&&/\bUCWEB\b/.test(x)?re.push("speed mode"):T=="PaleMoon"&&(I=/\bFirefox\/([\d.]+)\b/.exec(x))?re.push("identifying as Firefox "+I[1]):T=="Firefox"&&(I=/\b(Mobile|Tablet|TV)\b/i.exec(x))?(q||(q="Firefox OS"),G||(G=I[1])):!T||(I=!/\bMinefield\b/i.test(x)&&/\b(?:Firefox|Safari)\b/.exec(T))?(T&&!G&&/[\/,]|^[^(]+?\)/.test(x.slice(x.indexOf(I+"/")+8))&&(T=null),(I=G||ee||q)&&(G||ee||/\b(?:Android|Symbian OS|Tablet OS|webOS)\b/.test(q))&&(T=/[a-z]+(?: Hat)?/i.exec(/\bAndroid\b/.test(q)?q:I)+" Browser")):T=="Electron"&&(I=(/\bChrome\/([\d.]+)\b/.exec(x)||0)[1])&&re.push("Chromium "+I),ce||(ce=Te(["(?:Cloud9|CriOS|CrMo|Edge|Edg|EdgA|EdgiOS|FxiOS|HeadlessChrome|IEMobile|Iron|Opera ?Mini|OPiOS|OPR|Raven|SamsungBrowser|Silk(?!/[\\d.]+$)|UCBrowser|YaBrowser)","Version",ve(T),"(?:Firefox|Minefield|NetFront)"])),(I=E=="iCab"&&parseFloat(ce)>3&&"WebKit"||/\bOpera\b/.test(T)&&(/\bOPR\b/.test(x)?"Blink":"Presto")||/\b(?:Midori|Nook|Safari)\b/i.test(x)&&!/^(?:Trident|EdgeHTML)$/.test(E)&&"WebKit"||!E&&/\bMSIE\b/i.test(x)&&(q=="Mac OS"?"Tasman":"Trident")||E=="WebKit"&&/\bPlayStation\b(?! Vita\b)/i.test(T)&&"NetFront")&&(E=[I]),T=="IE"&&(I=(/; *(?:XBLWP|ZuneWP)(\d+)/i.exec(x)||0)[1])?(T+=" Mobile",q="Windows Phone "+(/\+$/.test(I)?I:I+".x"),re.unshift("desktop mode")):/\bWPDesktop\b/i.test(x)?(T="IE Mobile",q="Windows Phone 8.x",re.unshift("desktop mode"),ce||(ce=(/\brv:([\d.]+)/.exec(x)||0)[1])):T!="IE"&&E=="Trident"&&(I=/\brv:([\d.]+)/.exec(x))&&(T&&re.push("identifying as "+T+(ce?" "+ce:"")),T="IE",ce=I[1]),xe){if(B(le,"global"))if(Le&&(I=Le.lang.System,Z=I.getProperty("os.arch"),q=q||I.getProperty("os.name")+" "+I.getProperty("os.version")),at){try{ce=le.require("ringo/engine").version.join("."),T="RingoJS"}catch{(I=le.system)&&I.global.system==le.system&&(T="Narwhal",q||(q=I[0].os||null))}T||(T="Rhino")}else typeof le.process=="object"&&!le.process.browser&&(I=le.process)&&(typeof I.versions=="object"&&(typeof I.versions.electron=="string"?(re.push("Node "+I.versions.node),T="Electron",ce=I.versions.electron):typeof I.versions.nw=="string"&&(re.push("Chromium "+ce,"Node "+I.versions.node),T="NW.js",ce=I.versions.nw)),T||(T="Node.js",Z=I.arch,q=I.platform,ce=/[\d.]+/.exec(I.version),ce=ce?ce[0]:null));else L(I=le.runtime)==ae?(T="Adobe AIR",q=I.flash.system.Capabilities.os):L(I=le.phantom)==A?(T="PhantomJS",ce=(I=I.version||null)&&I.major+"."+I.minor+"."+I.patch):typeof V.documentMode=="number"&&(I=/\bTrident\/(\d+)/i.exec(x))?(ce=[ce,V.documentMode],(I=+I[1]+4)!=ce[1]&&(re.push("IE "+ce[1]+" mode"),E&&(E[1]=""),ce[1]=I),ce=T=="IE"?String(ce[1].toFixed(1)):ce[0]):typeof V.documentMode=="number"&&/^(?:Chrome|Firefox)\b/.test(T)&&(re.push("masking as "+T+" "+ce),T="IE",ce="11.0",E=["Trident"],q="Windows");q=q&&N(q)}if(ce&&(I=/(?:[ab]|dp|pre|[ab]\d+pre)(?:\d+\+?)?$/i.exec(ce)||/(?:alpha|beta)(?: ?\d)?/i.exec(x+";"+(xe&&Se.appMinorVersion))||/\bMinefield\b/i.test(x)&&"a")&&(Ie=/b/i.test(I)?"beta":"alpha",ce=ce.replace(RegExp(I+"\\+?$"),"")+(Ie=="beta"?fe:We)+(/\d+\+?/.exec(I)||"")),T=="Fennec"||T=="Firefox"&&/\b(?:Android|Firefox OS|KaiOS)\b/.test(q))T="Firefox Mobile";else if(T=="Maxthon"&&ce)ce=ce.replace(/\.[\d.]+/,".x");else if(/\bXbox\b/i.test(G))G=="Xbox 360"&&(q=null),G=="Xbox 360"&&/\bIEMobile\b/.test(x)&&re.unshift("mobile mode");else if((/^(?:Chrome|IE|Opera)$/.test(T)||T&&!G&&!/Browser|Mobi/.test(T))&&(q=="Windows CE"||/Mobi/i.test(x)))T+=" Mobile";else if(T=="IE"&&xe)try{le.external===null&&re.unshift("platform preview")}catch{re.unshift("embedded")}else(/\bBlackBerry\b/.test(G)||/\bBB10\b/.test(x))&&(I=(RegExp(G.replace(/ +/g," *")+"/([.\\d]+)","i").exec(x)||0)[1]||ce)?(I=[I,/BB10/.test(x)],q=(I[1]?(G=null,ee="BlackBerry"):"Device Software")+" "+I[0],ce=null):this!=M&&G!="Wii"&&(xe&&Q||/Opera/.test(T)&&/\b(?:MSIE|Firefox)\b/i.test(x)||T=="Firefox"&&/\bOS X (?:\d+\.){2,}/.test(q)||T=="IE"&&(q&&!/^Win/.test(q)&&ce>5.5||/\bWindows XP\b/.test(q)&&ce>8||ce==8&&!/\bTrident\b/.test(x)))&&!o.test(I=Re.call(M,x.replace(o,"")+";"))&&I.name&&(I="ing as "+I.name+((I=I.version)?" "+I:""),o.test(T)?(/\bIE\b/.test(I)&&q=="Mac OS"&&(q=null),I="identify"+I):(I="mask"+I,$?T=N($.replace(/([a-z])([A-Z])/g,"$1 $2")):T="Opera",/\bIE\b/.test(I)&&(q=null),xe||(ce=null)),E=["Presto"],re.push(I));(I=(/\bAppleWebKit\/([\d.]+\+?)/i.exec(x)||0)[1])&&(I=[parseFloat(I.replace(/\.(\d)$/,".0$1")),I],T=="Safari"&&I[1].slice(-1)=="+"?(T="WebKit Nightly",Ie="alpha",ce=I[1].slice(0,-1)):(ce==I[1]||ce==(I[2]=(/\bSafari\/([\d.]+\+?)/i.exec(x)||0)[1]))&&(ce=null),I[1]=(/\b(?:Headless)?Chrome\/([\d.]+)/i.exec(x)||0)[1],I[0]==537.36&&I[2]==537.36&&parseFloat(I[1])>=28&&E=="WebKit"&&(E=["Blink"]),!xe||!oe&&!I[1]?(E&&(E[1]="like Safari"),I=(I=I[0],I<400?1:I<500?2:I<526?3:I<533?4:I<534?"4+":I<535?5:I<537?6:I<538?7:I<601?8:I<602?9:I<604?10:I<606?11:I<608?12:"12")):(E&&(E[1]="like Chrome"),I=I[1]||(I=I[0],I<530?1:I<532?2:I<532.05?3:I<533?4:I<534.03?5:I<534.07?6:I<534.1?7:I<534.13?8:I<534.16?9:I<534.24?10:I<534.3?11:I<535.01?12:I<535.02?"13+":I<535.07?15:I<535.11?16:I<535.19?17:I<536.05?18:I<536.1?19:I<537.01?20:I<537.11?"21+":I<537.13?23:I<537.18?24:I<537.24?25:I<537.36?26:E!="Blink"?"27":"28")),E&&(E[1]+=" "+(I+=typeof I=="number"?".x":/[.+]/.test(I)?"":"+")),T=="Safari"&&(!ce||parseInt(ce)>45)?ce=I:T=="Chrome"&&/\bHeadlessChrome/i.test(x)&&re.unshift("headless")),T=="Opera"&&(I=/\bzbov|zvav$/.exec(q))?(T+=" ",re.unshift("desktop mode"),I=="zvav"?(T+="Mini",ce=null):T+="Mobile",q=q.replace(RegExp(" *"+I+"$"),"")):T=="Safari"&&/\bChrome\b/.exec(E&&E[1])?(re.unshift("desktop mode"),T="Chrome Mobile",ce=null,/\bOS X\b/.test(q)?(ee="Apple",q="iOS 4.3+"):q=null):/\bSRWare Iron\b/.test(T)&&!ce&&(ce=Te("Chrome")),ce&&ce.indexOf(I=/[\d.]+$/.exec(q))==0&&x.indexOf("/"+I+"-")>-1&&(q=Me(q.replace(I,""))),q&&q.indexOf(T)!=-1&&!RegExp(T+" OS").test(q)&&(q=q.replace(RegExp(" *"+ve(T)+" *"),"")),E&&!/\b(?:Avant|Nook)\b/.test(T)&&(/Browser|Lunascape|Maxthon/.test(T)||T!="Safari"&&/^iOS/.test(q)&&/\bSafari\b/.test(E[1])||/^(?:Adobe|Arora|Breach|Midori|Opera|Phantom|Rekonq|Rock|Samsung Internet|Sleipnir|SRWare Iron|Vivaldi|Web)/.test(T)&&E[1])&&(I=E[E.length-1])&&re.push(I),re.length&&(re=["("+re.join("; ")+")"]),ee&&G&&G.indexOf(ee)<0&&re.push("on "+ee),G&&re.push((/^on /.test(re[re.length-1])?"":"on ")+G),q&&(I=/ ([\d.+]+)$/.exec(q),$e=I&&q.charAt(q.length-I[0].length-1)=="/",q={architecture:32,family:I&&!$e?q.replace(I[0],""):q,version:I?I[1]:null,toString:function(){var je=this.version;return this.family+(je&&!$e?" "+je:"")+(this.architecture==64?" 64-bit":"")}}),(I=/\b(?:AMD|IA|Win|WOW|x86_|x)64\b/i.exec(Z))&&!/\bi686\b/i.test(Z)?(q&&(q.architecture=64,q.family=q.family.replace(RegExp(" *"+I),"")),T&&(/\bWOW64\b/i.test(x)||xe&&/\w(?:86|32)$/.test(Se.cpuClass||Se.platform)&&!/\bWin64; x64\b/i.test(x))&&re.unshift("32-bit")):q&&/^OS X/.test(q.family)&&T=="Chrome"&&parseFloat(ce)>=39&&(q.architecture=64),x||(x=null);var Oe={};return Oe.description=x,Oe.layout=E&&E[0],Oe.manufacturer=ee,Oe.name=T,Oe.prerelease=Ie,Oe.product=G,Oe.ua=x,Oe.version=T&&ce,Oe.os=q||{architecture:null,family:null,version:null,toString:function(){return"null"}},Oe.parse=Re,Oe.toString=Ne,Oe.version&&re.unshift(ce),Oe.name&&re.unshift(T),q&&T&&!(q==String(q).split(" ")[0]&&(q==T.split(" ")[0]||G))&&re.push(G?"("+q+")":"on "+q),re.length&&(Oe.description=re.join(" ")),Oe}var Ae=Re();i&&a?M(Ae,function(x,le){i[le]=x}):n.platform=Ae}).call($n)})(Nc,Nc.exports);var Nz=Pt,xz=_f,Lz=Zt,jz=Gn,Uz=mi,np=fr,Dz=Vn,Fz=Xa,Bz=ug,S_=Sf;xz("match",function(e,t,r){return[function(i){var a=Dz(this),s=jz(i)?void 0:Fz(i,e);return s?Nz(s,i,a):new RegExp(i)[e](np(a))},function(n){var i=Lz(this),a=np(n),s=r(t,i,a);if(s.done)return s.value;if(!i.global)return S_(i,a);var u=i.unicode;i.lastIndex=0;for(var o=[],c=0,d;(d=S_(i,a))!==null;){var y=np(d[0]);o[c]=y,y===""&&(i.lastIndex=Bz(a,Uz(i.lastIndex),u)),c++}return c===0?null:o}]});var qz=Object.is||function(t,r){return t===r?t!==0||1/t===1/r:t!=t&&r!=r},Wz=Pt,Hz=_f,Gz=Zt,Vz=Gn,zz=Vn,$_=qz,k_=fr,Kz=Xa,Jz=Sf;Hz("search",function(e,t,r){return[function(i){var a=zz(this),s=Vz(i)?void 0:Kz(i,e);return s?Wz(s,i,a):new RegExp(i)[e](k_(a))},function(n){var i=Gz(this),a=k_(n),s=r(t,i,a);if(s.done)return s.value;var u=i.lastIndex;$_(u,0)||(i.lastIndex=0);var o=Jz(i,a);return $_(i.lastIndex,u)||(i.lastIndex=u),o===null?-1:o.index}]});var Yz=Bt,Qz=zu,Xz=TypeError,Zz=Object.getOwnPropertyDescriptor,e7=Yz&&!function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(e){return e instanceof TypeError}}(),t7=e7?function(e,t){if(Qz(e)&&!Zz(e,"length").writable)throw Xz("Cannot set read only .length");return e.length=t}:function(e,t){return e.length=t},r7=ft,n7=yr,i7=es,a7=yi,s7=br,o7=t7,u7=$0,l7=Nv,c7=po,ip=Mg,f7=Yu,d7=f7("splice"),p7=Math.max,h7=Math.min;r7({target:"Array",proto:!0,forced:!d7},{splice:function(t,r){var n=n7(this),i=s7(n),a=i7(t,i),s=arguments.length,u,o,c,d,y,_;for(s===0?u=o=0:s===1?(u=0,o=i-a):(u=s-2,o=h7(p7(a7(r),0),i-a)),u7(i+u-o),c=l7(n,o),d=0;d<o;d++)y=a+d,y in n&&c7(c,d,n[y]);if(c.length=o,u<o){for(d=a;d<i-o;d++)y=d+o,_=d+u,y in n?n[_]=n[y]:ip(n,_);for(d=i;d>i-o+u;d--)ip(n,d-1)}else if(u>o)for(d=i-o;d>a;d--)y=d+o-1,_=d+u-1,y in n?n[_]=n[y]:ip(n,_);for(d=0;d<u;d++)n[d+a]=arguments[d+2];return o7(n,i-o+u),c}});/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.


*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=ho.exports,n=ts.exports,i=sa.exports,a=Tf.exports,s=oa.exports,u=ua.exports,o=zn.exports,c=fa.exports,d=ca.exports,y=rl,_=la.exports,w=nr,k=yo.exports,N=_1.exports,M=If,L=qg.exports,B=Si,ve=Nc.exports;function ue(m){return m&&typeof m=="object"&&"default"in m?m:{default:m}}function Me(m){if(m&&m.__esModule)return m;var v=Object.create(null);return m&&Object.keys(m).forEach(function(l){if(l!=="default"){var p=Object.getOwnPropertyDescriptor(m,l);Object.defineProperty(v,l,p.get?p:{enumerable:!0,get:function(){return m[l]}})}}),v.default=m,Object.freeze(v)}var Re=ue(r),Ae=ue(n),x=ue(i),le=ue(a),F=ue(s),Se=ue(u),Ee=ue(o),oe=ue(c),te=ue(d),ae=ue(y),ne=ue(_),be=Me(k),A=Me(N),Le=ue(L),at=Me(ve);function We(m,v,l,p){var f=arguments.length,g=f<3?v:p===null?p=Object.getOwnPropertyDescriptor(v,l):p,h;if((typeof Reflect>"u"?"undefined":ne.default(Reflect))==="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(m,v,l,p);else for(var b=m.length-1;b>=0;b--)(h=m[b])&&(g=(f<3?h(g):f>3?h(v,l,g):h(v,l))||g);return f>3&&g&&Object.defineProperty(v,l,g),g}function fe(m,v){if((typeof Reflect>"u"?"undefined":ne.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(m,v)}var V;function Q(){}Q.prototype=Object.create(null);function $(){$.init.call(this)}$.EventEmitter=$,$.usingDomains=!1,$.prototype.domain=void 0,$.prototype._events=void 0,$.prototype._maxListeners=void 0,$.defaultMaxListeners=10,$.init=function(){this.domain=null,$.usingDomains&&V.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Q,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},$.prototype.setMaxListeners=function(v){if(typeof v!="number"||v<0||isNaN(v))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=v,this};function I(m){return m._maxListeners===void 0?$.defaultMaxListeners:m._maxListeners}$.prototype.getMaxListeners=function(){return I(this)};function Z(m,v,l){if(v)m.call(l);else for(var p=m.length,f=q(m,p),g=0;g<p;++g)f[g].call(l)}function re(m,v,l,p){if(v)m.call(l,p);else for(var f=m.length,g=q(m,f),h=0;h<f;++h)g[h].call(l,p)}function Ie(m,v,l,p,f){if(v)m.call(l,p,f);else for(var g=m.length,h=q(m,g),b=0;b<g;++b)h[b].call(l,p,f)}function xe(m,v,l,p,f,g){if(v)m.call(l,p,f,g);else for(var h=m.length,b=q(m,h),S=0;S<h;++S)b[S].call(l,p,f,g)}function ce(m,v,l,p){if(v)m.apply(l,p);else for(var f=m.length,g=q(m,f),h=0;h<f;++h)g[h].apply(l,p)}$.prototype.emit=function(v){var l,p,f,g,h,b,S,j=v==="error";if(b=this._events,b)j=j&&b.error==null;else if(!j)return!1;if(S=this.domain,j){if(l=arguments[1],S)l||(l=new Error('Uncaught, unspecified "error" event')),l.domainEmitter=this,l.domain=S,l.domainThrown=!1,S.emit("error",l);else{if(l instanceof Error)throw l;var D=new Error('Uncaught, unspecified "error" event. ('+l+")");throw D.context=l,D}return!1}if(p=b[v],!p)return!1;var z=typeof p=="function";switch(f=arguments.length,f){case 1:Z(p,z,this);break;case 2:re(p,z,this,arguments[1]);break;case 3:Ie(p,z,this,arguments[1],arguments[2]);break;case 4:xe(p,z,this,arguments[1],arguments[2],arguments[3]);break;default:for(g=new Array(f-1),h=1;h<f;h++)g[h-1]=arguments[h];ce(p,z,this,g)}return!0};function $e(m,v,l,p){var f,g,h;if(typeof l!="function")throw new TypeError('"listener" argument must be a function');if(g=m._events,g?(g.newListener&&(m.emit("newListener",v,l.listener?l.listener:l),g=m._events),h=g[v]):(g=m._events=new Q,m._eventsCount=0),!h)h=g[v]=l,++m._eventsCount;else if(typeof h=="function"?h=g[v]=p?[l,h]:[h,l]:p?h.unshift(l):h.push(l),!h.warned&&(f=I(m),f&&f>0&&h.length>f)){h.warned=!0;var b=new Error("Possible EventEmitter memory leak detected. "+h.length+" "+v+" listeners added. Use emitter.setMaxListeners() to increase limit");b.name="MaxListenersExceededWarning",b.emitter=m,b.type=v,b.count=h.length,E(b)}return m}function E(m){typeof console.warn=="function"?console.warn(m):console.log(m)}$.prototype.addListener=function(v,l){return $e(this,v,l,!1)},$.prototype.on=$.prototype.addListener,$.prototype.prependListener=function(v,l){return $e(this,v,l,!0)};function T(m,v,l){var p=!1;function f(){m.removeListener(v,f),p||(p=!0,l.apply(m,arguments))}return f.listener=l,f}$.prototype.once=function(v,l){if(typeof l!="function")throw new TypeError('"listener" argument must be a function');return this.on(v,T(this,v,l)),this},$.prototype.prependOnceListener=function(v,l){if(typeof l!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(v,T(this,v,l)),this},$.prototype.removeListener=function(v,l){var p,f,g,h,b;if(typeof l!="function")throw new TypeError('"listener" argument must be a function');if(f=this._events,!f)return this;if(p=f[v],!p)return this;if(p===l||p.listener&&p.listener===l)--this._eventsCount===0?this._events=new Q:(delete f[v],f.removeListener&&this.emit("removeListener",v,p.listener||l));else if(typeof p!="function"){for(g=-1,h=p.length;h-- >0;)if(p[h]===l||p[h].listener&&p[h].listener===l){b=p[h].listener,g=h;break}if(g<0)return this;if(p.length===1){if(p[0]=void 0,--this._eventsCount===0)return this._events=new Q,this;delete f[v]}else ee(p,g);f.removeListener&&this.emit("removeListener",v,b||l)}return this},$.prototype.off=function(m,v){return this.removeListener(m,v)},$.prototype.removeAllListeners=function(v){var l,p;if(p=this._events,!p)return this;if(!p.removeListener)return arguments.length===0?(this._events=new Q,this._eventsCount=0):p[v]&&(--this._eventsCount===0?this._events=new Q:delete p[v]),this;if(arguments.length===0){for(var f=Object.keys(p),g=0,h;g<f.length;++g)h=f[g],h!=="removeListener"&&this.removeAllListeners(h);return this.removeAllListeners("removeListener"),this._events=new Q,this._eventsCount=0,this}if(l=p[v],typeof l=="function")this.removeListener(v,l);else if(l)do this.removeListener(v,l[l.length-1]);while(l[0]);return this},$.prototype.listeners=function(v){var l,p,f=this._events;return f?(l=f[v],l?typeof l=="function"?p=[l.listener||l]:p=ke(l):p=[]):p=[],p},$.listenerCount=function(m,v){return typeof m.listenerCount=="function"?m.listenerCount(v):G.call(m,v)},$.prototype.listenerCount=G;function G(m){var v=this._events;if(v){var l=v[m];if(typeof l=="function")return 1;if(l)return l.length}return 0}$.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function ee(m,v){for(var l=v,p=l+1,f=m.length;p<f;l+=1,p+=1)m[l]=m[p];m.pop()}function q(m,v){for(var l=new Array(v);v--;)l[v]=m[v];return l}function ke(m){for(var v=new Array(m.length),l=0;l<v.length;++l)v[l]=m[l].listener||m[l];return v}var J=be.getLogger("twilsock");function W(m,v){return["".concat(new Date().toISOString()," Twilsock ").concat(m,":")].concat(Array.from(v))}var pe=function(){function m(v){oe.default(this,m),te.default(this,"prefix",""),this.prefix=v!=null&&v.length>0?" "+v+":":""}return Ae.default(m,[{key:"setLevel",value:function(l){J.setLevel(l)}},{key:"trace",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];J.trace.apply(null,W("T",p))}},{key:"debug",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];J.debug.apply(null,W("D",p))}},{key:"info",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];J.info.apply(null,W("I",p))}},{key:"warn",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];J.warn.apply(null,W("W",p))}},{key:"error",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];J.error.apply(null,W("E",p))}}],[{key:"setLevel",value:function(l){J.setLevel(l)}},{key:"trace",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];J.trace.apply(null,W("T",p))}},{key:"debug",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];J.debug.apply(null,W("D",p))}},{key:"info",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];J.info.apply(null,W("I",p))}},{key:"warn",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];J.warn.apply(null,W("W",p))}},{key:"error",value:function(){for(var l=arguments.length,p=new Array(l),f=0;f<l;f++)p[f]=arguments[f];J.error.apply(null,W("E",p))}}]),m}(),R=new pe(""),Te="0.12.2",Ne=function(){function m(v,l,p){oe.default(this,m),te.default(this,"confirmedCapabilities",new Set),this.activeGrant=l,this._token=v;var f=p.region||"us1",g="wss://tsock.".concat(f,".twilio.com/v3/wsconnect"),h=p.twilsock||p.Twilsock||{};this.url=h.uri||g,this._continuationToken=p.continuationToken?p.continuationToken:null,this.logLevel=p.logLevel?p.logLevel:"error",this.retryPolicy=p.retryPolicy?p.retryPolicy:{min:1*1e3,max:2*60*1e3,randomness:.2},this.clientMetadata=p.clientMetadata?p.clientMetadata:{},this.clientMetadata.ver=Te,this.initRegistrations=p.initRegistrations?p.initRegistrations:null,this.tweaks=p.tweaks?p.tweaks:null}return Ae.default(m,[{key:"token",get:function(){return this._token}},{key:"continuationToken",get:function(){return this._continuationToken}},{key:"updateToken",value:function(l){this._token=l}},{key:"updateContinuationToken",value:function(l){this._continuationToken=l}}]),m}(),Oe=function m(v){oe.default(this,m),this.id=v||"TM".concat(M.v4())};function je(m){var v=De();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function De(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ue=function(m){F.default(l,m);var v=je(l);function l(p,f,g,h,b){var S;return oe.default(this,l),S=v.call(this),te.default(x.default(S),"method","init"),S.token=p,S.continuation_token=f,S.metadata=g,S.registrations=h,S.tweaks=b,S.capabilities=["client_update","offline_storage","telemetry.v1"],S}return l}(Oe);function Ve(m){var v=Xe();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function Xe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var er=function(m){F.default(l,m);var v=Ve(l);function l(p,f,g,h,b,S,j){var D;return oe.default(this,l),D=v.call(this,p),D.continuationToken=f,D.continuationTokenStatus=h,D.offlineStorage=b,D.initRegistrations=S,D.debugInfo=j,D.confirmedCapabilities=g,D}return l}(Oe);function wr(m){var v=pn();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function pn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Cr=function(m){F.default(l,m);var v=wr(l);function l(p){var f;return oe.default(this,l),f=v.call(this),te.default(x.default(f),"method","update"),f.token=p,f}return l}(Oe);function mt(m){var v=jt();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function jt(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var se=function(m){F.default(l,m);var v=mt(l);function l(p,f,g){var h;return oe.default(this,l),h=v.call(this),te.default(x.default(h),"method","message"),h.active_grant=p,h.payload_type=f,h.http_request=g,h}return l}(Oe);function de(m){var v=Y();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function Y(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ie=function(m){F.default(l,m);var v=de(l);function l(p){var f;return oe.default(this,l),f=v.call(this,p),te.default(x.default(f),"method","reply"),te.default(x.default(f),"payload_type","application/json"),te.default(x.default(f),"status",{code:200,status:"OK"}),f}return l}(Oe);function X(m){var v=ye();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function ye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var we=function(m){F.default(l,m);var v=X(l);function l(){var p;return oe.default(this,l),p=v.call(this),te.default(x.default(p),"method","close"),p}return l}(Oe);function Pe(m){var v=Ye();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function Ye(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var st=function m(v,l,p,f,g,h){oe.default(this,m),this.start=v,this.end=l,this.title=p,this.details=f,this.id=g,this.type=h},Ze=function(m){F.default(l,m);var v=Pe(l);function l(p){var f;return oe.default(this,l),f=v.call(this),te.default(x.default(f),"method","telemetry.v1"),f.events=p,f}return l}(Oe);function Fe(m){var v=encodeURIComponent(m),l=v.replace(/%([0-9A-F]{2})/g,function(p,f){return String.fromCharCode(Number("0x"+f))});return l.length}function _r(m){var v=encodeURIComponent(m),l=v.replace(/%([0-9A-F]{2})/g,function(f,g){return String.fromCharCode(Number("0x"+g))}),p=new Uint8Array(l.length);return Array.prototype.forEach.call(l,function(f,g){p[g]=f.charCodeAt(0)}),p}function Je(m){var v=Array.prototype.map.call(m,function(p){return String.fromCharCode(p)}).join(""),l=v.replace(/(.)/g,function(p,f){var g=f.charCodeAt(0).toString(16).toUpperCase();return g.length<2&&(g="0"+g),"%"+g});return decodeURIComponent(l)}function qt(m){return JSON.parse(Je(m))}function Ut(m){for(var v="",l=0;l<m.length;++l){var p=String.fromCharCode(m[l]);if(v+=p,p==="\r"){l+=2;break}}var f=v.split(" ");return{size:l,protocol:f[0],version:f[1],headerSize:Number(f[2])}}var $i=function(){function m(){oe.default(this,m)}return Ae.default(m,null,[{key:"parse",value:function(l){var p=2,f=new Uint8Array(l),g=Ut(f);if(g.protocol!=="TWILSOCK"||g.version!=="V3.0")return R.error("unsupported protocol: ".concat(g.protocol," ver ").concat(g.version)),null;var h;try{h=qt(f.subarray(g.size,g.size+g.headerSize))}catch(D){return R.error("failed to parse message header",D,l),null}R.debug("message received: ",h.method),R.trace("message received: ",h);var b;if(h.payload_size>0){var S=p+g.size+g.headerSize,j=h.payload_size;if(!h.hasOwnProperty("payload_type")||h.payload_type.indexOf("application/json")===0)try{b=qt(f.subarray(S,S+j))}catch(D){return R.error("failed to parse message body",D,l),null}else h.payload_type.indexOf("text/plain")===0&&(b=Je(f.subarray(S,S+j)))}return{method:h.method,header:h,payload:b}}},{key:"createPacket",value:function(l){var p=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";l.payload_size=Fe(p);var f=JSON.stringify(l),g="TWILSOCK V3.0 "+Fe(f);R.debug("send request:",g+f+p);var h=_r(g+`\r
`+f+`\r
`+p);return h.buffer}}]),m}();function Kn(m){var v=An();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function An(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Et=function(m){F.default(l,m);var v=Kn(l);function l(p){return oe.default(this,l),v.call(this,p)}return l}(Le.default(Error));function Dt(m){var v=Lr();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function Lr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Rr=function(m){F.default(l,m);var v=Dt(l);function l(p,f){var g;return oe.default(this,l),g=v.call(this,p),g.reply=f,g}return l}(Et);function ha(m,v){var l=Object.keys(m);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(m);v&&(p=p.filter(function(f){return Object.getOwnPropertyDescriptor(m,f).enumerable})),l.push.apply(l,p)}return l}function ss(m){for(var v=1;v<arguments.length;v++){var l=arguments[v]!=null?arguments[v]:{};v%2?ha(Object(l),!0).forEach(function(p){te.default(m,p,l[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(m,Object.getOwnPropertyDescriptors(l)):ha(Object(l)).forEach(function(p){Object.defineProperty(m,p,Object.getOwnPropertyDescriptor(l,p))})}return m}function jr(m){var v=os();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function os(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var wo=function(m){F.default(l,m);var v=jr(l);function l(p){var f;return oe.default(this,l),f=v.call(this),te.default(x.default(f),"newBackoff",null),te.default(x.default(f),"usedBackoff",null),te.default(x.default(f),"retrier",null),f.options=p?ss({},p):{},f}return Ae.default(l,[{key:"inProgress",get:function(){return!!this.retrier}},{key:"start",value:function(){if(this.inProgress)throw new Error("Already waiting for next attempt, call finishAttempt(success : boolean) to finish it");this.createRetrier()}},{key:"stop",value:function(){this.cleanRetrier(),this.newBackoff=null,this.usedBackoff=null}},{key:"modifyBackoff",value:function(f){this.newBackoff=f}},{key:"attemptFailed",value:function(){if(!this.inProgress)throw new Error("No attempt is in progress");if(this.newBackoff){var f=!this.usedBackoff||this.usedBackoff<this.newBackoff;if(f)this.createRetrier();else{var g;(g=this.retrier)===null||g===void 0||g.failed(new Error)}}else{var h;(h=this.retrier)===null||h===void 0||h.failed(new Error)}}},{key:"cancel",value:function(){var f;(f=this.retrier)===null||f===void 0||f.cancel()}},{key:"cleanRetrier",value:function(){var f,g;(f=this.retrier)===null||f===void 0||f.removeAllListeners(),(g=this.retrier)===null||g===void 0||g.cancel(),this.retrier=null}},{key:"getRetryPolicy",value:function(){var f=ss({},this.options);return this.newBackoff&&(f.min=this.newBackoff,f.max=this.options.max&&this.options.max>this.newBackoff?this.options.max:this.newBackoff),f.maxAttemptsCount=this.options.maxAttemptsCount?this.options.maxAttemptsCount+1:void 0,f}},{key:"createRetrier",value:function(){var f=this;this.cleanRetrier();var g=this.getRetryPolicy();this.retrier=new B.Retrier(g),this.retrier.once("attempt",function(){var h,b;(h=f.retrier)===null||h===void 0||h.on("attempt",function(){return f.emit("attempt")}),(b=f.retrier)===null||b===void 0||b.failed(new Error("Skipping first attempt"))}),this.retrier.on("failed",function(h){return f.emit("failed",h)}),this.usedBackoff=this.newBackoff,this.newBackoff=null,this.retrier.start()}}]),l}($);function _o(m){var v=dr();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function dr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var hn=3e3;function zr(m){setTimeout(m,0)}var _t=function(m){F.default(l,m);var v=_o(l);function l(p,f,g){var h;oe.default(this,l),h=v.call(this),te.default(x.default(h),"disconnectingTimer",null),te.default(x.default(h),"disconnectedPromiseResolve",null),te.default(x.default(h),"terminalStates",["disconnected","rejected"]),te.default(x.default(h),"tokenExpiredSasCode",20104),te.default(x.default(h),"terminationReason","Connection is not initialized"),h.websocket=p,h.websocket.on("connected",function(){return h.fsm.socketConnected()}),h.websocket.on("disconnected",function(){return h.fsm.socketClosed()}),h.websocket.on("message",function(S){return h.onIncomingMessage(S)}),h.websocket.on("socketError",function(S){return h.emit("connectionError",{terminal:!1,message:"Socket error: ".concat(S.message),httpStatusCode:null,errorCode:null})}),h.transport=f,h.config=g,h.retrier=new wo(g.retryPolicy),h.retrier.on("attempt",function(){return h.retry()}),h.retrier.on("failed",function(S){R.warn("Retrying failed: ".concat(S.message)),h.disconnect()}),typeof window<"u"&&typeof window.addEventListener<"u"&&(window.addEventListener("online",function(){R.debug("Browser reported connectivity state: online"),h.resetBackoff(),h.fsm.systemOnline()}),window.addEventListener("offline",function(){R.debug("Browser reported connectivity state: offline"),h.websocket.close(),h.fsm.socketClosed()}));var b=A.factory({init:"disconnected",transitions:[{name:"userConnect",from:["disconnected","rejected"],to:"connecting"},{name:"userConnect",from:["connecting","connected"]},{name:"userDisconnect",from:["connecting","initialising","connected","updating","retrying","rejected","waitSocketClosed","waitOffloadSocketClosed"],to:"disconnecting"},{name:"userRetry",from:["retrying"],to:"connecting"},{name:"socketConnected",from:["connecting"],to:"initialising"},{name:"socketClosed",from:["connecting","initialising","connected","updating","error","waitOffloadSocketClosed"],to:"retrying"},{name:"socketClosed",from:["disconnecting"],to:"disconnected"},{name:"socketClosed",from:["waitSocketClosed"],to:"disconnected"},{name:"socketClosed",from:["rejected"],to:"rejected"},{name:"initSuccess",from:["initialising"],to:"connected"},{name:"initError",from:["initialising"],to:"error"},{name:"tokenRejected",from:["initialising","updating"],to:"rejected"},{name:"protocolError",from:["initialising","connected","updating"],to:"error"},{name:"receiveClose",from:["initialising","connected","updating"],to:"waitSocketClosed"},{name:"receiveOffload",from:["initialising","connected","updating"],to:"waitOffloadSocketClosed"},{name:"unsupportedProtocol",from:["initialising","connected","updating"],to:"unsupported"},{name:"receiveFatalClose",from:["initialising","connected","updating"],to:"unsupported"},{name:"userUpdateToken",from:["disconnected","rejected","connecting","retrying"],to:"connecting"},{name:"userUpdateToken",from:["connected"],to:"updating"},{name:"updateSuccess",from:["updating"],to:"connected"},{name:"updateError",from:["updating"],to:"error"},{name:"userSend",from:["connected"],to:"connected"},{name:"systemOnline",from:["retrying"],to:"connecting"}],methods:{onConnecting:function(){h.setupSocket(),h.emit("connecting")},onEnterInitialising:function(){h.sendInit()},onLeaveInitialising:function(){h.cancelInit()},onEnterUpdating:function(){h.sendUpdate()},onLeaveUpdating:function(){h.cancelUpdate()},onEnterRetrying:function(){h.initRetry(),h.emit("connecting")},onEnterConnected:function(){h.resetBackoff(),h.onConnected()},onUserUpdateToken:function(){h.resetBackoff()},onTokenRejected:function(){h.resetBackoff(),h.closeSocket(!0),h.finalizeSocket()},onUserDisconnect:function(){h.closeSocket(!0)},onEnterDisconnecting:function(){h.startDisconnectTimer()},onLeaveDisconnecting:function(){h.cancelDisconnectTimer()},onEnterWaitSocketClosed:function(){h.startDisconnectTimer()},onLeaveWaitSocketClosed:function(){h.cancelDisconnectTimer()},onEnterWaitOffloadSocketClosed:function(){h.startDisconnectTimer()},onLeaveWaitOffloadSocketClosed:function(){h.cancelDisconnectTimer()},onDisconnected:function(){h.resetBackoff(),h.finalizeSocket()},onReceiveClose:function(){h.onCloseReceived()},onReceiveOffload:function(j,D){R.debug("onreceiveoffload: ",D),h.modifyBackoff(D.body),h.onCloseReceived()},onUnsupported:function(){h.closeSocket(!0),h.finalizeSocket()},onError:function(j,D){h.closeSocket(D),h.finalizeSocket()},onEnterState:function(j){j.from!=="none"&&h.changeState(j)},onInvalidTransition:function(j,D,z){R.warn("FSM: unexpected transition",D,z)}}});return h.fsm=new b,h}return Ae.default(l,[{key:"changeState",value:function(f){R.debug("FSM: ".concat(f.transition,": ").concat(f.from," --> ").concat(f.to)),this.lastEmittedState!==this.state&&(this.lastEmittedState=this.state,this.emit("stateChanged",this.state))}},{key:"resetBackoff",value:function(){R.trace("resetBackoff"),this.retrier.stop()}},{key:"modifyBackoff",value:function(f){R.trace("modifyBackoff",f);var g=f?f.backoff_policy:null;g&&typeof g.reconnect_min_ms=="number"&&this.retrier.modifyBackoff(g.reconnect_min_ms)}},{key:"startDisconnectTimer",value:function(){var f=this;R.trace("startDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null),this.disconnectingTimer=setTimeout(function(){R.debug("disconnecting is timed out"),f.closeSocket(!0)},hn)}},{key:"cancelDisconnectTimer",value:function(){R.trace("cancelDisconnectTimer"),this.disconnectingTimer&&(clearTimeout(this.disconnectingTimer),this.disconnectingTimer=null)}},{key:"isConnected",get:function(){return this.state==="connected"&&this.websocket.isConnected}},{key:"state",get:function(){switch(this.fsm.state){case"connecting":case"initialising":case"retrying":case"error":return"connecting";case"updating":case"connected":return"connected";case"rejected":return"denied";case"disconnecting":case"waitSocketClosed":case"waitOffloadSocketClosed":return"disconnecting";case"disconnected":default:return"disconnected"}}},{key:"initRetry",value:function(){R.debug("initRetry"),this.retrier.inProgress?this.retrier.attemptFailed():this.retrier.start()}},{key:"retry",value:function(){this.fsm.state!="connecting"?(R.trace("retry"),this.websocket.close(),this.fsm.userRetry()):R.trace("can	 retry as already connecting")}},{key:"onConnected",value:function(){this.emit("connected")}},{key:"finalizeSocket",value:function(){R.trace("finalizeSocket"),this.websocket.close(),this.emit("disconnected"),this.disconnectedPromiseResolve&&(this.disconnectedPromiseResolve(),this.disconnectedPromiseResolve=null)}},{key:"setupSocket",value:function(){R.trace("setupSocket:",this.config.token),this.emit("beforeConnect"),this.websocket.connect()}},{key:"onIncomingMessage",value:function(f){var g=$i.parse(f);if(!!g){var h=g.method,b=g.header,S=g.payload;if(h!=="reply"&&this.confirmReceiving(b),h==="notification")this.emit("message",b.message_type,S);else if(b.method==="reply")this.transport.processReply({id:b.id,status:b.status,header:b,body:S});else if(b.method==="client_update")b.client_update_type==="token_about_to_expire"&&this.emit("tokenAboutToExpire");else if(b.method==="close")if(b.status.code===308)R.debug("Connection has been offloaded"),this.fsm.receiveOffload({status:b.status.status,body:S});else if(b.status.code===406){var j="Server closed connection because can't parse protocol: ".concat(JSON.stringify(b.status));this.emitReplyConnectionError(j,b,!0),R.error(j),this.fsm.receiveFatalClose()}else b.status.code===417?(R.error("Server closed connection because can't parse client reply: ".concat(JSON.stringify(b.status))),this.fsm.receiveFatalClose(b.status.status)):b.status.code===410?(R.warn("Server closed connection: ".concat(JSON.stringify(b.status))),this.fsm.receiveClose(b.status.status),this.emit("tokenExpired")):b.status.code===401?(R.error("Server closed connection: ".concat(JSON.stringify(b.status))),this.fsm.receiveClose(b.status.status)):(R.warn("unexpected message: ",b.status),this.fsm.receiveOffload({status:b.status.status,body:null}))}}},{key:"sendInit",value:function(){var p=Re.default(ae.default.mark(function g(){var h,b;return ae.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return R.trace("sendInit"),j.prev=1,this.emit("beforeSendInit"),j.next=5,this.transport.sendInit();case 5:h=j.sent,this.config.updateContinuationToken(h.continuationToken),this.config.confirmedCapabilities=h.confirmedCapabilities,this.fsm.initSuccess(h),this.emit("initialized",h),this.emit("tokenUpdated"),j.next=17;break;case 13:j.prev=13,j.t0=j.catch(1),j.t0 instanceof Rr?(b=!1,R.warn("Init rejected by server: ".concat(JSON.stringify(j.t0.reply.status))),this.emit("sendInitFailed"),j.t0.reply.status.code===401||j.t0.reply.status.code===403?(b=!0,this.fsm.tokenRejected(j.t0.reply.status),j.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):j.t0.reply.status.code===429?(this.modifyBackoff(j.t0.reply.body),this.fsm.initError(!0)):j.t0.reply.status.code===500?this.fsm.initError(!1):this.fsm.initError(!0),this.emitReplyConnectionError(j.t0.message,j.t0.reply,b)):(this.terminationReason=j.t0.message,this.emit("connectionError",{terminal:!0,message:"Unknown error during connection initialisation: ".concat(j.t0.message,`
`).concat(JSON.stringify(j.t0,null,2)),httpStatusCode:null,errorCode:null}),this.fsm.initError(!0)),this.emit("tokenUpdated",j.t0);case 17:case"end":return j.stop()}},g,this,[[1,13]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"sendUpdate",value:function(){var p=Re.default(ae.default.mark(function g(){var h,b,S;return ae.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return R.trace("sendUpdate"),h=new Cr(this.config.token),D.prev=2,D.next=5,this.transport.sendWithReply(h);case 5:b=D.sent,this.fsm.updateSuccess(b.body),this.emit("tokenUpdated"),D.next=14;break;case 10:D.prev=10,D.t0=D.catch(2),D.t0 instanceof Rr?(S=!1,R.warn("Token update rejected by server: ".concat(JSON.stringify(D.t0.reply.status))),D.t0.reply.status.code===401||D.t0.reply.status.code===403?(S=!0,this.fsm.tokenRejected(D.t0.reply.status),D.t0.reply.status.errorCode===this.tokenExpiredSasCode&&this.emit("tokenExpired")):D.t0.reply.status.code===429?(this.modifyBackoff(D.t0.reply.body),this.fsm.updateError(D.t0.reply.status)):this.fsm.updateError(D.t0.reply.status),this.emitReplyConnectionError(D.t0.message,D.t0.reply,S)):(this.emit("error",!1,D.t0.message,null,null),this.fsm.updateError(D.t0)),this.emit("tokenUpdated",D.t0);case 14:case"end":return D.stop()}},g,this,[[2,10]])}));function f(){return p.apply(this,arguments)}return f}()},{key:"emitReplyConnectionError",value:function(f,g,h){var b=g.status&&g.status.description?g.status.description:f,S=g.status.code,j=g.status&&g.status.errorCode?g.status.errorCode:null;h&&(this.terminationReason=b),this.emit("connectionError",{terminal:h,message:"Connection error: ".concat(b),httpStatusCode:S,errorCode:j})}},{key:"cancelInit",value:function(){R.trace("cancelInit")}},{key:"cancelUpdate",value:function(){R.trace("cancelUpdate")}},{key:"confirmReceiving",value:function(f){R.trace("confirmReceiving");try{this.transport.send(new ie(f.id))}catch(g){R.debug("failed to confirm packet receiving",g)}}},{key:"closeSocket",value:function(f){var g=this;R.trace("closeSocket (graceful: ".concat(f,")")),f&&this.transport.isConnected&&this.transport.sendClose(),this.websocket.close(),zr(function(){return g.fsm.socketClosed()})}},{key:"connect",value:function(){R.trace("connect"),this.fsm.userConnect()}},{key:"disconnect",value:function(){var f=this;return R.trace("disconnect"),this.fsm.is("disconnected")?Promise.resolve():new Promise(function(g){f.disconnectedPromiseResolve=g,f.fsm.userDisconnect()})}},{key:"updateToken",value:function(f){var g=this;return R.trace("updateToken:",f),new Promise(function(h,b){g.once("tokenUpdated",function(S){S?b(S):h()}),g.fsm.userUpdateToken()})}},{key:"isTerminalState",get:function(){return this.terminalStates.indexOf(this.fsm.state)!==-1}},{key:"getTerminationReason",get:function(){return this.terminationReason}},{key:"onCloseReceived",value:function(){this.websocket.close()}}]),l}($),So=function(){function m(){oe.default(this,m)}return Ae.default(m,null,[{key:"getMetadata",value:function(l){var p,f,g,h,b,S,j,D,z=l&&l.clientMetadata?l.clientMetadata:{},ge=["ver","env","envv","os","osv","osa","type","sdk","sdkv","dev","devv","devt","app","appv"],qe={env:(p=at.name)!==null&&p!==void 0?p:"unknown",envv:(f=at.version)!==null&&f!==void 0?f:"unknown",os:(g=(h=at.os)===null||h===void 0?void 0:h.family)!==null&&g!==void 0?g:"unknown",osv:(b=(S=at.os)===null||S===void 0?void 0:S.version)!==null&&b!==void 0?b:"unknown",osa:(j=(D=at.os)===null||D===void 0?void 0:D.architecture)!==null&&j!==void 0?j:"unknown",sdk:"js-default"},rt={};return ge.filter(function(He){return He in z||He in qe}).forEach(function(He){return rt[He]=He in z?z[He]:qe[He]}),rt}}]),m}(),$o=3e4;function ko(m){return m>=200&&m<300}function us(m){switch(ne.default(m)){case"undefined":return"";case"object":return JSON.stringify(m);default:return m}}var Jn=function(){function m(v,l){var p=this;oe.default(this,m),this.config=l,this.activeRequests=new Map,this.channel=v,this.channel.on("reply",function(f){return p.processReply(f)}),this.channel.on("disconnected",function(){p.activeRequests.forEach(function(f){clearTimeout(f.timeout),f.reject(new Et("disconnected"))}),p.activeRequests.clear()})}return Ae.default(m,[{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"processReply",value:function(l){var p=this.activeRequests.get(l.id);p&&(clearTimeout(p.timeout),this.activeRequests.delete(l.id),ko(l.status.code)?p.resolve(l):(p.reject(new Rr("Transport failure: "+l.status.status,l)),R.trace("message rejected")))}},{key:"storeRequest",value:function(l,p,f){var g={resolve:p,reject:f,timeout:setTimeout(function(){R.trace("request",l,"is timed out"),f(new Et("Twilsock: request timeout: "+l))},$o)};this.activeRequests.set(l,g)}},{key:"shutdown",value:function(){this.activeRequests.forEach(function(l){clearTimeout(l.timeout),l.reject(new Et("Twilsock: request cancelled by user"))}),this.activeRequests.clear()}},{key:"sendInit",value:function(){var v=Re.default(ae.default.mark(function p(){var f,g,h;return ae.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return R.trace("sendInit"),f=So.getMetadata(this.config),g=new Ue(this.config.token,this.config.continuationToken,f,this.config.initRegistrations,this.config.tweaks),S.next=5,this.sendWithReply(g);case 5:return h=S.sent,S.abrupt("return",new er(h.id,h.header.continuation_token,new Set(h.header.capabilities),h.header.continuation_token_status,h.header.offline_storage,h.header.init_registrations,h.header.debug_info));case 7:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"sendClose",value:function(){var l=new we;this.send(l)}},{key:"sendWithReply",value:function(l,p){var f=this;return new Promise(function(g,h){var b=f.send(l,p);f.storeRequest(b,g,h)})}},{key:"send",value:function(l,p){l.id=l.id||"TM".concat(M.v4());var f=$i.createPacket(l,us(p));try{return this.channel.send(f),l.id}catch(g){throw R.debug("failed to send ",l,g),R.trace(g.stack),g}}}]),m}();function To(m){var v=Eo();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function Eo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Kr=function(m){F.default(l,m);var v=To(l);function l(p){var f;return oe.default(this,l),f=v.call(this),te.default(x.default(f),"socket",null),f.url=p,f.url=p,f.WebSocket=t.WebSocket||t.MozWebSocket||{},f}return Ae.default(l,[{key:"isConnected",get:function(){return!!this.socket&&this.socket.readyState===1}},{key:"connect",value:function(){var f=this;R.trace("connecting to socket");var g;try{g=new this.WebSocket(this.url)}catch(h){R.debug("Socket error: ".concat(this.url)),this.emit("socketError",h);return}g.binaryType="arraybuffer",g.onopen=function(){R.debug("socket opened ".concat(f.url)),f.emit("connected")},g.onclose=function(h){R.debug("socket closed",h),f.emit("disconnected",h)},g.onerror=function(h){R.debug("Socket error:",h),f.emit("socketError",h)},g.onmessage=function(h){f.emit("message",h.data)},this.socket=g}},{key:"send",value:function(f){return this.socket&&this.socket.send(f)}},{key:"close",value:function(){if(R.trace("closing socket"),this.socket){this.socket.onopen=null,this.socket.onclose=null,this.socket.onerror=null,this.socket.onmessage=null;try{this.socket.close()}finally{}}}}]),l}($);function Sr(m){var v=Io();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function Io(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Co=function(m){F.default(l,m);var v=Sr(l);function l(p){var f;return oe.default(this,l),f=v.call(this),f.transport=p,f.registrations=new Map,f.registrationsInProgress=new Map,f}return Ae.default(l,[{key:"putNotificationContext",value:function(){var p=Re.default(ae.default.mark(function g(h,b){var S;return ae.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return S={method:"put_notification_ctx",notification_ctx_id:h},D.next=3,this.transport.sendWithReply(S,b);case 3:case"end":return D.stop()}},g,this)}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"deleteNotificationContext",value:function(){var p=Re.default(ae.default.mark(function g(h){var b;return ae.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return b={method:"delete_notification_ctx",notification_ctx_id:h},j.next=3,this.transport.sendWithReply(b);case 3:case"end":return j.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()},{key:"updateRegistration",value:function(){var p=Re.default(ae.default.mark(function g(h,b){var S,j;return ae.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return R.debug("update registration for context",h),S=this.registrationsInProgress.get(h),S||(S=new Set,this.registrationsInProgress.set(h,S)),j=M.v4(),S.add(j),z.prev=5,z.next=8,this.putNotificationContext(h,b);case 8:R.debug("registration attempt succeeded for context",b),S.delete(j),S.size===0&&(this.registrationsInProgress.delete(h),this.emit("registered",h)),z.next=19;break;case 13:z.prev=13,z.t0=z.catch(5),R.warn("registration attempt failed for context",b),R.debug(z.t0),S.delete(j),S.size===0&&(this.registrationsInProgress.delete(h),this.emit("registrationFailed",h,z.t0));case 19:case"end":return z.stop()}},g,this,[[5,13]])}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"updateRegistrations",value:function(){var p=Re.default(ae.default.mark(function g(){var h=this,b;return ae.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return R.trace("refreshing ".concat(this.registrations.size," registrations")),b=[],this.registrations.forEach(function(D,z){b.push(h.updateRegistration(z,D))}),j.next=5,Promise.all(b);case 5:case"end":return j.stop()}},g,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=Re.default(ae.default.mark(function g(h,b){return ae.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(!(!h||!b)){j.next=2;break}throw new Et("Invalid arguments provided");case 2:return this.registrations.set(h,b),j.next=5,this.updateRegistration(h,b);case 5:return j.abrupt("return",j.sent);case 6:case"end":return j.stop()}},g,this)}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=Re.default(ae.default.mark(function g(h){return ae.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(this.registrations.has(h)){S.next=2;break}return S.abrupt("return");case 2:return S.next=4,this.deleteNotificationContext(h);case 4:this.transport.isConnected&&this.registrations.delete(h);case 5:case"end":return S.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()}]),l}($);function Ro(m){var v=Oo();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function Oo(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ki=function(m){F.default(l,m);var v=Ro(l);function l(p,f,g){var h;return oe.default(this,l),h=v.call(this,f),h.status=p,h.description=f,h.body=g,h}return l}(Et);function Ti(m){var v=Ei();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function Ei(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var vn=function(m){F.default(l,m);var v=Ti(l);function l(p){return oe.default(this,l),v.call(this,p)}return l}(Et),va=2e4;function ls(m){return m>=200&&m<300}function cs(m){return m&&m.header&&m.header.http_status}function Ao(m){var v=m.match(/^(https?\:)\/\/(([^:\/?#]*)(?:\:([0-9]+))?)(\/[^?#]*)(\?[^#]*|)(#.*|)$/);if(v){var l={protocol:v[1],host:v[2],hostname:v[3],port:v[4],pathname:v[5],search:v[6],hash:v[7],params:{}};if(l.search.length>0){var p=l.search.substring(1);l.params=p.split("&").map(function(f){return f.split("=")}).reduce(function(f,g){return f.hasOwnProperty(g[0])?Array.isArray(f[g[0]])?f[g[0]].push(g[1]):f[g[0]]=[f[g[0]],g[1]]:f[g[0]]=g[1],f},{})}return l}throw new Et("Incorrect URI: "+m)}function Po(m,v){var l=Ao(v),p={method:m,host:l.host,path:l.pathname};return l.params&&(p.params=l.params),p}function St(m,v,l,p,f){return{to:Po(m,v),headers:l,body:p,grant:f}}var ga=function(){function m(v,l,p){oe.default(this,m),this.config=p,this.transport=v,this.pendingMessages=[],this.twilsock=l}return Ae.default(m,[{key:"saveMessage",value:function(l){var p=this;return new Promise(function(f,g){var h={message:l,resolve:f,reject:g,alreadyRejected:!1,timeout:setTimeout(function(){R.debug("request is timed out"),g(new Et("request '".concat(l.to.method,"' to '").concat(l.to.host,"' timed out"))),h.alreadyRejected=!0},va)};p.pendingMessages.push(h)})}},{key:"sendPendingMessages",value:function(){for(var l=this,p=function(){var h=l.pendingMessages[0];if(!h.alreadyRejected)try{var b=h.message;l.actualSend(b).then(function(S){return h.resolve(S)}).catch(function(S){return h.reject(S)}),clearTimeout(h.timeout)}catch(S){return R.debug("Failed to send pending message",S),"break"}l.pendingMessages.splice(0,1)};this.pendingMessages.length>0;){var f=p();if(f==="break")break}}},{key:"rejectPendingMessages",value:function(){var l=this;this.pendingMessages.forEach(function(p){p.reject(new vn("Unable to connect: "+l.twilsock.getTerminationReason)),p.alreadyRejected=!0,clearTimeout(p.timeout)}),this.pendingMessages.splice(0,this.pendingMessages.length)}},{key:"actualSend",value:function(){var v=Re.default(ae.default.mark(function p(f){var g,h,b,S,j,D,z,ge;return ae.default.wrap(function(rt){for(;;)switch(rt.prev=rt.next){case 0:return h=f.to,b=f.headers,S=f.body,j=(g=f.grant)!==null&&g!==void 0?g:this.config.activeGrant,D={host:h.host,path:h.path,method:h.method,params:h.params,headers:b},z=new se(j,b["Content-Type"]||"application/json",D),R.trace("Sending upstream message",z),rt.next=9,this.transport.sendWithReply(z,S);case 9:if(ge=rt.sent,R.trace("Received upstream message response",ge),!(cs(ge)&&!ls(ge.header.http_status.code))){rt.next=13;break}throw new ki(ge.header.http_status.code,ge.header.http_status.status,ge.body);case 13:return rt.abrupt("return",{status:ge.header.http_status,headers:ge.header.http_headers,body:ge.body});case 14:case"end":return rt.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"send",value:function(l,p){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},g=arguments.length>3?arguments[3]:void 0,h=arguments.length>4?arguments[4]:void 0;if(this.twilsock.isTerminalState)return Promise.reject(new vn("Unable to connect: "+this.twilsock.getTerminationReason));var b=St(l,p,f,g,h);return this.twilsock.isConnected?this.actualSend(b):this.saveMessage(b)}}]),m}(),fs=function(){function m(){var v=this;oe.default(this,m),this._promise=new Promise(function(l,p){v._resolve=l,v._reject=p})}return Ae.default(m,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(l){this._resolve(l)}},{key:"set",value:function(l){this._resolve(l)}},{key:"fail",value:function(l){this._reject(l)}}]),m}(),Ii=function(){function m(v){oe.default(this,m),this.id=v}return Ae.default(m,null,[{key:"create",value:function(l){if(l instanceof Object&&"storage_id"in l)return new m(l.storage_id);throw new Et('Field "storage_id" is missing')}}]),m}(),ya=function(){function m(){return oe.default(this,m),te.default(this,"initializedFlag","twilio_twilsock_token_storage"),te.default(this,"tokenStoragePrefix","twilio_continuation_token_"),m._instance||(this.initialize(),m._instance=this),m._instance}return Ae.default(m,[{key:"sessionStorage",value:function(){try{return t.sessionStorage}catch{return null}}},{key:"window",value:function(){try{return t.window}catch{return null}}},{key:"storeToken",value:function(l,p){this.canStore()&&this.sessionStorage.setItem(this.getKeyName(p),l)}},{key:"getStoredToken",value:function(l){return this.canStore()?this.sessionStorage.getItem(this.getKeyName(l)):null}},{key:"initialize",value:function(){var l=this;if(this.canStore()){var p=this.sessionStorage.getItem(this.initializedFlag);p&&this.clear(),this.sessionStorage.setItem(this.initializedFlag,"true");var f=this.sessionStorage.removeItem;this.window.addEventListener("unload",function(){f(l.initializedFlag)})}}},{key:"clear",value:function(){if(this.canStore()){for(var l=[],p=0;p<this.sessionStorage.length;p++){var f=this.sessionStorage.key(p);f&&f.indexOf(this.tokenStoragePrefix)===0&&l.push(f)}var g=this.sessionStorage.removeItem;l.forEach(function(h){return g(h)}),g(this.initializedFlag)}}},{key:"getKeyName",value:function(l){return"".concat(this.tokenStoragePrefix).concat(l)}},{key:"canStore",value:function(){return!!(this.sessionStorage&&this.sessionStorage.length&&this.window)}}]),m}();te.default(ya,"_instance",null);var Yn=new ya,Rt=function(){function m(v,l,p,f,g,h){oe.default(this,m),this.title=v,this.details=l,this.start=p,this.type=g,this.id=h,this.end=f}return Ae.default(m,[{key:"toTelemetryEvent",value:function(){var l=new Date,p=this.start,f=this.end?this.end:l;if(f<p){var g=f;f=p,p=g}var h=p.getTime()-l.getTime(),b=f.getTime()-l.getTime(),S=new st(h,b,this.title,this.details,this.id,this.type);return S}}]),m}();e.TelemetryPoint=void 0,function(m){m[m.Start=0]="Start",m[m.End=1]="End"}(e.TelemetryPoint||(e.TelemetryPoint={})),e.EventSendingLimitation=void 0,function(m){m[m.MinEventsPortion=0]="MinEventsPortion",m[m.AnyEvents=1]="AnyEvents",m[m.AnyEventsIncludingUnfinished=2]="AnyEventsIncludingUnfinished"}(e.EventSendingLimitation||(e.EventSendingLimitation={}));var Jr=function(){function m(v,l){oe.default(this,m),te.default(this,"minEventsPortionToSend",50),te.default(this,"maxEventsPortionToSend",100),te.default(this,"pendingEvents",new Map),te.default(this,"readyEvents",[]),te.default(this,"hasInitializationFinished",!1),te.default(this,"_canSendTelemetry",!1),this.config=v,this.packetInterface=l}return Ae.default(m,[{key:"isTelemetryEnabled",get:function(){return this.config.confirmedCapabilities.has("telemetry.v1")}},{key:"canSendTelemetry",get:function(){return this._canSendTelemetry&&this.isTelemetryEnabled},set:function(l){R.debug("TelemetryTracker.canSendTelemetry: ".concat(l," TelemetryTracker.isTelemetryEnabled: ").concat(this.isTelemetryEnabled)),this._canSendTelemetry&&!l&&(this.pendingEvents.clear(),this.readyEvents=[]),this._canSendTelemetry=l,l&&this.sendTelemetry(e.EventSendingLimitation.AnyEvents),l&&!this.hasInitializationFinished&&(this.hasInitializationFinished=!0)}},{key:"addTelemetryEvent",value:function(l){!this.canSendTelemetry&&this.hasInitializationFinished||this.readyEvents.push(l)}},{key:"addPartialEvent",value:function(l,p,f){R.debug("Adding ".concat(f===e.TelemetryPoint.Start?"starting":"ending"," timepoint for '").concat(p,"' event"));var g=this.pendingEvents.has(p);if(f===e.TelemetryPoint.Start)g&&R.debug("Overwriting starting point for '".concat(p,"' event")),this.pendingEvents.set(p,l);else{if(!g){R.info("Could not find started event for '".concat(p,"' event"));return}this.addTelemetryEvent(this.merge(this.pendingEvents.get(p),l)),this.pendingEvents.delete(p)}}},{key:"getTelemetryToSend",value:function(l){return!this.canSendTelemetry||this.readyEvents.length==0?[]:l==e.EventSendingLimitation.MinEventsPortion&&this.readyEvents.length<this.minEventsPortionToSend?[]:this.getTelemetryPortion(l==e.EventSendingLimitation.AnyEventsIncludingUnfinished)}},{key:"getTelemetryPortion",value:function(l){var p=this,f=Math.min(this.readyEvents.length,this.maxEventsPortionToSend),g=this.readyEvents.splice(0,f);return l&&g.length<this.maxEventsPortionToSend&&this.pendingEvents.forEach(function(h,b){if(!(g.length>=p.maxEventsPortionToSend)){var S=p.pendingEvents.get(b);p.pendingEvents.delete(b),g.push(new Rt("[UNFINISHED] ".concat(S.title),S.details,S.start,null,S.type,S.id))}}),g}},{key:"merge",value:function(l,p){return new Rt(p.title?p.title:l.title,p.details?p.details:l.details,l.start,p.end,p.type?p.type:l.type,p.id?p.id:l.id)}},{key:"sendTelemetryIfMinimalPortionCollected",value:function(){this.sendTelemetry(e.EventSendingLimitation.MinEventsPortion)}},{key:"sendTelemetry",value:function(l){var p=this.getTelemetryToSend(l);if(p.length!==0)try{this.packetInterface.send(new Ze(p.map(function(f){return f.toTelemetryEvent()})))}catch(f){R.debug("Error while sending ".concat(p.length," telemetry events due to ").concat(f,"; they will be resubmitted")),this.readyEvents=this.readyEvents.concat(p)}}}]),m}();function ma(m){var v=Yr();return function(){var p=Ee.default(m),f;if(v){var g=Ee.default(this).constructor;f=Reflect.construct(p,arguments,g)}else f=p.apply(this,arguments);return Se.default(this,f)}}function Yr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var C=function m(){oe.default(this,m)};te.default(C,"TWILSOCK_CONNECT","twilsock.sdk.connect"),te.default(C,"TWILSOCK_INIT","twilsock.sdk.init"),e.TwilsockClient=function(m){F.default(l,m);var v=ma(l);function l(p,f,g){var h;oe.default(this,l),h=v.call(this),te.default(x.default(h),"version",Te),te.default(x.default(h),"offlineStorageDeferred",new fs),g.continuationToken=g.continuationToken?g.continuationToken:Yn.getStoredToken(f);var b=h.config=new Ne(p,f,g);R.setLevel(b.logLevel);var S=new Kr(b.url),j=new Jn(S,b);return h.channel=new _t(S,j,b),h.registrations=new Co(j),h.upstream=new ga(j,h.channel,b),h.telemetryTracker=new Jr(b,j),h.channel.on("initialized",function(){return h.telemetryTracker.canSendTelemetry=!0}),S.on("disconnected",function(){return h.telemetryTracker.canSendTelemetry=!1}),h.registrations.on("registered",function(D){return h.emit("registered",D)}),h.channel.on("message",function(D,z){return setTimeout(function(){return h.emit("message",D,z)},0)}),h.channel.on("stateChanged",function(D){return setTimeout(function(){return h.emit("stateChanged",D)},0)}),h.channel.on("connectionError",function(D){return setTimeout(function(){return h.emit("connectionError",D)},0)}),h.channel.on("tokenAboutToExpire",function(){return setTimeout(function(){return h.emit("tokenAboutToExpire")},0)}),h.channel.on("tokenExpired",function(){return setTimeout(function(){return h.emit("tokenExpired")},0)}),h.channel.on("connected",function(){return h.registrations.updateRegistrations()}),h.channel.on("connected",function(){return h.upstream.sendPendingMessages()}),h.channel.on("connected",function(){return setTimeout(function(){return h.emit("connected")},0)}),h.channel.on("beforeConnect",function(){return h.telemetryTracker.addPartialEvent(new Rt("Establish WebSocket connection","",new Date),C.TWILSOCK_CONNECT,e.TelemetryPoint.Start)}),h.channel.on("connected",function(){return h.telemetryTracker.addPartialEvent(new Rt("Establish WebSocket connection","",new Date,new Date),C.TWILSOCK_CONNECT,e.TelemetryPoint.End)}),h.channel.on("beforeSendInit",function(){return h.telemetryTracker.addPartialEvent(new Rt("Send Twilsock init","",new Date),C.TWILSOCK_INIT,e.TelemetryPoint.Start)}),h.channel.on("initialized",function(){return h.telemetryTracker.addPartialEvent(new Rt("Send Twilsock init","Succeeded",new Date,new Date),C.TWILSOCK_INIT,e.TelemetryPoint.End)}),h.channel.on("sendInitFailed",function(){return h.telemetryTracker.addPartialEvent(new Rt("Send Twilsock init","Failed",new Date,new Date),C.TWILSOCK_INIT,e.TelemetryPoint.End)}),h.channel.on("initialized",function(D){h.handleStorageId(f,D),Yn.storeToken(D.continuationToken,f),setTimeout(function(){return h.emit("initialized",D)},0)}),h.channel.on("disconnected",function(){return setTimeout(function(){return h.emit("disconnected")},0)}),h.channel.on("disconnected",function(){return h.upstream.rejectPendingMessages()}),h.channel.on("disconnected",function(){return h.offlineStorageDeferred.fail(new Et("Client disconnected"))}),h.offlineStorageDeferred.promise.catch(function(){}),h}return Ae.default(l,[{key:"emit",value:function(f){for(var g,h=arguments.length,b=new Array(h>1?h-1:0),S=1;S<h;S++)b[S-1]=arguments[S];return R.debug("Emitting ".concat(f.toString(),"(").concat(b.map(function(j){return JSON.stringify(j)}).join(", "),")")),(g=le.default(Ee.default(l.prototype),"emit",this)).call.apply(g,[this,f].concat(b))}},{key:"handleStorageId",value:function(f,g){if(!g.offlineStorage)this.offlineStorageDeferred.fail(new Et("No offline storage id"));else if(g.offlineStorage.hasOwnProperty(f))try{this.offlineStorageDeferred.set(Ii.create(g.offlineStorage[f])),R.debug("Offline storage for '".concat(f,"' product: ").concat(JSON.stringify(g.offlineStorage[f]),"."))}catch(h){this.offlineStorageDeferred.fail(new Et("Failed to parse offline storage for ".concat(f," ").concat(JSON.stringify(g.offlineStorage[f]),". ").concat(h,".")))}else this.offlineStorageDeferred.fail(new Et("No offline storage id for '".concat(f,"' product: ").concat(JSON.stringify(g.offlineStorage))))}},{key:"storageId",value:function(){return this.offlineStorageDeferred.promise}},{key:"isConnected",get:function(){return this.channel.isConnected}},{key:"state",get:function(){return this.channel.state}},{key:"updateToken",value:function(){var p=Re.default(ae.default.mark(function g(h){return ae.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(R.trace("updating token '".concat(h,"'")),this.config.token!==h){S.next=3;break}return S.abrupt("return");case 3:return this.config.updateToken(h),S.next=6,this.channel.updateToken(h);case 6:return S.abrupt("return",S.sent);case 7:case"end":return S.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()},{key:"setNotificationsContext",value:function(){var p=Re.default(ae.default.mark(function g(h,b){return ae.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,this.registrations.setNotificationsContext(h,b);case 2:case"end":return j.stop()}},g,this)}));function f(g,h){return p.apply(this,arguments)}return f}()},{key:"removeNotificationsContext",value:function(){var p=Re.default(ae.default.mark(function g(h){return ae.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this.registrations.removeNotificationsContext(h);case 2:case"end":return S.stop()}},g,this)}));function f(g){return p.apply(this,arguments)}return f}()},{key:"connect",value:function(){return this.channel.connect()}},{key:"disconnect",value:function(){var p=Re.default(ae.default.mark(function g(){return ae.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEventsIncludingUnfinished),b.next=3,this.channel.disconnect();case 3:return b.abrupt("return",b.sent);case 4:case"end":return b.stop()}},g,this)}));function f(){return p.apply(this,arguments)}return f}()},{key:"get",value:function(){var p=Re.default(ae.default.mark(function g(h,b,S){return ae.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),D.next=3,this.upstream.send("GET",h,b,void 0,S);case 3:return D.abrupt("return",D.sent);case 4:case"end":return D.stop()}},g,this)}));function f(g,h,b){return p.apply(this,arguments)}return f}()},{key:"post",value:function(){var p=Re.default(ae.default.mark(function g(h,b,S,j){return ae.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),z.next=3,this.upstream.send("POST",h,b,S,j);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},g,this)}));function f(g,h,b,S){return p.apply(this,arguments)}return f}()},{key:"put",value:function(){var p=Re.default(ae.default.mark(function g(h,b,S,j){return ae.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),z.next=3,this.upstream.send("PUT",h,b,S,j);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},g,this)}));function f(g,h,b,S){return p.apply(this,arguments)}return f}()},{key:"delete",value:function(){var p=Re.default(ae.default.mark(function g(h,b,S,j){return ae.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return this.telemetryTracker.sendTelemetry(e.EventSendingLimitation.AnyEvents),z.next=3,this.upstream.send("DELETE",h,b,S,j);case 3:return z.abrupt("return",z.sent);case 4:case"end":return z.stop()}},g,this)}));function f(g,h,b,S){return p.apply(this,arguments)}return f}()},{key:"addTelemetryEvent",value:function(f){this.telemetryTracker.addTelemetryEvent(f),this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}},{key:"addPartialTelemetryEvent",value:function(f,g,h){this.telemetryTracker.addPartialEvent(f,g,h),h===e.TelemetryPoint.End&&this.telemetryTracker.sendTelemetryIfMinimalPortionCollected()}}]),l}($),e.TwilsockClient=We([w.validateConstructorTypes(w.nonEmptyString,w.nonEmptyString,[w.pureObject,"undefined",w.literal(null)]),fe("design:paramtypes",[String,String,Object])],e.TwilsockClient);var P=function(){function m(v){oe.default(this,m),this.product=v,this.type="ers",this.notification_protocol_version=0,this.message_types=[]}return Ae.default(m,[{key:"populateInitRegistrations",value:function(l){var p=new Set(this.message_types);for(var f in l)p.add(l[f]);this.message_types=Array.from(p)}}]),m}();e.InitRegistration=P,e.TelemetryEventDescription=Rt,e.TelemetryTracker=Jr,e.TransportUnavailableError=vn,e.Twilsock=e.TwilsockClient,e.TwilsockError=Et})(Ef);var LT={},T_=Bt,v7=Qe,g7=Pt,y7=et,ap=Gu,m7=Wu,b7=ju,w7=yr,_7=Uu,$s=Object.assign,E_=Object.defineProperty,S7=v7([].concat),jT=!$s||y7(function(){if(T_&&$s({b:1},$s(E_({},"a",{enumerable:!0,get:function(){E_(this,"b",{value:3,enumerable:!1})}}),{b:2})).b!==1)return!0;var e={},t={},r=Symbol(),n="abcdefghijklmnopqrst";return e[r]=7,n.split("").forEach(function(i){t[i]=i}),$s({},e)[r]!=7||ap($s({},t)).join("")!=n})?function(t,r){for(var n=w7(t),i=arguments.length,a=1,s=m7.f,u=b7.f;i>a;)for(var o=_7(arguments[a++]),c=s?S7(ap(o),s(o)):ap(o),d=c.length,y=0,_;d>y;)_=c[y++],(!T_||g7(u,o,_))&&(n[_]=o[_]);return n}:$s,$7=ft,I_=jT;$7({target:"Object",stat:!0,arity:2,forced:Object.assign!==I_},{assign:I_});/*
@license
The MIT License (MIT)

Copyright (c) 2016 Twilio Inc.

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=ho.exports,r=fa.exports,n=ts.exports,i=oa.exports,a=ua.exports,s=zn.exports,u=rl,o=la.exports,c=Ef,d=sa.exports,y=ca.exports,_=Si,w=nl.exports,k=il.exports,N=yo.exports,M=If,L=nr;function B(se){return se&&typeof se=="object"&&"default"in se?se:{default:se}}function ve(se){if(se&&se.__esModule)return se;var de=Object.create(null);return se&&Object.keys(se).forEach(function(Y){if(Y!=="default"){var ie=Object.getOwnPropertyDescriptor(se,Y);Object.defineProperty(de,Y,ie.get?ie:{enumerable:!0,get:function(){return se[Y]}})}}),de.default=se,Object.freeze(de)}var ue=B(t),Me=B(r),Re=B(n),Ae=B(i),x=B(a),le=B(s),F=B(u),Se=B(o),Ee=B(d),oe=B(y),te=B(w),ae=B(k),ne=ve(N),be=ve(M);function A(se,de,Y,ie){var X=arguments.length,ye=X<3?de:ie===null?ie=Object.getOwnPropertyDescriptor(de,Y):ie,we;if((typeof Reflect>"u"?"undefined":Se.default(Reflect))==="object"&&typeof Reflect.decorate=="function")ye=Reflect.decorate(se,de,Y,ie);else for(var Pe=se.length-1;Pe>=0;Pe--)(we=se[Pe])&&(ye=(X<3?we(ye):X>3?we(de,Y,ye):we(de,Y))||ye);return X>3&&ye&&Object.defineProperty(de,Y,ye),ye}function Le(se,de){if((typeof Reflect>"u"?"undefined":Se.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(se,de)}var at;function We(){}We.prototype=Object.create(null);function fe(){fe.init.call(this)}fe.EventEmitter=fe,fe.usingDomains=!1,fe.prototype.domain=void 0,fe.prototype._events=void 0,fe.prototype._maxListeners=void 0,fe.defaultMaxListeners=10,fe.init=function(){this.domain=null,fe.usingDomains&&at.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new We,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},fe.prototype.setMaxListeners=function(de){if(typeof de!="number"||de<0||isNaN(de))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=de,this};function V(se){return se._maxListeners===void 0?fe.defaultMaxListeners:se._maxListeners}fe.prototype.getMaxListeners=function(){return V(this)};function Q(se,de,Y){if(de)se.call(Y);else for(var ie=se.length,X=T(se,ie),ye=0;ye<ie;++ye)X[ye].call(Y)}function $(se,de,Y,ie){if(de)se.call(Y,ie);else for(var X=se.length,ye=T(se,X),we=0;we<X;++we)ye[we].call(Y,ie)}function I(se,de,Y,ie,X){if(de)se.call(Y,ie,X);else for(var ye=se.length,we=T(se,ye),Pe=0;Pe<ye;++Pe)we[Pe].call(Y,ie,X)}function Z(se,de,Y,ie,X,ye){if(de)se.call(Y,ie,X,ye);else for(var we=se.length,Pe=T(se,we),Ye=0;Ye<we;++Ye)Pe[Ye].call(Y,ie,X,ye)}function re(se,de,Y,ie){if(de)se.apply(Y,ie);else for(var X=se.length,ye=T(se,X),we=0;we<X;++we)ye[we].apply(Y,ie)}fe.prototype.emit=function(de){var Y,ie,X,ye,we,Pe,Ye,st=de==="error";if(Pe=this._events,Pe)st=st&&Pe.error==null;else if(!st)return!1;if(Ye=this.domain,st){if(Y=arguments[1],Ye)Y||(Y=new Error('Uncaught, unspecified "error" event')),Y.domainEmitter=this,Y.domain=Ye,Y.domainThrown=!1,Ye.emit("error",Y);else{if(Y instanceof Error)throw Y;var Ze=new Error('Uncaught, unspecified "error" event. ('+Y+")");throw Ze.context=Y,Ze}return!1}if(ie=Pe[de],!ie)return!1;var Fe=typeof ie=="function";switch(X=arguments.length,X){case 1:Q(ie,Fe,this);break;case 2:$(ie,Fe,this,arguments[1]);break;case 3:I(ie,Fe,this,arguments[1],arguments[2]);break;case 4:Z(ie,Fe,this,arguments[1],arguments[2],arguments[3]);break;default:for(ye=new Array(X-1),we=1;we<X;we++)ye[we-1]=arguments[we];re(ie,Fe,this,ye)}return!0};function Ie(se,de,Y,ie){var X,ye,we;if(typeof Y!="function")throw new TypeError('"listener" argument must be a function');if(ye=se._events,ye?(ye.newListener&&(se.emit("newListener",de,Y.listener?Y.listener:Y),ye=se._events),we=ye[de]):(ye=se._events=new We,se._eventsCount=0),!we)we=ye[de]=Y,++se._eventsCount;else if(typeof we=="function"?we=ye[de]=ie?[Y,we]:[we,Y]:ie?we.unshift(Y):we.push(Y),!we.warned&&(X=V(se),X&&X>0&&we.length>X)){we.warned=!0;var Pe=new Error("Possible EventEmitter memory leak detected. "+we.length+" "+de+" listeners added. Use emitter.setMaxListeners() to increase limit");Pe.name="MaxListenersExceededWarning",Pe.emitter=se,Pe.type=de,Pe.count=we.length,xe(Pe)}return se}function xe(se){typeof console.warn=="function"?console.warn(se):console.log(se)}fe.prototype.addListener=function(de,Y){return Ie(this,de,Y,!1)},fe.prototype.on=fe.prototype.addListener,fe.prototype.prependListener=function(de,Y){return Ie(this,de,Y,!0)};function ce(se,de,Y){var ie=!1;function X(){se.removeListener(de,X),ie||(ie=!0,Y.apply(se,arguments))}return X.listener=Y,X}fe.prototype.once=function(de,Y){if(typeof Y!="function")throw new TypeError('"listener" argument must be a function');return this.on(de,ce(this,de,Y)),this},fe.prototype.prependOnceListener=function(de,Y){if(typeof Y!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(de,ce(this,de,Y)),this},fe.prototype.removeListener=function(de,Y){var ie,X,ye,we,Pe;if(typeof Y!="function")throw new TypeError('"listener" argument must be a function');if(X=this._events,!X)return this;if(ie=X[de],!ie)return this;if(ie===Y||ie.listener&&ie.listener===Y)--this._eventsCount===0?this._events=new We:(delete X[de],X.removeListener&&this.emit("removeListener",de,ie.listener||Y));else if(typeof ie!="function"){for(ye=-1,we=ie.length;we-- >0;)if(ie[we]===Y||ie[we].listener&&ie[we].listener===Y){Pe=ie[we].listener,ye=we;break}if(ye<0)return this;if(ie.length===1){if(ie[0]=void 0,--this._eventsCount===0)return this._events=new We,this;delete X[de]}else E(ie,ye);X.removeListener&&this.emit("removeListener",de,Pe||Y)}return this},fe.prototype.off=function(se,de){return this.removeListener(se,de)},fe.prototype.removeAllListeners=function(de){var Y,ie;if(ie=this._events,!ie)return this;if(!ie.removeListener)return arguments.length===0?(this._events=new We,this._eventsCount=0):ie[de]&&(--this._eventsCount===0?this._events=new We:delete ie[de]),this;if(arguments.length===0){for(var X=Object.keys(ie),ye=0,we;ye<X.length;++ye)we=X[ye],we!=="removeListener"&&this.removeAllListeners(we);return this.removeAllListeners("removeListener"),this._events=new We,this._eventsCount=0,this}if(Y=ie[de],typeof Y=="function")this.removeListener(de,Y);else if(Y)do this.removeListener(de,Y[Y.length-1]);while(Y[0]);return this},fe.prototype.listeners=function(de){var Y,ie,X=this._events;return X?(Y=X[de],Y?typeof Y=="function"?ie=[Y.listener||Y]:ie=G(Y):ie=[]):ie=[],ie},fe.listenerCount=function(se,de){return typeof se.listenerCount=="function"?se.listenerCount(de):$e.call(se,de)},fe.prototype.listenerCount=$e;function $e(se){var de=this._events;if(de){var Y=de[se];if(typeof Y=="function")return 1;if(Y)return Y.length}return 0}fe.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function E(se,de){for(var Y=de,ie=Y+1,X=se.length;ie<X;Y+=1,ie+=1)se[Y]=se[ie];se.pop()}function T(se,de){for(var Y=new Array(de);de--;)Y[de]=se[de];return Y}function G(se){for(var de=new Array(se.length),Y=0;Y<de.length;++Y)de[Y]=se[Y].listener||se[Y];return de}var ee=ne.getLogger("twilio-notificatiions");function q(se,de){return["".concat(new Date().toISOString()," Twilio.Notifications ").concat(se,":")].concat(Array.from(de))}var ke=function(){function se(){Me.default(this,se)}return Re.default(se,[{key:"setLevel",value:function(Y){ee.setLevel(Y)}},{key:"trace",value:function(){for(var Y=arguments.length,ie=new Array(Y),X=0;X<Y;X++)ie[X]=arguments[X];ee.trace.apply(null,q("T",ie))}},{key:"debug",value:function(){for(var Y=arguments.length,ie=new Array(Y),X=0;X<Y;X++)ie[X]=arguments[X];ee.debug.apply(null,q("D",ie))}},{key:"info",value:function(){for(var Y=arguments.length,ie=new Array(Y),X=0;X<Y;X++)ie[X]=arguments[X];ee.info.apply(null,q("I",ie))}},{key:"warn",value:function(){for(var Y=arguments.length,ie=new Array(Y),X=0;X<Y;X++)ie[X]=arguments[X];ee.warn.apply(null,q("W",ie))}},{key:"error",value:function(){for(var Y=arguments.length,ie=new Array(Y),X=0;X<Y;X++)ie[X]=arguments[X];ee.error.apply(null,q("E",ie))}}]),se}(),J=new ke;function W(se){var de=pe();return function(){var ie=le.default(se),X;if(de){var ye=le.default(this).constructor;X=Reflect.construct(ie,arguments,ye)}else X=ie.apply(this,arguments);return x.default(this,X)}}function pe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var R=function se(){var de=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",ie=arguments.length>2&&arguments[2]!==void 0?arguments[2]:new Set;Me.default(this,se),this.token=de,this.notificationId=Y,this.messageTypes=ie};function Te(se,de){return[].concat(ae.default(ae.default(se).filter(function(Y){return!de.has(Y)})),ae.default(ae.default(de).filter(function(Y){return!se.has(Y)})))}function Ne(se,de){var Y=new Set;return se.notificationId!==de.notificationId&&Y.add("notificationId"),se.token!==de.token&&Y.add("token"),Te(se.messageTypes,de.messageTypes).length>0&&Y.add("messageType"),[Y.size>0,Y]}var Oe=function(se){Ae.default(Y,se);var de=W(Y);function Y(ie){var X;return Me.default(this,Y),X=de.call(this),oe.default(Ee.default(X),"desiredState",new R),oe.default(Ee.default(X),"currentState",new R),oe.default(Ee.default(X),"_hasActiveAttempt",!1),X.channelType=ie,X}return Re.default(Y,[{key:"setNotificationId",value:function(X){this.desiredState.notificationId=X}},{key:"isActive",value:function(){return this.desiredState.notificationId!==""}},{key:"subscribe",value:function(X){if(this.desiredState.messageTypes.has(X)){J.debug("message type '".concat(X,"' for channel ").concat(this.channelType," is already registered"));return}this.desiredState.messageTypes.add(X)}},{key:"unsubscribe",value:function(X){!this.desiredState.messageTypes.has(X)||this.desiredState.messageTypes.delete(X)}},{key:"updateToken",value:function(X){this.desiredState.token=X}},{key:"commitChanges",value:function(){var ie=ue.default(F.default.mark(function ye(){var we,Pe,Ye,st,Ze,Fe;return F.default.wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(!this._hasActiveAttempt){Je.next=3;break}throw J.error("One registration attempt is already in progress"),new Error("One registration attempt is already in progress");case 3:if(we=Ne(this.desiredState,this.currentState),Pe=te.default(we,2),Ye=Pe[0],st=Pe[1],Ye){Je.next=6;break}return Je.abrupt("return");case 6:if(this.currentState.notificationId||st.delete("notificationId"),J.trace("Persisting ".concat(this.channelType," registration"),st,this.desiredState),Je.prev=8,this._hasActiveAttempt=!0,Ze=new R,Ze.token=this.desiredState.token,Ze.notificationId=this.desiredState.notificationId,Ze.messageTypes=new Set(this.desiredState.messageTypes),!(Ze.messageTypes.size>0)){Je.next=24;break}return Je.next=17,this.updateRegistration(Ze,st);case 17:Fe=Je.sent,this.currentState.token=Fe.token,this.currentState.notificationId=Fe.notificationId,this.currentState.messageTypes=new Set(Fe.messageTypes),this.emit("stateChanged",this.channelType,"registered",this.currentState),Je.next=30;break;case 24:return Je.next=26,this.removeRegistration();case 26:this.currentState.token=Ze.token,this.currentState.notificationId=Ze.notificationId,this.currentState.messageTypes.clear(),this.emit("stateChanged",this.channelType,"unregistered",this.currentState);case 30:Je.next=35;break;case 32:throw Je.prev=32,Je.t0=Je.catch(8),Je.t0;case 35:return Je.prev=35,this._hasActiveAttempt=!1,Je.finish(35);case 38:case"end":return Je.stop()}},ye,this,[[8,32,35,38]])}));function X(){return ie.apply(this,arguments)}return X}()}]),Y}(fe);function je(se){var de=De();return function(){var ie=le.default(se),X;if(de){var ye=le.default(this).constructor;X=Reflect.construct(ie,arguments,ye)}else X=ie.apply(this,arguments);return x.default(this,X)}}function De(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ue={min:2e3,max:12e4,randomness:.2},Ve=function(se){Ae.default(Y,se);var de=je(Y);function Y(ie,X,ye,we){var Pe;return Me.default(this,Y),Pe=de.call(this,ie),oe.default(Ee.default(Pe),"registrationId",null),Pe.context=X,Pe.twilsock=ye,Pe.registrarUrl=we,Pe}return Re.default(Y,[{key:"updateRegistration",value:function(){var ie=ue.default(F.default.mark(function ye(we,Pe){var Ye=this,st,Ze,Fe,_r,Je;return F.default.wrap(function(Ut){for(;;)switch(Ut.prev=Ut.next){case 0:if(!Pe.has("notificationId")){Ut.next=3;break}return Ut.next=3,this.removeRegistration();case 3:if(!(!we.notificationId||!we.notificationId.length)){Ut.next=6;break}throw J.error("No push notification ID for registration"),new Error("No push notification ID for registration");case 6:return J.trace("Registering",this.channelType,we),st={endpoint_platform:this.context.platform,channel_type:this.channelType,version:this.context.protocolVersion.toString(),message_types:Array.from(we.messageTypes),data:{registration_id:we.notificationId}},Ze=this.context.productId,Fe="".concat(this.registrarUrl,"?productId=").concat(Ze),_r={"Content-Type":"application/json"},J.trace("Creating registration for channel ".concat(this.channelType)),Ut.prev=12,Ut.next=15,new _.AsyncRetrier(Ue).run(function(){return Ye.twilsock.post(Fe,_r,st,Ze)});case 15:Je=Ut.sent,this.registrationId=Je.body.id,J.debug("Registration created: ",Je),Ut.next=24;break;case 20:throw Ut.prev=20,Ut.t0=Ut.catch(12),J.error("Registration failed: ",Ut.t0),Ut.t0;case 24:return Ut.abrupt("return",we);case 25:case"end":return Ut.stop()}},ye,this,[[12,20]])}));function X(ye,we){return ie.apply(this,arguments)}return X}()},{key:"removeRegistration",value:function(){var ie=ue.default(F.default.mark(function ye(){var we=this,Pe,Ye,st;return F.default.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(this.registrationId){Fe.next=2;break}return Fe.abrupt("return");case 2:return Pe=this.context.productId,Ye="".concat(this.registrarUrl,"/").concat(this.registrationId,"?productId=").concat(Pe),st={"Content-Type":"application/json"},J.trace("Removing registration for ".concat(this.channelType)),Fe.prev=6,Fe.next=9,new _.AsyncRetrier(Object.assign(Ue,{maxAttemptsCount:3})).run(function(){return we.twilsock.delete(Ye,st,{},Pe)});case 9:this.registrationId=null,this.currentState.notificationId="",J.debug("Registration removed for ".concat(this.channelType)),Fe.next=18;break;case 14:throw Fe.prev=14,Fe.t0=Fe.catch(6),J.error("Failed to remove registration ",this.channelType,Fe.t0),Fe.t0;case 18:case"end":return Fe.stop()}},ye,this,[[6,14]])}));function X(){return ie.apply(this,arguments)}return X}()},{key:"sendDeviceRemoveRequest",value:function(){var ie=ue.default(F.default.mark(function ye(we){var Pe=this,Ye,st,Ze,Fe;return F.default.wrap(function(Je){for(;;)switch(Je.prev=Je.next){case 0:if(we!==""){Je.next=2;break}throw new Error("Empty registration ID");case 2:return Ye=this.context.productId,st="".concat(this.registrarUrl,"?productId=").concat(Ye),Ze={"Content-Type":"application/json"},Fe={binding_type:this.channelType,address:we},Je.prev=6,J.trace("Removing old registrations for ".concat(this.channelType)),Je.next=10,new _.AsyncRetrier(Object.assign(Ue,{maxAttemptsCount:3})).run(function(){return Pe.twilsock.delete(st,Ze,Fe,Ye)});case 10:this.registrationId=null,this.currentState.notificationId="",J.debug("Registration removed for ".concat(this.channelType)),Je.next=19;break;case 15:throw Je.prev=15,Je.t0=Je.catch(6),J.error("Failed to remove registration ",this.channelType,Je.t0),Je.t0;case 19:case"end":return Je.stop()}},ye,this,[[6,15]])}));function X(ye){return ie.apply(this,arguments)}return X}()}]),Y}(Oe);function Xe(se){var de=er();return function(){var ie=le.default(se),X;if(de){var ye=le.default(this).constructor;X=Reflect.construct(ie,arguments,ye)}else X=ie.apply(this,arguments);return x.default(this,X)}}function er(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var wr=function(se){Ae.default(Y,se);var de=Xe(Y);function Y(ie,X,ye){var we;return Me.default(this,Y),we=de.call(this,"twilsock"),oe.default(Ee.default(we),"contextId",be.v4()),we.productId=ie,we.platform=X,we.twilsock=ye,we}return Re.default(Y,[{key:"updateRegistration",value:function(){var ie=ue.default(F.default.mark(function ye(we,Pe){var Ye,st;return F.default.wrap(function(Fe){for(;;)switch(Fe.prev=Fe.next){case 0:if(Pe.has("messageType")){Fe.next=2;break}return Fe.abrupt("return",we);case 2:return Ye=Array.from(we.messageTypes),st={product_id:this.productId,notification_protocol_version:4,endpoint_platform:this.platform,message_types:Ye},Fe.prev=4,Fe.next=7,this.twilsock.setNotificationsContext(this.contextId,st);case 7:Fe.next=13;break;case 9:throw Fe.prev=9,Fe.t0=Fe.catch(4),J.error("Failed to update twilsock notification context: ".concat(Fe.t0)),Fe.t0;case 13:return Fe.abrupt("return",we);case 14:case"end":return Fe.stop()}},ye,this,[[4,9]])}));function X(ye,we){return ie.apply(this,arguments)}return X}()},{key:"removeRegistration",value:function(){var ie=ue.default(F.default.mark(function ye(){return F.default.wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:return Pe.prev=0,Pe.next=3,this.twilsock.removeNotificationsContext(this.contextId);case 3:Pe.next=9;break;case 5:throw Pe.prev=5,Pe.t0=Pe.catch(0),J.error("Failed to remove twilsock notification context: ".concat(Pe.t0)),Pe.t0;case 9:case"end":return Pe.stop()}},ye,this,[[0,5]])}));function X(){return ie.apply(this,arguments)}return X}()},{key:"sendDeviceRemoveRequest",value:function(){var ie=ue.default(F.default.mark(function ye(we){return F.default.wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:case"end":return Ye.stop()}},ye)}));function X(ye){return ie.apply(this,arguments)}return X}()}]),Y}(Oe);function pn(se){var de=Cr();return function(){var ie=le.default(se),X;if(de){var ye=le.default(this).constructor;X=Reflect.construct(ie,arguments,ye)}else X=ie.apply(this,arguments);return x.default(this,X)}}function Cr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var mt,jt=L.literal("apn","fcm","twilsock");e.Notifications=mt=function(se){Ae.default(Y,se);var de=pn(Y);function Y(ie){var X,ye,we,Pe,Ye,st,Ze,Fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Me.default(this,Y),Ze=de.call(this),Fe.logLevel=(X=Fe.logLevel)!==null&&X!==void 0?X:"error",J.setLevel(Fe.logLevel);var _r=(ye=Fe.productId)!==null&&ye!==void 0?ye:"notifications",Je=!Fe.twilsockClient,qt=Fe.twilsockClient=(we=Fe.twilsockClient)!==null&&we!==void 0?we:new c.TwilsockClient(ie,_r,Fe),Ut=(Pe=Fe.notifications)!==null&&Pe!==void 0?Pe:{},$i=(Ye=(st=Ut.region)!==null&&st!==void 0?st:Fe.region)!==null&&Ye!==void 0?Ye:"us1",Kn="https://ers.".concat($i,".twilio.com/v1/registrations"),An=Ut.ersUrl||Kn;Ze.connectors=new Map;var Et=mt._detectPlatform();return Ze.connectors.set("apn",new Ve("apn",{protocolVersion:4,productId:_r,platform:Et},qt,An)),Ze.connectors.set("fcm",new Ve("fcm",{protocolVersion:3,productId:_r,platform:Et},qt,An)),Ze.connectors.set("twilsock",new wr(_r,Et,qt)),qt.on("stateChanged",function(Dt){return Ze.emit("transportState",Dt)}),Ze._connector("twilsock").on("stateChanged",function(Dt,Lr,Rr){return Ze.emit("stateChanged",Dt,Lr,Rr)}),Ze._connector("apn").on("stateChanged",function(Dt,Lr,Rr){return Ze.emit("stateChanged",Dt,Lr,Rr)}),Ze._connector("fcm").on("stateChanged",function(Dt,Lr,Rr){return Ze.emit("stateChanged",Dt,Lr,Rr)}),qt.on("message",function(Dt,Lr){return Ze._routeMessage(Dt,Lr)}),Ze.updateToken(ie),Je&&(qt.connect(),Ze.twilsock=qt),Ze}return Re.default(Y,[{key:"shutdown",value:function(){var ie=ue.default(F.default.mark(function ye(){return F.default.wrap(function(Pe){for(;;)switch(Pe.prev=Pe.next){case 0:if(this.connectors.clear(),!this.twilsock){Pe.next=4;break}return Pe.next=4,this.twilsock.disconnect();case 4:case"end":return Pe.stop()}},ye,this)}));function X(){return ie.apply(this,arguments)}return X}()},{key:"setPushRegistrationId",value:function(X,ye){J.debug("Set ".concat(X," push registration id '").concat(ye,"'")),this._connector(X).setNotificationId(ye)}},{key:"subscribe",value:function(X,ye){J.debug("Add ".concat(X," subscriptions for message type ").concat(ye)),this._connector(X).subscribe(ye)}},{key:"unsubscribe",value:function(X,ye){J.debug("Remove ".concat(X," subscriptions for message type ").concat(ye)),this._connector(X).unsubscribe(ye)}},{key:"updateToken",value:function(X){this.connectors.forEach(function(ye){return ye.updateToken(X)})}},{key:"commitChanges",value:function(){var ie=ue.default(F.default.mark(function ye(){var we;return F.default.wrap(function(Ye){for(;;)switch(Ye.prev=Ye.next){case 0:return we=[],this.connectors.forEach(function(st){st.isActive()&&we.push(st.commitChanges())}),Ye.next=4,Promise.all(we);case 4:case"end":return Ye.stop()}},ye,this)}));function X(){return ie.apply(this,arguments)}return X}()},{key:"removeRegistrations",value:function(){var ie=ue.default(F.default.mark(function ye(we,Pe){return F.default.wrap(function(st){for(;;)switch(st.prev=st.next){case 0:return st.next=2,this._connector(we).sendDeviceRemoveRequest(Pe);case 2:case"end":return st.stop()}},ye,this)}));function X(ye,we){return ie.apply(this,arguments)}return X}()},{key:"handlePushNotification",value:function(X){return{messageType:X.twi_message_type,payload:X.payload}}},{key:"_routeMessage",value:function(X,ye){J.debug("Notification message arrived: ",X,ye),this.emit("message",X,ye)}},{key:"_connector",value:function(X){var ye=this.connectors.get(X);if(!ye)throw new Error("Unknown channel type: ".concat(X));return ye}}],[{key:"_detectPlatform",value:function(){var X="";return typeof navigator<"u"?(X="unknown",typeof navigator.product<"u"&&(X=navigator.product),typeof navigator.userAgent<"u"&&(X=navigator.userAgent)):X="web",X.substring(0,128)}}]),Y}(fe),A([L.validateTypes(jt,L.nonEmptyString),Le("design:type",Function),Le("design:paramtypes",[String,String]),Le("design:returntype",void 0)],e.Notifications.prototype,"setPushRegistrationId",null),A([L.validateTypes(jt,L.nonEmptyString),Le("design:type",Function),Le("design:paramtypes",[String,String]),Le("design:returntype",void 0)],e.Notifications.prototype,"subscribe",null),A([L.validateTypes(jt,L.nonEmptyString),Le("design:type",Function),Le("design:paramtypes",[String,String]),Le("design:returntype",void 0)],e.Notifications.prototype,"unsubscribe",null),A([L.validateTypes(L.nonEmptyString),Le("design:type",Function),Le("design:paramtypes",[String]),Le("design:returntype",void 0)],e.Notifications.prototype,"updateToken",null),A([L.validateTypesAsync(jt,L.nonEmptyString),Le("design:type",Function),Le("design:paramtypes",[String,String]),Le("design:returntype",Promise)],e.Notifications.prototype,"removeRegistrations",null),e.Notifications=mt=A([L.validateConstructorTypes(L.nonEmptyString,[L.pureObject,"undefined",L.literal(null)]),Le("design:paramtypes",[String,Object])],e.Notifications)})(LT);var xr={};/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2016, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes Backoff library under the following license

    Copyright (C) 2012 Mathieu Turcotte

    Permission is hereby granted, free of charge, to any person obtaining a copy of
    this software and associated documentation files (the "Software"), to deal in
    the Software without restriction, including without limitation the rights to
    use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies
    of the Software, and to permit persons to whom the Software is furnished to do
    so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.

This software includes Event-to-Promise library under the following license

    Copyright (c) 2014, Julien Fontanet <julien.fontanet@isonoe.net>.

    Permission to use, copy, modify, and/or distribute this software for any purpose
    with or without fee is hereby granted, provided that the above copyright notice
    and this permission notice appear in all copies.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY AND
    FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS
    OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
    TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF
    THIS SOFTWARE.

*/Object.defineProperty(xr,"__esModule",{value:!0});var k7=ho.exports,T7=fa.exports,E7=ts.exports,I7=sa.exports,C7=oa.exports,R7=ua.exports,O7=zn.exports,A7=ca.exports,P7=rl,M7=la.exports,me=nr,xc=Ef,N7=qg.exports,x7=yo.exports,L7=nl.exports,UT=Si,DT=If,j7=Tf.exports,U7=Nc.exports;function Gr(e){return e&&typeof e=="object"&&"default"in e?e:{default:e}}function Wg(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach(function(r){if(r!=="default"){var n=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(t,r,n.get?n:{enumerable:!0,get:function(){return e[r]}})}}),t.default=e,Object.freeze(t)}var Ce=Gr(k7),pt=Gr(T7),wt=Gr(E7),Bn=Gr(I7),Ir=Gr(C7),pa=Gr(R7),Qt=Gr(O7),$t=Gr(A7),H=Gr(P7),FT=Gr(M7),D7=Gr(N7),F7=Wg(x7),BT=Gr(L7),B7=Wg(DT),ol=Gr(j7),Vl=Wg(U7);function vt(e,t,r,n){var i=arguments.length,a=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,s;if((typeof Reflect>"u"?"undefined":FT.default(Reflect))==="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(s=e[u])&&(a=(i<3?s(a):i>3?s(t,r,a):s(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function _e(e,t){if((typeof Reflect>"u"?"undefined":FT.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}var q7;function Yi(){}Yi.prototype=Object.create(null);function Tt(){Tt.init.call(this)}Tt.EventEmitter=Tt;Tt.usingDomains=!1;Tt.prototype.domain=void 0;Tt.prototype._events=void 0;Tt.prototype._maxListeners=void 0;Tt.defaultMaxListeners=10;Tt.init=function(){this.domain=null,Tt.usingDomains&&q7.active,(!this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=new Yi,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Tt.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=t,this};function qT(e){return e._maxListeners===void 0?Tt.defaultMaxListeners:e._maxListeners}Tt.prototype.getMaxListeners=function(){return qT(this)};function W7(e,t,r){if(t)e.call(r);else for(var n=e.length,i=ul(e,n),a=0;a<n;++a)i[a].call(r)}function H7(e,t,r,n){if(t)e.call(r,n);else for(var i=e.length,a=ul(e,i),s=0;s<i;++s)a[s].call(r,n)}function G7(e,t,r,n,i){if(t)e.call(r,n,i);else for(var a=e.length,s=ul(e,a),u=0;u<a;++u)s[u].call(r,n,i)}function V7(e,t,r,n,i,a){if(t)e.call(r,n,i,a);else for(var s=e.length,u=ul(e,s),o=0;o<s;++o)u[o].call(r,n,i,a)}function z7(e,t,r,n){if(t)e.apply(r,n);else for(var i=e.length,a=ul(e,i),s=0;s<i;++s)a[s].apply(r,n)}Tt.prototype.emit=function(t){var r,n,i,a,s,u,o,c=t==="error";if(u=this._events,u)c=c&&u.error==null;else if(!c)return!1;if(o=this.domain,c){if(r=arguments[1],o)r||(r=new Error('Uncaught, unspecified "error" event')),r.domainEmitter=this,r.domain=o,r.domainThrown=!1,o.emit("error",r);else{if(r instanceof Error)throw r;var d=new Error('Uncaught, unspecified "error" event. ('+r+")");throw d.context=r,d}return!1}if(n=u[t],!n)return!1;var y=typeof n=="function";switch(i=arguments.length,i){case 1:W7(n,y,this);break;case 2:H7(n,y,this,arguments[1]);break;case 3:G7(n,y,this,arguments[1],arguments[2]);break;case 4:V7(n,y,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(i-1),s=1;s<i;s++)a[s-1]=arguments[s];z7(n,y,this,a)}return!0};function WT(e,t,r,n){var i,a,s;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(a=e._events,a?(a.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),a=e._events),s=a[t]):(a=e._events=new Yi,e._eventsCount=0),!s)s=a[t]=r,++e._eventsCount;else if(typeof s=="function"?s=a[t]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),!s.warned&&(i=qT(e),i&&i>0&&s.length>i)){s.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=e,u.type=t,u.count=s.length,K7(u)}return e}function K7(e){typeof console.warn=="function"?console.warn(e):console.log(e)}Tt.prototype.addListener=function(t,r){return WT(this,t,r,!1)};Tt.prototype.on=Tt.prototype.addListener;Tt.prototype.prependListener=function(t,r){return WT(this,t,r,!0)};function HT(e,t,r){var n=!1;function i(){e.removeListener(t,i),n||(n=!0,r.apply(e,arguments))}return i.listener=r,i}Tt.prototype.once=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.on(t,HT(this,t,r)),this};Tt.prototype.prependOnceListener=function(t,r){if(typeof r!="function")throw new TypeError('"listener" argument must be a function');return this.prependListener(t,HT(this,t,r)),this};Tt.prototype.removeListener=function(t,r){var n,i,a,s,u;if(typeof r!="function")throw new TypeError('"listener" argument must be a function');if(i=this._events,!i)return this;if(n=i[t],!n)return this;if(n===r||n.listener&&n.listener===r)--this._eventsCount===0?this._events=new Yi:(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(a=-1,s=n.length;s-- >0;)if(n[s]===r||n[s].listener&&n[s].listener===r){u=n[s].listener,a=s;break}if(a<0)return this;if(n.length===1){if(n[0]=void 0,--this._eventsCount===0)return this._events=new Yi,this;delete i[t]}else J7(n,a);i.removeListener&&this.emit("removeListener",t,u||r)}return this};Tt.prototype.off=function(e,t){return this.removeListener(e,t)};Tt.prototype.removeAllListeners=function(t){var r,n;if(n=this._events,!n)return this;if(!n.removeListener)return arguments.length===0?(this._events=new Yi,this._eventsCount=0):n[t]&&(--this._eventsCount===0?this._events=new Yi:delete n[t]),this;if(arguments.length===0){for(var i=Object.keys(n),a=0,s;a<i.length;++a)s=i[a],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=new Yi,this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r)do this.removeListener(t,r[r.length-1]);while(r[0]);return this};Tt.prototype.listeners=function(t){var r,n,i=this._events;return i?(r=i[t],r?typeof r=="function"?n=[r.listener||r]:n=Y7(r):n=[]):n=[],n};Tt.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):GT.call(e,t)};Tt.prototype.listenerCount=GT;function GT(e){var t=this._events;if(t){var r=t[e];if(typeof r=="function")return 1;if(r)return r.length}return 0}Tt.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function J7(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function ul(e,t){for(var r=new Array(t);t--;)r[t]=e[t];return r}function Y7(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}var to=function(){function e(t){pt.default(this,e),this.base=t,this.args=new Array,this.paths=new Array}return wt.default(e,[{key:"pathSegment",value:function(r){return this.paths.push(encodeURIComponent(r)),this}},{key:"queryParam",value:function(r,n){return typeof n<"u"&&this.args.push(encodeURIComponent(r)+"="+encodeURIComponent(n)),this}},{key:"build",value:function(){var r=this.base;return this.paths.length&&(r+="/"+this.paths.join("/")),this.args.length&&(r+="?"+this.args.join("&")),r}}]),e}();function VT(e){var t=Q7();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function Q7(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Nr=function(e){Ir.default(r,e);var t=VT(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return pt.default(this,r),i=t.call(this),i.name=i.constructor.name,i.message="".concat(n," (status: ").concat(a,", code: ").concat(s,")"),i.status=a,i.code=s,i}return r}(D7.default(Error)),X7=function(e){Ir.default(r,e);var t=VT(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,u=arguments.length>3?arguments[3]:void 0;return pt.default(this,r),i=t.call(this,n,a,s),i.body=u,i}return r}(Nr);function Tn(e){return JSON.parse(JSON.stringify(e))}function zT(e){var t=e===void 0||Hg(e);if(!t)throw new Nr("Invalid pageSize parameter. Expected a positive integer, was '".concat(e,"'."),400,20007)}function Z7(e){return!isNaN(parseInt(e))&&isFinite(e)}function Hg(e){return Z7(e)&&e>0}var ks=F7.getLogger("twilio-sync");function Go(e,t){return["".concat(new Date().toISOString()," Sync ").concat(e,":")].concat(Array.from(t))}var gt={setLevel:function(t){ks.setLevel(t)},trace:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];ks.trace.apply(null,Go("T",r))},debug:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];ks.debug.apply(null,Go("D",r))},info:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];ks.info.apply(null,Go("I",r))},warn:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];ks.warn.apply(null,Go("W",r))},error:function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];ks.error.apply(null,Go("E",r))}},eK="/v4/Subscriptions",tK="/v3/Maps",rK="/v3/Lists",nK="/v3/Documents",iK="/v3/Streams",aK="/v3/Insights";function sK(e,t,r){return e&&typeof e[t]<"u"?e[t]:r}var oK=function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};pt.default(this,e);var r=t.region||"us1",n="https://cds.".concat(r,".twilio.com"),i=t.cdsUri||n;this.settings={subscriptionsUri:i+eK,documentsUri:i+nK,listsUri:i+rK,mapsUri:i+tK,streamsUri:i+iK,insightsUri:i+aK,sessionStorageEnabled:sK(t.Sync,"enableSessionStorage",!0),productId:t.productId}}return wt.default(e,[{key:"subscriptionsUri",get:function(){return this.settings.subscriptionsUri}},{key:"documentsUri",get:function(){return this.settings.documentsUri}},{key:"listsUri",get:function(){return this.settings.listsUri}},{key:"mapsUri",get:function(){return this.settings.mapsUri}},{key:"streamsUri",get:function(){return this.settings.streamsUri}},{key:"insightsUri",get:function(){return this.settings.insightsUri}},{key:"backoffConfig",get:function(){return this.settings.backoffConfig||{}}},{key:"sessionStorageEnabled",get:function(){return this.settings.sessionStorageEnabled}},{key:"productId",get:function(){return this.settings.productId}}]),e}();function Vo(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=uK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function uK(e,t){if(!!e){if(typeof e=="string")return C_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C_(e,t)}}function C_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var lK=function(){function e(t){pt.default(this,e),this.localObject=t,this.pendingCorrelationId=null,this.pendingAction=null,this.established=!1,this.retryCount=0}return wt.default(e,[{key:"sid",get:function(){return this.localObject.sid}},{key:"type",get:function(){return this.localObject.type}},{key:"lastEventId",get:function(){return this.localObject.lastEventId}},{key:"indexName",get:function(){return this.localObject.indexName}},{key:"queryString",get:function(){return this.localObject.queryString}},{key:"isEstablished",get:function(){return this.established}},{key:"update",value:function(r,n){this.localObject._update(r,n)}},{key:"updatePending",value:function(r,n){this.pendingAction=r,this.pendingCorrelationId=n}},{key:"reset",value:function(){this.updatePending(null,null),this.retryCount=0,this.established=!1,this.setSubscriptionState("none")}},{key:"markAsFailed",value:function(r){this.rejectedWithError=r.error,this.updatePending(null,null),this.localObject.reportFailure(new Nr("Failed to subscribe on service events: ".concat(r.error.message),r.error.status,r.error.code))}},{key:"complete",value:function(r){this.updatePending(null,null),this.established=!0,this.localObject._advanceLastEventId(r)}},{key:"setSubscriptionState",value:function(r){this.localObject._setSubscriptionState(r)}}]),e}(),cK=function(){function e(t){var r=this;pt.default(this,e),$t.default(this,"isConnected",!1),$t.default(this,"maxBatchSize",100),$t.default(this,"subscriptionTtlTimer",null),$t.default(this,"pendingPokeReason",null),this.services=t,this.subscriptions=new Map,this.persisted=new Map,this.latestPokeResponseArrivalTimestampByCorrelationId=new Map;var n={randomisationFactor:.2,initialDelay:100,maxDelay:2*60*1e3};this.backoff=UT.Backoff.exponential(Object.assign(n,this.services.config.backoffConfig)),this.backoff.on("ready",function(){var i=r.getSubscriptionUpdateBatch(),a=i.action,s=i.subscriptions;a?r.applyNewSubscriptionUpdateBatch(a,s):(r.backoff.reset(),gt.debug("All subscriptions resolved."))})}return wt.default(e,[{key:"getSubscriptionUpdateBatch",value:function(){function r(a,s,u,o){var c=[],d=Vo(a),y;try{for(d.s();!(y=d.n()).done;){var _=BT.default(y.value,2),w=_[0],k=_[1],N=s.get(w);if(!N&&u!==k.pendingAction&&!k.rejectedWithError&&(c.push(k),o&&c.length>=o))break}}catch(M){d.e(M)}finally{d.f()}return c}var n=r(this.subscriptions,this.persisted,"establish",this.maxBatchSize);if(n.length>0)return{action:"establish",subscriptions:n};var i=r(this.persisted,this.subscriptions,"cancel",this.maxBatchSize);return i.length>0?{action:"cancel",subscriptions:i}:{action:null,subscriptions:null}}},{key:"persist",value:function(){this.backoff.backoff()}},{key:"applyNewSubscriptionUpdateBatch",value:function(){var t=Ce.default(H.default.mark(function n(i,a){var s=this,u,o,c,d,y,_,w,k,N,M,L,B,ve,ue,Me,Re;return H.default.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(this.isConnected){x.next=4;break}return gt.debug("Twilsock connection (required for subscription) not ready; waiting\u2026"),this.backoff.reset(),x.abrupt("return");case 4:a=this.processLocalActions(i,a),u=new Date().getTime(),o=Vo(a);try{for(o.s();!(c=o.n()).done;)d=c.value,this.recordActionAttemptOn(d,i,u)}catch(le){o.e(le)}finally{o.f()}return y=this.pendingPokeReason,this.pendingPokeReason=null,x.prev=10,x.next=13,this.request(i,u,y,a);case 13:_=x.sent,w=_.body.max_batch_size,!isNaN(parseInt(w))&&isFinite(w)&&w>0&&(this.maxBatchSize=w),this.subscriptionTtlTimer||(k=_.body.ttl_in_s,N=!isNaN(parseFloat(k))&&isFinite(k),M=N&&k>0,M&&(this.subscriptionTtlTimer=setTimeout(function(){return s.onSubscriptionTtlElapsed()},k*1e3))),i==="establish"&&(L=_.body.estimated_delivery_in_ms,B=!isNaN(parseFloat(L))&&isFinite(L),ve=B&&L>0,ve?setTimeout(function(){return s.verifyPokeDelivery(u,L,a)},L):gt.error("Invalid timeout: ".concat(L)),a.filter(function(le){return le.pendingCorrelationId===u}).forEach(function(le){return le.setSubscriptionState("response_in_flight")})),this.backoff.reset(),x.next=26;break;case 21:x.prev=21,x.t0=x.catch(10),ue=Vo(a);try{for(ue.s();!(Me=ue.n()).done;)Re=Me.value,this.recordActionFailureOn(Re,i)}catch(le){ue.e(le)}finally{ue.f()}x.t0 instanceof xc.TransportUnavailableError?(gt.debug("Twilsock connection (required for subscription) not ready (c:".concat(u,"); waiting\u2026")),this.backoff.reset()):(gt.debug("Failed an attempt to ".concat(i," subscriptions (c:").concat(u,"); retrying"),x.t0),this.persist());case 26:case"end":return x.stop()}},n,this,[[10,21]])}));function r(n,i){return t.apply(this,arguments)}return r}()},{key:"verifyPokeDelivery",value:function(r,n,i){var a=this,s=this.latestPokeResponseArrivalTimestampByCorrelationId.get(r),u=s?new Date().getTime()-s:n;if(u>=n)i.filter(function(c){return c.pendingCorrelationId===r}).forEach(function(c){c.updatePending(null,null),c.retryCount++,a.persisted.delete(c.sid)}),this.persist(),this.latestPokeResponseArrivalTimestampByCorrelationId.delete(r);else{var o=n-u;setTimeout(function(){return a.verifyPokeDelivery(r,n,i)},o)}}},{key:"processLocalActions",value:function(r,n){return r==="cancel"?n.filter(function(i){return!i.rejectedWithError}):n}},{key:"recordActionAttemptOn",value:function(r,n,i){if(r.setSubscriptionState("request_in_flight"),n==="establish")this.persisted.set(r.sid,r),r.updatePending(n,i);else{var a=this.persisted.get(r.sid);a&&a.updatePending(n,i)}}},{key:"recordActionFailureOn",value:function(r,n){r.setSubscriptionState("none"),r.updatePending(null,null),n==="establish"&&this.persisted.delete(r.sid)}},{key:"request",value:function(r,n,i,a){var s=a.map(function(c){return{object_sid:c.sid,object_type:c.type,last_event_id:r==="establish"?c.lastEventId:void 0,index_name:r==="establish"?c.indexName:void 0,query_string:r==="establish"?c.queryString:void 0}}),u=a.filter(function(c){return c.retryCount>0}).length;gt.debug("Attempting '".concat(r,"' request (c:").concat(n,"):"),s);var o={event_protocol_version:4,action:r,correlation_id:n,retried_requests:u,ttl_in_s:-1,requests:s};return i==="ttl"&&(o.reason=i),this.services.network.post(this.services.config.subscriptionsUri,o)}},{key:"add",value:function(r,n){gt.debug("Establishing intent to subscribe to ".concat(r));var i=this.subscriptions.get(r);i&&n&&i.lastEventId===n.lastEventId||(this.persisted.delete(r),this.subscriptions.set(r,new lK(n)),this.persist())}},{key:"remove",value:function(r){gt.debug("Establishing intent to unsubscribe from ".concat(r));var n=this.subscriptions.delete(r);n&&this.persist()}},{key:"acceptMessage",value:function(r,n){gt.trace("Subscriptions received",r);var i=r.event_type,a=typeof r.events<"u"?r.events:[r.event],s=r.correlation_id;s&&this.latestPokeResponseArrivalTimestampByCorrelationId.set(s,new Date().getTime());var u=Vo(a),o;try{for(u.s();!(o=u.n()).done;){var c=o.value,d=void 0;switch(r.event_type){case"subscription_established":this.applySubscriptionEstablishedMessage(c,s);break;case"subscription_canceled":this.applySubscriptionCancelledMessage(c,s);break;case"subscription_failed":this.applySubscriptionFailedMessage(c,s);break;case(d=i.match(/^(?:map|list|document|stream|live_query)_/)||{}).input:{var y=void 0;switch(d[0]){case"map_":y=c.map_sid;break;case"list_":y=c.list_sid;break;case"document_":y=c.document_sid;break;case"stream_":y=c.stream_sid;break;case"live_query_":y=c.query_id,n=!1,r.strictly_ordered===!0&&(n=!0);break;default:y=void 0}this.applyEventToSubscribedEntity(y,c,i,n);break}default:gt.debug("Dropping unknown message type ".concat(i));break}}}catch(_){u.e(_)}finally{u.f()}}},{key:"applySubscriptionEstablishedMessage",value:function(r,n){var i=r.object_sid,a=this.persisted.get(r.object_sid);a&&a.pendingCorrelationId===n?r.replay_status==="interrupted"?(gt.debug("Event Replay for subscription to ".concat(i," (c:").concat(n,") interrupted; continuing eagerly.")),a.updatePending(null,null),this.persisted.delete(a.sid),this.backoff.reset()):r.replay_status==="completed"&&(gt.debug("Event Replay for subscription to ".concat(i," (c:").concat(n,") completed. Subscription is ready.")),a.complete(r.last_event_id),this.persisted.set(r.object_sid,a),a.setSubscriptionState("established"),this.backoff.reset()):gt.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionCancelledMessage",value:function(r,n){var i=this.persisted.get(r.object_sid);i&&i.pendingCorrelationId===n?(i.updatePending(null,null),i.setSubscriptionState("none"),this.persisted.delete(r.object_sid)):gt.debug("Late message for ".concat(r.object_sid," (c:").concat(n,") dropped.")),this.persist()}},{key:"applySubscriptionFailedMessage",value:function(r,n){var i=r.object_sid,a=this.subscriptions.get(i),s=this.persisted.get(i);a&&s?s.pendingCorrelationId===n&&(gt.error("Failed to subscribe on ".concat(s.sid),r.error),s.markAsFailed(r),s.setSubscriptionState("none")):!a&&s&&(this.persisted.delete(i),s.setSubscriptionState("none")),this.persist()}},{key:"applyEventToSubscribedEntity",value:function(r,n,i,a){var s=this;if(!!r){a=a||function(){var o=s.persisted.get(r);return o&&o.isEstablished}();var u=this.subscriptions.get(r);u?(n.type=i,u.update(n,a)):gt.debug("Message dropped for SID '".concat(r,"', for which there is no subscription."))}}},{key:"onConnectionStateChanged",value:function(r){this.isConnected=r,r&&this.poke("reconnect")}},{key:"onSubscriptionTtlElapsed",value:function(){this.isConnected&&this.poke("ttl")}},{key:"poke",value:function(r){gt.debug("Triggering event replay for all subscriptions, reason=".concat(r)),this.pendingPokeReason=r,this.subscriptionTtlTimer&&(clearTimeout(this.subscriptionTtlTimer),this.subscriptionTtlTimer=null);var n=[],i=Vo(this.persisted.values()),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.reset(),s.rejectedWithError&&n.push(s)}}catch(d){i.e(d)}finally{i.f()}this.persisted.clear();for(var u=0,o=n;u<o.length;u++){var c=o[u];this.persisted.set(c.sid,c)}this.persist()}},{key:"shutdown",value:function(){this.backoff.reset(),this.subscriptions.clear()}}]),e}(),fK=4e3,dK=6e4,pK=9e4,hK=.2;function R_(e){if(e.body&&e.body.message)return e.body.message;switch(e.status){case 429:return"Throttled by server";case 404:return"Not found from server";default:return"Error from server"}}function O_(e){return e.body?e.body.code:0}function zo(e){return e.status===409?new X7(R_(e),e.status,O_(e),e.body):e.status?new Nr(R_(e),e.status,O_(e)):e instanceof xc.TransportUnavailableError?e:new Nr(e.message,0,0)}var vK=function(){function e(t,r,n){pt.default(this,e),this.clientInfo=t,this.config=r,this.transport=n}return wt.default(e,[{key:"createHeaders",value:function(){return{"Content-Type":"application/json","Twilio-Sync-Client-Info":JSON.stringify(this.clientInfo),"Twilio-Request-Id":"RQ"+B7.v4().replace(/-/g,"")}}},{key:"backoffConfig",value:function(){return Object.assign({min:fK,max:dK,maxAttemptsTime:pK,randomness:hK},this.config.backoffConfig)}},{key:"executeWithRetry",value:function(r){var n=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return new Promise(function(a,s){var u=[502,503,504];i&&u.push(429);var o=new UT.Retrier(n.backoffConfig());o.on("attempt",function(){r().then(function(c){return o.succeeded(c)}).catch(function(c){if(u.includes(c.status)){var d=parseInt(c.headers?c.headers["Retry-After"]:null);o.failed(zo(c),isNaN(d)?null:d*1e3)}else c.message==="Twilsock disconnected"?o.failed(zo(c)):(o.removeAllListeners(),o.cancel(),s(zo(c)))})}),o.on("succeeded",function(c){a(c)}),o.on("cancelled",function(c){return s(zo(c))}),o.on("failed",function(c){return s(zo(c))}),o.start()})}},{key:"get",value:function(r){var n=this,i=this.createHeaders();return gt.debug("GET",r,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.get(r,i,n.config.productId)},!0)}},{key:"post",value:function(r,n,i){var a=this,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,u=this.createHeaders();return typeof i<"u"&&i!==null&&(u["If-Match"]=i),gt.debug("POST",r,"ID:",u["Twilio-Request-Id"]),this.executeWithRetry(function(){return a.transport.post(r,u,n,a.config.productId)},s)}},{key:"put",value:function(r,n,i){var a=this,s=this.createHeaders();return typeof i<"u"&&i!==null&&(s["If-Match"]=i),gt.debug("PUT",r,"ID:",s["Twilio-Request-Id"]),this.executeWithRetry(function(){return a.transport.put(r,s,n,a.config.productId)},!1)}},{key:"delete",value:function(r){var n=this,i=this.createHeaders();return gt.debug("DELETE",r,"ID:",i["Twilio-Request-Id"]),this.executeWithRetry(function(){return n.transport.delete(r,i,n.config.productId)},!1)}}]),e}(),gK=function(){function e(t,r){pt.default(this,e),this.config=t,this.storageId=null;try{this.storage=r||sessionStorage}catch{}}return wt.default(e,[{key:"storageKey",value:function(r,n){return"".concat(this.storageId,"::").concat(r,"::").concat(n)}},{key:"isReady",get:function(){return this.config.sessionStorageEnabled&&!!this.storageId}},{key:"updateStorageId",value:function(r){this.storageId=r}},{key:"store",value:function(r,n,i){return this.isReady?this._store(this.storageKey(r,n),i):null}},{key:"read",value:function(r,n){return this.isReady?this._read(this.storageKey(r,n)):null}},{key:"remove",value:function(r,n,i){if(!this.isReady)return null;try{this.storage.removeItem(this.storageKey(r,n)),i&&this.storage.removeItem(this.storageKey(r,i))}catch{}}},{key:"update",value:function(r,n,i,a){if(!this.isReady)return null;this._apply(this.storageKey(r,n),a),i&&this._apply(this.storageKey(r,i),a)}},{key:"_store",value:function(r,n){try{this.storage.setItem(r,JSON.stringify(n))}catch{}}},{key:"_read",value:function(r){try{var n=this.storage.getItem(r);if(n)return JSON.parse(n)}catch{}return null}},{key:"_apply",value:function(r,n){var i=this._read(r);if(!i)return!1;this._store(r,Object.assign(i,n))}}]),e}();function yK(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=mK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function mK(e,t){if(!!e){if(typeof e=="string")return A_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return A_(e,t)}}function A_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var ll=function(){function e(t,r){pt.default(this,e),this.services=t,this.removalHandler=r,this.subscriptionState="none",this._attachedListeners=new Map}return wt.default(e,[{key:"_advanceLastEventId",value:function(r,n){}},{key:"reportFailure",value:function(r){r.status===404?this.onRemoved(!1):this.broadcastEventToListeners("failure",r)}},{key:"_subscribe",value:function(){this.services.router._subscribe(this.sid,this)}},{key:"_unsubscribe",value:function(){this.services.router._unsubscribe(this.sid)}},{key:"_setSubscriptionState",value:function(r){this.subscriptionState=r,this.broadcastEventToListeners("_subscriptionStateChanged",r)}},{key:"close",value:function(){this._unsubscribe(),this.removalHandler!=null&&this.removalHandler(this.type,this.sid,this.uniqueName)}},{key:"attach",value:function(r){var n=r.listenerUuid,i=this._attachedListeners.get(n);i||(this._attachedListeners.size||this._subscribe(),this._attachedListeners.set(n,r))}},{key:"detach",value:function(r){this._attachedListeners.delete(r),this._attachedListeners.size||this.close()}},{key:"broadcastEventToListeners",value:function(r,n){var i=yK(this._attachedListeners.values()),a;try{for(i.s();!(a=i.n()).done;){var s=a.value;s.emit(r,n)}}catch(u){i.e(u)}finally{i.f()}}}]),e}(),KT=function(){function e(t){pt.default(this,e),$t.default(this,"queuedRequests",[]),$t.default(this,"isRequestInFlight",!1),this.inputMergingFunction=t}return wt.default(e,[{key:"add",value:function(r,n){var i=this,a=new Promise(function(s,u){return i.queuedRequests.push({input:r,requestFunction:n,resolve:s,reject:u})});return this.wakeupQueue(),a}},{key:"squashAndAdd",value:function(r,n){var i=this.queuedRequests;this.queuedRequests=[];var a;i.length>0?(a=i.map(function(u){return u.input}).reduce(this.inputMergingFunction),a=this.inputMergingFunction(a,r)):a=r;var s=this.add(a,n);return i.forEach(function(u){return s.then(u.resolve,u.reject)}),s}},{key:"isEmpty",value:function(){return this.queuedRequests.length===0&&!this.isRequestInFlight}},{key:"wakeupQueue",value:function(){var r=this;if(!(this.queuedRequests.length===0||this.isRequestInFlight)){var n=this.queuedRequests.shift();this.isRequestInFlight=!0,n.requestFunction(n.input).then(n.resolve,n.reject).then(function(i){r.isRequestInFlight=!1,r.wakeupQueue()})}}}]),e}(),JT=function(){function e(t){pt.default(this,e),$t.default(this,"queueByNamespaceKey",new Map),this.inputReducer=t}return wt.default(e,[{key:"add",value:function(){var t=Ce.default(H.default.mark(function n(i,a,s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.invokeQueueMethod(i,function(c){return c.add(a,s)}));case 1:case"end":return o.stop()}},n,this)}));function r(n,i,a){return t.apply(this,arguments)}return r}()},{key:"squashAndAdd",value:function(){var t=Ce.default(H.default.mark(function n(i,a,s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.invokeQueueMethod(i,function(c){return c.squashAndAdd(a,s)}));case 1:case"end":return o.stop()}},n,this)}));function r(n,i,a){return t.apply(this,arguments)}return r}()},{key:"invokeQueueMethod",value:function(){var t=Ce.default(H.default.mark(function n(i,a){var s,u;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.queueByNamespaceKey.has(i)||this.queueByNamespaceKey.set(i,new KT(this.inputReducer)),s=this.queueByNamespaceKey.get(i),u=a(s),this.queueByNamespaceKey.get(i).isEmpty()&&this.queueByNamespaceKey.delete(i),c.abrupt("return",u);case 5:case"end":return c.stop()}},n,this)}));function r(n,i){return t.apply(this,arguments)}return r}()}]),e}();function bK(e){var t=wK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function wK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var cl=function(e){Ir.default(r,e);var t=bK(r);function r(){var n;return pt.default(this,r),n=t.call(this),n.closed=!1,n.uuid=DT.v4(),n}return wt.default(r,[{key:"listenerUuid",get:function(){return this.uuid}},{key:"close",value:function(){this.removeAllListeners(),this.closed=!0}},{key:"ensureNotClosed",value:function(){if(this.closed)throw new Error("Invalid operation on closed object")}}]),r}(Tt);function YT(e){var t=_K();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function _K(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Nh=function(e){Ir.default(r,e);var t=YT(r);function r(n,i,a){var s;pt.default(this,r),s=t.call(this,n,a),$t.default(Bn.default(s),"isDeleted",!1);var u=function(c,d){return typeof d.ttl=="number"?{ttl:d.ttl}:c};return s.updateMergingQueue=new KT(u),s.descriptor=i,s.descriptor.data=s.descriptor.data||{},s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return wt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"document"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"_update",value:function(i){switch(i.date_created=new Date(i.date_created),i.type){case"document_updated":if(i.id<=this.lastEventId){gt.trace("Document update skipped, current:",this.lastEventId,", remote:",i.id);break}var a=this.descriptor.data!==void 0?Tn(this.descriptor.data):null;this.descriptor.last_event_id=i.id,this.descriptor.revision=i.document_revision,this.descriptor.date_updated=i.date_created,this.descriptor.data=i.document_data,this.broadcastEventToListeners("updated",{data:i.document_data,isLocal:!1,previousData:a}),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:i.id,revision:i.document_revision,date_updated:i.date_created,data:i.document_data});break;case"document_removed":this.onRemoved(!1);break}}},{key:"set",value:function(){var n=Ce.default(H.default.mark(function a(s,u){var o=this,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return c=u||{},y.abrupt("return",this.updateMergingQueue.squashAndAdd(c,function(_){return o._setUnconditionally(s,_.ttl)}));case 2:case"end":return y.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ce.default(H.default.mark(function a(s,u){var o=this,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return c=u||{},y.abrupt("return",this.updateMergingQueue.add(c,function(_){return o._setWithIfMatch(s,_.ttl)}));case 2:case"end":return y.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ce.default(H.default.mark(function a(s,u){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.abrupt("return",this.mutate(function(d){return Object.assign(d,s)},u));case 1:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ce.default(H.default.mark(function a(s){var u;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this._postUpdateToServer({ttl:s});case 2:u=c.sent,this.descriptor.date_expires=u.date_expires;case 4:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_setUnconditionally",value:function(){var n=Ce.default(H.default.mark(function a(s,u){var o;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this._postUpdateToServer({data:s,revision:void 0,ttl:u});case 2:return o=d.sent,this._handleSuccessfulUpdateResult(o),d.abrupt("return",this.descriptor.data);case 5:case"end":return d.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_setWithIfMatch",value:function(){var n=Ce.default(H.default.mark(function a(s,u){var o,c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:if(o=s(Tn(this.descriptor.data)),!o){_.next=22;break}return c=this.revision,_.prev=3,_.next=6,this._postUpdateToServer({data:o,revision:c,ttl:u});case 6:return d=_.sent,this._handleSuccessfulUpdateResult(d),_.abrupt("return",this.descriptor.data);case 11:if(_.prev=11,_.t0=_.catch(3),_.t0.status!==412){_.next=19;break}return _.next=16,this._softSync();case 16:return _.abrupt("return",this._setWithIfMatch(s));case 19:throw _.t0;case 20:_.next=23;break;case 22:return _.abrupt("return",this.descriptor.data);case 23:case"end":return _.stop()}},a,this,[[3,11]])}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_handleSuccessfulUpdateResult",value:function(i){if(!(i.last_event_id<=this.descriptor.last_event_id)){var a=this.descriptor.data!==void 0?Tn(this.descriptor.data):null;this.descriptor.revision=i.revision,this.descriptor.data=i.data,this.descriptor.last_event_id=i.last_event_id,this.descriptor.date_expires=i.date_expires,this.descriptor.date_updated=new Date(i.date_updated),this.services.storage.update(this.type,this.sid,this.uniqueName,{last_event_id:i.last_event_id,revision:i.revision,date_updated:i.date_updated,data:i.data}),this.broadcastEventToListeners("updated",{data:this.descriptor.data,isLocal:!0,previousData:a})}}},{key:"_postUpdateToServer",value:function(){var n=Ce.default(H.default.mark(function a(s){var u,o,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(this.isDeleted){y.next=17;break}return u={data:s.data},s.ttl!==void 0&&(u.ttl=s.ttl),o=s.revision,y.prev=4,y.next=7,this.services.network.post(this.uri,u,o);case 7:return c=y.sent,y.abrupt("return",{revision:c.body.revision,data:s.data,last_event_id:c.body.last_event_id,date_updated:c.body.date_updated,date_expires:c.body.date_expires});case 11:throw y.prev=11,y.t0=y.catch(4),y.t0.status===404&&this.onRemoved(!1),y.t0;case 15:y.next=18;break;case 17:return y.abrupt("return",Promise.reject(new Nr("The Document has been removed",404,54100)));case 18:case"end":return y.stop()}},a,this,[[4,11]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_softSync",value:function(){var n=Ce.default(H.default.mark(function a(){var s=this;return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.services.network.get(this.uri).then(function(c){var d={type:"document_updated",id:c.body.last_event_id,document_revision:c.body.revision,document_data:c.body.data,date_created:c.body.date_updated};return s._update(d),s}).catch(function(c){c.status===404?s.onRemoved(!1):gt.error("Can't get updates for ".concat(s.sid,":"),c)}));case 1:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"onRemoved",value:function(i){if(!this.isDeleted){var a=this.descriptor.data!==void 0?Tn(this.descriptor.data):null;this.isDeleted=!0,this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i,previousData:a})}}},{key:"removeDocument",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.isDeleted){u.next=6;break}return u.next=3,this.services.network.delete(this.uri);case 3:this.onRemoved(!0),u.next=7;break;case 6:return u.abrupt("return",Promise.reject(new Nr("The Document has been removed",404,54100)));case 7:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}],[{key:"type",get:function(){return"document"}}]),r}(ll),sn=function(e){Ir.default(r,e);var t=YT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncDocumentImpl=n,i.syncDocumentImpl.attach(Bn.default(i)),i}return wt.default(r,[{key:"uri",get:function(){return this.syncDocumentImpl.uri}},{key:"revision",get:function(){return this.syncDocumentImpl.revision}},{key:"lastEventId",get:function(){return this.syncDocumentImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncDocumentImpl.dateExpires}},{key:"type",get:function(){return Nh.type}},{key:"sid",get:function(){return this.syncDocumentImpl.sid}},{key:"data",get:function(){return this.syncDocumentImpl.data}},{key:"dateUpdated",get:function(){return this.syncDocumentImpl.dateUpdated}},{key:"uniqueName",get:function(){return this.syncDocumentImpl.uniqueName}},{key:"set",value:function(){var n=Ce.default(H.default.mark(function a(s,u){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncDocumentImpl.set(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ce.default(H.default.mark(function a(s,u){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncDocumentImpl.mutate(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ce.default(H.default.mark(function a(s,u){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncDocumentImpl.update(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncDocumentImpl.setTtl(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeDocument",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncDocumentImpl.removeDocument());case 2:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){ol.default(Qt.default(r.prototype),"close",this).call(this),this.syncDocumentImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Nh.type}}]),r}(cl);$t.default(sn,"removed","removed");$t.default(sn,"updated","updated");vt([me.validateTypesAsync(me.pureObject,["undefined",me.objectSchema("document metadata",{ttl:[me.nonNegativeInteger,"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Object,Object]),_e("design:returntype",Promise)],sn.prototype,"set",null);vt([me.validateTypesAsync("function",["undefined",me.objectSchema("document metadata",{ttl:[me.nonNegativeInteger,"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Function,Object]),_e("design:returntype",Promise)],sn.prototype,"mutate",null);vt([me.validateTypesAsync(me.pureObject,["undefined",me.objectSchema("document metadata",{ttl:[me.nonNegativeInteger,"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Object,Object]),_e("design:returntype",Promise)],sn.prototype,"update",null);vt([me.validateTypesAsync(me.nonNegativeInteger),_e("design:type",Function),_e("design:paramtypes",[Number]),_e("design:returntype",Promise)],sn.prototype,"setTtl",null);var xh=function(){function e(t){pt.default(this,e),this.descriptor=t}return wt.default(e,[{key:"uri",get:function(){return this.descriptor.uri}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.lastEventId}},{key:"dateUpdated",get:function(){return this.descriptor.dateUpdated}},{key:"dateExpires",get:function(){return this.descriptor.dateExpires}},{key:"index",get:function(){return this.descriptor.index}},{key:"data",get:function(){return this.descriptor.data}},{key:"update",value:function(r,n,i,a){return this.descriptor.lastEventId=r,this.descriptor.revision=n,this.descriptor.data=i,this.descriptor.dateUpdated=a,this}},{key:"updateDateExpires",value:function(r){this.descriptor.dateExpires=r}}]),e}(),Gg=function(){function e(t,r,n,i){pt.default(this,e),this.prevToken=n,this.nextToken=i,this.items=t,this.source=r}return wt.default(e,[{key:"hasNextPage",get:function(){return!!this.nextToken}},{key:"hasPrevPage",get:function(){return!!this.prevToken}},{key:"nextPage",value:function(){var t=Ce.default(H.default.mark(function n(){return H.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.hasNextPage){a.next=2;break}throw new Error("No next page");case 2:return a.abrupt("return",this.source(this.nextToken));case 3:case"end":return a.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()},{key:"prevPage",value:function(){var t=Ce.default(H.default.mark(function n(){return H.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(this.hasPrevPage){a.next=2;break}throw new Error("No previous page");case 2:return a.abrupt("return",this.source(this.prevToken));case 3:case"end":return a.stop()}},n,this)}));function r(){return t.apply(this,arguments)}return r}()}]),e}();function SK(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=$K(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function $K(e,t){if(!!e){if(typeof e=="string")return P_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return P_(e,t)}}function P_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var kK=function(){function e(t,r){pt.default(this,e),this.balanceFactor=0,this.key=t,this.value=r,this.parent=null,this.left=null,this.right=null}return wt.default(e,[{key:"isRoot",get:function(){return this.parent===null}},{key:"isLeaf",get:function(){return this.left===null&&this.right===null}},{key:"isLeftChild",get:function(){return this.parent.left===this}},{key:"update",value:function(r){this.value=r}},{key:"replace",value:function(r,n){!r||(this.left===n?this.left=n:this.right===n&&(this.right=n))}}]),e}(),TK=function(){function e(t,r){pt.default(this,e),this.isLessThan=t||function(n,i){return n<i},this.isEqual=r||function(n,i){return n===i},this.root=null,this.count=null}return wt.default(e,[{key:"size",get:function(){return this.count}},{key:"clear",value:function(){this.root=null,this.count=0}},{key:"set",value:function(r,n){var i=this.getNode(r);i?i.update(n):this.insert(r,n)}},{key:"insert",value:function(r,n){var i=new kK(r,n);if(this.count++,!this.root){this.root=i;return}for(var a=this.root;;)if(this.isLessThan(r,a.key))if(a.left)a=a.left;else{a.left=i;break}else if(a.right)a=a.right;else{a.right=i;break}for(i.parent=a,a=i;a.parent;){var s=a.parent,u=s.balanceFactor;if(a.isLeftChild?s.balanceFactor++:s.balanceFactor--,Math.abs(s.balanceFactor)<Math.abs(u))break;if(s.balanceFactor<-1||s.balanceFactor>1){this.rebalance(s);break}a=s}}},{key:"get",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n.value;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"delete",value:function(r){var n=this.getNode(r);if(!n||n.key!==r)return null;var i=n.parent,a=n.left,s=n.right;if(!!a!=!!s){var u=a||s;!i&&!u?this.root=null:i&&!u?this.root=u:(i.replace(n,null),this.rebalance(i))}else{for(var o=n.left;o.right;)o=o.right;if(n.left===o)n.isRoot?(this.root=o,o.parent=null):(n.isLeftChild?n.parent.left=o:n.parent.right=o,o.parent=n.parent),o.right=n.right,o.right.parent=o,o.balanceFactor=n.balanceFactor,n={parent:o,isLeftChild:!0};else{var c=o.parent,d=o.left;c.right=d,d&&(d.parent=c),n.isRoot?(this.root=o,o.parent=null):(n.isLeftChild?n.parent.left=o:n.parent.right=o,o.parent=n.parent),o.right=n.right,o.right.parent=o,o.left=n.left,o.left.parent=o,o.balanceFactor=n.balanceFactor,n={parent:c,isLeftChild:!1}}}for(this.count--;n.parent;){var y=n.parent,_=y.balanceFactor;if(n.isLeftChild?y.balanceFactor-=1:y.balanceFactor+=1,Math.abs(y.balanceFactor)>Math.abs(_))if(y.balanceFactor<-1||y.balanceFactor>1)if(this.rebalance(y),y.parent.balanceFactor===0)n=y.parent;else break;else break;else n=y}return null}},{key:"getNode",value:function(r){for(var n=this.root;n;){if(this.isEqual(r,n.key))return n;this.isLessThan(r,n.key)?n=n.left:n=n.right}return null}},{key:"rebalance",value:function(r){r.balanceFactor<0?r.right.balanceFactor>0?(this.rotateRight(r.right),this.rotateLeft(r)):this.rotateLeft(r):r.balanceFactor>0&&(r.left.balanceFactor<0?(this.rotateLeft(r.left),this.rotateRight(r)):this.rotateRight(r))}},{key:"rotateLeft",value:function(r){var n=r.right;r.right=n.left,n.left!==null&&(n.left.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.left=r,r.parent=n,r.balanceFactor=r.balanceFactor+1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor+1-Math.max(r.balanceFactor,0)}},{key:"rotateRight",value:function(r){var n=r.left;r.left=n.right,n.right!==null&&(n.right.parent=r),n.parent=r.parent,n.parent===null?this.root=n:r.isLeftChild?n.parent.left=n:n.parent.right=n,n.right=r,r.parent=n,r.balanceFactor=r.balanceFactor-1-Math.min(n.balanceFactor,0),n.balanceFactor=n.balanceFactor-1-Math.max(r.balanceFactor,0)}},{key:Symbol.iterator,value:H.default.mark(function t(){var r,n,i;return H.default.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:r=SK(this.getIterator()),s.prev=1,r.s();case 3:if((n=r.n()).done){s.next=9;break}return i=n.value,s.next=7,i;case 7:s.next=3;break;case 9:s.next=14;break;case 11:s.prev=11,s.t0=s.catch(1),r.e(s.t0);case 14:return s.prev=14,r.f(),s.finish(14);case 17:case"end":return s.stop()}},t,this,[[1,11,14,17]])})},{key:"getIterator",value:H.default.mark(function t(){var r,n,i,a=arguments;return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=a.length>0&&a[0]!==void 0?a[0]:null,n=this.root;case 2:if(!n){u.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.left)){u.next=5;break}return u.abrupt("break",8);case 5:this.isLessThan(r,n.key)||r===null?n=n.left:n=n.right,u.next=2;break;case 8:if(n){u.next=10;break}return u.abrupt("return",null);case 10:i=!0;case 11:if(!i){u.next=29;break}return u.next=14,[n.key,n.value];case 14:if(i=!1,!n.right){u.next=21;break}for(n=n.right;n.left;)n=n.left;i=!0,u.next=27;break;case 21:if(!n.parent){u.next=26;break}i=n.parent.left===n,n=n.parent,u.next=27;break;case 26:return u.abrupt("break",37);case 27:u.next=35;break;case 29:if(!n.parent){u.next=34;break}i=n.parent.left===n,n=n.parent,u.next=35;break;case 34:return u.abrupt("break",37);case 35:u.next=11;break;case 37:return u.abrupt("return",null);case 38:case"end":return u.stop()}},t,this)})},{key:"getReverseIterator",value:H.default.mark(function t(){var r,n,i,a=arguments;return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:r=a.length>0&&a[0]!==void 0?a[0]:null,n=this.root;case 2:if(!n){u.next=8;break}if(!(this.isEqual(r,n.key)||r===null&&!n.right)){u.next=5;break}return u.abrupt("break",8);case 5:!this.isLessThan(r,n.key)||r===null?n=n.right:n=n.left,u.next=2;break;case 8:if(n){u.next=10;break}return u.abrupt("return",null);case 10:i=!0;case 11:if(!i){u.next=29;break}return u.next=14,[n.key,n.value];case 14:if(i=!1,!n.left){u.next=21;break}for(n=n.left;n.right;)n=n.right;i=!0,u.next=27;break;case 21:if(!n.parent){u.next=26;break}i=n.parent.right===n,n=n.parent,u.next=27;break;case 26:return u.abrupt("break",37);case 27:u.next=35;break;case 29:if(!n.parent){u.next=34;break}i=n.parent.right===n,n=n.parent,u.next=35;break;case 34:return u.abrupt("break",37);case 35:u.next=11;break;case 37:return u.abrupt("return",null);case 38:case"end":return u.stop()}},t,this)})}]),e}();function EK(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=IK(e))||t&&e&&typeof e.length=="number"){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(c){throw c},f:i}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a=!0,s=!1,u;return{s:function(){r=r.call(e)},n:function(){var c=r.next();return a=c.done,c},e:function(c){s=!0,u=c},f:function(){try{!a&&r.return!=null&&r.return()}finally{if(s)throw u}}}}function IK(e,t){if(!!e){if(typeof e=="string")return M_(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);if(r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set")return Array.from(e);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return M_(e,t)}}function M_(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var CK=function(){function e(t,r){pt.default(this,e),this.value=t,this.revision=r||0}return wt.default(e,[{key:"isValid",get:function(){return!0}}]),e}(),RK=function(){function e(t){pt.default(this,e),this.revision=t}return wt.default(e,[{key:"isValid",get:function(){return!1}}]),e}(),Vg=function(){function e(){pt.default(this,e),this.items=new TK}return wt.default(e,[{key:"store",value:function(r,n,i){var a=this.items.get(r);return a&&a.revision>i?a.isValid?a.value:null:(this.items.set(r,new CK(n,i)),n)}},{key:"delete",value:function(r,n){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this.items.get(r);(!a||a.revision<n||a&&i===!0)&&this.items.set(r,new RK(n))}},{key:"isKnown",value:function(r,n){var i=this.items.get(r);return i&&i.revision>=n}},{key:"get",value:function(r){var n=this.items.get(r);return n&&n.isValid?n.value:null}},{key:"has",value:function(r){var n=this.items.get(r);return n&&n.isValid}},{key:"forEach",value:function(r){if(this.items){var n=EK(this.items),i;try{for(n.s();!(i=n.n()).done;){var a=BT.default(i.value,2),s=a[0],u=a[1];u.isValid&&r(s,u.value)}}catch(o){n.e(o)}finally{n.f()}}}}]),e}();function QT(e){var t=OK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function OK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Lh=function(e){Ir.default(r,e);var t=QT(r);function r(n,i,a){var s;pt.default(this,r),s=t.call(this,n,a);var u=function(c,d){return typeof d.ttl=="number"?{ttl:d.ttl}:c};return s.updateMergingQueue=new JT(u),s.cache=new Vg,s.descriptor=i,s.descriptor.date_updated=new Date(s.descriptor.date_updated),s}return wt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"list"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"_addOrUpdateItemOnServer",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o,c){var d,y;return H.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return d={data:u},c!==void 0&&(d.ttl=c),w.next=4,this.services.network.post(s,d,o);case 4:return y=w.sent,y.body.data=u,y.body.date_updated=new Date(y.body.date_updated),w.abrupt("return",y.body);case 8:case"end":return w.stop()}},a,this)}));function i(a,s,u,o){return n.apply(this,arguments)}return i}()},{key:"push",value:function(){var n=Ce.default(H.default.mark(function a(s,u){var o,c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return o=(u||{}).ttl,_.next=3,this._addOrUpdateItemOnServer(this.links.items,s,void 0,o);case 3:return c=_.sent,d=Number(c.index),this._handleItemMutated(d,c.url,c.last_event_id,c.revision,s,c.date_updated,c.date_expires,!0,!1),_.abrupt("return",this.cache.get(d));case 7:case"end":return _.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"set",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){var c=this,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=o||{},_.abrupt("return",this.updateMergingQueue.squashAndAdd(s,d,function(w){return c._updateItemUnconditionally(s,u,w.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"_updateItemUnconditionally",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){var c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.get(s);case 2:return c=_.sent,_.next=5,this._addOrUpdateItemOnServer(c.uri,u,void 0,o);case 5:return d=_.sent,this._handleItemMutated(s,d.url,d.last_event_id,d.revision,d.data,d.date_updated,d.date_expires,!1,!1),_.abrupt("return",this.cache.get(s));case 8:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"_updateItemWithIfMatch",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){var c,d,y,_;return H.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,this.get(s);case 2:if(c=k.sent,d=u(Tn(c.data)),!d){k.next=25;break}return y=c.revision,k.prev=6,k.next=9,this._addOrUpdateItemOnServer(c.uri,d,y,o);case 9:return _=k.sent,this._handleItemMutated(s,_.url,_.last_event_id,_.revision,_.data,_.date_updated,_.date_expires,!1,!1),k.abrupt("return",this.cache.get(s));case 14:if(k.prev=14,k.t0=k.catch(6),k.t0.status!==412){k.next=22;break}return k.next=19,this._getItemFromServer(s);case 19:return k.abrupt("return",this._updateItemWithIfMatch(s,u,o));case 22:throw k.t0;case 23:k.next=26;break;case 25:return k.abrupt("return",c);case 26:case"end":return k.stop()}},a,this,[[6,14]])}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){var c=this,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=o||{},_.abrupt("return",this.updateMergingQueue.add(s,d,function(w){return c._updateItemWithIfMatch(s,u,w.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.mutate(s,function(y){return Object.assign(y,u)},o));case 1:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Ce.default(H.default.mark(function a(s){var u,o,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.get(s);case 2:return u=y.sent,o=Tn(u.data),y.next=6,this.services.network.delete(u.uri);case 6:c=y.sent,this._handleItemRemoved(s,c.body.last_event_id,o,new Date(c.body.date_updated),!1);case 8:case"end":return y.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Ce.default(H.default.mark(function a(s){var u;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(u=this.cache.get(s),!u){c.next=5;break}return c.abrupt("return",u);case 5:return c.abrupt("return",this._getItemFromServer(s));case 6:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getItemFromServer",value:function(){var n=Ce.default(H.default.mark(function a(s){var u;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.queryItems({index:s});case 2:if(u=c.sent,!(u.items.length<1)){c.next=7;break}throw new Nr("No item with index ".concat(s," found"),404,54151);case 7:return c.abrupt("return",u.items[0]);case 8:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"queryItems",value:function(){var n=Ce.default(H.default.mark(function a(s){var u=this,o,c,d,y;return H.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return s=s||{},o=new to(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Index",s.index).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),w.next=4,this.services.network.get(o);case 4:return c=w.sent,d=c.body.items.map(function(k){k.date_updated=new Date(k.date_updated);var N=u.cache.get(k.index);return N?u._handleItemMutated(k.index,k.url,k.last_event_id,k.revision,k.data,k.date_updated,k.date_expires,!1,!0):u.cache.store(Number(k.index),new xh({index:Number(k.index),uri:k.url,revision:k.revision,lastEventId:k.last_event_id,dateUpdated:k.date_updated,dateExpires:k.date_expires,data:k.data}),k.last_event_id),u.cache.get(k.index)}),y=c.body.meta,w.abrupt("return",new Gg(d,function(k){return u.queryItems({pageToken:k})},y.previous_token,y.next_token));case 8:case"end":return w.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return s=s||{},zT(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",o.abrupt("return",this.queryItems(s));case 5:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getContext",value:function(){var n=Ce.default(H.default.mark(function a(){var s;return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.context){o.next=5;break}return o.next=3,this.services.network.get(this.links.context);case 3:s=o.sent,this._updateContextIfRequired(s.body.data,s.body.last_event_id);case 5:return o.abrupt("return",this.context);case 6:case"end":return o.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ce.default(H.default.mark(function a(s){var u,o;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,u={ttl:s},d.next=4,this.services.network.post(this.uri,u);case 4:o=d.sent,this.descriptor.date_expires=o.body.date_expires,d.next=12;break;case 8:throw d.prev=8,d.t0=d.catch(0),d.t0.status===404&&this.onRemoved(!1),d.t0;case 12:case"end":return d.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Ce.default(H.default.mark(function a(s,u){var o,c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.get(s);case 2:return o=_.sent,c={ttl:u},_.next=6,this.services.network.post(o.uri,c);case 6:d=_.sent,o.updateDateExpires(d.body.date_expires);case 8:case"end":return _.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeList",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}},{key:"shouldIgnoreEvent",value:function(i,a){return this.cache.isKnown(i,a)}},{key:"_update",value:function(i,a){var s=Number(i.item_index);switch(i.date_created=new Date(i.date_created),i.type){case"list_item_added":case"list_item_updated":this._handleItemMutated(s,i.item_url,i.id,i.item_revision,i.item_data,i.date_created,void 0,i.type==="list_item_added",!0);break;case"list_item_removed":this._handleItemRemoved(s,i.id,i.item_data,i.date_created,!0);break;case"list_context_updated":this._handleContextUpdate(i.context_data,i.id,i.date_created);break;case"list_removed":this.onRemoved(!1);break}a&&this._advanceLastEventId(i.id,i.list_revision)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i,a&&(this.descriptor.revision=a))}},{key:"_updateRootDateUpdated",value:function(i){(!this.descriptor.date_updated||i.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=i,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:i}))}},{key:"_handleItemMutated",value:function(i,a,s,u,o,c,d,y,_){if(this.shouldIgnoreEvent(i,s)){gt.trace("Item ".concat(i," update skipped, current: ").concat(this.lastEventId,", remote: ").concat(s));return}this._updateRootDateUpdated(c);var w=this.cache.get(i);if(!w){var k=new xh({index:i,uri:a,lastEventId:s,revision:u,data:o,dateUpdated:c,dateExpires:d});this.cache.store(i,k,s),this.emitItemMutationEvent(k,_,y);return}var N=Tn(w.data);w.update(s,u,o,c),this.cache.store(i,w,s),d!==void 0&&w.updateDateExpires(d),this.emitItemMutationEvent(w,_,!1,N)}},{key:"emitItemMutationEvent",value:function(i,a,s){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=s?"itemAdded":"itemUpdated",c={item:i,isLocal:!a};s||(c.previousItemData=u),this.broadcastEventToListeners(o,c)}},{key:"_handleItemRemoved",value:function(i,a,s,u,o){this._updateRootDateUpdated(u),this.cache.delete(i,a),this.broadcastEventToListeners("itemRemoved",{index:i,isLocal:!o,previousItemData:s})}},{key:"_handleContextUpdate",value:function(i,a,s){this._updateRootDateUpdated(s),this._updateContextIfRequired(i,a)&&this.broadcastEventToListeners("contextUpdated",{context:i,isLocal:!1})}},{key:"_updateContextIfRequired",value:function(i,a){return!this.contextEventId||a>this.contextEventId?(this.context=i,this.contextEventId=a,!0):(gt.trace("Context update skipped, current:",this.lastEventId,", remote:",a),!1)}}],[{key:"type",get:function(){return"list"}}]),r}(ll),tr=function(e){Ir.default(r,e);var t=QT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncListImpl=n,i.syncListImpl.attach(Bn.default(i)),i}return wt.default(r,[{key:"uri",get:function(){return this.syncListImpl.uri}},{key:"revision",get:function(){return this.syncListImpl.revision}},{key:"lastEventId",get:function(){return this.syncListImpl.lastEventId}},{key:"links",get:function(){return this.syncListImpl.links}},{key:"dateExpires",get:function(){return this.syncListImpl.dateExpires}},{key:"type",get:function(){return Lh.type}},{key:"sid",get:function(){return this.syncListImpl.sid}},{key:"uniqueName",get:function(){return this.syncListImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncListImpl.dateUpdated}},{key:"push",value:function(){var n=Ce.default(H.default.mark(function a(s,u){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.push(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"set",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncListImpl.set(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncListImpl.mutate(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncListImpl.update(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.remove(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.get(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getContext",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.getContext());case 2:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.getItems(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncListImpl.setTtl(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Ce.default(H.default.mark(function a(s,u){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncListImpl.setItemTtl(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeList",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncListImpl.removeList());case 2:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){ol.default(Qt.default(r.prototype),"close",this).call(this),this.syncListImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Lh.type}}]),r}(cl);$t.default(tr,"itemAdded","itemAdded");$t.default(tr,"itemUpdated","itemUpdated");$t.default(tr,"itemRemoved","itemRemoved");$t.default(tr,"removed","removed");vt([me.validateTypesAsync(me.pureObject,["undefined",me.objectSchema("item metadata",{ttl:[me.nonNegativeInteger,"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Object,Object]),_e("design:returntype",Promise)],tr.prototype,"push",null);vt([me.validateTypesAsync(me.nonNegativeInteger,me.pureObject,["undefined",me.objectSchema("item metadata",{ttl:[me.nonNegativeInteger,"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Number,Object,Object]),_e("design:returntype",Promise)],tr.prototype,"set",null);vt([me.validateTypesAsync(me.nonNegativeInteger,"function",["undefined",me.objectSchema("item metadata",{ttl:[me.nonNegativeInteger,"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Number,Function,Object]),_e("design:returntype",Promise)],tr.prototype,"mutate",null);vt([me.validateTypesAsync(me.nonNegativeInteger,me.pureObject,["undefined",me.objectSchema("item metadata",{ttl:[me.nonNegativeInteger,"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Number,Object,Object]),_e("design:returntype",Promise)],tr.prototype,"update",null);vt([me.validateTypesAsync(me.nonNegativeInteger),_e("design:type",Function),_e("design:paramtypes",[Number]),_e("design:returntype",Promise)],tr.prototype,"remove",null);vt([me.validateTypesAsync(me.nonNegativeInteger),_e("design:type",Function),_e("design:paramtypes",[Number]),_e("design:returntype",Promise)],tr.prototype,"get",null);vt([me.validateTypesAsync(["undefined",me.objectSchema("query options",{from:[me.nonNegativeInteger,"undefined"],pageSize:[me.custom(function(e){return[Hg(e),"a positive integer"]}),"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Object]),_e("design:returntype",Promise)],tr.prototype,"getItems",null);vt([me.validateTypesAsync(me.nonNegativeInteger),_e("design:type",Function),_e("design:paramtypes",[Number]),_e("design:returntype",Promise)],tr.prototype,"setTtl",null);vt([me.validateTypesAsync(me.nonNegativeInteger,me.nonNegativeInteger),_e("design:type",Function),_e("design:paramtypes",[Number,Number]),_e("design:returntype",Promise)],tr.prototype,"setItemTtl",null);var Zo=function(){function e(t){pt.default(this,e),this.descriptor=t}return wt.default(e,[{key:"uri",get:function(){return this.descriptor.url}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"key",get:function(){return this.descriptor.key}},{key:"data",get:function(){return this.descriptor.data}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"update",value:function(r,n,i,a){return this.descriptor.last_event_id=r,this.descriptor.revision=n,this.descriptor.data=i,this.descriptor.date_updated=a,this}},{key:"updateDateExpires",value:function(r){this.descriptor.date_expires=r}}]),e}();function XT(e){var t=AK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function AK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var jh=function(e){Ir.default(r,e);var t=XT(r);function r(n,i,a){var s;pt.default(this,r),s=t.call(this,n,a);var u=function(c,d){return typeof d.ttl=="number"?{ttl:d.ttl}:c};return s.updateMergingQueue=new JT(u),s.cache=new Vg,s.descriptor=i,s.descriptor.date_updated=new Date(s.descriptor.date_updated),i.items&&i.items.forEach(function(o){o.date_updated=new Date(o.date_updated),s.cache.store(o.key,new Zo(o),o.last_event_id)}),s}return wt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"revision",get:function(){return this.descriptor.revision}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"map"}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"dateUpdated",get:function(){return this.descriptor.date_updated}},{key:"set",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){var c=this,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=o||{},_.abrupt("return",this.updateMergingQueue.squashAndAdd(s,d,function(w){return c._putItemUnconditionally(s,u,w.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(s!=null){o.next=2;break}throw new Nr("SyncMapItem key may not be empty",400,54209);case 2:if(!this.cache.has(s)){o.next=6;break}return o.abrupt("return",this.cache.get(s));case 6:return o.abrupt("return",this._getItemFromServer(s));case 7:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getItemFromServer",value:function(){var n=Ce.default(H.default.mark(function a(s){var u;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,this.queryItems({key:s});case 2:if(u=c.sent,!(u.items.length<1)){c.next=7;break}throw new Nr("The specified Map Item does not exist",404,54201);case 7:return c.abrupt("return",u.items[0]);case 8:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){var c=this,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return d=o||{},_.abrupt("return",this.updateMergingQueue.add(s,d,function(w){return c._putItemWithIfMatch(s,u,w.ttl)}));case 2:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.abrupt("return",this.mutate(s,function(y){return Object.assign(y,u)},o));case 1:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"_putItemUnconditionally",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){var c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this._putItemToServer(s,u,void 0,o);case 2:return c=_.sent,d=c.item,this._handleItemMutated(d.key,d.url,d.last_event_id,d.revision,d.data,d.date_updated,d.date_expires,c.added,!1),_.abrupt("return",this.cache.get(d.key));case 6:case"end":return _.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"_putItemWithIfMatch",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){var c,d,y,_,w;return H.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this.get(s).catch(function(M){if(M.status===404)return new Zo({key:s,data:{},last_event_id:-1,revision:"-1",url:null,date_updated:null,date_expires:null});throw M});case 2:if(c=N.sent,d=u(Tn(c.data)),!d){N.next=26;break}return y=c.revision,N.prev=6,N.next=9,this._putItemToServer(s,d,y,o);case 9:return _=N.sent,w=_.item,this._handleItemMutated(w.key,w.url,w.last_event_id,w.revision,w.data,w.date_updated,w.date_expires,_.added,!1),N.abrupt("return",this.cache.get(w.key));case 15:if(N.prev=15,N.t0=N.catch(6),N.t0.status!==412){N.next=23;break}return N.next=20,this._getItemFromServer(s);case 20:return N.abrupt("return",this._putItemWithIfMatch(s,u,o));case 23:throw N.t0;case 24:N.next=27;break;case 26:return N.abrupt("return",c);case 27:case"end":return N.stop()}},a,this,[[6,15]])}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"_putItemToServer",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o,c){var d,y,_,w,k;return H.default.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return d=new to(this.links.items).pathSegment(s).build(),y={data:u},c!==void 0&&(y.ttl=c),M.prev=3,M.next=6,this.services.network.put(d,y,o);case 6:return _=M.sent,w=_.body,w.data=u,w.date_updated=new Date(w.date_updated),k=_.status.code===201,M.abrupt("return",{added:k,item:w});case 14:throw M.prev=14,M.t0=M.catch(3),M.t0.status===404&&this.onRemoved(!1),M.t0;case 18:case"end":return M.stop()}},a,this,[[3,14]])}));function i(a,s,u,o){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Ce.default(H.default.mark(function a(s){var u,o,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,this.get(s);case 2:return u=y.sent,o=Tn(u.data),y.next=6,this.services.network.delete(u.uri);case 6:c=y.sent,this._handleItemRemoved(s,c.body.last_event_id,o,new Date(c.body.date_updated),!1);case 8:case"end":return y.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"queryItems",value:function(){var n=Ce.default(H.default.mark(function a(s){var u=this,o,c,d,y;return H.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return s=s||{},o=new to(this.links.items).queryParam("From",s.from).queryParam("PageSize",s.limit).queryParam("Key",s.key).queryParam("PageToken",s.pageToken).queryParam("Order",s.order).build(),w.next=4,this.services.network.get(o);case 4:return c=w.sent,d=c.body.items.map(function(k){k.date_updated=new Date(k.date_updated);var N=u.cache.get(k.key);return N?u._handleItemMutated(k.key,k.url,k.last_event_id,k.revision,k.data,k.date_updated,k.date_expires,!1,!0):u.cache.store(k.key,new Zo(k),k.last_event_id),u.cache.get(k.key)}),y=c.body.meta,w.abrupt("return",new Gg(d,function(k){return u.queryItems({pageToken:k})},y.previous_token,y.next_token));case 8:case"end":return w.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return s=s||{},zT(s.pageSize),s.limit=s.pageSize||s.limit||50,s.order=s.order||"asc",o.abrupt("return",this.queryItems(s));case 5:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"shouldIgnoreEvent",value:function(i,a){return this.cache.isKnown(i,a)}},{key:"_update",value:function(i,a){switch(i.date_created=new Date(i.date_created),i.type){case"map_item_added":case"map_item_updated":this._handleItemMutated(i.item_key,i.item_url,i.id,i.item_revision,i.item_data,i.date_created,void 0,i.type==="map_item_added",!0);break;case"map_item_removed":this._handleItemRemoved(i.item_key,i.id,i.item_data,i.date_created,!0);break;case"map_removed":this.onRemoved(!1);break}a&&this._advanceLastEventId(i.id,i.map_revision)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i,a&&(this.descriptor.revision=a))}},{key:"_updateRootDateUpdated",value:function(i){(!this.descriptor.date_updated||i.getTime()>this.descriptor.date_updated.getTime())&&(this.descriptor.date_updated=i,this.services.storage.update(this.type,this.sid,this.uniqueName,{date_updated:i}))}},{key:"_handleItemMutated",value:function(i,a,s,u,o,c,d,y,_){if(this.shouldIgnoreEvent(i,s)){gt.trace("SyncMapItem ",i," update skipped, current:",this.lastEventId,", remote:",s);return}this._updateRootDateUpdated(c);var w=this.cache.get(i);if(!w){var k=new Zo({key:i,url:a,last_event_id:s,revision:u,data:o,date_updated:c,date_expires:d});this.cache.store(i,k,s),this.emitItemMutationEvent(k,_,y);return}var N=Tn(w.data);w.update(s,u,o,c),this.cache.store(i,w,s),d!==void 0&&w.updateDateExpires(d),this.emitItemMutationEvent(w,_,!1,N)}},{key:"emitItemMutationEvent",value:function(i,a,s){var u=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,o=s?"itemAdded":"itemUpdated",c={item:i,isLocal:!a};s||(c.previousItemData=u),this.broadcastEventToListeners(o,c)}},{key:"_handleItemRemoved",value:function(i,a,s,u,o){this._updateRootDateUpdated(u),this.cache.delete(i,a),this.broadcastEventToListeners("itemRemoved",{key:i,isLocal:!o,previousItemData:s})}},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}},{key:"setTtl",value:function(){var n=Ce.default(H.default.mark(function a(s){var u,o;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,u={ttl:s},d.next=4,this.services.network.post(this.uri,u);case 4:o=d.sent,this.descriptor.date_expires=o.body.date_expires,d.next=12;break;case 8:throw d.prev=8,d.t0=d.catch(0),d.t0.status===404&&this.onRemoved(!1),d.t0;case 12:case"end":return d.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Ce.default(H.default.mark(function a(s,u){var o,c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,this.get(s);case 2:return o=_.sent,c={ttl:u},_.next=6,this.services.network.post(o.uri,c);case 6:d=_.sent,o.updateDateExpires(d.body.date_expires);case 8:case"end":return _.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeMap",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()}],[{key:"type",get:function(){return"map"}}]),r}(ll),rr=function(e){Ir.default(r,e);var t=XT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncMapImpl=n,i.syncMapImpl.attach(Bn.default(i)),i}return wt.default(r,[{key:"uri",get:function(){return this.syncMapImpl.uri}},{key:"links",get:function(){return this.syncMapImpl.links}},{key:"revision",get:function(){return this.syncMapImpl.revision}},{key:"lastEventId",get:function(){return this.syncMapImpl.lastEventId}},{key:"dateExpires",get:function(){return this.syncMapImpl.dateExpires}},{key:"type",get:function(){return jh.type}},{key:"sid",get:function(){return this.syncMapImpl.sid}},{key:"uniqueName",get:function(){return this.syncMapImpl.uniqueName}},{key:"dateUpdated",get:function(){return this.syncMapImpl.dateUpdated}},{key:"set",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncMapImpl.set(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"get",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.get(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"mutate",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncMapImpl.mutate(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"update",value:function(){var n=Ce.default(H.default.mark(function a(s,u,o){return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.ensureNotClosed(),d.abrupt("return",this.syncMapImpl.update(s,u,o));case 2:case"end":return d.stop()}},a,this)}));function i(a,s,u){return n.apply(this,arguments)}return i}()},{key:"remove",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.remove(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.getItems(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncMapImpl.setTtl(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setItemTtl",value:function(){var n=Ce.default(H.default.mark(function a(s,u){return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.ensureNotClosed(),c.abrupt("return",this.syncMapImpl.setItemTtl(s,u));case 2:case"end":return c.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"removeMap",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.next=3,this.syncMapImpl.removeMap();case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){ol.default(Qt.default(r.prototype),"close",this).call(this),this.syncMapImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return jh.type}}]),r}(cl);$t.default(rr,"itemAdded","itemAdded");$t.default(rr,"itemUpdated","itemUpdated");$t.default(rr,"itemRemoved","itemRemoved");$t.default(rr,"removed","removed");vt([me.validateTypesAsync("string",me.pureObject,["undefined",me.objectSchema("item metadata",{ttl:[me.nonNegativeInteger,"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[String,Object,Object]),_e("design:returntype",Promise)],rr.prototype,"set",null);vt([me.validateTypesAsync("string"),_e("design:type",Function),_e("design:paramtypes",[String]),_e("design:returntype",Promise)],rr.prototype,"get",null);vt([me.validateTypesAsync("string","function",["undefined",me.objectSchema("item metadata",{ttl:[me.nonNegativeInteger,"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[String,Function,Object]),_e("design:returntype",Promise)],rr.prototype,"mutate",null);vt([me.validateTypesAsync("string",me.pureObject,["undefined",me.objectSchema("item metadata",{ttl:[me.nonNegativeInteger,"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[String,Object,Object]),_e("design:returntype",Promise)],rr.prototype,"update",null);vt([me.validateTypesAsync("string"),_e("design:type",Function),_e("design:paramtypes",[String]),_e("design:returntype",Promise)],rr.prototype,"remove",null);vt([me.validateTypesAsync(["undefined",me.objectSchema("query options",{from:["string","undefined"],pageSize:[me.custom(function(e){return[Hg(e),"a positive integer"]}),"undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Object]),_e("design:returntype",Promise)],rr.prototype,"getItems",null);vt([me.validateTypesAsync(me.nonNegativeInteger),_e("design:type",Function),_e("design:paramtypes",[Number]),_e("design:returntype",Promise)],rr.prototype,"setTtl",null);vt([me.validateTypesAsync("string",me.nonNegativeInteger),_e("design:type",Function),_e("design:paramtypes",[String,Number]),_e("design:returntype",Promise)],rr.prototype,"setItemTtl",null);function ZT(e){var t=PK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function PK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ou=function(e){Ir.default(r,e);var t=ZT(r);function r(n,i,a){var s;return pt.default(this,r),s=t.call(this,n,a),s.descriptor=i,s}return wt.default(r,[{key:"uri",get:function(){return this.descriptor.url}},{key:"links",get:function(){return this.descriptor.links}},{key:"dateExpires",get:function(){return this.descriptor.date_expires}},{key:"type",get:function(){return"stream"}},{key:"lastEventId",get:function(){return null}},{key:"indexName",get:function(){}},{key:"queryString",get:function(){}},{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return this.descriptor.unique_name||null}},{key:"publishMessage",value:function(){var n=Ce.default(H.default.mark(function a(s){var u,o,c,d;return H.default.wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return u={data:s},_.next=3,this.services.network.post(this.links.messages,u);case 3:return o=_.sent,c=o.body,d=this._handleMessagePublished(c.sid,s,!1),_.abrupt("return",d);case 7:case"end":return _.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ce.default(H.default.mark(function a(s){var u,o;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.prev=0,u={ttl:s},d.next=4,this.services.network.post(this.uri,u);case 4:o=d.sent,this.descriptor.date_expires=o.body.date_expires,d.next=12;break;case 8:throw d.prev=8,d.t0=d.catch(0),d.t0.status===404&&this.onRemoved(!1),d.t0;case 12:case"end":return d.stop()}},a,this,[[0,8]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeStream",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.network.delete(this.uri);case 2:this.onRemoved(!0);case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"_update",value:function(i){switch(i.type){case"stream_message_published":{this._handleMessagePublished(i.message_sid,i.message_data,!0);break}case"stream_removed":{this.onRemoved(!1);break}}}},{key:"_handleMessagePublished",value:function(i,a,s){var u={sid:i,data:a};return this.broadcastEventToListeners("messagePublished",{message:u,isLocal:!s}),u}},{key:"onRemoved",value:function(i){this._unsubscribe(),this.removalHandler(this.type,this.sid,this.uniqueName),this.broadcastEventToListeners("removed",{isLocal:i})}}],[{key:"type",get:function(){return"stream"}}]),r}(ll);vt([me.validateTypesAsync(me.pureObject),_e("design:type",Function),_e("design:paramtypes",[Object]),_e("design:returntype",Promise)],Ou.prototype,"publishMessage",null);vt([me.validateTypesAsync(me.nonNegativeInteger),_e("design:type",Function),_e("design:paramtypes",[Number]),_e("design:returntype",Promise)],Ou.prototype,"setTtl",null);var Dn=function(e){Ir.default(r,e);var t=ZT(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.syncStreamImpl=n,i.syncStreamImpl.attach(Bn.default(i)),i}return wt.default(r,[{key:"uri",get:function(){return this.syncStreamImpl.uri}},{key:"links",get:function(){return this.syncStreamImpl.links}},{key:"dateExpires",get:function(){return this.syncStreamImpl.dateExpires}},{key:"type",get:function(){return Ou.type}},{key:"lastEventId",get:function(){return null}},{key:"sid",get:function(){return this.syncStreamImpl.sid}},{key:"uniqueName",get:function(){return this.syncStreamImpl.uniqueName}},{key:"publishMessage",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncStreamImpl.publishMessage(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"setTtl",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return this.ensureNotClosed(),o.abrupt("return",this.syncStreamImpl.setTtl(s));case 2:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"removeStream",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return this.ensureNotClosed(),u.abrupt("return",this.syncStreamImpl.removeStream());case 2:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"close",value:function(){ol.default(Qt.default(r.prototype),"close",this).call(this),this.syncStreamImpl.detach(this.listenerUuid)}}],[{key:"type",get:function(){return Ou.type}}]),r}(cl);$t.default(Dn,"messagePublished","messagePublished");$t.default(Dn,"removed","removed");vt([me.validateTypesAsync(me.pureObject),_e("design:type",Function),_e("design:paramtypes",[Object]),_e("design:returntype",Promise)],Dn.prototype,"publishMessage",null);vt([me.validateTypesAsync(me.nonNegativeInteger),_e("design:type",Function),_e("design:paramtypes",[Number]),_e("design:returntype",Promise)],Dn.prototype,"setTtl",null);var MK=function e(t){pt.default(this,e),this.sdk="js",this.sdkVer=t,this.os=Vl.os.family,this.osVer=Vl.os.version,this.pl=Vl.name,this.plVer=Vl.version},NK=function(){function e(){pt.default(this,e),this.names=new Map,this.entities=new Map}return wt.default(e,[{key:"store",value:function(r){var n=this.entities.get(r.sid);return n||(this.entities.set(r.sid,r),r.uniqueName&&this.names.set(r.type+"::"+r.uniqueName,r.sid),r)}},{key:"getResolved",value:function(r,n){var i=this.names.get(n+"::"+r);return i?this.entities.get(i):null}},{key:"get",value:function(r,n){return this.entities.get(r)||this.getResolved(r,n)||null}},{key:"remove",value:function(r){var n=this.entities.get(r);n&&(this.entities.delete(r),n.uniqueName&&this.names.delete(n.type+"::"+n.uniqueName))}}]),e}();function zg(e){var t=xK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function xK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var LK=function e(){pt.default(this,e)},Uh=function(e){Ir.default(r,e);var t=zg(r);function r(n,i,a,s){var u;return pt.default(this,r),u=t.call(this,i,a),u.descriptor=n,u.cache=new Vg,s&&s.forEach(function(o){u.cache.store(o.key,{key:o.key,value:o.data},o.revision)}),u}return wt.default(r,[{key:"sid",get:function(){return this.descriptor.sid}},{key:"uniqueName",get:function(){return null}},{key:"type",get:function(){return r.type}},{key:"lastEventId",get:function(){return this.descriptor.last_event_id}},{key:"indexName",get:function(){return this.descriptor.indexName}},{key:"queryString",get:function(){return this.descriptor.queryExpression}},{key:"queryUri",get:function(){return this.descriptor.queryUri}},{key:"liveQueryDescriptor",get:function(){return this.descriptor}},{key:"onRemoved",value:function(){}},{key:"getItems",value:function(){var i={};return this.cache.forEach(function(a,s){i[a]=s.value}),i}},{key:"_update",value:function(i,a){switch(i.type){case"live_query_item_updated":this.handleItemMutated(i.item_key,i.item_data,i.item_revision);break;case"live_query_item_removed":this.handleItemRemoved(i.item_key,i.item_revision);break;case"live_query_updated":this.handleBatchUpdate(i.items);break}a&&this._advanceLastEventId(i.last_event_id)}},{key:"handleItemMutated",value:function(i,a,s){if(this.shouldIgnoreEvent(i,s))gt.trace("Item ".concat(i," update skipped, revision: ").concat(s));else{var u={key:i,value:a};this.cache.store(i,u,s),this.broadcastEventToListeners("itemUpdated",u)}}},{key:"handleItemRemoved",value:function(i,a){var s=a===null;this.shouldIgnoreEvent(i,a)?gt.trace("Item ".concat(i," delete skipped, revision: ").concat(a)):(this.cache.delete(i,a,s),this.broadcastEventToListeners("itemRemoved",{key:i}))}},{key:"handleBatchUpdate",value:function(i){var a=this,s={};i!=null&&i.forEach(function(o){s[o.key]={data:o.data,revision:o.revision}}),this.cache.forEach(function(o,c){var d=s[o];d!=null?a.handleItemMutated(o,d.data,d.revision):a.handleItemRemoved(o,null),delete s[o]});for(var u in s)this.handleItemMutated(u,s[u].data,s[u].revision)}},{key:"shouldIgnoreEvent",value:function(i,a){return i!=null&&a!=null&&this.cache.isKnown(i,a)}},{key:"_advanceLastEventId",value:function(i,a){this.lastEventId<i&&(this.descriptor.last_event_id=i)}}],[{key:"type",get:function(){return"live_query"}}]),r}(ll);function eE(e){return Dh.apply(this,arguments)}function Dh(){return Dh=Ce.default(H.default.mark(function e(t){var r,n,i,a,s,u;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(r=t.network,n=t.queryString,i=t.uri,a=t.type,n!=null){c.next=3;break}throw new Nr("Invalid query",400,54507);case 3:return s={query_string:n},a===oi.type&&(s.type=a),c.next=7,r.post(i,s,void 0,!0);case 7:return u=c.sent,c.abrupt("return",u.body);case 9:case"end":return c.stop()}},e)})),Dh.apply(this,arguments)}var oi=function(e){Ir.default(r,e);var t=zg(r);function r(n){var i;return pt.default(this,r),i=t.call(this),i.liveQueryImpl=n,i.liveQueryImpl.attach(Bn.default(i)),i}return wt.default(r,[{key:"type",get:function(){return Uh.type}},{key:"lastEventId",get:function(){return this.liveQueryImpl.lastEventId}},{key:"sid",get:function(){return this.liveQueryImpl.sid}},{key:"close",value:function(){ol.default(Qt.default(r.prototype),"close",this).call(this),this.liveQueryImpl.detach(this.listenerUuid)}},{key:"getItems",value:function(){return this.ensureNotClosed(),this.liveQueryImpl.getItems()}}],[{key:"type",get:function(){return Uh.type}}]),r}(cl);$t.default(oi,"itemUpdated","itemUpdated");$t.default(oi,"itemRemoved","itemRemoved");var fl=function(e){Ir.default(r,e);var t=zg(r);function r(n){var i;return pt.default(this,r),i=t.call(this),$t.default(Bn.default(i),"queryExpression",null),$t.default(Bn.default(i),"items",{}),Object.assign(Bn.default(i),n),i.updateIndexName(n.indexName),i}return wt.default(r,[{key:"type",get:function(){return r.type}},{key:"search",value:function(){var n=Ce.default(H.default.mark(function a(s){var u=this;return H.default.wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return this.items={},c.abrupt("return",eE({network:this.network,uri:this.queryUri,queryString:s}).then(function(d){u.queryExpression=s,d.items&&d.items.forEach(function(y){u.items[y.key]=y.data}),u.emit("searchResult",u.getItems())}).catch(function(d){throw gt.error("Error '".concat(d.message,"' while executing query '").concat(s,"'")),u.queryExpression=null,d}));case 2:case"end":return c.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"subscribe",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(this.queryExpression!=null){u.next=2;break}return u.abrupt("return",Promise.reject(new Nr("Invalid query",400,54507)));case 2:return u.abrupt("return",this.liveQueryCreator(this.indexName,this.queryExpression));case 3:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"getItems",value:function(){return this.items}},{key:"updateIndexName",value:function(i){this.indexName=i,this.queryUri=this.generateQueryUri(this.indexName)}},{key:"generateQueryUri",value:function(i){return new to(this.insightsUri).pathSegment(i).pathSegment("Items").build()}}],[{key:"type",get:function(){return"instant_query"}}]),r}(Tt);$t.default(fl,"searchResult","searchResult");vt([me.validateTypesAsync("string"),_e("design:type",Function),_e("design:paramtypes",[String]),_e("design:returntype",Promise)],fl.prototype,"search",null);vt([me.validateTypes(me.nonEmptyString),_e("design:type",Function),_e("design:paramtypes",[String]),_e("design:returntype",void 0)],fl.prototype,"updateIndexName",null);var jK="3.1.0";function UK(e){var t=DK();return function(){var n=Qt.default(e),i;if(t){var a=Qt.default(this).constructor;i=Reflect.construct(n,arguments,a)}else i=n.apply(this,arguments);return pa.default(this,i)}}function DK(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function N_(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function x_(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?N_(Object(r),!0).forEach(function(n){$t.default(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):N_(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}var FK="data_sync",sp=jK;function zl(e){if(e){if(typeof e=="string")return{id:e,mode:"open_or_create"};var t=e.mode||(e.id?"open_or_create":"create_new");return x_(x_({},e),{},{mode:t})}else return{mode:"create_new"}}var L_="com.twilio.rtd.cds.document",j_="com.twilio.rtd.cds.list",U_="com.twilio.rtd.cds.map",D_="twilio.sync.event",Vr=function(e){Ir.default(r,e);var t=UK(r);function r(n){var i,a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(pt.default(this,r),i=t.call(this),!n)throw new Error("Sync library needs a valid Twilio token to be passed");a.hasOwnProperty("logLevel")?gt.setLevel(a.logLevel):gt.setLevel("silent");var s=a.productId=a.productId||FK;a.clientMetadata=a.clientMetadata||{},a.clientMetadata.hasOwnProperty("type")||(a.clientMetadata.type="sync"),a.clientMetadata.hasOwnProperty("sdk")||(a.clientMetadata.sdk="JS",a.clientMetadata.sdkv=sp);var u=!a.twilsockClient;if(!a.initRegistrations){var o=new xc.InitRegistration(s);r.populateInitRegistrations(o),a.initRegistrations=[o]}var c=a.twilsockClient=a.twilsockClient||new xc.Twilsock(n,s,a);c.on("tokenAboutToExpire",function(w){return i.emit("tokenAboutToExpire",w)}),c.on("tokenExpired",function(){return i.emit("tokenExpired")}),c.on("connectionError",function(w){return i.emit("connectionError",w)}),c.on("stateChanged",function(w){i.emit("connectionStateChanged",w),i.services.subscriptions.onConnectionStateChanged(w==="connected")}),c.on("message",function(w,k){return i._routeMessage(w,k)});var d=new oK(a),y=new vK(new MK(sp),d,c),_=new gK(d);return i.services={config:d,twilsock:c,network:y,storage:_,router:Bn.default(i),subscriptions:null},i.services.subscriptions=new cK(i.services),i.entities=new NK,u&&c.connect(),i}return wt.default(r,[{key:"_routeMessage",value:function(i,a){switch(gt.trace("Notification type:",i,"content:",a),i){case L_:case j_:case U_:this.services.subscriptions.acceptMessage(a,!1);break;case D_:this.services.subscriptions.acceptMessage(a,!0);break}}},{key:"_subscribe",value:function(i,a){this.services.subscriptions.add(i,a)}},{key:"_unsubscribe",value:function(i){this.services.subscriptions.remove(i)}},{key:"connectionState",get:function(){return this.services.twilsock.state}},{key:"ensureReady",value:function(){var n=Ce.default(H.default.mark(function a(){var s;return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:if(this.services.config.sessionStorageEnabled){o.next=2;break}return o.abrupt("return");case 2:return o.prev=2,o.next=5,this.services.twilsock.storageId();case 5:s=o.sent,this.services.storage.updateStorageId(s.id),o.next=12;break;case 9:o.prev=9,o.t0=o.catch(2),gt.warn("Failed to initialize storage",o.t0);case 12:case"end":return o.stop()}},a,this,[[2,9]])}));function i(){return n.apply(this,arguments)}return i}()},{key:"storeRootInSessionCache",value:function(i,a,s){if(!(!this.services.config.sessionStorageEnabled||!a)){var u=Tn(s);(i===tr.type||i===rr.type)&&(u.last_event_id=null,delete u.items),this.services.storage.store(i,a,u)}}},{key:"readRootFromSessionCache",value:function(i,a){return!this.services.config.sessionStorageEnabled||!a?null:this.services.storage.read(i,a)}},{key:"_get",value:function(){var n=Ce.default(H.default.mark(function a(s,u){var o,c,d,y=arguments;return H.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:if(o=y.length>2&&y[2]!==void 0?y[2]:!1,u){w.next=3;break}throw new Nr("Cannot get entity without id",404);case 3:return c=new to(s).pathSegment(u).queryParam("Include",o?"items":void 0).build(),w.next=6,this.services.network.get(c);case 6:return d=w.sent,w.abrupt("return",d.body);case 8:case"end":return w.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_createDocument",value:function(i,a,s){var u={unique_name:i,data:a||{}};return s!==void 0&&(u.ttl=s),this.services.network.post(this.services.config.documentsUri,u).then(function(o){return o.body.data=u.data,o.body})}},{key:"_getDocument",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.readRootFromSessionCache(sn.type,s)||this._get(this.services.config.documentsUri,s));case 1:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createList",value:function(i,a,s,u){var o={unique_name:i,purpose:a,context:s};return u!==void 0&&(o.ttl=u),this.services.network.post(this.services.config.listsUri,o).then(function(c){return c.body})}},{key:"_getList",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.readRootFromSessionCache(tr.type,s)||this._get(this.services.config.listsUri,s));case 1:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createMap",value:function(i,a){var s={unique_name:i};return a!==void 0&&(s.ttl=a),this.services.network.post(this.services.config.mapsUri,s).then(function(u){return u.body})}},{key:"_getMap",value:function(){var n=Ce.default(H.default.mark(function a(s){var u,o=arguments;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return u=o.length>1&&o[1]!==void 0?o[1]:!1,d.abrupt("return",this.readRootFromSessionCache(rr.type,s)||this._get(this.services.config.mapsUri,s,u));case 2:case"end":return d.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_getStream",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.readRootFromSessionCache(Dn.type,s)||this._get(this.services.config.streamsUri,s,!1));case 1:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"_createStream",value:function(){var n=Ce.default(H.default.mark(function a(s,u){var o,c;return H.default.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return o={unique_name:s},u!==void 0&&(o.ttl=u),y.next=4,this.services.network.post(this.services.config.streamsUri,o);case 4:return c=y.sent,y.abrupt("return",c.body);case 6:case"end":return y.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"_getLiveQuery",value:function(i){return this.readRootFromSessionCache(oi.type,i)}},{key:"getCached",value:function(i,a){return i&&this.entities.get(i,a)||null}},{key:"removeFromCacheAndSession",value:function(i,a,s){this.entities.remove(a),this.services.config.sessionStorageEnabled&&this.services.storage.remove(i,a,s)}},{key:"document",value:function(){var n=Ce.default(H.default.mark(function a(s){var u=this,o,c,d,y;return H.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.ensureReady();case 2:if(o=zl(s),o.mode!=="create_new"){w.next=9;break}return w.next=6,this._createDocument(o.id,o.data,o.ttl);case 6:c=w.sent,w.next=39;break;case 9:if(d=this.getCached(o.id,sn.type),!d){w.next=14;break}return w.abrupt("return",new sn(d));case 14:return w.prev=14,w.next=17,this._getDocument(o.id);case 17:c=w.sent,w.next=39;break;case 20:if(w.prev=20,w.t0=w.catch(14),!(w.t0.status!==404||o.mode==="open_existing")){w.next=26;break}throw w.t0;case 26:return w.prev=26,w.next=29,this._createDocument(o.id,o.data,o.ttl);case 29:c=w.sent,w.next=39;break;case 32:if(w.prev=32,w.t1=w.catch(26),w.t1.status!==409){w.next=38;break}return w.abrupt("return",this.document(s));case 38:throw w.t1;case 39:return this.storeRootInSessionCache(sn.type,o.id,c),y=new Nh(this.services,c,function(k,N,M){return u.removeFromCacheAndSession(k,N,M)}),y=this.entities.store(y),w.abrupt("return",new sn(y));case 43:case"end":return w.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"map",value:function(){var n=Ce.default(H.default.mark(function a(s){var u=this,o,c,d,y;return H.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.ensureReady();case 2:if(o=zl(s),o.mode!=="create_new"){w.next=9;break}return w.next=6,this._createMap(o.id,o.ttl);case 6:c=w.sent,w.next=39;break;case 9:if(d=this.getCached(o.id,rr.type),!d){w.next=14;break}return w.abrupt("return",new rr(d));case 14:return w.prev=14,w.next=17,this._getMap(o.id,o.includeItems);case 17:c=w.sent,w.next=39;break;case 20:if(w.prev=20,w.t0=w.catch(14),!(w.t0.status!==404||o.mode==="open_existing")){w.next=26;break}throw w.t0;case 26:return w.prev=26,w.next=29,this._createMap(o.id,o.ttl);case 29:c=w.sent,w.next=39;break;case 32:if(w.prev=32,w.t1=w.catch(26),w.t1.status!==409){w.next=38;break}return w.abrupt("return",this.map(s));case 38:throw w.t1;case 39:return this.storeRootInSessionCache(rr.type,o.id,c),y=new jh(this.services,c,function(k,N,M){return u.removeFromCacheAndSession(k,N,M)}),y=this.entities.store(y),w.abrupt("return",new rr(y));case 43:case"end":return w.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"list",value:function(){var n=Ce.default(H.default.mark(function a(s){var u=this,o,c,d,y;return H.default.wrap(function(w){for(;;)switch(w.prev=w.next){case 0:return w.next=2,this.ensureReady();case 2:if(o=zl(s),o.mode!=="create_new"){w.next=9;break}return w.next=6,this._createList(o.id,o.purpose,o.context,o.ttl);case 6:c=w.sent,w.next=39;break;case 9:if(d=this.getCached(o.id,tr.type),!d){w.next=14;break}return w.abrupt("return",new tr(d));case 14:return w.prev=14,w.next=17,this._getList(o.id);case 17:c=w.sent,w.next=39;break;case 20:if(w.prev=20,w.t0=w.catch(14),!(w.t0.status!==404||o.mode==="open_existing")){w.next=26;break}throw w.t0;case 26:return w.prev=26,w.next=29,this._createList(o.id,o.purpose,o.context,o.ttl);case 29:c=w.sent,w.next=39;break;case 32:if(w.prev=32,w.t1=w.catch(26),w.t1.status!==409){w.next=38;break}return w.abrupt("return",this.list(s));case 38:throw w.t1;case 39:return this.storeRootInSessionCache(tr.type,o.id,c),y=new Lh(this.services,c,function(k,N,M){return u.removeFromCacheAndSession(k,N,M)}),y=this.entities.store(y),w.abrupt("return",new tr(y));case 43:case"end":return w.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"stream",value:function(){var n=Ce.default(H.default.mark(function a(s){var u=this,o,c,d,y,_;return H.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,this.ensureReady();case 2:if(o=zl(s),o.mode!=="create_new"){k.next=9;break}return k.next=6,this._createStream(o.id,o.ttl);case 6:c=k.sent,k.next=39;break;case 9:if(d=this.getCached(o.id,Dn.type),!d){k.next=14;break}return k.abrupt("return",new Dn(d));case 14:return k.prev=14,k.next=17,this._getStream(o.id);case 17:c=k.sent,k.next=39;break;case 20:if(k.prev=20,k.t0=k.catch(14),!(k.t0.status!==404||o.mode==="open_existing")){k.next=26;break}throw k.t0;case 26:return k.prev=26,k.next=29,this._createStream(o.id,o.ttl);case 29:c=k.sent,k.next=39;break;case 32:if(k.prev=32,k.t1=k.catch(26),k.t1.status!==409){k.next=38;break}return k.abrupt("return",this.stream(s));case 38:throw k.t1;case 39:return this.storeRootInSessionCache(Dn.type,o.id,c),y=function(M,L,B){return u.removeFromCacheAndSession(M,L,B)},_=new Ou(this.services,c,y),_=this.entities.store(_),k.abrupt("return",new Dn(_));case 44:case"end":return k.stop()}},a,this,[[14,20],[26,32]])}));function i(a){return n.apply(this,arguments)}return i}()},{key:"shutdown",value:function(){var n=Ce.default(H.default.mark(function a(){return H.default.wrap(function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,this.services.subscriptions.shutdown();case 2:return u.next=4,this.services.twilsock.disconnect();case 4:case"end":return u.stop()}},a,this)}));function i(){return n.apply(this,arguments)}return i}()},{key:"updateToken",value:function(){var n=Ce.default(H.default.mark(function a(s){return H.default.wrap(function(o){for(;;)switch(o.prev=o.next){case 0:return o.abrupt("return",this.services.twilsock.updateToken(s).catch(function(c){var d,y=c==null||(d=c.reply)===null||d===void 0?void 0:d.status;throw(y==null?void 0:y.code)===401&&(y==null?void 0:y.status)==="UNAUTHORIZED"?new Nr("Updated token was rejected by server",400,51130):c}));case 1:case"end":return o.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()},{key:"liveQuery",value:function(){var n=Ce.default(H.default.mark(function a(s,u){var o=this,c,d,y,_,w;return H.default.wrap(function(N){for(;;)switch(N.prev=N.next){case 0:return N.next=2,this.ensureReady();case 2:return c=new to(this.services.config.insightsUri).pathSegment(s).pathSegment("Items").build(),N.next=5,eE({network:this.services.network,uri:c,queryString:u,type:oi.type});case 5:return d=N.sent,y=this.getCached(d.query_id,oi.type),y||(_=this._getLiveQuery(d.query_id),_||(_={indexName:s,queryExpression:u,sid:d.query_id,queryUri:c,last_event_id:d.last_event_id}),w=function(L,B,ve){return o.removeFromCacheAndSession(L,B,ve)},y=new Uh(_,this.services,w,d.items)),this.storeRootInSessionCache(oi.type,d.query_id,y.liveQueryDescriptor),y=this.entities.store(y),N.abrupt("return",new oi(y));case 11:case"end":return N.stop()}},a,this)}));function i(a,s){return n.apply(this,arguments)}return i}()},{key:"instantQuery",value:function(){var n=Ce.default(H.default.mark(function a(s){var u=this,o;return H.default.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.next=2,this.ensureReady();case 2:return o=function(_,w){return u.liveQuery(_,w)},d.abrupt("return",new fl({indexName:s,network:this.services.network,insightsUri:this.services.config.insightsUri,liveQueryCreator:o}));case 4:case"end":return d.stop()}},a,this)}));function i(a){return n.apply(this,arguments)}return i}()}],[{key:"populateInitRegistrations",value:function(i){i.populateInitRegistrations([D_,L_,j_,U_])}},{key:"version",get:function(){return sp}}]),r}(Tt);$t.default(Vr,"connectionStateChanged","connectionStateChanged");$t.default(Vr,"connectionError","connectionError");$t.default(Vr,"tokenAboutToExpire","tokenAboutToExpire");$t.default(Vr,"tokenExpired","tokenExpired");vt([me.validateTypesAsync(["undefined","string",me.objectSchema("open document options",{id:["string","undefined"],mode:[me.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[me.nonNegativeInteger,"undefined"],data:[me.pureObject,"undefined",me.literal(null)]})]),_e("design:type",Function),_e("design:paramtypes",[Object]),_e("design:returntype",Promise)],Vr.prototype,"document",null);vt([me.validateTypesAsync(["undefined","string",me.objectSchema("open map options",{id:["string","undefined"],mode:[me.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[me.nonNegativeInteger,"undefined"],data:[me.pureObject,"undefined",me.literal(null)],includeItems:["boolean","undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Object]),_e("design:returntype",Promise)],Vr.prototype,"map",null);vt([me.validateTypesAsync(["undefined","string",me.objectSchema("open list options",{id:["string","undefined"],mode:[me.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[me.nonNegativeInteger,"undefined"],data:[me.pureObject,"undefined",me.literal(null)],purpose:["string","undefined"],context:[me.pureObject,"undefined"],includeItems:["boolean","undefined"]})]),_e("design:type",Function),_e("design:paramtypes",[Object]),_e("design:returntype",Promise)],Vr.prototype,"list",null);vt([me.validateTypesAsync(["undefined","string",me.objectSchema("open stream options",{id:["string","undefined"],mode:[me.literal("open_or_create","open_existing","create_new"),"undefined"],ttl:[me.nonNegativeInteger,"undefined"],data:[me.pureObject,"undefined",me.literal(null)]})]),_e("design:type",Function),_e("design:paramtypes",[Object]),_e("design:returntype",Promise)],Vr.prototype,"stream",null);vt([me.validateTypesAsync(me.nonEmptyString),_e("design:type",Function),_e("design:paramtypes",[String]),_e("design:returntype",Promise)],Vr.prototype,"updateToken",null);vt([me.validateTypesAsync(me.nonEmptyString,"string"),_e("design:type",Function),_e("design:paramtypes",[String,String]),_e("design:returntype",Promise)],Vr.prototype,"liveQuery",null);vt([me.validateTypesAsync(me.nonEmptyString),_e("design:type",Function),_e("design:paramtypes",[String]),_e("design:returntype",Promise)],Vr.prototype,"instantQuery",null);xr.Client=Vr;xr.InsightsItem=LK;xr.InstantQuery=fl;xr.LiveQuery=oi;xr.Paginator=Gg;xr.SyncClient=Vr;xr.SyncDocument=sn;xr.SyncList=tr;xr.SyncListItem=xh;xr.SyncMap=rr;xr.SyncMapItem=Zo;xr.SyncStream=Dn;var tE={},BK=AT,qK=TypeError,rE=function(e){if(BK(e))throw qK("The method doesn't accept regular expressions");return e},WK=Ct,HK=WK("match"),nE=function(e){var t=/./;try{"/./"[e](t)}catch{try{return t[HK]=!1,"/./"[e](t)}catch{}}return!1},GK=ft,iE=Qe,VK=Hn.f,zK=mi,F_=fr,KK=rE,JK=Vn,YK=nE,B_=iE("".startsWith),QK=iE("".slice),XK=Math.min,aE=YK("startsWith"),ZK=!aE&&!!function(){var e=VK(String.prototype,"startsWith");return e&&!e.writable}();GK({target:"String",proto:!0,forced:!ZK&&!aE},{startsWith:function(t){var r=F_(JK(this));KK(t);var n=zK(XK(arguments.length>1?arguments[1]:void 0,r.length)),i=F_(t);return B_?B_(r,i,n):QK(r,n,n+i.length)===i}});var e9=ft,t9=Ug.left,r9=tl,q_=Ya,n9=Qu,i9=r9("reduce"),a9=!n9&&q_>79&&q_<83;e9({target:"Array",proto:!0,forced:!i9||a9},{reduce:function(t){var r=arguments.length;return t9(this,t,r,r>1?arguments[1]:void 0)}});var s9=et,o9=Ct,u9=SM,l9=o9("iterator"),sE=!s9(function(){var e=new URL("b?a=1&b=2&c=3","http://a"),t=e.searchParams,r="";return e.pathname="c%20d",t.forEach(function(n,i){t.delete("b"),r+=i+n}),u9&&!e.toJSON||!t.sort||e.href!=="http://a/c%20d?a=1&c=3"||t.get("c")!=="3"||String(new URLSearchParams("?a=1"))!=="a=1"||!t[l9]||new URL("https://a@b").username!=="a"||new URLSearchParams(new URLSearchParams("a=b")).get("a")!=="b"||new URL("http://\u0442\u0435\u0441\u0442").host!=="xn--e1aybc"||new URL("http://a#\u0431").hash!=="#%D0%B1"||r!=="a1c3"||new URL("http://x",void 0).host!=="x"}),W_=$v.exports,c9=Xt,f9=function(e,t,r){return r.get&&W_(r.get,t,{getter:!0}),r.set&&W_(r.set,t,{setter:!0}),c9.f(e,t,r)},as=Qe,op=2147483647,fu=36,oE=1,Fh=26,d9=38,p9=700,h9=72,v9=128,g9="-",y9=/[^\0-\u007E]/,uE=/[.\u3002\uFF0E\uFF61]/g,H_="Overflow: input needs wider integers to process",up=fu-oE,G_=RangeError,m9=as(uE.exec),xs=Math.floor,lp=String.fromCharCode,V_=as("".charCodeAt),lE=as([].join),qi=as([].push),b9=as("".replace),w9=as("".split),_9=as("".toLowerCase),S9=function(e){for(var t=[],r=0,n=e.length;r<n;){var i=V_(e,r++);if(i>=55296&&i<=56319&&r<n){var a=V_(e,r++);(a&64512)==56320?qi(t,((i&1023)<<10)+(a&1023)+65536):(qi(t,i),r--)}else qi(t,i)}return t},z_=function(e){return e+22+75*(e<26)},$9=function(e,t,r){var n=0;for(e=r?xs(e/p9):e>>1,e+=xs(e/t);e>up*Fh>>1;)e=xs(e/up),n+=fu;return xs(n+(up+1)*e/(e+d9))},k9=function(e){var t=[];e=S9(e);var r=e.length,n=v9,i=0,a=h9,s,u;for(s=0;s<e.length;s++)u=e[s],u<128&&qi(t,lp(u));var o=t.length,c=o;for(o&&qi(t,g9);c<r;){var d=op;for(s=0;s<e.length;s++)u=e[s],u>=n&&u<d&&(d=u);var y=c+1;if(d-n>xs((op-i)/y))throw G_(H_);for(i+=(d-n)*y,n=d,s=0;s<e.length;s++){if(u=e[s],u<n&&++i>op)throw G_(H_);if(u==n){for(var _=i,w=fu;;){var k=w<=a?oE:w>=a+Fh?Fh:w-a;if(_<k)break;var N=_-k,M=fu-k;qi(t,lp(z_(k+N%M))),_=xs(N/M),w+=fu}qi(t,lp(z_(_))),a=$9(i,y,c==o),i=0,c++}}i++,n++}return lE(t,"")},T9=function(e){var t=[],r=w9(b9(_9(e),uE,"."),"."),n,i;for(n=0;n<r.length;n++)i=r[n],qi(t,m9(y9,i)?"xn--"+k9(i):i);return lE(t,".")},Bh=ft,ro=dt,Kl=Pt,Wn=Qe,E9=Bt,cE=sE,fE=mr,I9=wg,C9=aa,R9=C0,Kg=fn,dE=rs,cp=Mt,O9=Vt,A9=wi,P9=bi,M9=Zt,pE=Gt,Fr=fr,N9=ia,K_=Ka,qh=vf,x9=el,Ts=Bv,L9=Ct,j9=Fg,U9=L9("iterator"),dl="URLSearchParams",hE=dl+"Iterator",vE=Kg.set,mn=Kg.getterFor(dl),D9=Kg.getterFor(hE),F9=Object.getOwnPropertyDescriptor,Jg=function(e){if(!E9)return ro[e];var t=F9(ro,e);return t&&t.value},J_=Jg("fetch"),Lc=Jg("Request"),du=Jg("Headers"),fp=Lc&&Lc.prototype,Y_=du&&du.prototype,B9=ro.RegExp,q9=ro.TypeError,gE=ro.decodeURIComponent,W9=ro.encodeURIComponent,H9=Wn("".charAt),Q_=Wn([].join),ja=Wn([].push),Wh=Wn("".replace),G9=Wn([].shift),X_=Wn([].splice),Z_=Wn("".split),V9=Wn("".slice),z9=/\+/g,eS=Array(4),K9=function(e){return eS[e-1]||(eS[e-1]=B9("((?:%[\\da-f]{2}){"+e+"})","gi"))},J9=function(e){try{return gE(e)}catch{return e}},tS=function(e){var t=Wh(e,z9," "),r=4;try{return gE(t)}catch{for(;r;)t=Wh(t,K9(r--),J9);return t}},Y9=/[!'()~]|%20/g,Q9={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+"},X9=function(e){return Q9[e]},rS=function(e){return Wh(W9(e),Y9,X9)},dp=R9(function(t,r){vE(this,{type:hE,iterator:qh(mn(t).entries),kind:r})},"Iterator",function(){var t=D9(this),r=t.kind,n=t.iterator.next(),i=n.value;return n.done||(n.value=r==="keys"?i.key:r==="values"?i.value:[i.key,i.value]),n},!0),yE=function(e){this.entries=[],this.url=null,e!==void 0&&(pE(e)?this.parseObject(e):this.parseQuery(typeof e=="string"?H9(e,0)==="?"?V9(e,1):e:Fr(e)))};yE.prototype={type:dl,bindURL:function(e){this.url=e,this.update()},parseObject:function(e){var t=x9(e),r,n,i,a,s,u,o;if(t)for(r=qh(e,t),n=r.next;!(i=Kl(n,r)).done;){if(a=qh(M9(i.value)),s=a.next,(u=Kl(s,a)).done||(o=Kl(s,a)).done||!Kl(s,a).done)throw q9("Expected sequence with length 2");ja(this.entries,{key:Fr(u.value),value:Fr(o.value)})}else for(var c in e)O9(e,c)&&ja(this.entries,{key:c,value:Fr(e[c])})},parseQuery:function(e){if(e)for(var t=Z_(e,"&"),r=0,n,i;r<t.length;)n=t[r++],n.length&&(i=Z_(n,"="),ja(this.entries,{key:tS(G9(i)),value:tS(Q_(i,"="))}))},serialize:function(){for(var e=this.entries,t=[],r=0,n;r<e.length;)n=e[r++],ja(t,rS(n.key)+"="+rS(n.value));return Q_(t,"&")},update:function(){this.entries.length=0,this.parseQuery(this.url.query)},updateURL:function(){this.url&&this.url.update()}};var Nf=function(){dE(this,Au);var t=arguments.length>0?arguments[0]:void 0;vE(this,new yE(t))},Au=Nf.prototype;I9(Au,{append:function(t,r){Ts(arguments.length,2);var n=mn(this);ja(n.entries,{key:Fr(t),value:Fr(r)}),n.updateURL()},delete:function(e){Ts(arguments.length,1);for(var t=mn(this),r=t.entries,n=Fr(e),i=0;i<r.length;)r[i].key===n?X_(r,i,1):i++;t.updateURL()},get:function(t){Ts(arguments.length,1);for(var r=mn(this).entries,n=Fr(t),i=0;i<r.length;i++)if(r[i].key===n)return r[i].value;return null},getAll:function(t){Ts(arguments.length,1);for(var r=mn(this).entries,n=Fr(t),i=[],a=0;a<r.length;a++)r[a].key===n&&ja(i,r[a].value);return i},has:function(t){Ts(arguments.length,1);for(var r=mn(this).entries,n=Fr(t),i=0;i<r.length;)if(r[i++].key===n)return!0;return!1},set:function(t,r){Ts(arguments.length,1);for(var n=mn(this),i=n.entries,a=!1,s=Fr(t),u=Fr(r),o=0,c;o<i.length;o++)c=i[o],c.key===s&&(a?X_(i,o--,1):(a=!0,c.value=u));a||ja(i,{key:s,value:u}),n.updateURL()},sort:function(){var t=mn(this);j9(t.entries,function(r,n){return r.key>n.key?1:-1}),t.updateURL()},forEach:function(t){for(var r=mn(this).entries,n=A9(t,arguments.length>1?arguments[1]:void 0),i=0,a;i<r.length;)a=r[i++],n(a.value,a.key,this)},keys:function(){return new dp(this,"keys")},values:function(){return new dp(this,"values")},entries:function(){return new dp(this,"entries")}},{enumerable:!0});fE(Au,U9,Au.entries,{name:"entries"});fE(Au,"toString",function(){return mn(this).serialize()},{enumerable:!0});C9(Nf,dl);Bh({global:!0,constructor:!0,forced:!cE},{URLSearchParams:Nf});if(!cE&&cp(du)){var Z9=Wn(Y_.has),eJ=Wn(Y_.set),nS=function(e){if(pE(e)){var t=e.body,r;if(P9(t)===dl)return r=e.headers?new du(e.headers):new du,Z9(r,"content-type")||eJ(r,"content-type","application/x-www-form-urlencoded;charset=UTF-8"),N9(e,{body:K_(0,Fr(t)),headers:K_(0,r)})}return e};if(cp(J_)&&Bh({global:!0,enumerable:!0,dontCallGetSet:!0,forced:!0},{fetch:function(t){return J_(t,arguments.length>1?nS(arguments[1]):{})}}),cp(Lc)){var pp=function(t){return dE(this,fp),new Lc(t,arguments.length>1?nS(arguments[1]):{})};fp.constructor=pp,pp.prototype=fp,Bh({global:!0,constructor:!0,dontCallGetSet:!0,forced:!0},{Request:pp})}}var tJ={URLSearchParams:Nf,getState:mn},rJ=ft,Yg=Bt,nJ=sE,Qg=dt,iS=wi,dn=Qe,jc=mr,en=f9,iJ=rs,Hh=Vt,Xg=jT,Es=T0,yn=Vu,aJ=Xv.codeAt,sJ=T9,ei=fr,oJ=aa,uJ=Bv,mE=tJ,bE=fn,lJ=bE.set,Uc=bE.getterFor("URL"),cJ=mE.URLSearchParams,fJ=mE.getState,Ko=Qg.URL,Gh=Qg.TypeError,Dc=Qg.parseInt,dJ=Math.floor,aS=Math.pow,an=dn("".charAt),_n=dn(/./.exec),eu=dn([].join),pJ=dn(1 .toString),hJ=dn([].pop),Ps=dn([].push),sS=dn("".replace),vJ=dn([].shift),gJ=dn("".split),pu=dn("".slice),Fc=dn("".toLowerCase),yJ=dn([].unshift),mJ="Invalid authority",hp="Invalid scheme",Ia="Invalid host",oS="Invalid port",wE=/[a-z]/i,bJ=/[\d+-.a-z]/i,Vh=/\d/,wJ=/^0x/i,_J=/^[0-7]+$/,SJ=/^\d+$/,_E=/^[\da-f]+$/i,$J=/[\0\t\n\r #%/:<>?@[\\\]^|]/,kJ=/[\0\t\n\r #/:<>?@[\\\]^|]/,TJ=/^[\u0000-\u0020]+|[\u0000-\u0020]+$/g,EJ=/[\t\n\r]/g,tn,IJ=function(e){var t=gJ(e,"."),r,n,i,a,s,u,o;if(t.length&&t[t.length-1]==""&&t.length--,r=t.length,r>4)return e;for(n=[],i=0;i<r;i++){if(a=t[i],a=="")return e;if(s=10,a.length>1&&an(a,0)=="0"&&(s=_n(wJ,a)?16:8,a=pu(a,s==8?1:2)),a==="")u=0;else{if(!_n(s==10?SJ:s==8?_J:_E,a))return e;u=Dc(a,s)}Ps(n,u)}for(i=0;i<r;i++)if(u=n[i],i==r-1){if(u>=aS(256,5-r))return null}else if(u>255)return null;for(o=hJ(n),i=0;i<n.length;i++)o+=n[i]*aS(256,3-i);return o},CJ=function(e){var t=[0,0,0,0,0,0,0,0],r=0,n=null,i=0,a,s,u,o,c,d,y,_=function(){return an(e,i)};if(_()==":"){if(an(e,1)!=":")return;i+=2,r++,n=r}for(;_();){if(r==8)return;if(_()==":"){if(n!==null)return;i++,r++,n=r;continue}for(a=s=0;s<4&&_n(_E,_());)a=a*16+Dc(_(),16),i++,s++;if(_()=="."){if(s==0||(i-=s,r>6))return;for(u=0;_();){if(o=null,u>0)if(_()=="."&&u<4)i++;else return;if(!_n(Vh,_()))return;for(;_n(Vh,_());){if(c=Dc(_(),10),o===null)o=c;else{if(o==0)return;o=o*10+c}if(o>255)return;i++}t[r]=t[r]*256+o,u++,(u==2||u==4)&&r++}if(u!=4)return;break}else if(_()==":"){if(i++,!_())return}else if(_())return;t[r++]=a}if(n!==null)for(d=r-n,r=7;r!=0&&d>0;)y=t[r],t[r--]=t[n+d-1],t[n+--d]=y;else if(r!=8)return;return t},RJ=function(e){for(var t=null,r=1,n=null,i=0,a=0;a<8;a++)e[a]!==0?(i>r&&(t=n,r=i),n=null,i=0):(n===null&&(n=a),++i);return i>r&&(t=n,r=i),t},Jo=function(e){var t,r,n,i;if(typeof e=="number"){for(t=[],r=0;r<4;r++)yJ(t,e%256),e=dJ(e/256);return eu(t,".")}else if(typeof e=="object"){for(t="",n=RJ(e),r=0;r<8;r++)i&&e[r]===0||(i&&(i=!1),n===r?(t+=r?":":"::",i=!0):(t+=pJ(e[r],16),r<7&&(t+=":")));return"["+t+"]"}return e},lc={},SE=Xg({},lc,{" ":1,'"':1,"<":1,">":1,"`":1}),$E=Xg({},SE,{"#":1,"?":1,"{":1,"}":1}),vp=Xg({},$E,{"/":1,":":1,";":1,"=":1,"@":1,"[":1,"\\":1,"]":1,"^":1,"|":1}),Ni=function(e,t){var r=aJ(e,0);return r>32&&r<127&&!Hh(t,e)?e:encodeURIComponent(e)},Jl={ftp:21,file:null,http:80,https:443,ws:80,wss:443},tu=function(e,t){var r;return e.length==2&&_n(wE,an(e,0))&&((r=an(e,1))==":"||!t&&r=="|")},uS=function(e){var t;return e.length>1&&tu(pu(e,0,2))&&(e.length==2||(t=an(e,2))==="/"||t==="\\"||t==="?"||t==="#")},OJ=function(e){return e==="."||Fc(e)==="%2e"},AJ=function(e){return e=Fc(e),e===".."||e==="%2e."||e===".%2e"||e==="%2e%2e"},gp={},lS={},yp={},cS={},fS={},mp={},dS={},pS={},Yl={},Ql={},bp={},wp={},_p={},Sp={},hS={},$p={},Is={},Mn={},vS={},Ca={},Zn={},Zg=function(e,t,r){var n=ei(e),i,a,s;if(t){if(a=this.parse(n),a)throw Gh(a);this.searchParams=null}else{if(r!==void 0&&(i=new Zg(r,!0)),a=this.parse(n,null,i),a)throw Gh(a);s=fJ(new cJ),s.bindURL(this),this.searchParams=s}};Zg.prototype={type:"URL",parse:function(e,t,r){var n=this,i=t||gp,a=0,s="",u=!1,o=!1,c=!1,d,y,_,w;for(e=ei(e),t||(n.scheme="",n.username="",n.password="",n.host=null,n.port=null,n.path=[],n.query=null,n.fragment=null,n.cannotBeABaseURL=!1,e=sS(e,TJ,"")),e=sS(e,EJ,""),d=Es(e);a<=d.length;){switch(y=d[a],i){case gp:if(y&&_n(wE,y))s+=Fc(y),i=lS;else{if(t)return hp;i=yp;continue}break;case lS:if(y&&(_n(bJ,y)||y=="+"||y=="-"||y=="."))s+=Fc(y);else if(y==":"){if(t&&(n.isSpecial()!=Hh(Jl,s)||s=="file"&&(n.includesCredentials()||n.port!==null)||n.scheme=="file"&&!n.host))return;if(n.scheme=s,t){n.isSpecial()&&Jl[n.scheme]==n.port&&(n.port=null);return}s="",n.scheme=="file"?i=Sp:n.isSpecial()&&r&&r.scheme==n.scheme?i=cS:n.isSpecial()?i=pS:d[a+1]=="/"?(i=fS,a++):(n.cannotBeABaseURL=!0,Ps(n.path,""),i=vS)}else{if(t)return hp;s="",i=yp,a=0;continue}break;case yp:if(!r||r.cannotBeABaseURL&&y!="#")return hp;if(r.cannotBeABaseURL&&y=="#"){n.scheme=r.scheme,n.path=yn(r.path),n.query=r.query,n.fragment="",n.cannotBeABaseURL=!0,i=Zn;break}i=r.scheme=="file"?Sp:mp;continue;case cS:if(y=="/"&&d[a+1]=="/")i=Yl,a++;else{i=mp;continue}break;case fS:if(y=="/"){i=Ql;break}else{i=Mn;continue}case mp:if(n.scheme=r.scheme,y==tn)n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=yn(r.path),n.query=r.query;else if(y=="/"||y=="\\"&&n.isSpecial())i=dS;else if(y=="?")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=yn(r.path),n.query="",i=Ca;else if(y=="#")n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=yn(r.path),n.query=r.query,n.fragment="",i=Zn;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,n.path=yn(r.path),n.path.length--,i=Mn;continue}break;case dS:if(n.isSpecial()&&(y=="/"||y=="\\"))i=Yl;else if(y=="/")i=Ql;else{n.username=r.username,n.password=r.password,n.host=r.host,n.port=r.port,i=Mn;continue}break;case pS:if(i=Yl,y!="/"||an(s,a+1)!="/")continue;a++;break;case Yl:if(y!="/"&&y!="\\"){i=Ql;continue}break;case Ql:if(y=="@"){u&&(s="%40"+s),u=!0,_=Es(s);for(var k=0;k<_.length;k++){var N=_[k];if(N==":"&&!c){c=!0;continue}var M=Ni(N,vp);c?n.password+=M:n.username+=M}s=""}else if(y==tn||y=="/"||y=="?"||y=="#"||y=="\\"&&n.isSpecial()){if(u&&s=="")return mJ;a-=Es(s).length+1,s="",i=bp}else s+=y;break;case bp:case wp:if(t&&n.scheme=="file"){i=$p;continue}else if(y==":"&&!o){if(s=="")return Ia;if(w=n.parseHost(s),w)return w;if(s="",i=_p,t==wp)return}else if(y==tn||y=="/"||y=="?"||y=="#"||y=="\\"&&n.isSpecial()){if(n.isSpecial()&&s=="")return Ia;if(t&&s==""&&(n.includesCredentials()||n.port!==null))return;if(w=n.parseHost(s),w)return w;if(s="",i=Is,t)return;continue}else y=="["?o=!0:y=="]"&&(o=!1),s+=y;break;case _p:if(_n(Vh,y))s+=y;else if(y==tn||y=="/"||y=="?"||y=="#"||y=="\\"&&n.isSpecial()||t){if(s!=""){var L=Dc(s,10);if(L>65535)return oS;n.port=n.isSpecial()&&L===Jl[n.scheme]?null:L,s=""}if(t)return;i=Is;continue}else return oS;break;case Sp:if(n.scheme="file",y=="/"||y=="\\")i=hS;else if(r&&r.scheme=="file")if(y==tn)n.host=r.host,n.path=yn(r.path),n.query=r.query;else if(y=="?")n.host=r.host,n.path=yn(r.path),n.query="",i=Ca;else if(y=="#")n.host=r.host,n.path=yn(r.path),n.query=r.query,n.fragment="",i=Zn;else{uS(eu(yn(d,a),""))||(n.host=r.host,n.path=yn(r.path),n.shortenPath()),i=Mn;continue}else{i=Mn;continue}break;case hS:if(y=="/"||y=="\\"){i=$p;break}r&&r.scheme=="file"&&!uS(eu(yn(d,a),""))&&(tu(r.path[0],!0)?Ps(n.path,r.path[0]):n.host=r.host),i=Mn;continue;case $p:if(y==tn||y=="/"||y=="\\"||y=="?"||y=="#"){if(!t&&tu(s))i=Mn;else if(s==""){if(n.host="",t)return;i=Is}else{if(w=n.parseHost(s),w)return w;if(n.host=="localhost"&&(n.host=""),t)return;s="",i=Is}continue}else s+=y;break;case Is:if(n.isSpecial()){if(i=Mn,y!="/"&&y!="\\")continue}else if(!t&&y=="?")n.query="",i=Ca;else if(!t&&y=="#")n.fragment="",i=Zn;else if(y!=tn&&(i=Mn,y!="/"))continue;break;case Mn:if(y==tn||y=="/"||y=="\\"&&n.isSpecial()||!t&&(y=="?"||y=="#")){if(AJ(s)?(n.shortenPath(),y!="/"&&!(y=="\\"&&n.isSpecial())&&Ps(n.path,"")):OJ(s)?y!="/"&&!(y=="\\"&&n.isSpecial())&&Ps(n.path,""):(n.scheme=="file"&&!n.path.length&&tu(s)&&(n.host&&(n.host=""),s=an(s,0)+":"),Ps(n.path,s)),s="",n.scheme=="file"&&(y==tn||y=="?"||y=="#"))for(;n.path.length>1&&n.path[0]==="";)vJ(n.path);y=="?"?(n.query="",i=Ca):y=="#"&&(n.fragment="",i=Zn)}else s+=Ni(y,$E);break;case vS:y=="?"?(n.query="",i=Ca):y=="#"?(n.fragment="",i=Zn):y!=tn&&(n.path[0]+=Ni(y,lc));break;case Ca:!t&&y=="#"?(n.fragment="",i=Zn):y!=tn&&(y=="'"&&n.isSpecial()?n.query+="%27":y=="#"?n.query+="%23":n.query+=Ni(y,lc));break;case Zn:y!=tn&&(n.fragment+=Ni(y,SE));break}a++}},parseHost:function(e){var t,r,n;if(an(e,0)=="["){if(an(e,e.length-1)!="]"||(t=CJ(pu(e,1,-1)),!t))return Ia;this.host=t}else if(this.isSpecial()){if(e=sJ(e),_n($J,e)||(t=IJ(e),t===null))return Ia;this.host=t}else{if(_n(kJ,e))return Ia;for(t="",r=Es(e),n=0;n<r.length;n++)t+=Ni(r[n],lc);this.host=t}},cannotHaveUsernamePasswordPort:function(){return!this.host||this.cannotBeABaseURL||this.scheme=="file"},includesCredentials:function(){return this.username!=""||this.password!=""},isSpecial:function(){return Hh(Jl,this.scheme)},shortenPath:function(){var e=this.path,t=e.length;t&&(this.scheme!="file"||t!=1||!tu(e[0],!0))&&e.length--},serialize:function(){var e=this,t=e.scheme,r=e.username,n=e.password,i=e.host,a=e.port,s=e.path,u=e.query,o=e.fragment,c=t+":";return i!==null?(c+="//",e.includesCredentials()&&(c+=r+(n?":"+n:"")+"@"),c+=Jo(i),a!==null&&(c+=":"+a)):t=="file"&&(c+="//"),c+=e.cannotBeABaseURL?s[0]:s.length?"/"+eu(s,"/"):"",u!==null&&(c+="?"+u),o!==null&&(c+="#"+o),c},setHref:function(e){var t=this.parse(e);if(t)throw Gh(t);this.searchParams.update()},getOrigin:function(){var e=this.scheme,t=this.port;if(e=="blob")try{return new no(e.path[0]).origin}catch{return"null"}return e=="file"||!this.isSpecial()?"null":e+"://"+Jo(this.host)+(t!==null?":"+t:"")},getProtocol:function(){return this.scheme+":"},setProtocol:function(e){this.parse(ei(e)+":",gp)},getUsername:function(){return this.username},setUsername:function(e){var t=Es(ei(e));if(!this.cannotHaveUsernamePasswordPort()){this.username="";for(var r=0;r<t.length;r++)this.username+=Ni(t[r],vp)}},getPassword:function(){return this.password},setPassword:function(e){var t=Es(ei(e));if(!this.cannotHaveUsernamePasswordPort()){this.password="";for(var r=0;r<t.length;r++)this.password+=Ni(t[r],vp)}},getHost:function(){var e=this.host,t=this.port;return e===null?"":t===null?Jo(e):Jo(e)+":"+t},setHost:function(e){this.cannotBeABaseURL||this.parse(e,bp)},getHostname:function(){var e=this.host;return e===null?"":Jo(e)},setHostname:function(e){this.cannotBeABaseURL||this.parse(e,wp)},getPort:function(){var e=this.port;return e===null?"":ei(e)},setPort:function(e){this.cannotHaveUsernamePasswordPort()||(e=ei(e),e==""?this.port=null:this.parse(e,_p))},getPathname:function(){var e=this.path;return this.cannotBeABaseURL?e[0]:e.length?"/"+eu(e,"/"):""},setPathname:function(e){this.cannotBeABaseURL||(this.path=[],this.parse(e,Is))},getSearch:function(){var e=this.query;return e?"?"+e:""},setSearch:function(e){e=ei(e),e==""?this.query=null:(an(e,0)=="?"&&(e=pu(e,1)),this.query="",this.parse(e,Ca)),this.searchParams.update()},getSearchParams:function(){return this.searchParams.facade},getHash:function(){var e=this.fragment;return e?"#"+e:""},setHash:function(e){if(e=ei(e),e==""){this.fragment=null;return}an(e,0)=="#"&&(e=pu(e,1)),this.fragment="",this.parse(e,Zn)},update:function(){this.query=this.searchParams.serialize()||null}};var no=function(t){var r=iJ(this,kr),n=uJ(arguments.length,1)>1?arguments[1]:void 0,i=lJ(r,new Zg(t,!1,n));Yg||(r.href=i.serialize(),r.origin=i.getOrigin(),r.protocol=i.getProtocol(),r.username=i.getUsername(),r.password=i.getPassword(),r.host=i.getHost(),r.hostname=i.getHostname(),r.port=i.getPort(),r.pathname=i.getPathname(),r.search=i.getSearch(),r.searchParams=i.getSearchParams(),r.hash=i.getHash())},kr=no.prototype,rn=function(e,t){return{get:function(){return Uc(this)[e]()},set:t&&function(r){return Uc(this)[t](r)},configurable:!0,enumerable:!0}};Yg&&(en(kr,"href",rn("serialize","setHref")),en(kr,"origin",rn("getOrigin")),en(kr,"protocol",rn("getProtocol","setProtocol")),en(kr,"username",rn("getUsername","setUsername")),en(kr,"password",rn("getPassword","setPassword")),en(kr,"host",rn("getHost","setHost")),en(kr,"hostname",rn("getHostname","setHostname")),en(kr,"port",rn("getPort","setPort")),en(kr,"pathname",rn("getPathname","setPathname")),en(kr,"search",rn("getSearch","setSearch")),en(kr,"searchParams",rn("getSearchParams")),en(kr,"hash",rn("getHash","setHash")));jc(kr,"toJSON",function(){return Uc(this).serialize()},{enumerable:!0});jc(kr,"toString",function(){return Uc(this).serialize()},{enumerable:!0});if(Ko){var gS=Ko.createObjectURL,yS=Ko.revokeObjectURL;gS&&jc(no,"createObjectURL",iS(gS,Ko)),yS&&jc(no,"revokeObjectURL",iS(yS,Ko))}oJ(no,"URL");rJ({global:!0,constructor:!0,forced:!nJ,sham:!Yg},{URL:no});/*
@license
Copyright (c) 2018, Twilio, Inc.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted, provided that the above
copyright notice and this permission notice appear in all copies.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY
SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION
OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN
CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.

*/(function(e){var t=typeof t<"u"?t:typeof self<"u"?self:typeof window<"u"?window:{};Object.defineProperty(e,"__esModule",{value:!0});var r=ho.exports,n=ca.exports,i=rl,a=yo.exports,s=Si,u=nr;function o(fe){return fe&&typeof fe=="object"&&"default"in fe?fe:{default:fe}}function c(fe){if(fe&&fe.__esModule)return fe;var V=Object.create(null);return fe&&Object.keys(fe).forEach(function(Q){if(Q!=="default"){var $=Object.getOwnPropertyDescriptor(fe,Q);Object.defineProperty(V,Q,$.get?$:{enumerable:!0,get:function(){return fe[Q]}})}}),V.default=fe,Object.freeze(V)}var d=o(r),y=o(n),_=o(i),w=c(a);/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */function k(fe,V,Q,$){var I=arguments.length,Z=I<3?V:$===null?$=Object.getOwnPropertyDescriptor(V,Q):$,re;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")Z=Reflect.decorate(fe,V,Q,$);else for(var Ie=fe.length-1;Ie>=0;Ie--)(re=fe[Ie])&&(Z=(I<3?re(Z):I>3?re(V,Q,Z):re(V,Q))||Z);return I>3&&Z&&Object.defineProperty(V,Q,Z),Z}function N(fe,V){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(fe,V)}function M(fe,V){return["".concat(new Date().toISOString()," MCS Client ").concat(fe,":")].concat(Array.from(V))}class L{constructor(V){y.default(this,"prefix",""),this.prefix=V!=null&&V.length>0?V+" ":""}static scope(V){return new L(V)}setLevel(V){w.setLevel(V)}static setLevel(V){w.setLevel(V)}trace(){for(var V=arguments.length,Q=new Array(V),$=0;$<V;$++)Q[$]=arguments[$];w.trace.apply(null,M(this.prefix+"T",Q))}debug(){for(var V=arguments.length,Q=new Array(V),$=0;$<V;$++)Q[$]=arguments[$];w.debug.apply(null,M(this.prefix+"D",Q))}info(){for(var V=arguments.length,Q=new Array(V),$=0;$<V;$++)Q[$]=arguments[$];w.info.apply(null,M(this.prefix+"I",Q))}warn(){for(var V=arguments.length,Q=new Array(V),$=0;$<V;$++)Q[$]=arguments[$];w.warn.apply(null,M(this.prefix+"W",Q))}error(){for(var V=arguments.length,Q=new Array(V),$=0;$<V;$++)Q[$]=arguments[$];w.error.apply(null,M(this.prefix+"E",Q))}static trace(){for(var V=arguments.length,Q=new Array(V),$=0;$<V;$++)Q[$]=arguments[$];w.trace.apply(null,M("T",Q))}static debug(){for(var V=arguments.length,Q=new Array(V),$=0;$<V;$++)Q[$]=arguments[$];w.debug.apply(null,M("D",Q))}static info(){for(var V=arguments.length,Q=new Array(V),$=0;$<V;$++)Q[$]=arguments[$];w.info.apply(null,M("I",Q))}static warn(){for(var V=arguments.length,Q=new Array(V),$=0;$<V;$++)Q[$]=arguments[$];w.warn.apply(null,M("W",Q))}static error(){for(var V=arguments.length,Q=new Array(V),$=0;$<V;$++)Q[$]=arguments[$];w.error.apply(null,M("E",Q))}}var B=1e3,ve=4e3,ue=3,Me=!0,Re=fe=>"https://mcs.".concat(fe!=null?fe:"us1",".twilio.com"),Ae=fe=>fe.startsWith("http"),x=(fe,V)=>"".concat(Ae(fe)?"":Re(V)).concat(fe);class le{constructor(V,Q,$,I){var Z,re,Ie,xe,ce,$e,E=(Z=(re=I.MCS)!==null&&re!==void 0?re:I)!==null&&Z!==void 0?Z:{};this.region=(Ie=(xe=E.region)!==null&&xe!==void 0?xe:I.region)!==null&&Ie!==void 0?Ie:"us1",this.mediaUrl=x(Q,this.region),this.mediaSetUrl=$?x($):"".concat(this.mediaUrl,"Set"),this.token=V,this.retryWhenThrottledOverride=(ce=E.retryWhenThrottledOverride)!==null&&ce!==void 0?ce:Me,this.backoffConfigOverride=($e=E.backoffConfigOverride)!==null&&$e!==void 0?$e:le.backoffConfigDefault}static get backoffConfigDefault(){return{min:B,max:ve,maxAttemptsCount:ue}}static get retryWhenThrottledDefault(){return Me}updateToken(V){this.token=V}}class F{constructor(V,Q,$){this.config=V,this.network=Q,this._update($)}get sid(){return this.state.sid}get serviceSid(){return this.state.serviceSid}get dateCreated(){return this.state.dateCreated}get dateUpdated(){return this.state.dateUpdated}get contentType(){return this.state.contentType}get size(){return this.state.size}get fileName(){return this.state.filename}get filename(){return this.state.filename}get category(){return this.state.category}getContentUrl(){var V=this;return d.default(_.default.mark(function Q(){var $;return _.default.wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.next=2,V.network.get("".concat(V.config.mediaUrl,"/").concat(V.sid));case 2:return $=Z.sent,V._update($.body),Z.abrupt("return",Promise.resolve(V.state.contentDirectUrl));case 5:case"end":return Z.stop()}},Q)}))()}getCachedContentUrl(){var V=this;return d.default(_.default.mark(function Q(){return _.default.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:if(!V.state.contentDirectUrl){I.next=2;break}return I.abrupt("return",Promise.resolve(V.state.contentDirectUrl));case 2:return I.next=4,V.getContentUrl();case 4:return I.abrupt("return",I.sent);case 5:case"end":return I.stop()}},Q)}))()}_update(V){var Q,$,I,Z;this.state={sid:V.sid,serviceSid:V.service_sid,channelSid:V.channel_sid,messageSid:V.message_sid,dateCreated:V.date_created?new Date(V.date_created):null,dateUploadUpdated:V.date_upload_updated?new Date(V.date_upload_updated):null,dateUpdated:V.date_updated?new Date(V.date_updated):null,size:V.size,contentType:V.content_type,author:V.author,url:V.url,contentUrl:V.links.content,contentDirectUrl:(Q=V.links.content_direct_temporary)!==null&&Q!==void 0?Q:null,filename:($=V.filename)!==null&&$!==void 0?$:null,category:(I=V.category)!==null&&I!==void 0?I:"media",isMultipartUpstream:(Z=V.is_multipart_upstream)!==null&&Z!==void 0?Z:!1}}}class Se extends Error{constructor(V,Q,$,I,Z){super(V),this.code=Q,this.body=$,this.status=I,this.headers=Z}}var Ee=t.XMLHttpRequest||{};function oe(fe){return fe?fe.split(`\r
`).map(V=>V.split(": ")).filter(V=>V.length===2&&V[1].length>0).reduce((V,Q)=>(V[Q[0]]=Q[1],V),{}):{}}function te(fe){var V=fe.getResponseHeader("Content-Type");if(!V||V.indexOf("application/json")!==0||fe.responseText.length===0)return fe.responseText;try{return JSON.parse(fe.responseText)}catch{return fe.responseText}}class ae{static request(V,Q,$,I){return d.default(_.default.mark(function Z(){return _.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.abrupt("return",new Promise((xe,ce)=>{var $e=new Ee;$e.open(V,Q,!0),$e.onreadystatechange=function(){if($e.readyState===4){var G=oe($e.getAllResponseHeaders()),ee=te($e);if(200<=$e.status&&$e.status<300)xe({status:$e.status,headers:G,body:ee});else{var q,ke=(q=$e.statusText)!==null&&q!==void 0?q:"NONE",J;typeof ee=="string"?J=ee&&ee.split(`
`,2).length===1?ee:"":J=JSON.stringify(ee);var W="".concat($e.status,": [").concat(ke,"] ").concat(J);ce(new Se(W,$e.status,ee,ke,G))}}};for(var E in $)$e.setRequestHeader(E,$[E]),E==="Content-Type"&&$[E]==="application/json"&&(I=JSON.stringify(I));$e.send(I)}));case 1:case"end":return Ie.stop()}},Z)}))()}get(V,Q){return d.default(_.default.mark(function $(){return _.default.wrap(function(Z){for(;;)switch(Z.prev=Z.next){case 0:return Z.abrupt("return",ae.request("GET",V,Q));case 1:case"end":return Z.stop()}},$)}))()}post(V,Q,$){return d.default(_.default.mark(function I(){return _.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.abrupt("return",ae.request("POST",V,Q,$));case 1:case"end":return re.stop()}},I)}))()}}var ne=L.scope("Network");class be{constructor(V,Q){this.config=V,this.transport=Q}backoffConfig(){return Object.assign(le.backoffConfigDefault,this.config.backoffConfigOverride)}retryWhenThrottled(){var V,Q;return(V=(Q=this.config.retryWhenThrottledOverride)!==null&&Q!==void 0?Q:le.retryWhenThrottledDefault)!==null&&V!==void 0?V:!1}executeWithRetry(V,Q){var $=this;return d.default(_.default.mark(function I(){return _.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.abrupt("return",new Promise((Ie,xe)=>{var ce=[502,503,504];Q&&ce.push(429);var $e=new s.Retrier($.backoffConfig());$e.on("attempt",d.default(_.default.mark(function E(){var T;return _.default.wrap(function(ee){for(;;)switch(ee.prev=ee.next){case 0:return ee.prev=0,ee.next=3,V();case 3:T=ee.sent,$e.succeeded(T),ee.next=10;break;case 7:ee.prev=7,ee.t0=ee.catch(0),ce.indexOf(ee.t0.status)>-1||ee.t0.message==="Twilsock disconnected"?$e.failed(ee.t0):($e.removeAllListeners(),$e.cancel(),xe(ee.t0));case 10:case"end":return ee.stop()}},E,null,[[0,7]])}))),$e.on("succeeded",E=>{Ie(E)}),$e.on("cancelled",E=>xe(E)),$e.on("failed",E=>xe(E)),$e.start()}));case 1:case"end":return re.stop()}},I)}))()}get(V){var Q=this;return d.default(_.default.mark(function $(){var I,Z;return _.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return I={"X-Twilio-Token":Q.config.token},ne.trace("sending GET request to ",V," headers ",I),Ie.prev=2,Ie.next=5,Q.executeWithRetry(()=>Q.transport.get(V,I),Q.retryWhenThrottled());case 5:return Z=Ie.sent,ne.trace("response",Z),Ie.abrupt("return",Z);case 10:throw Ie.prev=10,Ie.t0=Ie.catch(2),ne.debug("get() error ".concat(Ie.t0)),Ie.t0;case 14:case"end":return Ie.stop()}},$,null,[[2,10]])}))()}post(V,Q,$,I,Z){var re=this;return d.default(_.default.mark(function Ie(){var xe,ce,$e;return _.default.wrap(function(T){for(;;)switch(T.prev=T.next){case 0:return xe={"X-Twilio-Token":re.config.token},(typeof FormData>"u"||!($ instanceof FormData))&&I&&Object.assign(xe,{"Content-Type":I}),ce=new URL(V),Q&&ce.searchParams.append("Category",Q),Z&&ce.searchParams.append("Filename",Z),ne.trace("sending POST request to ".concat(V," with headers ").concat(xe)),T.prev=6,T.next=9,re.transport.post(ce.href,xe,$);case 9:$e=T.sent,T.next=18;break;case 12:if(T.prev=12,T.t0=T.catch(6),!(t.XMLHttpRequest===void 0&&$ instanceof FormData)){T.next=16;break}throw new TypeError("Posting FormData supported only with browser engine's FormData");case 16:throw ne.debug("post() error ".concat(T.t0)),T.t0;case 18:return ne.trace("response",$e),T.abrupt("return",$e);case 20:case"end":return T.stop()}},Ie,null,[[6,12]])}))()}}var A="0.5.3",Le,at,We=L.scope("");e.default=(at=Le=class{constructor(V,Q,$){var I,Z,re=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};this.options=re,this.options.logLevel=(I=this.options.logLevel)!==null&&I!==void 0?I:"silent",this.config=new le(V,Q,$,this.options),We.setLevel(this.options.logLevel),this.options.transport=(Z=this.options.transport)!==null&&Z!==void 0?Z:new ae,this.transport=this.options.transport,this.network=new be(this.config,this.transport)}updateToken(V){We.info("updateToken"),this.config.updateToken(V)}get(V){var Q=this;return d.default(_.default.mark(function $(){var I;return _.default.wrap(function(re){for(;;)switch(re.prev=re.next){case 0:return re.next=2,Q.network.get("".concat(Q.config.mediaUrl,"/").concat(V));case 2:return I=re.sent,re.abrupt("return",new F(Q.config,Q.network,I.body));case 4:case"end":return re.stop()}},$)}))()}post(V,Q,$,I){var Z=this;return d.default(_.default.mark(function re(){var Ie;return _.default.wrap(function(ce){for(;;)switch(ce.prev=ce.next){case 0:return ce.next=2,Z.network.post(Z.config.mediaUrl,$!=null?$:"media",Q,V,I);case 2:return Ie=ce.sent,ce.abrupt("return",new F(Z.config,Z.network,Ie.body));case 4:case"end":return ce.stop()}},re)}))()}postFormData(V,Q){var $=this;return d.default(_.default.mark(function I(){var Z;return _.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return Ie.next=2,$.network.post($.config.mediaUrl,Q!=null?Q:"media",V);case 2:return Z=Ie.sent,Ie.abrupt("return",new F($.config,$.network,Z.body));case 4:case"end":return Ie.stop()}},I)}))()}mediaSetGet(V){var Q=this;return d.default(_.default.mark(function $(){var I,Z;return _.default.wrap(function(Ie){for(;;)switch(Ie.prev=Ie.next){case 0:return I={command:"get",list:V.map(xe=>({media_sid:xe}))},Ie.next=3,Q.network.post("".concat(Q.config.mediaSetUrl),null,I,"application/json");case 3:return Z=Ie.sent,Ie.abrupt("return",Z.body.map(xe=>{if(xe.code!==200)throw new Error("Failed to obtain detailed information about Media items (failed SID ".concat(xe.media_record.sid,")"));return new F(Q.config,Q.network,xe.media_record)}));case 5:case"end":return Ie.stop()}},$)}))()}},y.default(Le,"version",A),at),k([u.validateTypes(u.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String]),N("design:returntype",void 0)],e.default.prototype,"updateToken",null),k([u.validateTypesAsync(u.nonEmptyString),N("design:type",Function),N("design:paramtypes",[String]),N("design:returntype",Promise)],e.default.prototype,"get",null),e.default=k([u.validateConstructorTypes(u.nonEmptyString,u.nonEmptyString,[u.nonEmptyString,u.literal(null)],[u.pureObject,"undefined"]),N("design:paramtypes",[String,String,Object,Object])],e.default),e.Client=e.default,e.McsClient=e.default,e.McsMedia=F,e.Media=F,e.default=e.default})(tE);var PJ=ft,MJ=dt,NJ=q1,xJ=df,ey="ArrayBuffer",mS=NJ[ey],LJ=MJ[ey];PJ({global:!0,constructor:!0,forced:LJ!==mS},{ArrayBuffer:mS});xJ(ey);var jJ=ft,kE=Qe,UJ=On,DJ=yr,bS=br,FJ=Mg,wS=fr,ty=et,BJ=Fg,qJ=tl,_S=kT,WJ=TT,SS=Ya,$S=ET,Wi=[],kS=kE(Wi.sort),HJ=kE(Wi.push),GJ=ty(function(){Wi.sort(void 0)}),VJ=ty(function(){Wi.sort(null)}),zJ=qJ("sort"),TE=!ty(function(){if(SS)return SS<70;if(!(_S&&_S>3)){if(WJ)return!0;if($S)return $S<603;var e="",t,r,n,i;for(t=65;t<76;t++){switch(r=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:n=3;break;case 68:case 71:n=4;break;default:n=2}for(i=0;i<47;i++)Wi.push({k:r+i,v:n})}for(Wi.sort(function(a,s){return s.v-a.v}),i=0;i<Wi.length;i++)r=Wi[i].k.charAt(0),e.charAt(e.length-1)!==r&&(e+=r);return e!=="DGBEFHACIJK"}}),KJ=GJ||!VJ||!zJ||!TE,JJ=function(e){return function(t,r){return r===void 0?-1:t===void 0?1:e!==void 0?+e(t,r)||0:wS(t)>wS(r)?1:-1}};jJ({target:"Array",proto:!0,forced:KJ},{sort:function(t){t!==void 0&&UJ(t);var r=DJ(this);if(TE)return t===void 0?kS(r):kS(r,t);var n=[],i=bS(r),a,s;for(s=0;s<i;s++)s in r&&HJ(n,r[s]);for(BJ(n,JJ(t)),a=bS(n),s=0;s<a;)r[s]=n[s++];for(;s<i;)FJ(r,s++);return r}});var YJ=ft,QJ=Qe,XJ=rE,ZJ=Vn,TS=fr,eY=nE,tY=QJ("".indexOf);YJ({target:"String",proto:!0,forced:!eY("includes")},{includes:function(t){return!!~tY(TS(ZJ(this)),TS(XJ(t)),arguments.length>1?arguments[1]:void 0)}});var rY=ft,nY=Hr.find,iY=ng,zh="find",EE=!0;zh in[]&&Array(1)[zh](function(){EE=!1});rY({target:"Array",proto:!0,forced:EE},{find:function(t){return nY(this,t,arguments.length>1?arguments[1]:void 0)}});iY(zh);/*
@license
The following license applies to all parts of this software except as
documented below.

    Copyright (c) 2019, Twilio, inc.
    All rights reserved.

    Redistribution and use in source and binary forms, with or without
    modification, are permitted provided that the following conditions are
    met:

      1. Redistributions of source code must retain the above copyright
         notice, this list of conditions and the following disclaimer.

      2. Redistributions in binary form must reproduce the above copyright
         notice, this list of conditions and the following disclaimer in
         the documentation and/or other materials provided with the
         distribution.

      3. Neither the name of Twilio nor the names of its contributors may
         be used to endorse or promote products derived from this software
         without specific prior written permission.

    THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
    "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
    LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
    A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
    HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
    SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
    LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
    DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
    THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
    (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
    OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

This software includes javascript-state-machine under the following license.

    Copyright (c) 2012, 2013, 2014, 2015, Jake Gordon and contributors

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE

This software includes loglevel under the following license.

    Copyright (c) 2013 Tim Perry

    Permission is hereby granted, free of charge, to any person
    obtaining a copy of this software and associated documentation
    files (the "Software"), to deal in the Software without
    restriction, including without limitation the rights to use,
    copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the
    Software is furnished to do so, subject to the following
    conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
    OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
    HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
    WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
    OTHER DEALINGS IN THE SOFTWARE.

This software includes q under the following license.

    Copyright 2009–2014 Kristopher Michael Kowal. All rights reserved.
    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to
    deal in the Software without restriction, including without limitation the
    rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
    sell copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in
    all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
    FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
    IN THE SOFTWARE.

This software includes platform.js under the following license.

    Copyright 2014 Benjamin Tan <https://d10.github.io/>
    Copyright 2011-2015 John-David Dalton <http://allyoucanleet.com/>

    Permission is hereby granted, free of charge, to any person obtaining
    a copy of this software and associated documentation files (the
    "Software"), to deal in the Software without restriction, including
    without limitation the rights to use, copy, modify, merge, publish,
    distribute, sublicense, and/or sell copies of the Software, and to
    permit persons to whom the Software is furnished to do so, subject to
    the following conditions:

    The above copyright notice and this permission notice shall be
    included in all copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
    EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
    MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
    NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
    LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
    OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
    WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

*/(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=ho.exports,r=ts.exports,n=sa.exports,i=oa.exports,a=ua.exports,s=zn.exports,u=ca.exports,o=fa.exports,c=rl,d=la.exports,y=yo.exports,_=qB,w=nr,k=vg,N=wh.exports,M=nl.exports,L=Si,B=Ef,ve=LT,ue=xr,Me=tE,Re=il.exports,Ae=If;function x(C){return C&&typeof C=="object"&&"default"in C?C:{default:C}}function le(C){if(C&&C.__esModule)return C;var P=Object.create(null);return C&&Object.keys(C).forEach(function(m){if(m!=="default"){var v=Object.getOwnPropertyDescriptor(C,m);Object.defineProperty(P,m,v.get?v:{enumerable:!0,get:function(){return C[m]}})}}),P.default=C,Object.freeze(P)}var F=x(t),Se=x(r),Ee=x(n),oe=x(i),te=x(a),ae=x(s),ne=x(u),be=x(o),A=x(c),Le=x(d),at=le(y),We=x(N),fe=x(M),V=x(Re);function Q(C,P,m,v){var l=arguments.length,p=l<3?P:v===null?v=Object.getOwnPropertyDescriptor(P,m):v,f;if((typeof Reflect>"u"?"undefined":Le.default(Reflect))==="object"&&typeof Reflect.decorate=="function")p=Reflect.decorate(C,P,m,v);else for(var g=C.length-1;g>=0;g--)(f=C[g])&&(p=(l<3?f(p):l>3?f(P,m,p):f(P,m))||p);return l>3&&p&&Object.defineProperty(P,m,p),p}function $(C,P){if((typeof Reflect>"u"?"undefined":Le.default(Reflect))==="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(C,P)}function I(C,P){return["".concat(new Date().toISOString()," Conversations ").concat(C,":")].concat(Array.from(P))}var Z=at.getLogger("twilio-conversations"),re=function(){function C(P){be.default(this,C),ne.default(this,"prefix",""),this.prefix=P!=null&&P.length>0?P+" ":""}return Se.default(C,[{key:"setLevel",value:function(m){Z.setLevel(m)}},{key:"trace",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.trace.apply(null,I(this.prefix+"T",v))}},{key:"debug",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.debug.apply(null,I(this.prefix+"D",v))}},{key:"info",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.info.apply(null,I(this.prefix+"I",v))}},{key:"warn",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.warn.apply(null,I(this.prefix+"W",v))}},{key:"error",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.error.apply(null,I(this.prefix+"E",v))}}],[{key:"scope",value:function(m){return new C(m)}},{key:"setLevel",value:function(m){Z.setLevel(m)}},{key:"trace",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.trace.apply(null,I("T",v))}},{key:"debug",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.debug.apply(null,I("D",v))}},{key:"info",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.info.apply(null,I("I",v))}},{key:"warn",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.warn.apply(null,I("W",v))}},{key:"error",value:function(){for(var m=arguments.length,v=new Array(m),l=0;l<m;l++)v[l]=arguments[l];Z.error.apply(null,I("E",v))}}]),C}();function Ie(C,P){var m=Object.keys(C);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(C);P&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(C,l).enumerable})),m.push.apply(m,v)}return m}function xe(C){for(var P=1;P<arguments.length;P++){var m=arguments[P]!=null?arguments[P]:{};P%2?Ie(Object(m),!0).forEach(function(v){ne.default(C,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(m)):Ie(Object(m)).forEach(function(v){Object.defineProperty(C,v,Object.getOwnPropertyDescriptor(m,v))})}return C}var ce=5,$e="PT5S",E="PT5S",T=100,G=1e3,ee=4e3,q=3,ke=!0,J=function C(){var P,m,v,l,p,f,g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=arguments.length>1?arguments[1]:void 0,b=arguments.length>2?arguments[2]:void 0;be.default(this,C),ne.default(this,"typingIndicatorTimeoutDefault",ce*1e3);var S=g.Chat||g.IPMessaging||g||{};this.productId=S.productId,this.links={myConversations:h.links.my_conversations,conversations:h.links.conversations,users:h.links.users,currentUser:h.links.current_user,typing:h.links.typing,mediaService:h.links.media_service,mediaSetService:h.links.media_set_service,messagesReceipts:h.links.messages_receipts},this.limits={mediaAttachmentsCountLimit:h.options.media_attachments_count_limit,mediaAttachmentSizeLimitInMb:h.options.media_attachment_size_limit_in_mb,mediaAttachmentsTotalSizeLimitInMb:h.options.media_attachments_total_size_limit_in_mb,emailHistoriesAllowedMimeTypes:h.options.email_histories_allowed_mime_types,emailBodiesAllowedMimeTypes:h.options.email_bodies_allowed_mime_types},this.typingIndicatorTimeoutOverride=S.typingIndicatorTimeoutOverride,this.backoffConfiguration=xe({min:G,max:ee,maxAttemptsCount:q},S.backoffConfigOverride),this.retryWhenThrottled=S.retryWhenThrottledOverride!==void 0?S.retryWhenThrottledOverride:ke,this.userInfosToSubscribe=(P=(m=S.userInfosToSubscribeOverride)!==null&&m!==void 0?m:h.options.user_infos_to_subscribe)!==null&&P!==void 0?P:T,this.reachabilityEnabled=h.options.reachability_enabled,this.userIdentity=h.identity,this.userInfo=h.sync_objects.my_user_info,this.myConversations=h.sync_objects.my_conversations;var j=(v=(l=S.httpCacheIntervalOverride)!==null&&l!==void 0?l:h.options.http_cache_interval)!==null&&v!==void 0?v:$e;try{this.httpCacheInterval=_.toSeconds(_.parse(j))}catch{b.error("Failed to parse http cache interval ".concat(j,", using default value ").concat($e)),this.httpCacheInterval=_.toSeconds(_.parse($e))}var D=(p=(f=S.consumptionReportIntervalOverride)!==null&&f!==void 0?f:h.options.consumption_report_interval)!==null&&p!==void 0?p:E;try{this.consumptionReportInterval=_.toSeconds(_.parse(D))}catch{b.error("Failed to parse consumption report interval ".concat(D,", using default value ").concat(E)),this.consumptionReportInterval=_.toSeconds(_.parse(E))}};function W(C){return JSON.parse(JSON.stringify(C))}function pe(C){return typeof C<"u"&&!isNaN(Number(C))?Number(C):null}function R(C){try{return new Date(C)}catch{return null}}function Te(C,P,m){var v={};if(C)try{v=JSON.parse(C)}catch(l){m.warn(P,l)}return v}var Ne=function(){function C(P){be.default(this,C),this.base=P.replace(/\/$/,""),this.args=[],this.paths=[]}return Se.default(C,[{key:"arg",value:function(m,v){return typeof v<"u"&&this.args.push(encodeURIComponent(m)+"="+encodeURIComponent(v)),this}},{key:"path",value:function(m){return this.paths.push(encodeURIComponent(m)),this}},{key:"build",value:function(){var m=this.base;return this.paths.length&&(m+="/"+this.paths.join("/")),this.args.length&&(m+="?"+this.args.join("&")),m}}]),C}(),Oe=w.custom(function(C){return[["string","number","boolean","object"].includes(Le.default(C)),"a JSON type"]}),je=w.custom(function(C){return[["undefined","string","number","boolean","object"].includes(Le.default(C)),"an optional JSON type"]});function De(C){var P=Ue();return function(){var v=ae.default(C),l;if(P){var p=ae.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return te.default(this,l)}}function Ue(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Ve=re.scope("User"),Xe=function(C){oe.default(m,C);var P=De(m);function m(v,l,p,f){var g;return be.default(this,m),g=P.call(this),ne.default(Ee.default(g),"promiseToFetch",null),ne.default(Ee.default(g),"updated","updated"),ne.default(Ee.default(g),"userSubscribed","userSubscribed"),ne.default(Ee.default(g),"userUnsubscribed","userUnsubscribed"),g.services=f,g.subscribed="initializing",g.setMaxListeners(0),g.state={identity:v,entityName:l,friendlyName:null,attributes:{},online:null,notifiable:null},g._initializationPromise=new Promise(function(h){g._resolveInitializationPromise=h}),p!==null&&g._resolveInitialization(p,v,l,!1),g}return Se.default(m,[{key:"identity",get:function(){return this.state.identity},set:function(l){this.state.identity=l}},{key:"entityName",set:function(l){this.state.entityName=l}},{key:"attributes",get:function(){return this.state.attributes}},{key:"friendlyName",get:function(){return this.state.friendlyName}},{key:"isOnline",get:function(){return this.state.online}},{key:"isNotifiable",get:function(){return this.state.notifiable}},{key:"isSubscribed",get:function(){return this.subscribed=="subscribed"}},{key:"_update",value:function(){var v=F.default(A.default.mark(function p(f,g){var h,b;return A.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,this._initializationPromise;case 2:h=[],Ve.debug("User for",this.state.identity,"updated:",f,g),j.t0=f,j.next=j.t0==="friendlyName"?7:j.t0==="attributes"?9:j.t0==="reachability"?12:15;break;case 7:return this.state.friendlyName!==g.value&&(h.push("friendlyName"),this.state.friendlyName=g.value),j.abrupt("break",16);case 9:return b=Te(g.value,"Retrieved malformed attributes from the server for user: ".concat(this.state.identity),Ve),We.default(this.state.attributes,b)||(this.state.attributes=b,h.push("attributes")),j.abrupt("break",16);case 12:return this.state.online!==g.online&&(this.state.online=g.online,h.push("reachabilityOnline")),this.state.notifiable!==g.notifiable&&(this.state.notifiable=g.notifiable,h.push("reachabilityNotifiable")),j.abrupt("break",16);case 15:return j.abrupt("return");case 16:h.length>0&&this.emit("updated",{user:this,updateReasons:h});case 17:case"end":return j.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_updateReachabilityInfo",value:function(){var v=F.default(A.default.mark(function p(f,g){var h=this;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._initializationPromise;case 2:if(this.configuration.reachabilityEnabled){S.next=4;break}return S.abrupt("return",Promise.resolve());case 4:return S.abrupt("return",f.get("reachability").then(g).catch(function(j){Ve.warn("Failed to get reachability info for ",h.state.identity,j)}));case 5:case"end":return S.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_fetch",value:function(){var v=F.default(A.default.mark(function p(){var f=this;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._initializationPromise;case 2:if(this.state.entityName){h.next=4;break}return h.abrupt("return",this);case 4:return this.promiseToFetch=this.services.syncClient.map({id:this.state.entityName,mode:"open_existing",includeItems:!0}).then(function(b){return f.entity=b,b.on("itemUpdated",function(S){return Ve.debug(f.state.entityName+" ("+f.state.identity+") itemUpdated: "+S.item.key),f._update(S.item.key,S.item.data)}),Promise.all([b.get("friendlyName").then(function(S){return f._update(S.key,S.data)}),b.get("attributes").then(function(S){return f._update(S.key,S.data)}),f._updateReachabilityInfo(b,function(S){return f._update(S.key,S.data)})])}).then(function(){return Ve.debug("Fetched for",f.identity),f.subscribed="subscribed",f.emit("userSubscribed",f),f}).catch(function(b){throw f.promiseToFetch=null,b}),h.abrupt("return",this.promiseToFetch);case 6:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_ensureFetched",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._initializationPromise;case 2:return g.abrupt("return",this.promiseToFetch||this._fetch());case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateAttributes",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){h.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return h.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(f)});case 6:return h.abrupt("return",this);case 7:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateFriendlyName",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._initializationPromise;case 2:if(this.subscribed!="unsubscribed"){h.next=4;break}throw new Error("Can't modify unsubscribed object");case 4:return h.next=6,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:f});case 6:return h.abrupt("return",this);case 7:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"unsubscribe",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._initializationPromise;case 2:if(!this.promiseToFetch){g.next=9;break}return g.next=5,this.promiseToFetch;case 5:this.entity.close(),this.promiseToFetch=null,this.subscribed="unsubscribed",this.emit("userUnsubscribed",this);case 9:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_resolveInitialization",value:function(l,p,f,g){this.configuration=l,this.identity=p,this.entityName=f,this.links={self:"".concat(this.configuration.links.users,"/").concat(this.identity)},this._resolveInitializationPromise(),g&&this.emit("updated",{user:this,updateReasons:["friendlyName","attributes","reachabilityOnline","reachabilityNotifiable"]})}}]),m}(k.ReplayEventEmitter);Q([w.validateTypesAsync(Oe),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],Xe.prototype,"updateAttributes",null),Q([w.validateTypesAsync(["string"]),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],Xe.prototype,"updateFriendlyName",null);function er(C,P){var m=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!m){if(Array.isArray(C)||(m=wr(C))||P&&C&&typeof C.length=="number"){m&&(C=m);var v=0,l=function(){};return{s:l,n:function(){return v>=C.length?{done:!0}:{done:!1,value:C[v++]}},e:function(b){throw b},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(C)},n:function(){var b=m.next();return p=b.done,b},e:function(b){f=!0,g=b},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function wr(C,P){if(!!C){if(typeof C=="string")return pn(C,P);var m=Object.prototype.toString.call(C).slice(8,-1);if(m==="Object"&&C.constructor&&(m=C.constructor.name),m==="Map"||m==="Set")return Array.from(C);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return pn(C,P)}}function pn(C,P){(P==null||P>C.length)&&(P=C.length);for(var m=0,v=new Array(P);m<P;m++)v[m]=C[m];return v}var Cr=function(){function C(P,m){be.default(this,C),this.configuration=P,this.services=m,this.cache=new Map,this.cacheLifetime=this.configuration.httpCacheInterval*100,this.cleanupCache()}return Se.default(C,[{key:"isExpired",value:function(m){return!this.cacheLifetime||Date.now()-m>this.cacheLifetime}},{key:"cleanupCache",value:function(){var m=er(this.cache),v;try{for(m.s();!(v=m.n()).done;){var l=fe.default(v.value,2),p=l[0],f=l[1];this.isExpired(f.timestamp)&&this.cache.delete(p)}}catch(g){m.e(g)}finally{m.f()}this.cache.size===0&&clearInterval(this.timer)}},{key:"pokeTimer",value:function(){var m=this;this.timer=this.timer||setInterval(function(){return m.cleanupCache()},this.cacheLifetime*2)}},{key:"executeWithRetry",value:function(m){var v=this,l=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return new Promise(function(p,f){var g=[502,503,504];l&&g.push(429);var h=new L.Retrier(v.configuration.backoffConfiguration);h.on("attempt",function(){m().then(function(b){return h.succeeded(b)}).catch(function(b){g.indexOf(b.status)>-1||b.message==="Twilsock disconnected"?h.failed(b):(h.removeAllListeners(),h.cancel(),f(b))})}),h.on("succeeded",function(b){p(b)}),h.on("cancelled",function(b){return f(b)}),h.on("failed",function(b){return f(b)}),h.start()})}},{key:"get",value:function(){var P=F.default(A.default.mark(function v(l){var p=this,f,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(f=this.cache.get(l),!(f&&!this.isExpired(f.timestamp))){S.next=3;break}return S.abrupt("return",f.response);case 3:return g={},S.next=6,this.executeWithRetry(function(){return p.services.transport.get(l,g,p.configuration.productId)},this.configuration.retryWhenThrottled);case 6:return h=S.sent,this.cache.set(l,{response:h,timestamp:Date.now()}),this.pokeTimer(),S.abrupt("return",h);case 10:case"end":return S.stop()}},v,this)}));function m(v){return P.apply(this,arguments)}return m}()}]),C}(),mt=function C(){be.default(this,C)};ne.default(mt,"TYPING_INDICATOR","twilio.ipmsg.typing_indicator"),ne.default(mt,"NEW_MESSAGE","twilio.conversations.new_message"),ne.default(mt,"ADDED_TO_CONVERSATION","twilio.conversations.added_to_conversation"),ne.default(mt,"REMOVED_FROM_CONVERSATION","twilio.conversations.removed_from_conversation"),ne.default(mt,"CONSUMPTION_UPDATE","twilio.channel.consumption_update");function jt(C){var P=se();return function(){var v=ae.default(C),l;if(P){var p=ae.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return te.default(this,l)}}function se(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var de=re.scope("Participant"),Y=function(C){oe.default(m,C);var P=jt(m);function m(v,l,p,f,g){var h,b,S;if(be.default(this,m),S=P.call(this),S.conversation=p,S.links=f,S.services=g,S.state={attributes:Te(v.attributes,"Retrieved malformed attributes from the server for participant: "+l,de),dateCreated:v.dateCreated?R(v.dateCreated):null,dateUpdated:v.dateCreated?R(v.dateUpdated):null,sid:l,typingTimeout:null,isTyping:!1,identity:v.identity,roleSid:(h=v.roleSid)!==null&&h!==void 0?h:"",lastReadMessageIndex:Number.isInteger(v.lastConsumedMessageIndex)?v.lastConsumedMessageIndex:null,lastReadTimestamp:v.lastConsumptionTimestamp?R(v.lastConsumptionTimestamp):null,type:v.type||"chat",userInfo:v.userInfo,bindings:(b=v.bindings)!==null&&b!==void 0?b:{}},!v.identity&&!v.type)throw new Error("Received invalid Participant object from server: Missing identity or type of Participant.");return S}return Se.default(m,[{key:"sid",get:function(){return this.state.sid}},{key:"attributes",get:function(){return this.state.attributes}},{key:"dateCreated",get:function(){return this.state.dateCreated}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"identity",get:function(){return this.state.identity}},{key:"isTyping",get:function(){return this.state.isTyping}},{key:"lastReadMessageIndex",get:function(){return this.state.lastReadMessageIndex}},{key:"lastReadTimestamp",get:function(){return this.state.lastReadTimestamp}},{key:"roleSid",get:function(){return this.state.roleSid}},{key:"type",get:function(){return this.state.type}},{key:"bindings",get:function(){var l;return(l=this.state.bindings)!==null&&l!==void 0?l:{}}},{key:"_startTyping",value:function(l){var p=this;return this.state.typingTimeout&&clearTimeout(this.state.typingTimeout),this.state.isTyping=!0,this.emit("typingStarted",this),this.conversation.emit("typingStarted",this),this.state.typingTimeout=Number(setTimeout(function(){return p._endTyping()},l)),this}},{key:"_endTyping",value:function(){!this.state.typingTimeout||(this.state.isTyping=!1,this.emit("typingEnded",this),this.conversation.emit("typingEnded",this),clearInterval(this.state.typingTimeout),this.state.typingTimeout=null)}},{key:"_update",value:function(l){var p=[],f=Te(l.attributes,"Retrieved malformed attributes from the server for participant: "+this.state.sid,de);l.attributes&&!We.default(this.state.attributes,f)&&(this.state.attributes=f,p.push("attributes"));var g=R(l.dateUpdated);l.dateUpdated&&(g==null?void 0:g.getTime())!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=g,p.push("dateUpdated"));var h=R(l.dateCreated);if(l.dateCreated&&(h==null?void 0:h.getTime())!==(this.state.dateCreated&&this.state.dateCreated.getTime())&&(this.state.dateCreated=h,p.push("dateCreated")),l.roleSid&&this.state.roleSid!==l.roleSid&&(this.state.roleSid=l.roleSid,p.push("roleSid")),(Number.isInteger(l.lastConsumedMessageIndex)||l.lastConsumedMessageIndex===null)&&this.state.lastReadMessageIndex!==l.lastConsumedMessageIndex&&(this.state.lastReadMessageIndex=l.lastConsumedMessageIndex,p.push("lastReadMessageIndex")),l.lastConsumptionTimestamp){var b=new Date(l.lastConsumptionTimestamp);(!this.state.lastReadTimestamp||this.state.lastReadTimestamp.getTime()!==b.getTime())&&(this.state.lastReadTimestamp=b,p.push("lastReadTimestamp"))}return l.bindings&&!We.default(this.state.bindings,l.bindings)&&(this.state.bindings=l.bindings,p.push("bindings")),p.length>0&&this.emit("updated",{participant:this,updateReasons:p}),this}},{key:"getUser",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.type=="chat"){g.next=2;break}throw new Error("Getting User is not supported for this Participant type: "+this.type);case 2:return g.abrupt("return",this.services.users.getUser(this.state.identity,this.state.userInfo));case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"remove",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.abrupt("return",this.conversation.removeParticipant(this));case 1:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateAttributes",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:JSON.stringify(f)});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}]),m}(k.ReplayEventEmitter);ne.default(Y,"typingStarted","typingStarted"),ne.default(Y,"typingEnded","typingEnded"),ne.default(Y,"updated","updated"),Q([w.validateTypesAsync(Oe),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],Y.prototype,"updateAttributes",null);function ie(C){var P=X();return function(){var v=ae.default(C),l;if(P){var p=ae.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return te.default(this,l)}}function X(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var ye=re.scope("Participants"),we=function(C){oe.default(m,C);var P=ie(m);function m(v,l,p,f,g){var h;return be.default(this,m),h=P.call(this),ne.default(Ee.default(h),"rosterEntityPromise",null),h.conversation=v,h.participants=l,h.links=p,h.configuration=f,h.services=g,h}return Se.default(m,[{key:"unsubscribe",value:function(){var v=F.default(A.default.mark(function p(){var f;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(!this.rosterEntityPromise){h.next=6;break}return h.next=3,this.rosterEntityPromise;case 3:f=h.sent,f.close(),this.rosterEntityPromise=null;case 6:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"subscribe",value:function(l){var p=this;return this.rosterEntityPromise=this.rosterEntityPromise||this.services.syncClient.map({id:l,mode:"open_existing"}).then(function(f){f.on("itemAdded",function(b){ye.debug(p.conversation.sid+" itemAdded: "+b.item.key),p.upsertParticipant(b.item.key,b.item.data).then(function(S){p.emit("participantJoined",S)})}),f.on("itemRemoved",function(b){ye.debug(p.conversation.sid+" itemRemoved: "+b.key);var S=b.key;if(!!p.participants.has(S)){var j=p.participants.get(S);p.participants.delete(S),j&&p.emit("participantLeft",j)}}),f.on("itemUpdated",function(b){ye.debug(p.conversation.sid+" itemUpdated: "+b.item.key),p.upsertParticipant(b.item.key,b.item.data)});var g=[],h=function b(S){return S.items.forEach(function(j){g.push(p.upsertParticipant(j.key,j.data))}),S.hasNextPage?S.nextPage().then(b):null};return f.getItems().then(h).then(function(){return Promise.all(g)}).then(function(){return f})}).catch(function(f){throw p.rosterEntityPromise=null,p.services.syncClient.connectionState!="disconnected"&&ye.error("Failed to get roster object for conversation",p.conversation.sid,f),ye.debug("ERROR: Failed to get roster object for conversation",p.conversation.sid,f),f})}},{key:"upsertParticipant",value:function(){var v=F.default(A.default.mark(function p(f,g){var h=this,b,S;return A.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:if(b=this.participants.get(f),!b){D.next=3;break}return D.abrupt("return",b._update(g));case 3:return S={self:"".concat(this.links.participants,"/").concat(f)},b=new Y(g,f,this.conversation,S,this.services),this.participants.set(f,b),b.on("updated",function(z){return h.emit("participantUpdated",z)}),D.abrupt("return",b);case 8:case"end":return D.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"getParticipants",value:function(){var v=F.default(A.default.mark(function p(){var f=this;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var b=[];return f.participants.forEach(function(S){return b.push(S)}),b}):[]);case 1:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getParticipantBySid",value:function(){var v=F.default(A.default.mark(function p(f){var g=this;return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){var S=g.participants.get(f);if(!S)throw new Error("Participant with SID "+f+" was not found");return S}):null);case 1:case"end":return b.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getParticipantByIdentity",value:function(){var v=F.default(A.default.mark(function p(f){var g=this,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return h=null,S.abrupt("return",this.rosterEntityPromise?this.rosterEntityPromise.then(function(){if(g.participants.forEach(function(j){j.identity===f&&(h=j)}),!h)throw new Error("Participant with identity "+f+" was not found");return h}):null);case 2:case"end":return S.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"add",value:function(){var v=F.default(A.default.mark(function p(f,g){return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:f,attributes:typeof g<"u"?JSON.stringify(g):void 0});case 2:return b.abrupt("return",b.sent);case 3:case"end":return b.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"addNonChatParticipant",value:function(l,p){var f,g,h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},b=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.services.commandExecutor.mutateResource("post",this.links.participants,{attributes:typeof h<"u"?JSON.stringify(h):void 0,messaging_binding:{address:p,proxy_address:l,name:b==null||(f=b.email)===null||f===void 0?void 0:f.name,level:b==null||(g=b.email)===null||g===void 0?void 0:g.level}})}},{key:"remove",value:function(l){return this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(l))}}]),m}(k.ReplayEventEmitter),Pe=function(){function C(P,m){be.default(this,C),ne.default(this,"mcsMedia",null),this.services=m,P instanceof Me.McsMedia&&(this.mcsMedia=P),this.state={sid:P.sid,category:P.category,filename:P.filename,contentType:P.contentType,size:P.size}}return Se.default(C,[{key:"sid",get:function(){return this.state.sid}},{key:"filename",get:function(){return this.state.filename}},{key:"contentType",get:function(){return this.state.contentType}},{key:"size",get:function(){return this.state.size}},{key:"category",get:function(){return this.state.category}},{key:"getContentTemporaryUrl",value:function(){var P=F.default(A.default.mark(function v(){var l,p;return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._fetchMcsMedia();case 2:return g.abrupt("return",(l=(p=this.mcsMedia)===null||p===void 0?void 0:p.getContentUrl())!==null&&l!==void 0?l:null);case 3:case"end":return g.stop()}},v,this)}));function m(){return P.apply(this,arguments)}return m}()},{key:"getCachedTemporaryUrl",value:function(){var P=F.default(A.default.mark(function v(){var l,p;return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._fetchMcsMedia();case 2:return g.abrupt("return",(l=(p=this.mcsMedia)===null||p===void 0?void 0:p.getCachedContentUrl())!==null&&l!==void 0?l:null);case 3:case"end":return g.stop()}},v,this)}));function m(){return P.apply(this,arguments)}return m}()},{key:"_fetchMcsMedia",value:function(){var P=F.default(A.default.mark(function v(){return A.default.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:if(this.mcsMedia){p.next=8;break}if(!this.services.mcsClient){p.next=7;break}return p.next=4,this.services.mcsClient.get(this.state.sid);case 4:this.mcsMedia=p.sent,p.next=8;break;case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return p.stop()}},v,this)}));function m(){return P.apply(this,arguments)}return m}()}]),C}(),Ye=function(){function C(P){be.default(this,C),this.state=P}return Se.default(C,[{key:"total",get:function(){return this.state.total}},{key:"sent",get:function(){return this.state.sent}},{key:"delivered",get:function(){return this.state.delivered}},{key:"read",get:function(){return this.state.read}},{key:"undelivered",get:function(){return this.state.undelivered}},{key:"failed",get:function(){return this.state.failed}},{key:"_update",value:function(m){this.state=m}},{key:"_isEquals",value:function(m){var v=this.total===m.total,l=this.sent===m.sent,p=this.delivered===m.delivered,f=this.read===m.read,g=this.undelivered===m.undelivered,h=this.failed===m.failed;return v&&l&&p&&f&&g&&h}}]),C}(),st=function(){function C(P,m,v,l){be.default(this,C),this.state={prevToken:v,nextToken:l,source:m,items:P}}return Se.default(C,[{key:"hasNextPage",get:function(){return!!this.state.nextToken}},{key:"hasPrevPage",get:function(){return!!this.state.prevToken}},{key:"items",get:function(){return this.state.items}},{key:"nextPage",value:function(){return this.hasNextPage?this.state.source(this.state.nextToken):Promise.reject(new Error("No next page"))}},{key:"prevPage",value:function(){return this.hasPrevPage?this.state.source(this.state.prevToken):Promise.reject(new Error("No previous page"))}}]),C}(),Ze=function C(P){be.default(this,C),this.sid=P.sid,this.messageSid=P.message_sid,this.conversationSid=P.conversation_sid,this.channelMessageSid=P.channel_message_sid,this.participantSid=P.participant_sid,this.status=P.status||"queued",this.errorCode=P.error_code||0,this.dateCreated=P.date_created,this.dateUpdated=P.date_updated};function Fe(C){var P=_r();return function(){var v=ae.default(C),l;if(P){var p=ae.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return te.default(this,l)}}function _r(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Je=re.scope("Message"),qt=function(C){oe.default(m,C);var P=Fe(m);function m(v,l,p,f,g,h){var b,S,j,D,z;return be.default(this,m),z=P.call(this),z.conversation=p,z.links=f,z.configuration=g,z.services=h,z.state={sid:l.sid,index:v,author:l.author,subject:l.subject,body:(b=l.text)!==null&&b!==void 0?b:null,timestamp:l.timestamp?new Date(l.timestamp):null,dateUpdated:l.dateUpdated?new Date(l.dateUpdated):null,lastUpdatedBy:(S=l.lastUpdatedBy)!==null&&S!==void 0?S:null,attributes:Te(l.attributes,"Got malformed attributes for the message ".concat(l.sid),Je),type:(j=l.type)!==null&&j!==void 0?j:"text",media:l.type&&l.type==="media"&&l.media?new Pe(l.media,z.services):null,medias:l.type&&l.type==="media"&&l.medias?l.medias.map(function(ge){return new Pe(ge,z.services)}):null,participantSid:(D=l.memberSid)!==null&&D!==void 0?D:null,aggregatedDeliveryReceipt:l.delivery?new Ye(l.delivery):null},z}return Se.default(m,[{key:"sid",get:function(){return this.state.sid}},{key:"author",get:function(){return this.state.author}},{key:"subject",get:function(){return this.state.subject}},{key:"body",get:function(){return this.state.body}},{key:"dateUpdated",get:function(){return this.state.dateUpdated}},{key:"index",get:function(){return this.state.index}},{key:"lastUpdatedBy",get:function(){return this.state.lastUpdatedBy}},{key:"dateCreated",get:function(){return this.state.timestamp}},{key:"attributes",get:function(){return this.state.attributes}},{key:"type",get:function(){return this.state.type}},{key:"media",get:function(){return this.state.media}},{key:"attachedMedia",get:function(){return this.getMediaByCategory(["media"])}},{key:"participantSid",get:function(){return this.state.participantSid}},{key:"aggregatedDeliveryReceipt",get:function(){return this.state.aggregatedDeliveryReceipt}},{key:"getMediaByCategory",value:function(l){var p;return((p=this.state.medias)!==null&&p!==void 0?p:[]).filter(function(f){return l.includes(f.category)})}},{key:"getEmailBody",value:function(){var l,p,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(l=(p=this.getMediaByCategory(["body"]))===null||p===void 0?void 0:p.filter(function(g){return g.contentType==f}).shift())!==null&&l!==void 0?l:null}},{key:"getEmailHistory",value:function(){var l,p,f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"text/plain";return(l=(p=this.getMediaByCategory(["history"]))===null||p===void 0?void 0:p.filter(function(g){return g.contentType==f}).shift())!==null&&l!==void 0?l:null}},{key:"_update",value:function(l){var p=[];(l.text||typeof l.text=="string")&&l.text!==this.state.body&&(this.state.body=l.text,p.push("body")),l.subject&&l.subject!==this.state.subject&&(this.state.subject=l.subject,p.push("subject")),l.lastUpdatedBy&&l.lastUpdatedBy!==this.state.lastUpdatedBy&&(this.state.lastUpdatedBy=l.lastUpdatedBy,p.push("lastUpdatedBy")),l.author&&l.author!==this.state.author&&(this.state.author=l.author,p.push("author")),l.dateUpdated&&new Date(l.dateUpdated).getTime()!==(this.state.dateUpdated&&this.state.dateUpdated.getTime())&&(this.state.dateUpdated=new Date(l.dateUpdated),p.push("dateUpdated")),l.timestamp&&new Date(l.timestamp).getTime()!==(this.state.timestamp&&this.state.timestamp.getTime())&&(this.state.timestamp=new Date(l.timestamp),p.push("dateCreated"));var f=Te(l.attributes,"Got malformed attributes for the message ".concat(this.sid),Je);We.default(this.state.attributes,f)||(this.state.attributes=f,p.push("attributes"));var g=l.delivery,h=this.state.aggregatedDeliveryReceipt,b=!!g&&!!g.total&&!!g.delivered&&!!g.failed&&!!g.read&&!!g.sent&&!!g.undelivered;b&&(h?h._isEquals(g)||(h._update(g),p.push("deliveryReceipt")):(this.state.aggregatedDeliveryReceipt=new Ye(g),p.push("deliveryReceipt"))),p.length>0&&this.emit("updated",{message:this,updateReasons:p})}},{key:"getParticipant",value:function(){var v=F.default(A.default.mark(function p(){var f=this,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(g=null,!this.state.participantSid){S.next=5;break}return S.next=4,this.conversation.getParticipantBySid(this.state.participantSid).catch(function(){return Je.debug('Participant with sid "'.concat(f.participantSid,'" not found for message ').concat(f.sid)),null});case 4:g=S.sent;case 5:if(!(!g&&this.state.author)){S.next=9;break}return S.next=8,this.conversation.getParticipantByIdentity(this.state.author).catch(function(){return Je.debug('Participant with identity "'.concat(f.author,'" not found for message ').concat(f.sid)),null});case 8:g=S.sent;case 9:if(!g){S.next=11;break}return S.abrupt("return",g);case 11:throw h="Participant with ",this.state.participantSid&&(h+="SID '"+this.state.participantSid+"' "),this.state.author&&(this.state.participantSid&&(h+="or "),h+="identity '"+this.state.author+"' "),h==="Participant with "&&(h="Participant "),h+="was not found",new Error(h);case 17:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getDetailedDeliveryReceipts",value:function(){var v=F.default(A.default.mark(function p(){var f,g;return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this._getDetailedDeliveryReceiptsPaginator();case 2:f=b.sent,g=[];case 4:if(g=[].concat(V.default(g),V.default(f.items)),f.hasNextPage){b.next=8;break}return b.abrupt("break",13);case 8:return b.next=10,f.nextPage();case 10:f=b.sent,b.next=4;break;case 13:return b.abrupt("return",g);case 14:case"end":return b.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"remove",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return g.abrupt("return",this);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateBody",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{body:f});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateAttributes",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:typeof f<"u"?JSON.stringify(f):void 0});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"attachTemporaryUrlsFor",value:function(){var v=F.default(A.default.mark(function p(f){var g=this,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(h=f==null?void 0:f.map(function(j){return j.sid}),!(this.services.mcsClient&&h)){S.next=7;break}return S.next=4,this.services.mcsClient.mediaSetGet(h);case 4:return S.abrupt("return",S.sent.map(function(j){return new Pe(j,g.services)}));case 7:throw new Error("Media Content Service is unavailable");case 8:case"end":return S.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"_getDetailedDeliveryReceiptsPaginator",value:function(){var v=F.default(A.default.mark(function p(f){var g=this,h,b,S;return A.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return h=this.configuration.links.messagesReceipts.replace("%s",this.conversation.sid).replace("%s",this.sid),b=new Ne(h).arg("PageToken",f==null?void 0:f.pageToken).arg("PageSize",f==null?void 0:f.pageSize).build(),D.next=4,this.services.network.get(b);case 4:return S=D.sent,D.abrupt("return",new st(S.body.delivery_receipts.map(function(z){return new Ze(z)}),function(z,ge){return g._getDetailedDeliveryReceiptsPaginator({pageToken:z,pageSize:ge})},S.body.meta.previous_token,S.body.meta.next_token));case 6:case"end":return D.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}]),m}(k.ReplayEventEmitter);ne.default(qt,"updated","updated"),Q([w.validateTypes([w.nonEmptyString,"undefined"]),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Pe)],qt.prototype,"getEmailBody",null),Q([w.validateTypes([w.nonEmptyString,"undefined"]),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Pe)],qt.prototype,"getEmailHistory",null),Q([w.validateTypesAsync("string"),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],qt.prototype,"updateBody",null),Q([w.validateTypesAsync(Oe),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],qt.prototype,"updateAttributes",null),Q([w.validateTypesAsync(w.custom(function(C){return[C instanceof Array&&C.length>0&&C.reduce(function(P,m){return P&&m instanceof Pe},!0),"a non-empty array of Media"]})),$("design:type",Function),$("design:paramtypes",[Array]),$("design:returntype",Promise)],qt.prototype,"attachTemporaryUrlsFor",null);function Ut(C,P){var m=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!m){if(Array.isArray(C)||(m=$i(C))||P&&C&&typeof C.length=="number"){m&&(C=m);var v=0,l=function(){};return{s:l,n:function(){return v>=C.length?{done:!0}:{done:!1,value:C[v++]}},e:function(b){throw b},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(C)},n:function(){var b=m.next();return p=b.done,b},e:function(b){f=!0,g=b},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function $i(C,P){if(!!C){if(typeof C=="string")return Kn(C,P);var m=Object.prototype.toString.call(C).slice(8,-1);if(m==="Object"&&C.constructor&&(m=C.constructor.name),m==="Map"||m==="Set")return Array.from(C);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return Kn(C,P)}}function Kn(C,P){(P==null||P>C.length)&&(P=C.length);for(var m=0,v=new Array(P);m<P;m++)v[m]=C[m];return v}function An(C){var P=Et();return function(){var v=ae.default(C),l;if(P){var p=ae.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return te.default(this,l)}}function Et(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Dt=re.scope("Messages"),Lr=function(C){oe.default(m,C);var P=An(m);function m(v,l,p){var f;return be.default(this,m),f=P.call(this),f.conversation=v,f.configuration=l,f.services=p,f.messagesByIndex=new Map,f.messagesListPromise=null,f}return Se.default(m,[{key:"subscribe",value:function(){var v=F.default(A.default.mark(function p(f){var g=this,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!this.messagesListPromise){S.next=2;break}return S.abrupt("return",this.messagesListPromise);case 2:return this.messagesListPromise=this.services.syncClient.list({id:f,mode:"open_existing"}),S.prev=3,S.next=6,this.messagesListPromise;case 6:return h=S.sent,h.on("itemAdded",function(j){Dt.debug("".concat(g.conversation.sid," itemAdded: ").concat(j.item.index));var D={self:"".concat(g.conversation.links.messages,"/").concat(j.item.data.sid),conversation:g.conversation.links.self,messages_receipts:"".concat(g.conversation.links.messages,"/").concat(j.item.data.sid,"/Receipts")},z=new qt(j.item.index,j.item.data,g.conversation,D,g.configuration,g.services);if(g.messagesByIndex.has(z.index)){Dt.debug("Message arrived, but is already known and ignored",g.conversation.sid,z.index);return}g.messagesByIndex.set(z.index,z),z.on("updated",function(ge){return g.emit("messageUpdated",ge)}),g.emit("messageAdded",z)}),h.on("itemRemoved",function(j){Dt.debug("#{this.conversation.sid} itemRemoved: ".concat(j.index));var D=j.index;if(g.messagesByIndex.has(D)){var z=g.messagesByIndex.get(D);if(!z)return;g.messagesByIndex.delete(z.index),z.removeAllListeners("updated"),g.emit("messageRemoved",z)}}),h.on("itemUpdated",function(j){Dt.debug("".concat(g.conversation.sid," itemUpdated: ").concat(j.item.index));var D=g.messagesByIndex.get(j.item.index);D&&D._update(j.item.data)}),S.abrupt("return",h);case 13:throw S.prev=13,S.t0=S.catch(3),this.messagesListPromise=null,this.services.syncClient.connectionState!=="disconnected"&&Dt.error("Failed to get messages object for conversation",this.conversation.sid,S.t0),Dt.debug("ERROR: Failed to get messages object for conversation",this.conversation.sid,S.t0),S.t0;case 19:case"end":return S.stop()}},p,this,[[3,13]])}));function l(p){return v.apply(this,arguments)}return l}()},{key:"unsubscribe",value:function(){var v=F.default(A.default.mark(function p(){var f;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.messagesListPromise){h.next=2;break}return h.abrupt("return");case 2:return h.next=4,this.messagesListPromise;case 4:f=h.sent,f.close(),this.messagesListPromise=null;case 7:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"sendV2",value:function(){var v=F.default(A.default.mark(function p(f){var g,h,b,S,j,D,z,ge,qe;return A.default.wrap(function(He){for(;;)switch(He.prev=He.next){case 0:Dt.debug("Sending message V2",f.mediaContent,f.attributes,f.emailOptions),h=[],b=Ut(f.mediaContent),He.prev=3,b.s();case 5:if((S=b.n()).done){He.next=22;break}if(z=fe.default(S.value,2),ge=z[0],qe=z[1],Dt.debug("Adding media to a message as ".concat(qe instanceof FormData?"FormData":"SendMediaOptions"),qe),He.t0=h,!(qe instanceof FormData)){He.next=15;break}return He.next=12,this.services.mcsClient.postFormData(qe,ge);case 12:He.t1=He.sent,He.next=18;break;case 15:return He.next=17,this.services.mcsClient.post((j=qe.contentType)!==null&&j!==void 0?j:"",(D=qe.media)!==null&&D!==void 0?D:"",ge,qe.filename);case 17:He.t1=He.sent;case 18:He.t2=He.t1,He.t0.push.call(He.t0,He.t2);case 20:He.next=5;break;case 22:He.next=27;break;case 24:He.prev=24,He.t3=He.catch(3),b.e(He.t3);case 27:return He.prev=27,b.f(),He.finish(27);case 30:return He.next=32,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{body:f.text,subject:(g=f.emailOptions)===null||g===void 0?void 0:g.subject,media_sids:h.map(function(ot){return ot.sid}),attributes:typeof f.attributes<"u"?JSON.stringify(f.attributes):void 0});case 32:return He.abrupt("return",He.sent);case 33:case"end":return He.stop()}},p,this,[[3,24,27,30]])}));function l(p){return v.apply(this,arguments)}return l}()},{key:"send",value:function(){var v=F.default(A.default.mark(function p(f){var g,h,b=arguments;return A.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return g=b.length>1&&b[1]!==void 0?b[1]:{},h=b.length>2?b[2]:void 0,Dt.debug("Sending text message",f,g,h),j.next=5,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{body:f!=null?f:"",attributes:typeof g<"u"?JSON.stringify(g):void 0,subject:h==null?void 0:h.subject});case 5:return j.abrupt("return",j.sent);case 6:case"end":return j.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"sendMedia",value:function(){var v=F.default(A.default.mark(function p(f){var g,h,b,S,j,D=arguments;return A.default.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(b=D.length>1&&D[1]!==void 0?D[1]:{},S=D.length>2?D[2]:void 0,Dt.debug("Sending media message",f,b,S),Dt.debug("Sending media message as ".concat(f instanceof FormData?"FormData":"SendMediaOptions"),f,b),!(f instanceof FormData)){ge.next=10;break}return ge.next=7,this.services.mcsClient.postFormData(f);case 7:ge.t0=ge.sent,ge.next=13;break;case 10:return ge.next=12,this.services.mcsClient.post((g=f.contentType)!==null&&g!==void 0?g:"",(h=f.media)!==null&&h!==void 0?h:"","media",f.filename);case 12:ge.t0=ge.sent;case 13:return j=ge.t0,ge.next=16,this.services.commandExecutor.mutateResource("post",this.conversation.links.messages,{media_sids:[j.sid],attributes:typeof b<"u"?JSON.stringify(b):void 0});case 16:return ge.abrupt("return",ge.sent);case 17:case"end":return ge.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getMessages",value:function(){var v=F.default(A.default.mark(function p(f,g){var h,b=arguments;return A.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return h=b.length>2&&b[2]!==void 0?b[2]:"backwards",j.abrupt("return",this._getMessages(f,g,h));case 2:case"end":return j.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_wrapPaginator",value:function(l,p,f){var g=this,h=l==="desc",b=function(){return p.nextPage().then(function(D){return g._wrapPaginator(l,D,f)})},S=function(){return p.prevPage().then(function(D){return g._wrapPaginator(l,D,f)})};return f(p.items).then(function(j){return{items:j.sort(function(D,z){return D.index-z.index}),hasPrevPage:h?p.hasNextPage:p.hasPrevPage,hasNextPage:h?p.hasPrevPage:p.hasNextPage,prevPage:h?b:S,nextPage:h?S:b}})}},{key:"_upsertMessage",value:function(l,p){var f=this,g=this.messagesByIndex.get(l);if(g)return g;var h={self:"".concat(this.conversation.links.messages,"/").concat(p.sid),conversation:this.conversation.links.self,messages_receipts:"".concat(this.conversation.links.messages,"/").concat(p.sid,"/Receipts")},b=new qt(l,p,this.conversation,h,this.configuration,this.services);return this.messagesByIndex.set(b.index,b),b.on("updated",function(S){return f.emit("messageUpdated",S)}),b}},{key:"_getMessages",value:function(){var v=F.default(A.default.mark(function p(){var f=this,g,h,b,S,j,D,z=arguments;return A.default.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return g=z.length>0&&z[0]!==void 0?z[0]:30,h=z.length>1&&z[1]!==void 0?z[1]:"end",b=z.length>2&&z[2]!==void 0?z[2]:"forward",S=b==="backwards"?"desc":"asc",qe.next=6,this.messagesListPromise;case 6:return j=qe.sent,qe.next=9,j==null?void 0:j.getItems({from:h!=="end"?h:void 0,pageSize:g,order:S,limit:g});case 9:return D=qe.sent,qe.next=12,this._wrapPaginator(S,D,function(rt){return Promise.all(rt.map(function(He){return f._upsertMessage(He.index,He.data)}))});case 12:return qe.abrupt("return",qe.sent);case 13:case"end":return qe.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()}]),m}(k.ReplayEventEmitter),Rr=function(){function C(P){be.default(this,C),ne.default(this,"attributes",{}),ne.default(this,"mediaContent",[]),ne.default(this,"emailOptions",{}),this.messagesEntity=P}return Se.default(C,[{key:"send",value:function(){var P=F.default(A.default.mark(function v(){var l;return A.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return f.next=2,this.messagesEntity.sendV2(this);case 2:return l=f.sent,f.abrupt("return",pe(l.index));case 4:case"end":return f.stop()}},v,this)}));function m(){return P.apply(this,arguments)}return m}()}]),C}(),ha=function(){function C(P,m){be.default(this,C),this.limits=P,this.message=new Rr(m),this.emailBodies=new Map,this.emailHistories=new Map}return Se.default(C,[{key:"setBody",value:function(m){return this.message.text=m,this}},{key:"setSubject",value:function(m){return this.message.emailOptions.subject=m,this}},{key:"setAttributes",value:function(m){return this.message.attributes=m,this}},{key:"setEmailBody",value:function(m,v){return this.emailBodies.set(m,v),this}},{key:"setEmailHistory",value:function(m,v){return this.emailHistories.set(m,v),this}},{key:"addMedia",value:function(m){if(typeof FormData>"u"&&m instanceof FormData)throw new Error("Could not add FormData content whilst not in a browser");if(!(m instanceof FormData)){var v=m;if(!v.contentType||!v.media)throw new Error("Media content in SendMediaOptions must contain non-empty contentType and media")}return this.message.mediaContent.push(["media",m]),this}},{key:"build",value:function(){var m=this;if(this.emailBodies.forEach(function(v,l){if(!m.limits.emailBodiesAllowedMimeTypes.includes(l))throw new Error("Unsupported email body MIME type ".concat(l))}),this.emailHistories.forEach(function(v,l){if(!m.limits.emailHistoriesAllowedMimeTypes.includes(l))throw new Error("Unsupported email history MIME type ".concat(l))}),this.emailBodies.size>this.limits.emailBodiesAllowedMimeTypes.length)throw new Error("Too many email bodies attached to the message (".concat(this.emailBodies.size," > ").concat(this.limits.emailBodiesAllowedMimeTypes.length,")"));if(this.emailHistories.size>this.limits.emailHistoriesAllowedMimeTypes.length)throw new Error("Too many email histories attached to the message (".concat(this.emailHistories.size," > ").concat(this.limits.emailHistoriesAllowedMimeTypes.length,")"));if(this.message.mediaContent.length>this.limits.mediaAttachmentsCountLimit)throw new Error("Too many media attachments in the message (".concat(this.message.mediaContent.length," > ").concat(this.limits.mediaAttachmentsCountLimit,")"));return this.emailBodies.forEach(function(v){m.message.mediaContent.push(["body",v])}),this.emailHistories.forEach(function(v){m.message.mediaContent.push(["history",v])}),this.message}},{key:"getPayloadContentType",value:function(m){return typeof FormData<"u"&&m instanceof FormData?m.get("Content-Type"):m.contentType}}]),C}();function ss(C,P){var m=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!m){if(Array.isArray(C)||(m=jr(C))||P&&C&&typeof C.length=="number"){m&&(C=m);var v=0,l=function(){};return{s:l,n:function(){return v>=C.length?{done:!0}:{done:!1,value:C[v++]}},e:function(b){throw b},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(C)},n:function(){var b=m.next();return p=b.done,b},e:function(b){f=!0,g=b},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function jr(C,P){if(!!C){if(typeof C=="string")return os(C,P);var m=Object.prototype.toString.call(C).slice(8,-1);if(m==="Object"&&C.constructor&&(m=C.constructor.name),m==="Map"||m==="Set")return Array.from(C);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return os(C,P)}}function os(C,P){(P==null||P>C.length)&&(P=C.length);for(var m=0,v=new Array(P);m<P;m++)v[m]=C[m];return v}function wo(C){var P=_o();return function(){var v=ae.default(C),l;if(P){var p=ae.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return te.default(this,l)}}function _o(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var dr=re.scope("Conversation"),hn={lastMessage:"lastMessage",attributes:"attributes",createdBy:"createdBy",dateCreated:"dateCreated",dateUpdated:"dateUpdated",friendlyName:"friendlyName",lastConsumedMessageIndex:"lastConsumedMessageIndex",notificationLevel:"notificationLevel",sid:"sid",status:"status",uniqueName:"uniqueName",state:"state",bindings:"bindings"};function zr(C){try{return new Date(C)}catch{return null}}var _t=function(C){oe.default(m,C);var P=wo(m);function m(v,l,p,f,g){var h,b;be.default(this,m),b=P.call(this),b.sid=l,b.links=p,b.configuration=f,b.services=g;var S=v.attributes||{},j=v.createdBy,D=zr(v.dateCreated),z=zr(v.dateUpdated),ge=v.friendlyName||null,qe=Number.isInteger(v.lastConsumedMessageIndex)?v.lastConsumedMessageIndex:null,rt=v.uniqueName||null;try{JSON.stringify(S)}catch{throw new Error("Attributes must be a valid JSON object.")}b.entityName=v.channel,b.channelState={uniqueName:rt,status:"notParticipating",attributes:S,createdBy:j,dateCreated:D,dateUpdated:z,friendlyName:ge,lastReadMessageIndex:qe,bindings:(h=v.bindings)!==null&&h!==void 0?h:{}},v.notificationLevel&&(b.channelState.notificationLevel=v.notificationLevel);var He={participants:b.links.participants};return b.participants=new Map,b.participantsEntity=new we(Ee.default(b),b.participants,He,b.configuration,b.services),b.participantsEntity.on("participantJoined",function(ot){return b.emit("participantJoined",ot)}),b.participantsEntity.on("participantLeft",function(ot){return b.emit("participantLeft",ot)}),b.participantsEntity.on("participantUpdated",function(ot){return b.emit("participantUpdated",ot)}),b.messagesEntity=new Lr(Ee.default(b),f,g),b.messagesEntity.on("messageAdded",function(ot){return b._onMessageAdded(ot)}),b.messagesEntity.on("messageUpdated",function(ot){return b.emit("messageUpdated",ot)}),b.messagesEntity.on("messageRemoved",function(ot){return b.emit("messageRemoved",ot)}),b}return Se.default(m,[{key:"uniqueName",get:function(){return this.channelState.uniqueName}},{key:"status",get:function(){return this.channelState.status}},{key:"friendlyName",get:function(){return this.channelState.friendlyName}},{key:"dateUpdated",get:function(){return this.channelState.dateUpdated}},{key:"dateCreated",get:function(){return this.channelState.dateCreated}},{key:"createdBy",get:function(){var l;return(l=this.channelState.createdBy)!==null&&l!==void 0?l:""}},{key:"attributes",get:function(){return this.channelState.attributes}},{key:"lastReadMessageIndex",get:function(){return this.channelState.lastReadMessageIndex}},{key:"lastMessage",get:function(){var l;return(l=this.channelState.lastMessage)!==null&&l!==void 0?l:void 0}},{key:"notificationLevel",get:function(){var l;return(l=this.channelState.notificationLevel)!==null&&l!==void 0?l:"default"}},{key:"bindings",get:function(){return this.channelState.bindings}},{key:"limits",get:function(){return this.configuration.limits}},{key:"state",get:function(){return this.channelState.state}},{key:"_subscribe",value:function(){var l,p=this;return this.entityPromise=(l=this.entityPromise)!==null&&l!==void 0?l:this.services.syncClient.document({id:this.entityName,mode:"open_existing"}).then(function(f){return p.entity=f,p.entity.on("updated",function(g){p._update(g.data)}),p.entity.on("removed",function(){return p.emit("removed",p)}),p._update(p.entity.data),f}).catch(function(f){throw p.entity=null,p.entityPromise=null,p.services.syncClient.connectionState!="disconnected"&&dr.error("Failed to get conversation object",f),dr.debug("ERROR: Failed to get conversation object",f),f})}},{key:"_subscribeStreams",value:function(){var v=F.default(A.default.mark(function p(){var f,g,h,b,S;return A.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.prev=0,D.next=3,this._subscribe();case 3:return dr.trace("_subscribeStreams, this.entity.data=",(f=this.entity)===null||f===void 0?void 0:f.data),b=(g=this.entity)===null||g===void 0?void 0:g.data.messages,S=(h=this.entity)===null||h===void 0?void 0:h.data.roster,D.next=8,Promise.all([this.messagesEntity.subscribe(b),this.participantsEntity.subscribe(S)]);case 8:D.next=15;break;case 10:throw D.prev=10,D.t0=D.catch(0),this.services.syncClient.connectionState!=="disconnected"&&dr.error("Failed to subscribe on conversation objects",this.sid,D.t0),dr.debug("ERROR: Failed to subscribe on conversation objects",this.sid,D.t0),D.t0;case 15:case"end":return D.stop()}},p,this,[[0,10]])}));function l(){return v.apply(this,arguments)}return l}()},{key:"_unsubscribe",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!this.entity){g.next=5;break}return g.next=3,this.entity.close();case 3:this.entity=null,this.entityPromise=null;case 5:return g.abrupt("return",Promise.all([this.participantsEntity.unsubscribe(),this.messagesEntity.unsubscribe()]));case 6:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_setStatus",value:function(l,p){var f=this;this.statusSource=p,this.channelState.status!==l&&(this.channelState.status=l,l==="joined"?this._subscribeStreams().catch(function(g){if(dr.debug("ERROR while setting conversation status "+l,g),f.services.syncClient.connectionState!=="disconnected")throw g}):this.entityPromise&&this._unsubscribe().catch(function(g){if(dr.debug("ERROR while setting conversation status "+l,g),f.services.syncClient.connectionState!=="disconnected")throw g}))}},{key:"_statusSource",value:function(){return this.statusSource}},{key:"_update",value:function(l){var p,f,g,h,b;dr.trace("_update",l),m.preprocessUpdate(l,this.sid);for(var S=new Set,j=0,D=Object.keys(l);j<D.length;j++){var z=D[j],ge=hn[z];if(!!ge)switch(ge){case hn.status:if(!l.status||l.status==="unknown"||this.channelState.status===l.status)break;this.channelState.status=l.status,S.add(ge);break;case hn.attributes:if(We.default(this.channelState.attributes,l.attributes))break;this.channelState.attributes=l.attributes,S.add(ge);break;case hn.lastConsumedMessageIndex:if(l.lastConsumedMessageIndex===void 0||l.lastConsumedMessageIndex===this.channelState.lastReadMessageIndex)break;this.channelState.lastReadMessageIndex=l.lastConsumedMessageIndex,S.add("lastReadMessageIndex");break;case hn.lastMessage:if(this.channelState.lastMessage&&!l.lastMessage){delete this.channelState.lastMessage,S.add(ge);break}this.channelState.lastMessage=this.channelState.lastMessage||{},((p=l.lastMessage)===null||p===void 0?void 0:p.index)!==void 0&&l.lastMessage.index!==this.channelState.lastMessage.index&&(this.channelState.lastMessage.index=l.lastMessage.index,S.add(ge)),((f=l.lastMessage)===null||f===void 0?void 0:f.timestamp)!==void 0&&((g=this.channelState.lastMessage)===null||g===void 0||(h=g.dateCreated)===null||h===void 0?void 0:h.getTime())!==l.lastMessage.timestamp.getTime()&&(this.channelState.lastMessage.dateCreated=l.lastMessage.timestamp,S.add(ge)),We.default(this.channelState.lastMessage,{})&&delete this.channelState.lastMessage;break;case hn.state:var qe=l.state||void 0;if(qe!==void 0&&(qe.dateUpdated=new Date(qe.dateUpdated)),We.default(this.channelState.state,qe))break;this.channelState.state=qe,S.add(ge);break;case hn.bindings:if(We.default(this.channelState.bindings,l.bindings))break;this.channelState.bindings=l.bindings,S.add(ge);break;default:var rt=l[z]instanceof Date,He=rt&&((b=this.channelState[ge])===null||b===void 0?void 0:b.getTime())===l[z].getTime(),ot=!rt&&this[ge]===l[z];if(He||ot)break;this.channelState[ge]=l[z],S.add(ge)}}S.size>0&&this.emit("updated",{conversation:this,updateReasons:V.default(S)})}},{key:"_onMessageAdded",value:function(l){var p=ss(this.participants.values()),f;try{for(p.s();!(f=p.n()).done;){var g=f.value;if(g.identity===l.author){g._endTyping();break}}}catch(h){p.e(h)}finally{p.f()}this.emit("messageAdded",l)}},{key:"_setLastReadMessageIndex",value:function(){var v=F.default(A.default.mark(function p(f){var g;return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.services.commandExecutor.mutateResource("post","".concat(this.configuration.links.myConversations,"/").concat(this.sid),{last_read_message_index:f});case 2:return g=b.sent,b.abrupt("return",g.unread_messages_count);case 4:case"end":return b.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"add",value:function(){var v=F.default(A.default.mark(function p(f,g){return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.abrupt("return",this.participantsEntity.add(f,g!=null?g:{}));case 1:case"end":return b.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"addNonChatParticipant",value:function(){var v=F.default(A.default.mark(function p(f,g){var h,b,S=arguments;return A.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return h=S.length>2&&S[2]!==void 0?S[2]:{},b=S.length>3&&S[3]!==void 0?S[3]:{},D.abrupt("return",this.participantsEntity.addNonChatParticipant(f,g,h!=null?h:{},b!=null?b:{}));case 3:case"end":return D.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"advanceLastReadMessageIndex",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._subscribeStreams();case 2:if(!(f<(this.lastReadMessageIndex||0))){h.next=6;break}return h.next=5,this._setLastReadMessageIndex(this.lastReadMessageIndex);case 5:return h.abrupt("return",h.sent);case 6:return h.next=8,this._setLastReadMessageIndex(f);case 8:return h.abrupt("return",h.sent);case 9:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"delete",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.commandExecutor.mutateResource("delete",this.links.self);case 2:return g.abrupt("return",this);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getAttributes",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._subscribe();case 2:return g.abrupt("return",this.attributes);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getMessages",value:function(){var v=F.default(A.default.mark(function p(f,g,h){return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._subscribeStreams();case 2:return S.abrupt("return",this.messagesEntity.getMessages(f,g,h));case 3:case"end":return S.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"getParticipants",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._subscribeStreams();case 2:return g.abrupt("return",this.participantsEntity.getParticipants());case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getParticipantsCount",value:function(){var v=F.default(A.default.mark(function p(){var f,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return g=new Ne(this.configuration.links.conversations).path(this.sid).build(),S.next=3,this.services.network.get(g);case 3:return h=S.sent,S.abrupt("return",(f=h.body.participants_count)!==null&&f!==void 0?f:0);case 5:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getParticipantBySid",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.abrupt("return",this.participantsEntity.getParticipantBySid(f));case 1:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getParticipantByIdentity",value:function(){var v=F.default(A.default.mark(function p(){var f,g=arguments;return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return f=g.length>0&&g[0]!==void 0?g[0]:"",b.abrupt("return",this.participantsEntity.getParticipantByIdentity(f!=null?f:""));case 2:case"end":return b.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getMessagesCount",value:function(){var v=F.default(A.default.mark(function p(){var f,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return g=new Ne(this.configuration.links.conversations).path(this.sid).build(),S.next=3,this.services.network.get(g);case 3:return h=S.sent,S.abrupt("return",(f=h.body.messages_count)!==null&&f!==void 0?f:0);case 5:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getUnreadMessagesCount",value:function(){var v=F.default(A.default.mark(function p(){var f,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return f=new Ne(this.configuration.links.myConversations).path(this.sid).build(),S.next=3,this.services.network.get(f);case 3:if(g=S.sent,g.body.conversation_sid===this.sid){S.next=6;break}throw new Error("Conversation was not found in the user conversations list");case 6:if(h=g.body.unread_messages_count,typeof h!="number"){S.next=9;break}return S.abrupt("return",h);case 9:return S.abrupt("return",null);case 10:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"join",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.commandExecutor.mutateResource("post",this.links.participants,{identity:this.configuration.userIdentity});case 2:return g.abrupt("return",this);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"leave",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(this.channelState.status!=="joined"){g.next=3;break}return g.next=3,this.services.commandExecutor.mutateResource("delete","".concat(this.links.participants,"/").concat(this.configuration.userIdentity));case 3:return g.abrupt("return",this);case 4:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"removeParticipant",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.participantsEntity.remove(typeof f=="string"?f:f.sid);case 2:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"sendMessage",value:function(){var v=F.default(A.default.mark(function p(f,g,h){var b,S,j,D;return A.default.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(!(typeof f=="string"||f===null)){ge.next=5;break}return ge.next=3,this.messagesEntity.send(f,g,h);case 3:return j=ge.sent,ge.abrupt("return",(S=pe(j.index))!==null&&S!==void 0?S:0);case 5:return ge.next=7,this.messagesEntity.sendMedia(f,g,h);case 7:return D=ge.sent,ge.abrupt("return",(b=pe(D.index))!==null&&b!==void 0?b:0);case 9:case"end":return ge.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"prepareMessage",value:function(){return new ha(this.limits,this.messagesEntity)}},{key:"setAllMessagesRead",value:function(){var v=F.default(A.default.mark(function p(){var f;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._subscribeStreams();case 2:return h.next=4,this.getMessages(1);case 4:if(f=h.sent,!(f.items.length>0)){h.next=7;break}return h.abrupt("return",this.advanceLastReadMessageIndex(f.items[0].index));case 7:return h.abrupt("return",Promise.resolve(0));case 8:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"setAllMessagesUnread",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._subscribeStreams();case 2:return g.next=4,this._setLastReadMessageIndex(null);case 4:return g.abrupt("return",g.sent);case 5:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"setUserNotificationLevel",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post","".concat(this.configuration.links.myConversations,"/").concat(this.sid),{notification_level:f});case 2:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"typing",value:function(){return this.services.typingIndicator.send(this.sid)}},{key:"updateAttributes",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.services.commandExecutor.mutateResource("post",this.links.self,{attributes:f!==void 0?JSON.stringify(f):void 0});case 2:return h.abrupt("return",this);case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateFriendlyName",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.channelState.friendlyName===f){h.next=3;break}return h.next=3,this.services.commandExecutor.mutateResource("post",this.links.self,{friendly_name:f});case 3:return h.abrupt("return",this);case 4:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateLastReadMessageIndex",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._subscribeStreams();case 2:return h.abrupt("return",this._setLastReadMessageIndex(f));case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"updateUniqueName",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(this.channelState.uniqueName===f){h.next=4;break}return f||(f=""),h.next=4,this.services.commandExecutor.mutateResource("post",this.links.self,{unique_name:f});case 4:return h.abrupt("return",this);case 5:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}],[{key:"preprocessUpdate",value:function(l,p){try{typeof l.attributes=="string"?l.attributes=JSON.parse(l.attributes):l.attributes&&JSON.stringify(l.attributes)}catch{dr.warn("Retrieved malformed attributes from the server for conversation: "+p),l.attributes={}}try{l.dateCreated&&(l.dateCreated=new Date(l.dateCreated))}catch{dr.warn("Retrieved malformed dateCreated from the server for conversation: "+p),delete l.dateCreated}try{l.dateUpdated&&(l.dateUpdated=new Date(l.dateUpdated))}catch{dr.warn("Retrieved malformed dateUpdated from the server for conversation: "+p),delete l.dateUpdated}try{l.lastMessage&&l.lastMessage.timestamp&&(l.lastMessage.timestamp=new Date(l.lastMessage.timestamp))}catch{dr.warn("Retrieved malformed lastMessage.timestamp from the server for conversation: "+p),delete l.lastMessage.timestamp}}}]),m}(k.ReplayEventEmitter);ne.default(_t,"participantJoined","participantJoined"),ne.default(_t,"participantLeft","participantLeft"),ne.default(_t,"participantUpdated","participantUpdated"),ne.default(_t,"messageAdded","messageAdded"),ne.default(_t,"messageRemoved","messageRemoved"),ne.default(_t,"messageUpdated","messageUpdated"),ne.default(_t,"typingEnded","typingEnded"),ne.default(_t,"typingStarted","typingStarted"),ne.default(_t,"updated","updated"),ne.default(_t,"removed","removed"),Q([w.validateTypesAsync(w.nonEmptyString,je),$("design:type",Function),$("design:paramtypes",[String,Object]),$("design:returntype",Promise)],_t.prototype,"add",null),Q([w.validateTypesAsync(w.nonEmptyString,w.nonEmptyString,je),$("design:type",Function),$("design:paramtypes",[String,String,Object,Object]),$("design:returntype",Promise)],_t.prototype,"addNonChatParticipant",null),Q([w.validateTypesAsync(w.nonNegativeInteger),$("design:type",Function),$("design:paramtypes",[Number]),$("design:returntype",Promise)],_t.prototype,"advanceLastReadMessageIndex",null),Q([w.validateTypesAsync(["undefined",w.nonNegativeInteger],["undefined",w.nonNegativeInteger],["undefined",w.literal("backwards","forward")]),$("design:type",Function),$("design:paramtypes",[Number,Number,String]),$("design:returntype",Promise)],_t.prototype,"getMessages",null),Q([w.validateTypesAsync(w.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],_t.prototype,"getParticipantBySid",null),Q([w.validateTypesAsync(w.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],_t.prototype,"getParticipantByIdentity",null),Q([w.validateTypesAsync([w.nonEmptyString,Y]),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],_t.prototype,"removeParticipant",null),Q([w.validateTypesAsync(["string",w.literal(null),w.custom(function(C){return[C instanceof FormData,"an instance of FormData"]}),w.objectSchema("media options",{contentType:w.nonEmptyString,media:w.custom(function(C){var P=typeof C=="string"&&C.length>0||C instanceof Uint8Array||C instanceof ArrayBuffer;return typeof Blob=="function"&&(P=P||C instanceof Blob),[P,"a non-empty string, an instance of Buffer or an instance of Blob"]})})],je,["undefined",w.literal(null),w.objectSchema("email attributes",{subject:[w.nonEmptyString,"undefined"]})]),$("design:type",Function),$("design:paramtypes",[Object,Object,Object]),$("design:returntype",Promise)],_t.prototype,"sendMessage",null),Q([w.validateTypesAsync(w.literal("default","muted")),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],_t.prototype,"setUserNotificationLevel",null),Q([w.validateTypesAsync(Oe),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],_t.prototype,"updateAttributes",null),Q([w.validateTypesAsync(["string"]),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],_t.prototype,"updateFriendlyName",null),Q([w.validateTypesAsync([w.literal(null),w.nonNegativeInteger]),$("design:type",Function),$("design:paramtypes",[Number]),$("design:returntype",Promise)],_t.prototype,"updateLastReadMessageIndex",null),Q([w.validateTypesAsync(["string",w.literal(null)]),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],_t.prototype,"updateUniqueName",null);var So=function(){function C(){var P=this;be.default(this,C),this._promise=new Promise(function(m,v){P._resolve=m,P._reject=v})}return Se.default(C,[{key:"promise",get:function(){return this._promise}},{key:"update",value:function(m){this._resolve(m)}},{key:"set",value:function(m){this.current=m,this._resolve(m)}},{key:"fail",value:function(m){this._reject(m)}}]),C}();function $o(C,P){var m=typeof Symbol<"u"&&C[Symbol.iterator]||C["@@iterator"];if(!m){if(Array.isArray(C)||(m=ko(C))||P&&C&&typeof C.length=="number"){m&&(C=m);var v=0,l=function(){};return{s:l,n:function(){return v>=C.length?{done:!0}:{done:!1,value:C[v++]}},e:function(b){throw b},f:l}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var p=!0,f=!1,g;return{s:function(){m=m.call(C)},n:function(){var b=m.next();return p=b.done,b},e:function(b){f=!0,g=b},f:function(){try{!p&&m.return!=null&&m.return()}finally{if(f)throw g}}}}function ko(C,P){if(!!C){if(typeof C=="string")return us(C,P);var m=Object.prototype.toString.call(C).slice(8,-1);if(m==="Object"&&C.constructor&&(m=C.constructor.name),m==="Map"||m==="Set")return Array.from(C);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return us(C,P)}}function us(C,P){(P==null||P>C.length)&&(P=C.length);for(var m=0,v=new Array(P);m<P;m++)v[m]=C[m];return v}function Jn(C,P){var m=Object.keys(C);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(C);P&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(C,l).enumerable})),m.push.apply(m,v)}return m}function To(C){for(var P=1;P<arguments.length;P++){var m=arguments[P]!=null?arguments[P]:{};P%2?Jn(Object(m),!0).forEach(function(v){ne.default(C,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(m)):Jn(Object(m)).forEach(function(v){Object.defineProperty(C,v,Object.getOwnPropertyDescriptor(m,v))})}return C}function Eo(C){var P=Kr();return function(){var v=ae.default(C),l;if(P){var p=ae.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return te.default(this,l)}}function Kr(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Sr=re.scope("Conversations"),Io=function(C){oe.default(m,C);var P=Eo(m);function m(v,l){var p;return be.default(this,m),p=P.call(this),ne.default(Ee.default(p),"conversations",new Map),ne.default(Ee.default(p),"myConversationsRead",new So),ne.default(Ee.default(p),"tombstones",new Set),ne.default(Ee.default(p),"myConversationsFetched",!1),p.configuration=v,p.services=l,p}return Se.default(m,[{key:"addConversation",value:function(){var v=F.default(A.default.mark(function p(f){var g,h,b,S,j,D,z,ge,qe,rt;return A.default.wrap(function(ot){for(;;)switch(ot.prev=ot.next){case 0:return S=typeof(f==null?void 0:f.attributes)<"u"?f.attributes:{},ot.next=3,this.services.commandExecutor.mutateResource("post",this.configuration.links.conversations,{friendly_name:f.friendlyName,unique_name:f.uniqueName,attributes:typeof S<"u"?JSON.stringify(S):void 0});case 3:if(j=ot.sent,D=(g=j.sid)!==null&&g!==void 0?g:null,z=(h=(b=j.sync_objects)===null||b===void 0?void 0:b.conversation)!==null&&h!==void 0?h:null,ge=To({self:j.url},j.links),qe=this.conversations.get(D),!qe){ot.next=12;break}return ot.next=11,qe._subscribe();case 11:return ot.abrupt("return",qe);case 12:return rt=new _t({channel:z,entityName:"",uniqueName:"",attributes:null,createdBy:"",friendlyName:"",lastConsumedMessageIndex:0,dateCreated:null,dateUpdated:null},D,ge,this.configuration,this.services),this.conversations.set(rt.sid,rt),this._registerForEvents(rt),ot.next=17,rt._subscribe();case 17:return this.emit("conversationAdded",rt),ot.abrupt("return",rt);case 19:case"end":return ot.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"fetchConversations",value:function(){var v=F.default(A.default.mark(function p(){var f=this,g,h,b,S,j,D,z;return A.default.wrap(function(qe){for(;;)switch(qe.prev=qe.next){case 0:return qe.prev=0,qe.next=3,this._getMap();case 3:return g=qe.sent,g.on("itemAdded",function(rt){Sr.debug("itemAdded: ".concat(rt.item.key)),f._upsertConversation("sync",rt.item.key,rt.item.data)}),g.on("itemRemoved",function(rt){Sr.debug("itemRemoved: ".concat(rt.key));var He=rt.key;f.myConversationsFetched||f.tombstones.add(He);var ot=f.conversations.get(He);!ot||(ot.status==="joined"&&(ot._setStatus("notParticipating","sync"),f.emit("conversationLeft",ot)),f.conversations.delete(He),f.emit("conversationRemoved",ot),ot.emit("removed",ot))}),g.on("itemUpdated",function(rt){Sr.debug("itemUpdated: ".concat(rt.item.key)),f._upsertConversation("sync",rt.item.key,rt.item.data)}),qe.next=9,this._fetchMyConversations();case 9:h=qe.sent,b=[],S=$o(h);try{for(S.s();!(j=S.n()).done;)D=j.value,b.push(this._upsertConversation("rest",D.channel_sid,D))}catch(rt){S.e(rt)}finally{S.f()}return this.myConversationsRead.set(!0),qe.next=16,Promise.all(b);case 16:return this.myConversationsFetched=!0,this.tombstones.clear(),Sr.debug("The conversations list has been successfully fetched"),qe.abrupt("return",this);case 22:throw qe.prev=22,qe.t0=qe.catch(0),z="Failed to fetch the conversations list",this.services.syncClient.connectionState!=="disconnected"&&Sr.error(z,qe.t0),Sr.debug("ERROR: ".concat(z),qe.t0),qe.t0;case 28:case"end":return qe.stop()}},p,this,[[0,22]])}));function l(){return v.apply(this,arguments)}return l}()},{key:"getConversations",value:function(){var v=F.default(A.default.mark(function p(){var f=this,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return S.next=2,this._getMap();case 2:return g=S.sent,S.next=5,g.getItems();case 5:return h=S.sent,S.abrupt("return",this._wrapPaginator(h,function(j){return Promise.all(j.map(function(D){return f._upsertConversation("sync",D.key,D.data)}))}));case 7:case"end":return S.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getConversation",value:function(){var v=F.default(A.default.mark(function p(f){var g=this,h,b,S;return A.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return D.next=2,this._getMap();case 2:return h=D.sent,D.next=5,h.getItems({key:f});case 5:return b=D.sent,S=b.items.map(function(z){return g._upsertConversation("sync",z.key,z.data)}),D.abrupt("return",S.length>0?S[0]:null);case 8:case"end":return D.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getConversationByUniqueName",value:function(){var v=F.default(A.default.mark(function p(f){var g,h,b,S,j;return A.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return g=new Ne(this.configuration.links.myConversations).path(f).build(),z.next=3,this.services.network.get(g);case 3:return h=z.sent,b=h.body,S=b.conversation_sid,j={entityName:null,lastConsumedMessageIndex:b.last_read_message_index,status:(b==null?void 0:b.status)||"unknown",friendlyName:b.friendly_name,dateUpdated:b.date_updated,dateCreated:b.date_created,uniqueName:b.unique_name,createdBy:b.created_by,attributes:b.attributes,channel:b.sync_objects.conversation,notificationLevel:b==null?void 0:b.notification_level,sid:S},z.abrupt("return",S?this._upsertConversation("sync",S,j):null);case 8:case"end":return z.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"peekConversation",value:function(){var v=F.default(A.default.mark(function p(f){var g,h,b,S;return A.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return g=new Ne(this.configuration.links.conversations).path(f).build(),D.next=3,this.services.network.get(g);case 3:return h=D.sent,b=h.body,S={entityName:null,status:(b==null?void 0:b.status)||"unknown",friendlyName:b.friendly_name,dateUpdated:b.date_updated,dateCreated:b.date_created,uniqueName:b.unique_name,createdBy:b.created_by,attributes:b.attributes,channel:"".concat(f,".channel"),sid:f},D.abrupt("return",this._upsertConversation("sync",f,S));case 7:case"end":return D.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"_getMap",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this.services.syncClient.map({id:this.configuration.myConversations,mode:"open_existing"});case 2:return g.abrupt("return",g.sent);case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_wrapPaginator",value:function(){var v=F.default(A.default.mark(function p(f,g){var h=this,b;return A.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,g(f.items);case 2:return b=j.sent,j.abrupt("return",{items:b,hasNextPage:f.hasNextPage,hasPrevPage:f.hasPrevPage,nextPage:function(){return f.nextPage().then(function(z){return h._wrapPaginator(z,g)})},prevPage:function(){return f.prevPage().then(function(z){return h._wrapPaginator(z,g)})}});case 4:case"end":return j.stop()}},p)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"_updateConversation",value:function(){var v=F.default(A.default.mark(function p(f,g,h){var b=this,S,j,D;return A.default.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(S=g._statusSource()!==void 0&&f!==g._statusSource(),j=f!=="rest"||g._statusSource()==="sync",!(S&&j&&f!=="sync")){ge.next=5;break}return Sr.trace("upsertConversation: conversation is known from sync and came from chat, ignoring",{sid:g.sid,data:h.status,conversation:g.status}),ge.abrupt("return");case 5:if(!(h.status==="joined"&&g.status!=="joined")){ge.next=13;break}return g._setStatus("joined",f),D={},typeof h.notificationLevel<"u"&&(D.notificationLevel=h.notificationLevel),typeof h.lastConsumedMessageIndex<"u"&&(D.lastConsumedMessageIndex=h.lastConsumedMessageIndex),We.default(D,{})||g._update(D),g._subscribe().then(function(){b.emit("conversationJoined",g)}),ge.abrupt("return");case 13:if(!(h.status==="notParticipating"&&g.status==="joined")){ge.next=20;break}return g._setStatus("notParticipating",f),g._update(h),ge.next=18,g._subscribe();case 18:return this.emit("conversationLeft",g),ge.abrupt("return");case 20:if(h.status!=="notParticipating"){ge.next=24;break}return ge.next=23,g._subscribe();case 23:return ge.abrupt("return");case 24:g._update(h);case 25:case"end":return ge.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"_upsertConversation",value:function(){var v=F.default(A.default.mark(function p(f,g,h){var b,S,j,D;return A.default.wrap(function(ge){for(;;)switch(ge.prev=ge.next){case 0:if(Sr.trace("upsertConversation called for ".concat(g),h),b=this.conversations.get(g),!b){ge.next=9;break}return Sr.trace("upsertConversation: the conversation ".concat(b.sid," is known;")+"its status is known from the source ".concat(b._statusSource()," ")+"and the update came from the source ".concat(f),b),ge.next=6,this._updateConversation(f,b,h);case 6:return ge.next=8,b._subscribe();case 8:return ge.abrupt("return",b);case 9:if(!(["chat","rest"].includes(f)&&this.tombstones.has(g))){ge.next=12;break}return Sr.trace("upsertChannel: the channel is deleted but reappeared again from chat, ignoring",g),ge.abrupt("return",null);case 12:return Sr.trace("upsertConversation: creating a local conversation object with sid "+g,h),S="".concat(this.configuration.links.conversations,"/").concat(g),j={self:S,messages:"".concat(S,"/Messages"),participants:"".concat(S,"/Participants")},D=new _t(h,g,j,this.configuration,this.services),this.conversations.set(g,D),ge.next=19,D._subscribe();case 19:return this._registerForEvents(D),this.emit("conversationAdded",D),h.status==="joined"&&(D._setStatus("joined",f),this.emit("conversationJoined",D)),ge.abrupt("return",D);case 23:case"end":return ge.stop()}},p,this)}));function l(p,f,g){return v.apply(this,arguments)}return l}()},{key:"_fetchMyConversations",value:function(){var v=F.default(A.default.mark(function p(){var f,g,h,b,S,j;return A.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:f=[],g=null;case 2:return b=new Ne(this.configuration.links.myConversations),g&&b.arg("PageToken",g),z.next=6,this.services.network.get(b.build());case 6:S=z.sent,j=(h=S.body)===null||h===void 0?void 0:h.conversations.map(function(ge){return{descriptor:ge,channel_sid:ge.conversation_sid,status:ge.status,channel:ge.sync_objects.conversation,messages:ge.sync_objects.messages,roster:"".concat(ge.conversation_sid,".roster"),lastConsumedMessageIndex:ge.last_read_message_index,notificationLevel:ge.notification_level}}),g=S.body.meta.next_token,f=[].concat(V.default(f),V.default(j));case 10:if(g){z.next=2;break}case 11:return z.abrupt("return",f);case 12:case"end":return z.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"_onConversationRemoved",value:function(l){var p=this.conversations.get(l);p&&(this.conversations.delete(l),this.emit("conversationRemoved",p))}},{key:"_registerForEvents",value:function(l){var p=this;l.on("removed",function(){return p._onConversationRemoved(l.sid)}),l.on("updated",function(f){return p.emit("conversationUpdated",f)}),l.on("participantJoined",function(f){return p.emit("participantJoined",f)}),l.on("participantLeft",function(f){return p.emit("participantLeft",f)}),l.on("participantUpdated",function(f){return p.emit("participantUpdated",f)}),l.on("messageAdded",function(f){return p.emit("messageAdded",f)}),l.on("messageUpdated",function(f){return p.emit("messageUpdated",f)}),l.on("messageRemoved",function(f){return p.emit("messageRemoved",f)}),l.on("typingStarted",function(f){return p.emit("typingStarted",f)}),l.on("typingEnded",function(f){return p.emit("typingEnded",f)})}}]),m}(k.ReplayEventEmitter);function Co(C){var P=Ro();return function(){var v=ae.default(C),l;if(P){var p=ae.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return te.default(this,l)}}function Ro(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Oo=function(C){oe.default(m,C);var P=Co(m);function m(v,l,p){var f;return be.default(this,m),f=P.call(this),f.configuration=l,f.services=p,f.fifoStack=[],f.myself=v,f.myself.on("updated",function(g){return f.emit("userUpdated",g)}),f.myself.on("userSubscribed",function(){return f.emit("userSubscribed",f.myself)}),f.myself.on("userUnsubscribed",function(){f.emit("userUnsubscribed",f.myself),f.myself._ensureFetched()}),f.subscribedUsers=new Map,f}return Se.default(m,[{key:"handleUnsubscribeUser",value:function(l){this.subscribedUsers.has(l.identity)&&this.subscribedUsers.delete(l.identity);var p=0,f=this.fifoStack.find(function(g,h){return g==l.identity?(p=h,!0):!1});f&&this.fifoStack.splice(p,1),this.emit("userUnsubscribed",l)}},{key:"handleSubscribeUser",value:function(l){if(!this.subscribedUsers.has(l.identity)){if(this.fifoStack.length>=this.configuration.userInfosToSubscribe){var p,f,g=this.fifoStack.shift();(p=this.subscribedUsers)===null||p===void 0||(f=p.get(g))===null||f===void 0||f.unsubscribe()}this.fifoStack.push(l.identity),this.subscribedUsers.set(l.identity,l),this.emit("userSubscribed",l)}}},{key:"getUser",value:function(){var v=F.default(A.default.mark(function p(){var f=this,g,h,b,S,j=arguments;return A.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:return g=j.length>0&&j[0]!==void 0?j[0]:"",h=j.length>1&&j[1]!==void 0?j[1]:"",z.next=4,this.myself._ensureFetched();case 4:if(g!=this.myself.identity){z.next=6;break}return z.abrupt("return",this.myself);case 6:if(b=this.subscribedUsers.get(g),!b){z.next=9;break}return z.abrupt("return",b);case 9:if(z.t0=h,z.t0){z.next=14;break}return z.next=13,this.getSyncUniqueName(g);case 13:z.t0=z.sent;case 14:return h=z.t0,S=new Xe(g,h,this.configuration,this.services),S.on("updated",function(ge){return f.emit("userUpdated",ge)}),S.on("userSubscribed",function(){return f.handleSubscribeUser(S)}),S.on("userUnsubscribed",function(){return f.handleUnsubscribeUser(S)}),z.next=21,S._ensureFetched();case 21:return z.abrupt("return",S);case 22:case"end":return z.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getSubscribedUsers",value:function(){var v=F.default(A.default.mark(function p(){var f;return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this.myself._ensureFetched();case 2:return f=[this.myself],this.subscribedUsers.forEach(function(b){return f.push(b)}),h.abrupt("return",f);case 5:case"end":return h.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"getSyncUniqueName",value:function(){var v=F.default(A.default.mark(function p(f){var g,h,b,S;return A.default.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return b=new Ne(this.configuration.links.users).path(f).build(),D.next=3,this.services.network.get(b);case 3:return S=D.sent,D.abrupt("return",(g=(h=S.body)===null||h===void 0?void 0:h.sync_objects.user_info_map)!==null&&g!==void 0?g:"");case 5:case"end":return D.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()}]),m}(k.ReplayEventEmitter),ki=re.scope("TypingIndicator"),Ti=function(){function C(P,m,v){be.default(this,C),this.configuration=m,this.services=v,this.getConversation=P,this.serviceTypingTimeout=null,this.sentUpdates=new Map}return Se.default(C,[{key:"typingTimeout",get:function(){return this.configuration.typingIndicatorTimeoutOverride||this.serviceTypingTimeout||this.configuration.typingIndicatorTimeoutDefault}},{key:"initialize",value:function(){var m=this;this.services.notificationClient.on("message",function(){var v=F.default(A.default.mark(function l(p,f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:if(p!==mt.TYPING_INDICATOR){h.next=3;break}return h.next=3,m._handleRemoteTyping(f);case 3:case"end":return h.stop()}},l)}));return function(l,p){return v.apply(this,arguments)}}())}},{key:"_handleRemoteTyping",value:function(){var P=F.default(A.default.mark(function v(l){var p=this;return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:ki.trace("Got new typing indicator ",l),this.getConversation(l.channel_sid).then(function(h){!h||h.participants.forEach(function(b){if(b.identity===l.identity){var S=p.configuration.typingIndicatorTimeoutOverride?p.configuration.typingIndicatorTimeoutOverride+1e3:l.typing_timeout*1e3;b._startTyping(S)}})}).catch(function(h){throw ki.error(h),h});case 2:case"end":return g.stop()}},v,this)}));function m(v){return P.apply(this,arguments)}return m}()},{key:"send",value:function(m){var v=this.sentUpdates.get(m);return v&&v>Date.now()-this.typingTimeout?Promise.resolve():(this.sentUpdates.set(m,Date.now()),this._send(m))}},{key:"_send",value:function(m){var v=this;ki.trace("Sending typing indicator");var l=this.configuration.links.typing,p={"Content-Type":"application/x-www-form-urlencoded"},f="ChannelSid=".concat(m);return this.services.twilsockClient.post(l,p,f,this.configuration.productId).then(function(g){g.body.hasOwnProperty("typing_timeout")&&(v.serviceTypingTimeout=g.body.typing_timeout*1e3)}).catch(function(g){throw ki.error("Failed to send typing indicator:",g),g})}}]),C}(),Ei=function C(P){be.default(this,C),this.title=P.title||null,this.body=P.body||null,this.sound=P.sound||null,this.badge=P.badge||null,this.action=P.action||null,this.type=P.type||null,this.data=P.data||{}},vn="2.1.0";function va(C,P){var m=Object.keys(C);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(C);P&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(C,l).enumerable})),m.push.apply(m,v)}return m}function ls(C){for(var P=1;P<arguments.length;P++){var m=arguments[P]!=null?arguments[P]:{};P%2?va(Object(m),!0).forEach(function(v){ne.default(C,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(m)):va(Object(m)).forEach(function(v){Object.defineProperty(C,v,Object.getOwnPropertyDescriptor(m,v))})}return C}var cs=function(P){return P.replace(/(^\/+|\/+$)/g,"")},Ao=function(P){return P.status.code===202},Po=function(){function C(P,m,v){be.default(this,C),this._serviceUrl=P,this._services=m,this._productId=v}return Se.default(C,[{key:"_preProcessUrl",value:function(m){var v=cs(m);return/^https?:\/\//.test(m)?v:"".concat(cs(this._serviceUrl),"/").concat(v)}},{key:"_makeRequest",value:function(){var P=F.default(A.default.mark(function v(l,p,f,g){var h,b,S,j;return A.default.wrap(function(z){for(;;)switch(z.prev=z.next){case 0:h=this._preProcessUrl(p),b=ls({"Content-Type":"application/json; charset=utf-8"},g||{}),z.t0=l,z.next=z.t0==="get"?5:z.t0==="post"?11:z.t0==="delete"?15:19;break;case 5:return j=h,f&&(j+="?"+Object.entries(f).map(function(ge){return ge.map(encodeURIComponent).join("=")}).join("&")),z.next=9,this._services.transport.get(j,b,this._productId);case 9:return S=z.sent,z.abrupt("break",19);case 11:return z.next=13,this._services.transport.post(h,b,JSON.stringify(f),this._productId);case 13:return S=z.sent,z.abrupt("break",19);case 15:return z.next=17,this._services.transport.delete(h,b,{},this._productId);case 17:return S=z.sent,z.abrupt("break",19);case 19:if(!(S.status.code<200||S.status.code>=300)){z.next=21;break}throw new Error("Request responded with a non-success code ".concat(S.status.code));case 21:return z.abrupt("return",S);case 22:case"end":return z.stop()}},v,this)}));function m(v,l,p,f){return P.apply(this,arguments)}return m}()},{key:"fetchResource",value:function(){var P=F.default(A.default.mark(function v(l,p){var f=this,g,h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:return g=6,S.prev=1,S.next=4,new L.AsyncRetrier({min:50,max:1600,maxAttemptsCount:g}).run(function(){return f._makeRequest("get",l,p)});case 4:return h=S.sent,S.abrupt("return",h.body);case 8:throw S.prev=8,S.t0=S.catch(1),new Error('Fetch resource from "'.concat(l,'" failed.'));case 11:case"end":return S.stop()}},v,null,[[1,8]])}));function m(v,l){return P.apply(this,arguments)}return m}()},{key:"mutateResource",value:function(){var P=F.default(A.default.mark(function v(l,p,f){var g;return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this._makeRequest(l,p,f,{"X-Twilio-Mutation-Id":Ae.v4()});case 2:if(g=b.sent,!Ao(g)){b.next=7;break}return b.next=6,this.fetchResource(g.body.resource_url);case 6:return b.abrupt("return",b.sent);case 7:return b.abrupt("return",g.body);case 8:case"end":return b.stop()}},v,this)}));function m(v,l,p){return P.apply(this,arguments)}return m}()}]),C}(),St,ga;function fs(C,P){var m=Object.keys(C);if(Object.getOwnPropertySymbols){var v=Object.getOwnPropertySymbols(C);P&&(v=v.filter(function(l){return Object.getOwnPropertyDescriptor(C,l).enumerable})),m.push.apply(m,v)}return m}function Ii(C){for(var P=1;P<arguments.length;P++){var m=arguments[P]!=null?arguments[P]:{};P%2?fs(Object(m),!0).forEach(function(v){ne.default(C,v,m[v])}):Object.getOwnPropertyDescriptors?Object.defineProperties(C,Object.getOwnPropertyDescriptors(m)):fs(Object(m)).forEach(function(v){Object.defineProperty(C,v,Object.getOwnPropertyDescriptor(m,v))})}return C}function ya(C){var P=Yn();return function(){var v=ae.default(C),l;if(P){var p=ae.default(this).constructor;l=Reflect.construct(v,arguments,p)}else l=v.apply(this,arguments);return te.default(this,l)}}function Yn(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var Rt,Jr=re.scope("Client"),ma=vn,Yr=function C(){be.default(this,C)};e.Client=Rt=(ga=St=function(C){oe.default(m,C);var P=ya(m);function m(v){var l,p,f,g,h,b,S=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(be.default(this,m),b=P.call(this),ne.default(Ee.default(b),"connectionState","unknown"),ne.default(Ee.default(b),"version",ma),ne.default(Ee.default(b),"parsePushNotification",Rt.parsePushNotification),b.fpaToken=v!=null?v:"",b.options=S!=null?S:{},!b.options.disableDeepClone){var j=Ii(Ii({},b.options),{},{transport:void 0,twilsockClient:void 0});j=W(j),j.transport=b.options.transport,j.twilsockClient=b.options.twilsockClient,b.options=j}b.options.logLevel=(l=b.options.logLevel)!==null&&l!==void 0?l:"silent",Jr.setLevel(b.options.logLevel);var D=b.options.productId="ip_messaging";if(b.options.clientMetadata=b.options.clientMetadata||{},b.options.clientMetadata.hasOwnProperty("type")||(b.options.clientMetadata.type="conversations"),b.options.clientMetadata.hasOwnProperty("sdk")||(b.options.clientMetadata.sdk="JS",b.options.clientMetadata.sdkv=ma),b.options.Sync=b.options.Sync||{},typeof b.options.Sync.enableSessionStorage>"u"&&(b.options.Sync.enableSessionStorage=!0),b.options.region&&(b.options.Sync.region=b.options.region),!v)throw new Error("A valid Twilio token should be provided");b.services=new Yr,b._myself=new Xe("","",null,b.services);var z=!b.options.twilsockClient;if(!b.options.initRegistrations){var ge=new B.InitRegistration(D);Rt.populateInitRegistrations(ge),b.options.initRegistrations=[ge]}b.services.twilsockClient=b.options.twilsockClient=(p=b.options.twilsockClient)!==null&&p!==void 0?p:new B.TwilsockClient(v,D,b.options),b.services.twilsockClient.on("tokenAboutToExpire",function(Or){return b.emit("tokenAboutToExpire",Or)}),b.services.twilsockClient.on("tokenExpired",function(){return b.emit("tokenExpired")}),b.services.twilsockClient.on("connectionError",function(Or){return b.emit("connectionError",Or)}),b.services.twilsockClient.on("stateChanged",function(Or){Jr.debug("Handling stateChanged for ConversationsClient: new state ".concat(Or)),Or!==b.connectionState&&(b.connectionState=Or,b.emit("connectionStateChanged",b.connectionState))}),b.services.transport=b.options.transport=(f=b.options.transport)!==null&&f!==void 0?f:b.options.twilsockClient,b.services.notificationClient=b.options.notificationsClient=(g=b.options.notificationsClient)!==null&&g!==void 0?g:new ve.Notifications(v,b.options),b.services.syncClient=b.options.syncClient=(h=b.options.syncClient)!==null&&h!==void 0?h:new ue.SyncClient(v,b.options);var qe=(S==null?void 0:S.Chat)||(S==null?void 0:S.IPMessaging)||S||{},rt=qe.region||(S==null?void 0:S.region),He=qe.apiUri||qe.typingUri||"https://aim.".concat(rt||"us1",".twilio.com");b.services.commandExecutor=new Po(He,{transport:b.options.transport},D);var ot=function(O){b._rejectEnsureReady(O),b.emit("stateChanged","failed")};return b.services.twilsockClient.once("connectionError",ot),b.services.twilsockClient.once("disconnected",ot),b.services.twilsockClient.once("connected",F.default(A.default.mark(function Or(){var O;return A.default.wrap(function(he){for(;;)switch(he.prev=he.next){case 0:return Jr.debug("ConversationsClient started INITIALIZING"),b.services.twilsockClient.off("connectionError",ot),b.services.twilsockClient.off("disconnected",ot),he.prev=3,O="conversations.client.startup",b.services.twilsockClient.addPartialTelemetryEvent(new B.TelemetryEventDescription(O,"Conversations client startup",new Date),O,B.TelemetryPoint.Start),he.next=8,b._initialize();case 8:b.services.twilsockClient.addPartialTelemetryEvent(new B.TelemetryEventDescription("","",new Date),O,B.TelemetryPoint.End),he.next=15;break;case 11:he.prev=11,he.t0=he.catch(3),b._rejectEnsureReady(he.t0),b.emit("stateChanged","failed");case 15:case"end":return he.stop()}},Or,null,[[3,11]])}))),b._ensureReady=new Promise(function(Or,O){b._resolveEnsureReady=Or,b._rejectEnsureReady=O}).catch(function(){}),z&&b.services.twilsockClient.connect(),b}return Se.default(m,[{key:"user",get:function(){return this._myself}},{key:"reachabilityEnabled",get:function(){if(!this.configuration)throw new Error("Reachability information could not yet be accessed as the client has not yet been initialized. Subscribe to the 'stateChanged' event to properly react to the client initialization.");return this.configuration.reachabilityEnabled}},{key:"token",get:function(){return this.fpaToken}},{key:"_subscribeToPushNotifications",value:function(l){var p=this;[mt.NEW_MESSAGE,mt.ADDED_TO_CONVERSATION,mt.REMOVED_FROM_CONVERSATION,mt.TYPING_INDICATOR,mt.CONSUMPTION_UPDATE].forEach(function(f){p.services.notificationClient.subscribe(l,f)})}},{key:"_unsubscribeFromPushNotifications",value:function(l){var p=this;[mt.NEW_MESSAGE,mt.ADDED_TO_CONVERSATION,mt.REMOVED_FROM_CONVERSATION,mt.TYPING_INDICATOR,mt.CONSUMPTION_UPDATE].forEach(function(f){p.services.notificationClient.unsubscribe(l,f)})}},{key:"_initialize",value:function(){var v=F.default(A.default.mark(function p(){var f=this,g;return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.services.commandExecutor.fetchResource("Client/v2/Configuration");case 2:return g=b.sent,this.configuration=new J(this.options,g,Jr),this._myself._resolveInitialization(this.configuration,this.configuration.userIdentity,this.configuration.userInfo,!0),this.services.typingIndicator=new Ti(this.getConversationBySid.bind(this),this.configuration,this.services),this.services.network=new Cr(this.configuration,this.services),this.services.users=new Oo(this._myself,this.configuration,this.services),this.services.users.on("userSubscribed",function(S){f.emit("userSubscribed",S)}),this.services.users.on("userUpdated",function(S){return f.emit("userUpdated",S)}),this.services.users.on("userUnsubscribed",function(S){f.emit("userUnsubscribed",S)}),this.conversations=new Io(this.configuration,this.services),this.conversations.on("conversationAdded",function(S){f.emit("conversationAdded",S)}),this.conversations.on("conversationRemoved",function(S){f.emit("conversationRemoved",S)}),this.conversations.on("conversationJoined",function(S){f.emit("conversationJoined",S)}),this.conversations.on("conversationLeft",function(S){f.emit("conversationLeft",S)}),this.conversations.on("conversationUpdated",function(S){return f.emit("conversationUpdated",S)}),this.conversations.on("participantJoined",function(S){f.emit("participantJoined",S)}),this.conversations.on("participantLeft",function(S){f.emit("participantLeft",S)}),this.conversations.on("participantUpdated",function(S){return f.emit("participantUpdated",S)}),this.conversations.on("messageAdded",function(S){return f.emit("messageAdded",S)}),this.conversations.on("messageUpdated",function(S){return f.emit("messageUpdated",S)}),this.conversations.on("messageRemoved",function(S){return f.emit("messageRemoved",S)}),this.conversations.on("typingStarted",function(S){return f.emit("typingStarted",S)}),this.conversations.on("typingEnded",function(S){return f.emit("typingEnded",S)}),this.conversationsPromise=this.conversations.fetchConversations().then(function(){return f.conversations}).catch(function(S){throw S}),b.next=28,this.services.users.myself._ensureFetched();case 28:Rt.supportedPushChannels.forEach(function(S){return f._subscribeToPushNotifications(S)}),this.services.typingIndicator.initialize(),this.services.mcsClient=new Me.McsClient(this.fpaToken,this.configuration.links.mediaService,this.configuration.links.mediaSetService,Ii(Ii({},this.options),{},{transport:void 0})),this._resolveEnsureReady(),this.emit("stateChanged","initialized");case 33:case"end":return b.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"shutdown",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._ensureReady;case 2:return g.next=4,this.services.twilsockClient.disconnect();case 4:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"updateToken",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:if(Jr.info("updateToken"),this.fpaToken!==f){h.next=5;break}return h.abrupt("return",this);case 5:return h.next=7,this.services.twilsockClient.updateToken(f);case 7:return h.next=9,this.services.notificationClient.updateToken(f);case 9:return h.next=11,this.services.mcsClient.updateToken(f);case 11:return this.fpaToken=f,h.abrupt("return",this);case 13:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getConversationBySid",value:function(){var v=F.default(A.default.mark(function p(f){var g;return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this._ensureReady;case 2:return b.next=4,this.conversations.myConversationsRead.promise;case 4:return b.next=6,this.conversations.getConversation(f);case 6:if(g=b.sent,g){b.next=11;break}return b.next=10,this.conversations.peekConversation(f);case 10:g=b.sent;case 11:if(g){b.next=13;break}throw new Error("Conversation with SID ".concat(f," is not found."));case 13:return b.abrupt("return",g);case 14:case"end":return b.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getConversationByUniqueName",value:function(){var v=F.default(A.default.mark(function p(f){var g;return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this._ensureReady;case 2:return b.next=4,this.conversations.myConversationsRead.promise;case 4:return b.next=6,this.conversations.getConversationByUniqueName(f);case 6:if(g=b.sent,g){b.next=9;break}throw new Error("Conversation with unique name ".concat(f," is not found."));case 9:return b.abrupt("return",g);case 10:case"end":return b.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getSubscribedConversations",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._ensureReady;case 2:return g.abrupt("return",this.conversationsPromise.then(function(h){return h.getConversations()}));case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()},{key:"createConversation",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:return f=f||{},h.abrupt("return",this.conversationsPromise.then(function(b){return b.addConversation(f)}));case 4:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"setPushRegistrationId",value:function(){var v=F.default(A.default.mark(function p(f,g){return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this._ensureReady;case 2:return this._subscribeToPushNotifications(f),this.services.notificationClient.setPushRegistrationId(f,g),b.next=6,this.services.notificationClient.commitChanges();case 6:case"end":return b.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"unsetPushRegistrationId",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:return this._unsubscribeFromPushNotifications(f),h.next=5,this.services.notificationClient.commitChanges();case 5:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"removePushRegistrations",value:function(){var v=F.default(A.default.mark(function p(f,g){return A.default.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return b.next=2,this.services.notificationClient.removeRegistrations(f,g);case 2:case"end":return b.stop()}},p,this)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"handlePushNotification",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:Jr.debug("handlePushNotification, notificationPayload=",f),this.emit("pushNotification",Rt.parsePushNotification(f));case 4:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getUser",value:function(){var v=F.default(A.default.mark(function p(f){return A.default.wrap(function(h){for(;;)switch(h.prev=h.next){case 0:return h.next=2,this._ensureReady;case 2:return h.abrupt("return",this.services.users.getUser(f));case 3:case"end":return h.stop()}},p,this)}));function l(p){return v.apply(this,arguments)}return l}()},{key:"getSubscribedUsers",value:function(){var v=F.default(A.default.mark(function p(){return A.default.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return g.next=2,this._ensureReady;case 2:return g.abrupt("return",this.services.users.getSubscribedUsers());case 3:case"end":return g.stop()}},p,this)}));function l(){return v.apply(this,arguments)}return l}()}],[{key:"populateInitRegistrations",value:function(l){l.populateInitRegistrations([mt.TYPING_INDICATOR]),ue.SyncClient.populateInitRegistrations(l)}},{key:"create",value:function(){var v=F.default(A.default.mark(function p(f,g){var h;return A.default.wrap(function(S){for(;;)switch(S.prev=S.next){case 0:if(!(g!=null&&g.twilsockClient)){S.next=2;break}throw new Error("Obsolete usage of ConversationsClient.create() factory method: if you pass twilsock from the outside then you must use ConversationsClient constructor and be prepared to work with uninitialized client.");case 2:return h=new Rt(f,g),S.next=5,h._ensureReady;case 5:return S.abrupt("return",h);case 6:case"end":return S.stop()}},p)}));function l(p,f){return v.apply(this,arguments)}return l}()},{key:"parsePushNotificationChatData",value:function(l){var p={};for(var f in Rt.supportedPushDataFields)if(!(typeof l[f]>"u"||l[f]===null)){if(f!=="message_index"){p[Rt.supportedPushDataFields[f]]=l[f];continue}pe(l[f])!==null&&(p[Rt.supportedPushDataFields[f]]=Number(l[f]))}return p}},{key:"parsePushNotification",value:function(l){if(Jr.debug("parsePushNotification, notificationPayload=",l),typeof l.aps<"u"){if(!l.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var p=Rt.parsePushNotificationChatData(l),f=l.aps,g,h=null;return typeof f.alert=="string"?g=f.alert||null:(g=f.alert.body||null,h=f.alert.title||null),new Ei({title:h,body:g,sound:f.sound||null,badge:f.badge||null,action:f.category||null,type:l.twi_message_type,data:p})}if(typeof l.data<"u"){var b=l.data;if(!b.twi_message_type)throw new Error("Provided push notification payload does not contain Programmable Chat push notification type");var S=Rt.parsePushNotificationChatData(l.data);return new Ei({title:b.twi_title||null,body:b.twi_body||null,sound:b.twi_sound||null,badge:null,action:b.twi_action||null,type:b.twi_message_type,data:S})}throw new Error("Provided push notification payload is not Programmable Chat notification")}}]),m}(k.ReplayEventEmitter),ne.default(St,"version",ma),ne.default(St,"supportedPushChannels",["fcm","apn"]),ne.default(St,"supportedPushDataFields",{conversation_sid:"conversationSid",message_sid:"messageSid",message_index:"messageIndex"}),ne.default(St,"conversationAdded","conversationAdded"),ne.default(St,"conversationJoined","conversationJoined"),ne.default(St,"conversationLeft","conversationLeft"),ne.default(St,"conversationRemoved","conversationRemoved"),ne.default(St,"conversationUpdated","conversationUpdated"),ne.default(St,"participantJoined","participantJoined"),ne.default(St,"participantLeft","participantLeft"),ne.default(St,"participantUpdated","participantUpdated"),ne.default(St,"messageAdded","messageAdded"),ne.default(St,"messageRemoved","messageRemoved"),ne.default(St,"messageUpdated","messageUpdated"),ne.default(St,"tokenAboutToExpire","tokenAboutToExpire"),ne.default(St,"tokenExpired","tokenExpired"),ne.default(St,"typingEnded","typingEnded"),ne.default(St,"typingStarted","typingStarted"),ne.default(St,"pushNotification","pushNotification"),ne.default(St,"userSubscribed","userSubscribed"),ne.default(St,"userUnsubscribed","userUnsubscribed"),ne.default(St,"userUpdated","userUpdated"),ne.default(St,"stateChanged","stateChanged"),ne.default(St,"connectionStateChanged","connectionStateChanged"),ne.default(St,"connectionError","connectionError"),ga),Q([w.validateTypesAsync(w.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],e.Client.prototype,"updateToken",null),Q([w.validateTypesAsync(w.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],e.Client.prototype,"getConversationBySid",null),Q([w.validateTypesAsync(w.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],e.Client.prototype,"getConversationByUniqueName",null),Q([w.validateTypesAsync(["undefined",w.objectSchema("conversation options",{friendlyName:["string","undefined"],isPrivate:["boolean","undefined"],uniqueName:["string","undefined"]})]),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],e.Client.prototype,"createConversation",null),Q([w.validateTypesAsync(w.literal("fcm","apn"),"string"),$("design:type",Function),$("design:paramtypes",[String,String]),$("design:returntype",Promise)],e.Client.prototype,"setPushRegistrationId",null),Q([w.validateTypesAsync(w.literal("fcm","apn")),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],e.Client.prototype,"unsetPushRegistrationId",null),Q([w.validateTypesAsync(w.literal("fcm","apn"),w.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String,String]),$("design:returntype",Promise)],e.Client.prototype,"removePushRegistrations",null),Q([w.validateTypesAsync(w.pureObject),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Promise)],e.Client.prototype,"handlePushNotification",null),Q([w.validateTypesAsync(w.nonEmptyString),$("design:type",Function),$("design:paramtypes",[String]),$("design:returntype",Promise)],e.Client.prototype,"getUser",null),Q([w.validateTypesAsync("string",["undefined",w.pureObject]),$("design:type",Function),$("design:paramtypes",[String,Object]),$("design:returntype",Promise)],e.Client,"create",null),Q([w.validateTypes(w.pureObject),$("design:type",Function),$("design:paramtypes",[Object]),$("design:returntype",Ei)],e.Client,"parsePushNotification",null),e.Client=Rt=Q([w.validateConstructorTypes(w.nonEmptyString,[w.pureObject,"undefined"]),$("design:paramtypes",[String,Object])],e.Client),e.AggregatedDeliveryReceipt=Ye,e.Conversation=_t,e.DetailedDeliveryReceipt=Ze,e.Media=Pe,e.Message=qt,e.MessageBuilder=ha,e.NotificationTypes=mt,e.Participant=Y,e.PushNotification=Ei,e.RestPaginator=st,e.UnsentMessage=Rr,e.User=Xe})(V$);const aY={props:["author","content","dateCreated","cSid","participant","mSid","pSid","media"],setup(e){const t=e.author,r=e.content,n=e.media,i=e.dateCreated,a=e.cSid,s=e.mSid,u=e.pSid,o=e.participant,c=nt("/placeholder.png"),d=Jt(()=>!!(o!=null&&o.agent!=null&&!o.agent&&(t.startsWith("+")||t.startsWith("whatsapp")||t.startsWith("EndUser:")))),y=Jt(()=>!!(o!=null&&o.chat!=null&&o.chat||t.startsWith("EndUser:"))),_=Jt(()=>t===a),w=Jt(()=>!!(o!=null&&o.agent!=null&&o.agent)),k=Jt(()=>!!(o!=null&&o.sms!=null&&o.sms||t.startsWith("+"))),N=Jt(()=>!!(o!=null&&o.whatsapp!=null&&o.whatsapp||t.startsWith("whatsapp"))),M=Jt(()=>r===null&&n!==null),L=async B=>{try{let ve=`/conversations/conversation-message-media-url?mediaSid=${B}`;const ue=await fetch(ve,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(ue.ok){let Me=await ue.json();console.log("getMediaUrl response ==> ",Me),c.value=Me.contentUrl}}catch(ve){console.log("getMediaUrl error => ",ve)}};return cv(()=>{console.log("In Message Component..."),console.log("Media => ",n)}),oo(async()=>{if(r===null&&n!==null){let B=null,ve=yt(n);ve[0]!==void 0?B=ve[0].sid:ve.state!==void 0&&(B=ve.state.sid),B!=null&&await L(B)}}),{author:t,content:r,dateCreated:i,isSms:k,isChat:y,isCustomer:d,isBot:_,isWhatsapp:N,isAgent:w,mSid:s,pSid:u,isMedia:M,participant:o,imageUrl:c,formatDate:H$,formatAuthor:G$}}},sY={key:0,class:"bi-phone"},oY={key:1,class:"bi-person-workspace"},uY={key:2,class:"bi-phone"},lY={key:3,class:"bi-robot"},cY={key:4,class:"ms-2"},fY={key:5},dY=["src"],pY={class:"mt-1"},hY={class:"fst-italic"};function vY(e,t,r,n,i,a){return Ge(),it("div",null,[U("div",{class:hu(["bg-info text-start mb-2",{"text-start":n.isCustomer,"text-end":!n.isCustomer}])},[U("span",{class:hu(["fs-4 fw-bold badge text-wrap",{"text-start":n.isCustomer,"text-end":!n.isCustomer,"bg-light":n.isCustomer,"text-dark":n.isCustomer,"bg-success":n.isAgent,"bg-secondary":n.isBot}])},[n.isSms?(Ge(),it("i",sY)):cr("",!0),n.isChat?(Ge(),it("i",oY)):cr("",!0),n.isWhatsapp?(Ge(),it("i",uY)):cr("",!0),n.isBot?(Ge(),it("i",lY)):cr("",!0),n.isMedia?cr("",!0):(Ge(),it("span",cY,Ht(n.content),1)),n.isMedia?(Ge(),it("span",fY,[U("img",{src:n.imageUrl,style:{"max-height":"300px","max-width":"300px"},class:"ms-2 img-fluid rounded"},null,8,dY)])):cr("",!0)],2),U("p",pY,[U("small",null,[U("span",hY,Ht(n.author)+" - "+Ht(n.formatDate(n.dateCreated)),1)])])],2)])}const gY=hi(aY,[["render",vY]]),yY={class:"container"},mY={class:"row row-height mt-2"},bY={class:"col-3"},wY={class:"alert alert-primary"},_Y=U("i",{class:"bi-pencil"},null,-1),SY=[_Y],$Y={class:"input-group"},kY=U("i",{class:"bi-pencil"},null,-1),TY=[kY],EY={key:1,class:"alert-heading"},IY=U("span",{class:"fst-italic"},"no name...",-1),CY=[IY],RY={key:0},OY={class:"alert alert-info text-center"},AY=U("h5",{class:"alert-heading"},"Not in Conversation",-1),PY=U("p",null,"You are not a participant in this conversation",-1),MY=U("hr",null,null,-1),NY=U("i",{class:"bi-person-plus"},null,-1),xY=tt(" Join"),LY=[NY,xY],jY={class:"list-group mb-3"},UY=U("li",{class:"list-group-item list-group-item-secondary"},[tt("Chat Agents "),U("i",{class:"bi-people"})],-1),DY=["onClick"],FY=U("i",{class:"bi-trash"},null,-1),BY=[FY],qY={class:"list-group-item"},WY=U("i",{class:"bi-person-plus"},null,-1),HY=[WY],GY={class:"input-group"},VY=["value"],zY=U("i",{class:"bi-person-plus"},null,-1),KY=tt(" Add"),JY=[zY,KY],YY={class:"list-group mb-3"},QY=U("li",{class:"list-group-item list-group-item-secondary"},[tt("Agent SMS "),U("i",{class:"bi-phone"})],-1),XY=["onClick"],ZY=U("i",{class:"bi-trash"},null,-1),eQ=[ZY],tQ={class:"list-group-item"},rQ=U("i",{class:"bi-phone"},null,-1),nQ=[rQ],iQ={class:"input-group"},aQ=U("i",{class:"bi-phone"},null,-1),sQ=tt(" Add"),oQ=[aQ,sQ],uQ={class:"list-group mb-3"},lQ=U("li",{class:"list-group-item list-group-item-success"},[tt("End User Chat "),U("i",{class:"bi-person-workspace"})],-1),cQ=["onClick"],fQ=U("i",{class:"bi-trash"},null,-1),dQ=[fQ],pQ={class:"list-group mb-3"},hQ=U("li",{class:"list-group-item list-group-item-success"},[tt("End User SMS "),U("i",{class:"bi-phone"})],-1),vQ=["onClick"],gQ=U("i",{class:"bi-trash"},null,-1),yQ=[gQ],mQ={class:"list-group-item"},bQ=U("i",{class:"bi-phone"},null,-1),wQ=[bQ],_Q={class:"input-group"},SQ=U("i",{class:"bi-phone"},null,-1),$Q=tt(" Add"),kQ=[SQ,$Q],TQ={class:"list-group mb-3"},EQ=U("li",{class:"list-group-item list-group-item-success"},[tt("End User WhatsApp "),U("i",{class:"bi-whatsapp"})],-1),IQ={class:"list-group-item"},CQ=U("i",{class:"bi-whatsapp"},null,-1),RQ=[CQ],OQ={class:"input-group"},AQ=U("i",{class:"bi-whatsapp"},null,-1),PQ=tt(" Add"),MQ=[AQ,PQ],NQ={class:"list-group mb-3"},xQ=U("li",{class:"list-group-item list-group-item-warning"},[tt("Webhooks "),U("i",{class:"bi-robot"})],-1),LQ=["onClick"],jQ=U("i",{class:"bi-trash"},null,-1),UQ=[jQ],DQ={class:"list-group-item"},FQ=U("i",{class:"bi-robot"},null,-1),BQ=[FQ],qQ={class:"input-group"},WQ=["value"],HQ=U("i",{class:"bi-robot"},null,-1),GQ=tt(" Add"),VQ=[HQ,GQ],zQ={class:"alert alert-info text-center"},KQ=U("i",{class:"bi-trash"},null,-1),JQ=tt(" Delete Conversation"),YQ=[KQ,JQ],QQ={class:"col-9 pb-5"},XQ={key:0},ZQ={key:0,class:"alert alert-danger"},eX=U("i",{class:"bi-plug"},null,-1),tX=tt(" Connect"),rX=[eX,tX],nX=U("h5",{class:"alert-heading"},"Not Connected",-1),iX=U("p",null,"You are not connected to this conversation!",-1),aX=tt(" Trouble connecting? "),sX=tt("Refresh Token"),oX={key:1,class:"alert alert-success"},uX={class:"form-check"},lX=U("label",{class:"form-check-label",for:"flexCheckDefault"},[U("em",null,"Prepend Your Name")],-1),cX={class:"input-group"},fX=U("i",{class:"bi-lightning"},null,-1),dX=tt(" SEND"),pX=[fX,dX],hX={class:"mt-1 text-end"},vX=U("i",{class:"bi-image"},null,-1),gX=tt(" Send Image "),yX=[vX,gX],mX={class:"mt-3"},bX={class:"text-end"},wX={class:"bg-info rounded",style:{"min-height":"200px"}},_X={ref:"messagesDiv",class:"container-fluid pt-3 pb-3"},SX={class:"float-end"},$X={__name:"Conversation",setup(e){uo();const t=Nu(),r=W$(),n=q$(),i=B$(),a=n.params.sid?n.params.sid:"Not Found",s=nt(!1),u=nt(""),o=nt([]),c=nt([]),d=za({details:{}}),y=nt(!1),_=nt(!1),w=nt([]),k=nt(""),N=nt(""),M=nt(!1),L=nt({}),B=async()=>{try{const W=await fetch("/conversations/conversation-delete",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a}})});W.ok&&(console.log("Success! Conversation deleted..."),console.log("delete conversation response ==> ",W),i.replace({name:"conversations"}))}catch(J){console.log("deleteConversations error => ",J)}},ve=async()=>{try{(await fetch("/conversations/conversation-change-name",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,friendlyName:u.value}})})).ok&&(console.log("Success! Conversation name changed..."),s.value=!1,u.value="",xe())}catch(J){console.log("changeConversationName error => ",J)}},ue=async J=>{try{if((await fetch("/conversations/conversation-delete-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,participant:J}})})).ok){console.log("Success! Agent Removed from Conversation..."),y.value=!1;let R=null,Te=null;xe()}}catch(W){console.log("removeFromConversation error => ",W)}},Me=nt(!1),Re=nt(""),Ae=async J=>{try{let W=hs("chat","agent",J);(await fetch("/conversations/conversation-add-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,identity:J,attributes:W}})})).ok?(console.log("Success! Added Agent to conversation..."),Re.value="",Me.value=!1,xe()):console.log("Error! Unable to add Agent to conversation...")}catch(W){console.log("addAgentToConversation error => ",W)}},x=async()=>{try{console.log("addWHObj.value => ",L.value);let J={configuration:{}};L.value.target!=null&&(J.target=L.value.target),L.value.flowSid!=null&&(J.configuration.flowSid=L.value.flowSid),L.value.replayAfter!=null&&(J.configuration.replayAfter=L.value.replayAfter),L.value.method!=null&&(J.configuration.method=L.value.method),L.value.filters!=null&&(J.configuration.filters=L.value.filters),L.value.url!=null&&(J.configuration.url=L.value.url),console.log("createObject => ",J),(await fetch("/conversations/conversation-add-webhook",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,createObject:J}})})).ok?(console.log("Success! Added Webhook to conversation..."),L.value={},M.value=!1,xe()):console.log("Error! Unable to add Webhook to conversation...")}catch(J){console.log("addWebhookToConversation error => ",J)}},le=async J=>{try{if((await fetch("/conversations/conversation-delete-webhook",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,webhook:J}})})).ok){console.log("Success! Webhook Agent Removed from Conversation..."),y.value=!1;let R=null,Te=null;xe()}}catch(W){console.log("removeFromConversation error => ",W)}},F=nt(!1),Se=nt(""),Ee=nt(!1),oe=nt(""),te=async(J,W)=>{try{Ee.value=!1;let pe=hs("sms",J,W);const Te=await fetch("/conversations/conversation-add-mobile-phone-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,mobile_number:Se.value,attributes:pe}})});Te.ok?(console.log("Success! Added Mobile to conversation..."),Se.value="",F.value=!1,xe()):(console.log("Error! Unable to add Mobile to conversation..."),Ee.value=!0,oe.value="We are not able to add that phone number.",Te.status==409&&(oe.value="That phone number is in use in a different conversation."),F.value=!1,Se="")}catch(pe){console.log("addMobileToConversation error => ",pe)}},ae=nt(!1),ne=nt(""),be=nt(!1),A=nt(""),Le=async(J,W)=>{try{be.value=!1;let pe=hs("sms",J,W);const Te=await fetch("/conversations/conversation-add-mobile-phone-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,mobile_number:ne.value,attributes:pe}})});Te.ok?(console.log("Success! Added Agent Mobile to conversation..."),ne.value="",ae.value=!1,xe()):(console.log("Error! Unable to add Agent Mobile to conversation..."),be.value=!0,A.value="We are not able to add that phone number.",Te.status==409&&(A.value="That phone number is in use in a different conversation."),ae.value=!1,ne.value="")}catch(pe){console.log("addAgentMobileToConversation error => ",pe)}},at=nt(!1),We=nt(""),fe=nt(!1),V=nt(""),Q=async(J,W)=>{try{fe.value=!1;let pe=hs("whatsapp",J,W);const Te=await fetch("/conversations/conversation-add-mobile-phone-participant",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({payload:{conversationSid:a,mobile_number:We.value,attributes:pe}})});Te.ok?(console.log("Success! Added WhatsApp to conversation..."),We.value="",at.value=!1,xe()):(console.log("Error! Unable to add WhatsApp to conversation..."),fe.value=!0,V.value="We are not able to add that WhatsApp phone number.",Te.status==409&&(V.value="That WhatsApp phone number is in use in a different conversation."),at.value=!1,We="")}catch(pe){console.log("addWhatsAppToConversation error => ",pe)}},$=async()=>{try{let J=`/conversations/conversation-details?sid=${a}`;const W=await fetch(J,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(W.ok){let pe=await W.json();console.log("in getConversationDetails and r => ",pe),d.details=pe}}catch(J){console.log("getConversationDetails error => ",J)}},I=nt({}),Z=async()=>{try{let J=`/conversations/conversation-participants?sid=${a}`;const W=await fetch(J,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(W.ok){let pe=await W.json();console.log("getConversationParticipants response ==> ",pe),o.value=pe;for(let R=0;R<o.value.length;R++)console.log("participants.value[i].identity ==> ",o.value[R].identity),Object.keys(o.value[R].attributes).length>0&&(o.value[R].attributes=JSON.parse(o.value[R].attributes)),I.value[o.value[R].sid]=o.value[R].attributes,o.value[R].identity===t.agent.identity&&(console.log("found current agent ==> ",o.value[R].identity),N.value=o.value[R].sid,y.value=!0)}}catch(J){console.log("getConversationParticipants error => ",J)}},re=async()=>{try{let J=`/conversations/conversation-messages?sid=${a}`;const W=await fetch(J,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(W.ok){let pe=await W.json();console.log("getConversationMessages response ==> ",pe),c.value=pe.reverse();for(let R=0;R<c.value.length;R++){let Te=I.value[c.value[R].participantSid];Te==null&&(Te=JSON.parse(hs("bot","bot","Webhook"))),c.value[R].participantAttributes=Te}}}catch(J){console.log("getConversationMessages error => ",J)}},Ie=async()=>{try{let J=`/conversations/conversation-webhooks?sid=${a}`;const W=await fetch(J,{method:"GET",cache:"no-store",headers:{"Content-type":"application/json"}});if(W.ok){let pe=await W.json();console.log("getConversationWebhooks response ==> ",pe),w.value=pe;for(let R=0;R<w.value.length;R++)w.value[R].Name=r.webhooks.find(Te=>Te.data.flowSid===w.value[R].configuration.flow_sid).data.Name}}catch(J){console.log("getConversationWebhooks error => ",J)}},xe=async()=>{await $(),await Z(),await re(),await Ie()};let ce=null,$e=null;nt(!0),nt(""),nt("");const E=async()=>{ce=await new V$.Client(t.agent.accessToken),console.log("conversationsClient => ",ce),console.log("in connectToConversation and conversationsClient => ",ce),$e=await ce.getConversationBySid(a),console.log("twilioConversation => ",$e),_.value=!0,$e.on("messageAdded",J=>{console.log("New Message Added ==> ",J);let W=I.value[J.participantSid];W==null&&(W=JSON.parse(hs("bot","bot","Webhook"))),J.participantAttributes=W,c.value.unshift(J)}),$e.on("tokenExpired",J=>{console.log("Token Expired!")})},T=nt(!0),G=async()=>{try{let J=k.value;k.value="...",T.value&&(J=t.agent.identity+": "+J),await $e.sendMessage(J),k.value="",console.log("Sent Message...")}catch(J){_.value=!1,console.log("sendMessage error => ",J)}},ee=nt(!1),q=nt(null),ke=async()=>{const J={contentType:q.value.files[0].type,filename:q.value.files[0].name,media:q.value.files[0]};await $e.prepareMessage().addMedia(J).build().send(),ee.value=!1,q.value=null};return oo(()=>{xe()}),(J,W)=>{const pe=Tr("router-link");return Ge(),it("div",yY,[U("div",mY,[U("div",bY,[U("div",wY,[ze(U("button",{type:"button",class:"btn btn-sm btn-link float-end",onClick:W[0]||(W[0]=R=>s.value=!0)},SY,512),[[ct,!s.value]]),ze(U("div",$Y,[ze(U("input",{type:"text","onUpdate:modelValue":W[1]||(W[1]=R=>u.value=R),class:"form-control"},null,512),[[Ma,u.value]]),U("button",{type:"button",class:"btn btn-sm btn-success",onClick:W[2]||(W[2]=R=>ve())},TY)],512),[[ct,s.value]]),d.details.friendlyName!==null?ze((Ge(),it("h4",{key:0,class:"alert-heading"},Ht(d.details.friendlyName),513)),[[ct,!s.value]]):cr("",!0),d.details.friendlyName===null?ze((Ge(),it("h5",EY,CY,512)),[[ct,!s.value]]):cr("",!0)]),y.value?cr("",!0):(Ge(),it("div",RY,[U("div",OY,[AY,PY,MY,U("button",{type:"button",class:"btn btn-sm btn-info",onClick:W[3]||(W[3]=R=>Ae(Ot(t).agent.identity))},LY)])])),U("ul",jY,[UY,(Ge(!0),it(Kt,null,xn(o.value,R=>ze((Ge(),it("li",{class:"list-group-item",key:R.sid},[tt(Ht(R.identity)+" \xA0 ",1),U("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:Te=>ue(R.sid)},BY,8,DY)])),[[ct,R.identity!=null&&R.attributes.chat&&R.attributes.agent]])),128)),U("li",qY,[ze(U("span",null,"Add Agent",512),[[ct,!Me.value]]),ze(U("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:W[4]||(W[4]=R=>Me.value=!0)},HY,512),[[ct,!Me.value]]),ze(U("div",GY,[ze(U("select",{class:"form-select","onUpdate:modelValue":W[5]||(W[5]=R=>Re.value=R)},[(Ge(!0),it(Kt,null,xn(Ot(t).agents,R=>(Ge(),it("option",{key:R,value:R},Ht(R),9,VY))),128))],512),[[Up,Re.value]]),U("button",{type:"button",class:"btn btn-sm btn-success",onClick:W[6]||(W[6]=R=>Ae(Re.value))},JY)],512),[[ct,Me.value]])])]),U("ul",YY,[QY,(Ge(!0),it(Kt,null,xn(o.value,R=>{var Te;return ze((Ge(),it("li",{class:"list-group-item",key:R.sid},[tt(Ht((Te=R.messagingBinding)==null?void 0:Te.address)+" ",1),U("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:Ne=>ue(R.sid)},eQ,8,XY)])),[[ct,R.messagingBinding!=null&&R.attributes.agent]])}),128)),U("li",tQ,[ze(U("span",null,"Add Agent SMS",512),[[ct,!ae.value]]),ze(U("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:W[7]||(W[7]=R=>ae.value=!0)},nQ,512),[[ct,!ae.value]]),ze(U("div",iQ,[ze(U("input",{type:"text","onUpdate:modelValue":W[8]||(W[8]=R=>ne.value=R),class:"form-control"},null,512),[[Ma,ne.value]]),U("button",{type:"button",class:"btn btn-sm btn-success",onClick:W[9]||(W[9]=R=>Le("agent","Agent"))},oQ)],512),[[ct,ae.value]]),ze(U("p",{class:"text-danger"},Ht(A.value),513),[[ct,be.value]])])]),U("ul",uQ,[lQ,(Ge(!0),it(Kt,null,xn(o.value,R=>ze((Ge(),it("li",{class:"list-group-item",key:R.sid},[tt(Ht(Ot(G$)(R.identity))+" \xA0 ",1),U("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:Te=>ue(R.sid)},dQ,8,cQ)])),[[ct,R.identity!==null&&R.attributes.chat&&R.attributes.enduser]])),128))]),U("ul",pQ,[hQ,(Ge(!0),it(Kt,null,xn(o.value,R=>{var Te;return ze((Ge(),it("li",{class:"list-group-item",key:R.sid},[tt(Ht((Te=R.messagingBinding)==null?void 0:Te.address)+" ",1),U("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:Ne=>ue(R.sid)},yQ,8,vQ)])),[[ct,R.messagingBinding!=null&&R.attributes.enduser]])}),128)),U("li",mQ,[ze(U("span",null,"Add SMS Participant",512),[[ct,!F.value]]),ze(U("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:W[10]||(W[10]=R=>F.value=!0)},wQ,512),[[ct,!F.value]]),ze(U("div",_Q,[ze(U("input",{type:"text","onUpdate:modelValue":W[11]||(W[11]=R=>Se.value=R),class:"form-control"},null,512),[[Ma,Se.value]]),U("button",{type:"button",class:"btn btn-sm btn-success",onClick:W[12]||(W[12]=R=>te("enduser","End User"))},kQ)],512),[[ct,F.value]]),ze(U("p",{class:"text-danger"},Ht(oe.value),513),[[ct,Ee.value]])])]),U("ul",TQ,[EQ,U("li",IQ,[ze(U("span",null,"Add WhatsApp Participant",512),[[ct,!at.value]]),ze(U("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:W[13]||(W[13]=R=>at.value=!0)},RQ,512),[[ct,!at.value]]),ze(U("div",OQ,[ze(U("input",{type:"text","onUpdate:modelValue":W[14]||(W[14]=R=>We.value=R),class:"form-control"},null,512),[[Ma,We.value]]),U("button",{type:"button",class:"btn btn-sm btn-success",onClick:W[15]||(W[15]=R=>Q("enduser","End User"))},MQ)],512),[[ct,at.value]]),ze(U("p",{class:"text-danger"},Ht(V.value),513),[[ct,fe.value]])])]),U("ul",NQ,[xQ,(Ge(!0),it(Kt,null,xn(w.value,R=>(Ge(),it("li",{class:"list-group-item",key:R.sid},[tt(Ht(R.Name)+" ",1),U("button",{type:"button",class:"btn btn-sm btn-warning float-end",onClick:Te=>le(R.sid)},UQ,8,LQ)]))),128)),U("li",DQ,[ze(U("span",null,"Add Webhook",512),[[ct,!M.value]]),ze(U("button",{type:"button",class:"btn btn-sm btn-success float-end",onClick:W[16]||(W[16]=R=>M.value=!0)},BQ,512),[[ct,!M.value]]),ze(U("div",qQ,[ze(U("select",{class:"form-select","onUpdate:modelValue":W[17]||(W[17]=R=>L.value=R)},[(Ge(!0),it(Kt,null,xn(Ot(r).webhooks,R=>(Ge(),it("option",{key:R.index,value:R.data},Ht(R.data.Name),9,WQ))),128))],512),[[Up,L.value]]),U("button",{type:"button",class:"btn btn-sm btn-success",onClick:W[18]||(W[18]=R=>x())},VQ)],512),[[ct,M.value]])])]),U("div",zQ,[U("button",{type:"button",class:"btn btn-sm btn-danger",onClick:W[19]||(W[19]=R=>B())},YQ)])]),U("div",QQ,[y.value?(Ge(),it("div",XQ,[_.value?cr("",!0):(Ge(),it("div",ZQ,[U("button",{type:"button",class:"btn btn-sm btn-danger float-end",onClick:W[20]||(W[20]=R=>E())},rX),nX,iX,U("p",null,[aX,bt(pe,{to:"/agent"},{default:ar(()=>[sX]),_:1})])])),_.value?(Ge(),it("div",oX,[U("form",{onSubmit:W[25]||(W[25]=YC((...R)=>J.submitForm&&J.submitForm(...R),["prevent"]))},[U("div",uX,[ze(U("input",{"onUpdate:modelValue":W[21]||(W[21]=R=>T.value=R),class:"form-check-input",type:"checkbox",id:"flexCheckDefault"},null,512),[[zC,T.value]]),lX]),U("div",cX,[ze(U("input",{onKeyup:W[22]||(W[22]=XC(R=>G(),["enter"])),type:"text",class:"form-control","onUpdate:modelValue":W[23]||(W[23]=R=>k.value=R),"aria-describedby":"btnGroupAddon"},null,544),[[Ma,k.value]]),U("button",{type:"button",class:"btn btn-primary",onClick:W[24]||(W[24]=R=>G())},pX)])],32),ze(U("div",hX,[U("button",{onClick:W[26]||(W[26]=R=>ee.value=!0),class:"btn btn-sm btn-link"},yX)],512),[[ct,!ee.value]]),ze(U("div",mX,[U("input",{ref_key:"file",ref:q,onChange:W[27]||(W[27]=R=>ke()),class:"form-control form-control-sm",id:"formFileSm",type:"file"},null,544)],512),[[ct,ee.value]]),ze(U("div",bX,[U("button",{onClick:W[28]||(W[28]=R=>ee.value=!1),class:"btn btn-sm btn-link"}," Cancel ")],512),[[ct,ee.value]])])):cr("",!0)])):cr("",!0),U("div",wX,[U("div",_X,[(Ge(!0),it(Kt,null,xn(c.value,R=>(Ge(),Cn(gY,{participant:R.participantAttributes,key:R.sid,mSid:R.sid,pSid:R.participantSid,dateCreated:R.dateCreated,author:R.author,content:R.body,media:R.media,cSid:d.details.sid},null,8,["participant","mSid","pSid","dateCreated","author","content","media","cSid"]))),128))],512)]),U("p",SX,[U("em",null,Ht(d.details.sid),1)])])])])}}},kX={name:"App",components:{Layout:xu,Conversation:$X}};function TX(e,t,r,n,i,a){const s=Tr("Conversation"),u=Tr("Layout");return Ge(),Cn(u,null,{default:ar(()=>[bt(s)]),_:1})}const EX=hi(kX,[["render",TX]]),IE=lO({history:IR(),routes:[{name:"home",path:"/",component:eA},{name:"login",path:"/login",component:PA},{name:"agent",path:"/agent",component:sP},{name:"conversations",path:"/conversations",component:UP},{name:"conversation",path:"/conversation/:sid",component:EX}]});IE.beforeEach(async(e,t)=>{if(uo().lists.length===0&&e.name!=="home")return{name:"home"}});const ry=tR(fO);ry.use(iR());ry.use(IE);ry.mount("#app");
